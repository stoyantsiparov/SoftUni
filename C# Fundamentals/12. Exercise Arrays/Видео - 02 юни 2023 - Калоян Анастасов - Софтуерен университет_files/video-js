(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):(n=n||self,n.videojs=t())})(this,function(){"use strict";function us(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n["default"]:n}function dt(n,t){return t={exports:{}},n(t,t.exports),t.exports}function eb(n){var i="info",r,t=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];r("log",i,u)};return r=fb(n,t),t.createLogger=function(t){return eb(n+": "+t)},t.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:i},t.level=function(n){if(typeof n=="string"){if(!t.levels.hasOwnProperty(n))throw new Error('"'+n+'" in not a valid log level');i=n}return i},t.history=function(){return st?[].concat(st):[]},t.history.filter=function(n){return(st||[]).filter(function(t){return new RegExp(".*"+n+".*").test(t[0])})},t.history.clear=function(){st&&(st.length=0)},t.history.disable=function(){st!==null&&(st.length=0,st=null)},t.history.enable=function(){st===null&&(st=[])},t.error=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("error",i,u)},t.warn=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("warn",i,u)},t.debug=function(){for(var t=arguments.length,u=new Array(t),n=0;n<t;n++)u[n]=arguments[n];return r("debug",i,u)},t}function lu(n,t){sb(n).forEach(function(i){return t(n[i],i)})}function oot(n,t,i){return i===void 0&&(i=0),sb(n).reduce(function(i,r){return t(i,n[r],r)},i)}function y(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return Object.assign?oe.apply(void 0,[n].concat(r)):(r.forEach(function(t){t&&lu(t,function(t,i){n[i]=t})}),n)}function ur(n){return!!n&&typeof n=="object"}function se(n){return ur(n)&&eot.call(n)==="[object Object]"&&n.constructor===Object}function he(n,i){if(!n||!i)return"";if(typeof t.getComputedStyle=="function"){var r=t.getComputedStyle(n);return r?r.getPropertyValue(i)||r[i]:""}return""}function pb(n){return typeof n=="string"&&Boolean(n.trim())}function wb(n){if(n.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters");}function lot(n){return new RegExp("(^|\\s)"+n+"($|\\s)")}function vu(){return r===t.document}function yu(n){return ur(n)&&n.nodeType===1}function bb(){try{return t.parent!==t.self}catch(n){return!0}}function kb(n){return function(t,i){if(!pb(t))return r[n](null);pb(i)&&(i=r.querySelector(i));var u=yu(i)?i:r;return u[n]&&u[n](t)}}function p(n,t,i,u){n===void 0&&(n="div");t===void 0&&(t={});i===void 0&&(i={});var f=r.createElement(n);return Object.getOwnPropertyNames(t).forEach(function(n){var i=t[n];n.indexOf("aria-")!==-1||n==="role"||n==="type"?(h.warn("Setting attributes in the second argument of createEl()\nhas been deprecated. Use the third argument instead.\n"+("createEl(type, properties, attributes). Attempting to set "+n+" to "+i+".")),f.setAttribute(n,i)):n==="textContent"?pu(f,i):(f[n]!==i||n==="tabIndex")&&(f[n]=i)}),Object.getOwnPropertyNames(i).forEach(function(n){f.setAttribute(n,i[n])}),u&&gl(f,u),f}function pu(n,t){return typeof n.textContent=="undefined"?n.innerText=t:n.textContent=t,n}function wl(n,t){t.firstChild?t.insertBefore(n,t.firstChild):t.appendChild(n)}function lr(n,t){return(wb(t),n.classList)?n.classList.contains(t):lot(t).test(n.className)}function di(n,t){return n.classList?n.classList.add(t):lr(n,t)||(n.className=(n.className+" "+t).trim()),n}function ae(n,t){return n.classList?n.classList.remove(t):(wb(t),n.className=n.className.split(/\s+/).filter(function(n){return n!==t}).join(" ")),n}function db(n,t,i){var r=lr(n,t);if(typeof i=="function"&&(i=i(n,t)),typeof i!="boolean"&&(i=!r),i!==r)return i?di(n,t):ae(n,t),n}function gb(n,t){Object.getOwnPropertyNames(t).forEach(function(i){var r=t[i];r===null||typeof r=="undefined"||r===!1?n.removeAttribute(i):n.setAttribute(i,r===!0?"":r)})}function gi(n){var f={},i,t,r,u;if(n&&n.attributes&&n.attributes.length>0)for(i=n.attributes,t=i.length-1;t>=0;t--)r=i[t].name,u=i[t].value,(typeof n[r]=="boolean"||",autoplay,controls,playsinline,loop,muted,default,defaultMuted,".indexOf(","+r+",")!==-1)&&(u=u!==null?!0:!1),f[r]=u;return f}function nk(n,t){return n.getAttribute(t)}function ve(n,t,i){n.setAttribute(t,i)}function ss(n,t){n.removeAttribute(t)}function tk(){r.body.focus();r.onselectstart=function(){return!1}}function ik(){r.onselectstart=function(){return!0}}function bl(n){if(n&&n.getBoundingClientRect&&n.parentNode){var i=n.getBoundingClientRect(),t={};return["bottom","height","left","right","top","width"].forEach(function(n){i[n]!==undefined&&(t[n]=i[n])}),t.height||(t.height=parseFloat(he(n,"height"))),t.width||(t.width=parseFloat(he(n,"width"))),t}}function ye(n){if(!n||n&&!n.offsetParent)return{left:0,top:0,width:0,height:0};for(var u=n.offsetWidth,f=n.offsetHeight,t=0,i=0;n.offsetParent&&n!==r[fs.fullscreenElement];)t+=n.offsetLeft,i+=n.offsetTop,n=n.offsetParent;return{left:t,top:i,width:u,height:f}}function kl(n,t){var i={x:0,y:0},r,f,e,o;if(gt)for(r=n;r&&r.nodeName.toLowerCase()!=="html";)f=he(r,"transform"),/^matrix/.test(f)?(e=f.slice(7,-1).split(/,\s/).map(Number),i.x+=e[4],i.y+=e[5]):/^matrix3d/.test(f)&&(o=f.slice(9,-1).split(/,\s/).map(Number),i.x+=o[12],i.y+=o[13]),r=r.parentNode;var s={},l=ye(t.target),u=ye(n),a=u.width,v=u.height,h=t.offsetY-(u.top-l.top),c=t.offsetX-(u.left-l.left);return t.changedTouches&&(c=t.changedTouches[0].pageX-u.left,h=t.changedTouches[0].pageY+u.top,gt&&(c-=i.x,h-=i.y)),s.y=1-Math.max(0,Math.min(1,h/v)),s.x=Math.max(0,Math.min(1,c/a)),s}function rk(n){return ur(n)&&n.nodeType===3}function dl(n){while(n.firstChild)n.removeChild(n.firstChild);return n}function uk(n){return typeof n=="function"&&(n=n()),(Array.isArray(n)?n:[n]).map(function(n){return(typeof n=="function"&&(n=n()),yu(n)||rk(n))?n:typeof n=="string"&&/\S/.test(n)?r.createTextNode(n):void 0}).filter(function(n){return n})}function gl(n,t){return uk(t).forEach(function(t){return n.appendChild(t)}),n}function fk(n,t){return gl(dl(n),t)}function wu(n){return n.button===undefined&&n.buttons===undefined?!0:n.button===0&&n.buttons===undefined?!0:n.type==="mouseup"&&n.button===0&&n.buttons===0?!0:n.button!==0||n.buttons!==1?!1:!0}function ta(n,i){i&&(na=i);t.setTimeout(aot,n)}function ia(){sk=!0;t.removeEventListener("load",ia)}function or(){return vot++}function ak(n,t){if(ut.has(n)){var i=ut.get(n);i.handlers[t].length===0&&(delete i.handlers[t],n.removeEventListener?n.removeEventListener(t,i.dispatcher,!1):n.detachEvent&&n.detachEvent("on"+t,i.dispatcher));Object.getOwnPropertyNames(i.handlers).length<=0&&(delete i.handlers,delete i.dispatcher,delete i.disabled);Object.getOwnPropertyNames(i).length===0&&ut["delete"](n)}}function ra(n,t,i,r){i.forEach(function(i){n(t,i,r)})}function hs(n){function o(){return!0}function s(){return!1}var i,u,f,e;if(n.fixed_)return n;if(!n||!n.isPropagationStopped){i=n||t.event;n={};for(u in i)u!=="layerX"&&u!=="layerY"&&u!=="keyLocation"&&u!=="webkitMovementX"&&u!=="webkitMovementY"&&(u==="returnValue"&&i.preventDefault||(n[u]=i[u]));n.target||(n.target=n.srcElement||r);n.relatedTarget||(n.relatedTarget=n.fromElement===n.target?n.toElement:n.fromElement);n.preventDefault=function(){i.preventDefault&&i.preventDefault();n.returnValue=!1;i.returnValue=!1;n.defaultPrevented=!0};n.defaultPrevented=!1;n.stopPropagation=function(){i.stopPropagation&&i.stopPropagation();n.cancelBubble=!0;i.cancelBubble=!0;n.isPropagationStopped=o};n.isPropagationStopped=s;n.stopImmediatePropagation=function(){i.stopImmediatePropagation&&i.stopImmediatePropagation();n.isImmediatePropagationStopped=o;n.stopPropagation()};n.isImmediatePropagationStopped=s;n.clientX!==null&&n.clientX!==undefined&&(f=r.documentElement,e=r.body,n.pageX=n.clientX+(f&&f.scrollLeft||e&&e.scrollLeft||0)-(f&&f.clientLeft||e&&e.clientLeft||0),n.pageY=n.clientY+(f&&f.scrollTop||e&&e.scrollTop||0)-(f&&f.clientTop||e&&e.clientTop||0));n.which=n.charCode||n.keyCode;n.button!==null&&n.button!==undefined&&(n.button=n.button&1?0:n.button&4?1:n.button&2?2:0)}return n.fixed_=!0,n}function ni(n,t,i){var r,u;if(Array.isArray(t))return ra(ni,n,t,i);ut.has(n)||ut.set(n,{});r=ut.get(n);r.handlers||(r.handlers={});r.handlers[t]||(r.handlers[t]=[]);i.guid||(i.guid=or());r.handlers[t].push(i);r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,i){var f,e,u,o;if(!r.disabled&&(t=hs(t),f=r.handlers[t.type],f))for(e=f.slice(0),u=0,o=e.length;u<o;u++)if(t.isImmediatePropagationStopped())break;else try{e[u].call(n,t,i)}catch(s){h.error(s)}});r.handlers[t].length===1&&(n.addEventListener?(u=!1,vk()&&yk.indexOf(t)>-1&&(u={passive:!0}),n.addEventListener(t,r.dispatcher,u)):n.attachEvent&&n.attachEvent("on"+t,r.dispatcher))}function ft(n,t,i){var r,e,o,u,f;if(ut.has(n)&&(r=ut.get(n),r.handlers)){if(Array.isArray(t))return ra(ft,n,t,i);if(e=function(n,t){r.handlers[t]=[];ak(n,t)},t===undefined){for(o in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},o)&&e(n,o);return}if(u=r.handlers[t],u){if(!i){e(n,t);return}if(i.guid)for(f=0;f<u.length;f++)u[f].guid===i.guid&&u.splice(f--,1);ak(n,t)}}}function bu(n,t,i){var f=ut.has(n)?ut.get(n):{},r=n.parentNode||n.ownerDocument,u;return typeof t=="string"?t={type:t,target:n}:t.target||(t.target=n),t=hs(t),f.dispatcher&&f.dispatcher.call(n,t,i),r&&!t.isPropagationStopped()&&t.bubbles===!0?bu.call(null,r,t,i):!r&&!t.defaultPrevented&&t.target&&t.target[t.type]&&(ut.has(t.target)||ut.set(t.target,{}),u=ut.get(t.target),t.target[t.type]&&(u.disabled=!0,typeof t.target[t.type]=="function"&&t.target[t.type](),u.disabled=!1)),!t.defaultPrevented}function ls(n,t,i){if(Array.isArray(t))return ra(ls,n,t,i);var r=function r(){ft(n,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||or();ni(n,t,r)}function pk(n,t,i){var r=function r(){ft(n,t,r);i.apply(this,arguments)};r.guid=i.guid=i.guid||or();ni(n,t,r)}function ea(n,i){i===void 0&&(i={});var u=i,r=u.eventBusKey;if(r){if(!n[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');n.eventBusEl_=n[r]}else n.eventBusEl_=p("span",{className:"vjs-event-bus"});y(n,bot);n.eventedCallbacks&&n.eventedCallbacks.forEach(function(n){n()});n.on("dispose",function(){n.off();t.setTimeout(function(){n.eventBusEl_=null},0)});return n}function dk(n,t){if(y(n,kk),n.state=y({},n.state,t),typeof n.handleStateChanged=="function"&&tr(n))n.on("statechanged",n.handleStateChanged);return n}function v(){for(var n={},i=arguments.length,r=new Array(i),t=0;t<i;t++)r[t]=arguments[t];return r.forEach(function(t){t&&lu(t,function(t,i){if(!se(t)){n[i]=t;return}se(n[i])||(n[i]={});n[i]=v(n[i],t)})}),n}function tst(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function ist(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function rst(n,t,i){if(typeof t!="number"||t<0||t>i)throw new Error("Failed to execute '"+n+"' on 'TimeRanges': The index provided ("+t+") is non-numeric or out of bounds (0-"+i+").");}function gk(n,t,i,r){return rst(n,r,i.length-1),i[r][t]}function sa(n){return n===undefined||n.length===0?{length:0,start:function(){throw new Error("This TimeRanges object is empty");},end:function(){throw new Error("This TimeRanges object is empty");}}:{length:n.length,start:gk.bind(null,"start",0,n),end:gk.bind(null,"end",1,n)}}function yr(n,t){return Array.isArray(n)?sa(n):n===undefined||t===undefined?sa():sa([[n,t]])}function nd(n,t){var u=0,f,r,i;if(!t)return 0;for(n&&n.length||(n=yr(0,0)),i=0;i<n.length;i++)f=n.start(i),r=n.end(i),r>t&&(r=t),u+=r-f;return u/t}function ht(n){if(n instanceof ht)return n;typeof n=="number"?this.code=n:typeof n=="string"?this.message=n:ur(n)&&(typeof n.code=="number"&&(this.code=n.code),y(this,n));this.message||(this.message=ht.defaultMessages[this.code]||"")}function ust(n,t){var i,r=null;try{i=JSON.parse(n,t)}catch(u){r=u}return[r,i]}function we(n){return n!==undefined&&n!==null&&typeof n.then=="function"}function wr(n){we(n)&&n.then(null,function(){})}function bst(n){var t=wst.call(n);return t==="[object Function]"||typeof n=="function"&&t!=="[object RegExp]"||typeof window!="undefined"&&(n===window.setTimeout||n===window.alert||n===window.confirm||n===window.prompt)}function gst(n,t){for(var i=0;i<n.length;i++)t(n[i])}function nht(n){for(var t in n)if(n.hasOwnProperty(t))return!1;return!0}function hd(n,t,i){var r=n;return pst(t)?(i=t,typeof n=="string"&&(r={uri:n})):r=oe({},t,{uri:n}),r.callback=i,r}function ir(n,t,i){return t=hd(n,t,i),cd(t)}function cd(n){function w(){t.readyState===4&&setTimeout(v,0)}function b(){var n=undefined;if(n=t.response?t.response:t.responseText||tht(t),y)try{n=JSON.parse(n)}catch(i){}return n}function s(n){return clearTimeout(a),n instanceof Error||(n=new Error(""+(n||"Unknown XMLHttpRequest Error"))),n.statusCode=0,o(n,p)}function v(){var u,i,e;if(!f)return clearTimeout(a),u=n.useXDR&&t.status===undefined?200:t.status===1223?204:t.status,i=p,e=null,u!==0?(i={body:b(),statusCode:u,method:r,headers:{},url:h,rawRequest:t},t.getAllResponseHeaders&&(i.headers=kst(t.getAllResponseHeaders()))):e=new Error("Internal XMLHttpRequest Error"),o(e,i,i.body)}var e,o,t;if(typeof n.callback=="undefined")throw new Error("callback argument missing");e=!1;o=function(t,i,r){e||(e=!0,n.callback(t,i,r))};t=n.xhr||null;t||(t=n.cors||n.useXDR?new ir.XDomainRequest:new ir.XMLHttpRequest);var u,f,h=t.url=n.uri||n.url,r=t.method=n.method||"GET",c=n.body||n.data,i=t.headers=n.headers||{},l=!!n.sync,y=!1,a,p={body:undefined,headers:{},statusCode:0,method:r,url:h,rawRequest:t};if("json"in n&&n.json!==!1&&(y=!0,i.accept||i.Accept||(i.Accept="application/json"),r!=="GET"&&r!=="HEAD"&&(i["content-type"]||i["Content-Type"]||(i["Content-Type"]="application/json"),c=JSON.stringify(n.json===!0?c:n.json))),t.onreadystatechange=w,t.onload=v,t.onerror=s,t.onprogress=function(){},t.onabort=function(){f=!0},t.ontimeout=s,t.open(r,h,!l,n.username,n.password),l||(t.withCredentials=!!n.withCredentials),!l&&n.timeout>0&&(a=setTimeout(function(){if(!f){f=!0;t.abort("timeout");var n=new Error("XMLHttpRequest timeout");n.code="ETIMEDOUT";s(n)}},n.timeout)),t.setRequestHeader)for(u in i)i.hasOwnProperty(u)&&t.setRequestHeader(u,i[u]);else if(n.headers&&!nht(n.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in n&&(t.responseType=n.responseType),"beforeSend"in n&&typeof n.beforeSend=="function"&&n.beforeSend(t),t.send(c||null),t}function tht(n){try{if(n.responseType==="document")return n.responseXML;var t=n.responseXML&&n.responseXML.documentElement.nodeName==="parsererror";if(n.responseType===""&&!t)return n.responseXML}catch(i){}return null}function iht(){}function ii(n,t){this.name="ParsingError";this.code=n.code;this.message=t||n.message}function ba(n){function i(n,t,i,r){return(n|0)*3600+(t|0)*60+(i|0)+(r|0)/1e3}var t=n.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return t?t[3]?i(t[1],t[2],t[3].replace(":",""),t[4]):t[1]>59?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null}function ke(){this.values=ws(null)}function de(n,t,i,r){var f=r?n.split(r):[n],e,u,o,s;for(e in f)typeof f[e]=="string"&&(u=f[e].split(i),u.length===2)&&(o=u[0],s=u[1],t(o,s))}function rht(n,t,i){function f(){var t=ba(n);if(t===null)throw new ii(ii.Errors.BadTimeStamp,"Malformed timestamp: "+u);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function e(n,t){var r=new ke;de(n,function(n,t){var f,u,e;switch(n){case"region":for(f=i.length-1;f>=0;f--)if(i[f].id===t){r.set(n,i[f].region);break}break;case"vertical":r.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");e=u[0];r.integer(n,e);r.percent(n,e)?r.set("snapToLines",!1):null;r.alt(n,e,["auto"]);u.length===2&&r.alt("lineAlign",u[1],["start","center","end"]);break;case"position":u=t.split(",");r.percent(n,u[0]);u.length===2&&r.alt("positionAlign",u[1],["start","center","end"]);break;case"size":r.percent(n,t);break;case"align":r.alt(n,t,["start","center","end","left","right"])}},/:/,/\s/);t.region=r.get("region",null);t.vertical=r.get("vertical","");try{t.line=r.get("line","auto")}catch(u){}t.lineAlign=r.get("lineAlign","start");t.snapToLines=r.get("snapToLines",!0);t.size=r.get("size",100);try{t.align=r.get("align","center")}catch(u){t.align=r.get("align","middle")}try{t.position=r.get("position","auto")}catch(u){t.position=r.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},t.align)}t.positionAlign=r.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},t.align)}function r(){n=n.replace(/^\s+/,"")}var u=n;if(r(),t.startTime=f(),r(),n.substr(0,3)!=="-->")throw new ii(ii.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+u);n=n.substr(3);r();t.endTime=f();r();e(n,t)}function dd(n,t){function c(){function i(n){return t=t.substr(n.length),n}if(!t)return null;var n=t.match(/^([^<]*)(<[^>]*>?)?/);return i(n[1]?n[1]:n[2])}function l(n){return ka.innerHTML=n,n=ka.textContent,ka.textContent="",n}function a(n,t){return!kd[t.localName]||kd[t.localName]===n.localName}function v(t,i){var f=uht[t],r,u;return f?(r=n.document.createElement(f),u=fht[t],u&&i&&(r[u]=i.trim()),r):null}for(var h=n.document.createElement("div"),u=h,r,e=[],o,i,f,s;(r=c())!==null;){if(r[0]==="<"){if(r[1]==="/"){e.length&&e[e.length-1]===r.substr(2).replace(">","")&&(e.pop(),u=u.parentNode);continue}if(o=ba(r.substr(1,r.length-2)),o){i=n.document.createProcessingInstruction("timestamp",o);u.appendChild(i);continue}if(f=r.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/),!f)continue;if(i=v(f[1],f[3]),!i)continue;if(!a(u,i))continue;f[2]&&(s=f[2].split("."),s.forEach(function(n){var t=/^bg_/.test(n),r=t?n.slice(3):n,u,f;bd.hasOwnProperty(r)&&(u=t?"background-color":"color",f=bd[r],i.style[u]=f)}),i.className=s.join(" "));e.push(f[1]);u.appendChild(i);u=i;continue}u.appendChild(n.document.createTextNode(l(r)))}return h}function eht(n){for(var i,t=0;t<da.length;t++)if(i=da[t],n>=i[0]&&n<=i[1])return!0;return!1}function oht(n){function e(n,t){for(var i=t.childNodes.length-1;i>=0;i--)n.push(t.childNodes[i])}function r(n){var t,i,u;return!n||!n.length?null:(t=n.pop(),i=t.textContent||t.innerText,i)?(u=i.match(/^.*(\n|\r)/),u)?(n.length=0,u[0]):i:t.tagName==="ruby"?r(n):t.childNodes?(e(n,t),r(n)):void 0}var u=[],i="",f,t;if(!n||!n.childNodes)return"ltr";for(e(u,n);i=r(u);)for(t=0;t<i.length;t++)if(f=i.charCodeAt(t),eht(f))return"rtl";return"ltr"}function sht(n){var t;if(typeof n.line=="number"&&(n.snapToLines||n.line>=0&&n.line<=100))return n.line;if(!n.track||!n.track.textTrackList||!n.track.textTrackList.mediaElement)return-1;var r=n.track,i=r.textTrackList,u=0;for(t=0;t<i.length&&i[t]!==r;t++)i[t].mode==="showing"&&u++;return++u*-1}function bs(){}function ks(n,t,i){var u,r;bs.call(this);this.cue=t;this.cueDiv=dd(n,t.text);u={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(u,this.cueDiv);this.div=n.document.createElement("div");u={direction:oht(this.cueDiv),writingMode:t.vertical===""?"horizontal-tb":t.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:t.align==="middle"?"center":t.align,font:i.font,whiteSpace:"pre-line",position:"absolute"};this.applyStyles(u);this.div.appendChild(this.cueDiv);r=0;switch(t.positionAlign){case"start":r=t.position;break;case"center":r=t.position-t.size/2;break;case"end":r=t.position-t.size}t.vertical===""?this.applyStyles({left:this.formatStyle(r,"%"),width:this.formatStyle(t.size,"%")}):this.applyStyles({top:this.formatStyle(r,"%"),height:this.formatStyle(t.size,"%")});this.move=function(n){this.applyStyles({top:this.formatStyle(n.top,"px"),bottom:this.formatStyle(n.bottom,"px"),left:this.formatStyle(n.left,"px"),right:this.formatStyle(n.right,"px"),height:this.formatStyle(n.height,"px"),width:this.formatStyle(n.width,"px")})}}function ct(n){var i,r,f,u,t;n.div&&(r=n.div.offsetHeight,f=n.div.offsetWidth,u=n.div.offsetTop,t=(t=n.div.childNodes)&&(t=t[0])&&t.getClientRects&&t.getClientRects(),n=n.div.getBoundingClientRect(),i=t?Math.max(t[0]&&t[0].height||0,n.height/t.length):0);this.left=n.left;this.right=n.right;this.top=n.top||u;this.height=n.height||r;this.bottom=n.bottom||u+(n.height||r);this.width=n.width||f;this.lineHeight=i!==undefined?i:n.lineHeight}function hht(n,t,i,r){function y(n,t){for(var f,e,o=new ct(n),s=1,u=0;u<t.length;u++){while(n.overlapsOppositeAxis(i,t[u])||n.within(i)&&n.overlapsAny(r))n.move(t[u]);if(n.within(i))return n;f=n.intersectPercentage(i);s>f&&(e=new ct(n),s=f);n=new ct(o)}return e||o}var o=new ct(t),e=t.cue,f=sht(e),u=[],h,l,v;if(e.snapToLines){switch(e.vertical){case"":u=["+y","-y"];h="height";break;case"rl":u=["+x","-x"];h="width";break;case"lr":u=["-x","+x"];h="width"}var c=o.lineHeight,s=c*Math.round(f),a=i[h]+c,p=u[0];Math.abs(s)>a&&(s=(s<0?-1:1)*Math.ceil(a/c)*c);f<0&&(s+=e.vertical===""?i.height:i.width,u=u.reverse());o.move(p,s)}else{l=o.lineHeight/i.height*100;switch(e.lineAlign){case"center":f-=l/2;break;case"end":f-=l}switch(e.vertical){case"":t.applyStyles({top:t.formatStyle(f,"%")});break;case"rl":t.applyStyles({left:t.formatStyle(f,"%")});break;case"lr":t.applyStyles({right:t.formatStyle(f,"%")})}u=["+y","-x","+x","-y"];o=new ct(t)}v=y(o,u);t.move(v.toCSSCompatValues(i))}function gu(){}function bht(n){if(typeof n!="string")return!1;var t=pht[n.toLowerCase()];return t?n.toLowerCase():!1}function ga(n){if(typeof n!="string")return!1;var t=wht[n.toLowerCase()];return t?n.toLowerCase():!1}function gd(n,t,i){this.hasBeenReset=!1;var r="",u=!1,f=n,e=t,o=i,s=null,h="",c=!0,l="auto",a="start",v="auto",y="auto",p=100,w="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return r},set:function(n){r=""+n}},pauseOnExit:{enumerable:!0,get:function(){return u},set:function(n){u=!!n}},startTime:{enumerable:!0,get:function(){return f},set:function(n){if(typeof n!="number")throw new TypeError("Start time must be set to a number.");f=n;this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return e},set:function(n){if(typeof n!="number")throw new TypeError("End time must be set to a number.");e=n;this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return o},set:function(n){o=""+n;this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return s},set:function(n){s=n;this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return h},set:function(n){var t=bht(n);if(t===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");h=t;this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(n){c=!!n;this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return l},set:function(n){if(typeof n!="number"&&n!==yht)throw new SyntaxError("Line: an invalid number or illegal string was specified.");l=n;this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return a},set:function(n){var t=ga(n);t?(a=t,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return v},set:function(n){if(n<0||n>100)throw new Error("Position must be between 0 and 100.");v=n;this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return y},set:function(n){var t=ga(n);t?(y=t,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return p},set:function(n){if(n<0||n>100)throw new Error("Size must be between 0 and 100.");p=n;this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return w},set:function(n){var t=ga(n);if(!t)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");w=t;this.hasBeenReset=!0}}});this.displayState=undefined}function kht(n){if(typeof n!="string")return!1;var t=tg[n.toLowerCase()];return t?n.toLowerCase():!1}function ge(n){return typeof n=="number"&&n>=0&&n<=100}function dht(){var n=100,t=3,i=0,r=100,u=0,f=100,e="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return n},set:function(t){if(!ge(t))throw new Error("Width must be between 0 and 100.");n=t}},lines:{enumerable:!0,get:function(){return t},set:function(n){if(typeof n!="number")throw new TypeError("Lines must be set to a number.");t=n}},regionAnchorY:{enumerable:!0,get:function(){return r},set:function(n){if(!ge(n))throw new Error("RegionAnchorX must be between 0 and 100.");r=n}},regionAnchorX:{enumerable:!0,get:function(){return i},set:function(n){if(!ge(n))throw new Error("RegionAnchorY must be between 0 and 100.");i=n}},viewportAnchorY:{enumerable:!0,get:function(){return f},set:function(n){if(!ge(n))throw new Error("ViewportAnchorY must be between 0 and 100.");f=n}},viewportAnchorX:{enumerable:!0,get:function(){return u},set:function(n){if(!ge(n))throw new Error("ViewportAnchorX must be between 0 and 100.");u=n}},scroll:{enumerable:!0,get:function(){return e},set:function(n){var t=kht(n);t===!1?console.warn("Scroll: an invalid or illegal string was specified."):e=t}}})}function nct(n,t,i,r,u){var e,f;return u===void 0&&(u={}),e=n.textTracks(),u.kind=t,i&&(u.label=i),r&&(u.language=r),u.tech=n,f=new et.text.TrackClass(u),e.addTrack(f),f}function tct(n,t){dr[n]=dr[n]||[];dr[n].push(t)}function ict(n,t,i){n.setTimeout(function(){return gr(t,dr[t.type],i,n)},1)}function rct(n,t){n.forEach(function(n){return n.setTech&&n.setTech(t)})}function uct(n,t,i){return n.reduceRight(tv(i),t[i]())}function fct(n,t,i,r){return t[i](n.reduce(tv(i),r))}function ig(n,t,i,r){r===void 0&&(r=null);var o="call"+w(i),u=n.reduce(tv(o),r),f=u===ds,e=f?null:t[i](u);return sct(n,i,e,f),e}function tv(n){return function(t,i){return t===ds?ds:i[n]?i[n](t):t}}function sct(n,t,i,r){for(var f,u=n.length-1;u>=0;u--)f=n[u],f[t]&&f[t](r,i)}function hct(n){nv[n.id()]=null}function cct(n,t){var r=nv[n.id()],i=null,u;if(r===undefined||r===null)return i=t(n),nv[n.id()]=[[t,i]],i;for(u=0;u<r.length;u++){var f=r[u],e=f[0],o=f[1];e===t&&(i=o)}return i===null&&(i=t(n),r.push([t,i])),i}function gr(n,t,i,r,u,f){var o;n===void 0&&(n={});t===void 0&&(t=[]);u===void 0&&(u=[]);f===void 0&&(f=!1);var h=t,s=h[0],e=h.slice(1);if(typeof s=="string")gr(n,dr[s],i,r,u,f);else if(s){if(o=cct(r,s),!o.setSource)return u.push(o),gr(n,e,i,r,u,f);o.setSource(y({},n),function(t,s){if(t)return gr(n,e,i,r,u,f);u.push(o);gr(s,n.type===s.type?e:dr[s.type],i,r,u,f)})}else e.length?gr(n,e,i,r,u,f):f?i(n,u):gr(n,dr["*"],i,r,u,!0)}function fg(n){if(!n.type){var t=gs(n.src);t&&(n.type=t)}return n}function iv(n,t){var i;if(n.length===4)i=n[1]+n[1]+n[2]+n[2]+n[3]+n[3];else if(n.length===7)i=n.slice(1);else throw new Error("Invalid color code provided, "+n+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(i.slice(0,2),16)+","+parseInt(i.slice(2,4),16)+","+parseInt(i.slice(4,6),16)+","+t+")"}function rv(n,t,i){try{n.style[t]=i}catch(r){return}}function yct(n){nh=n}function pct(){nh=ev}function nf(n,t){return t===void 0&&(t=n),nh(n,t)}function ln(n,t){return t&&(n=t(n)),n&&n!=="none"?n:void 0}function wct(n,t){var i=n.options[n.options.selectedIndex].value;return ln(i,t)}function bct(n,t,i){if(t)for(var r=0;r<n.options.length;r++)if(ln(n.options[r].value,i)===t){n.selectedIndex=r;break}}function ilt(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(n){return!1}}function elt(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}});t&&cy(n,t)}function n(t,r,u){var e=n.getPlayer(t),f,o;if(e)return r&&h.warn('Player "'+t+'" is already initialised. Options will not be applied.'),u&&e.ready(u),e;if(f=typeof t=="string"?er("#"+ttt(t)):t,!yu(f))throw new TypeError("The element or ID supplied is not valid. (videojs)");return f.ownerDocument.defaultView&&f.ownerDocument.body.contains(f)||h.warn("The element supplied is not included in the DOM"),r=r||{},n.hooks("beforesetup").forEach(function(n){var t=n(f,v(r));if(!ur(t)||Array.isArray(t)){h.error("please return an object in beforesetup hooks");return}r=v(r,t)}),o=i.getComponent("Player"),e=new o(f,r,u),n.hooks("setup").forEach(function(n){return n(e)}),e}function hlt(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function clt(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function utt(n){return n&&typeof n=="object"&&"default"in n?n["default"]:n}function vlt(n){return n&&typeof n=="object"&&"default"in n?n["default"]:n}function ylt(n){for(var i=ott(n),r=new Uint8Array(i.length),t=0;t<i.length;t++)r[t]=i.charCodeAt(t);return r}function vtt(){}function dlt(n,t,i,r,u){function ot(n){if(n>65535){n-=65536;var t=55296+(n>>10),i=56320+(n&1023);return String.fromCharCode(t,i)}return String.fromCharCode(n)}function p(n){var t=n.slice(1,-1);return t in i?i[t]:t.charAt(0)==="#"?ot(parseInt(t.substr(1).replace("x","0x"))):(u.error("entity not found:"+n),n)}function nt(t){if(t>s){var i=n.substring(s,t).replace(/&#?\w+;/g,p);c&&v(s);r.characters(i,0,t-s);s=t}}function v(t,i){while(t>=tt&&(i=st.exec(n)))w=i.index,tt=w+i[0].length,c.lineNumber++;c.columnNumber=t-w+1}for(var w=0,tt=0,st=/.*(?:\r\n?|\n)|.*$/g,c=r.locator,a=[{currentNSMap:t}],ht={},s=0,f,b,k,ut,et,y,g;;){try{if(f=n.indexOf("<",s),f<0){n.substr(s).match(/^\s*$/)||(b=r.doc,k=b.createTextNode(n.substr(s)),b.appendChild(k),r.currentElement=k);return}f>s&&nt(f);switch(n.charAt(f+1)){case"/":var e=n.indexOf(">",f+3),h=n.substring(f+2,e),l=a.pop();e<0?(h=n.substring(f+2).replace(/[\s<].*/,""),u.error("end tag name: "+h+" is not complete:"+l.tagName),e=f+1+h.length):h.match(/\s</)&&(h=h.replace(/[\s<].*/,""),u.error("end tag name: "+h+" maybe not complete"),e=f+1+h.length);var it=l.localNSMap,rt=l.tagName==h,ct=rt||l.tagName&&l.tagName.toLowerCase()==h.toLowerCase();if(ct){if(r.endElement(l.uri,l.localName,h),it)for(ut in it)r.endPrefixMapping(ut);rt||u.fatalError("end tag name: "+h+" is not match the current start tagName:"+l.tagName)}else a.push(l);e++;break;case"?":c&&v(f);e=rat(n,f,r);break;case"!":c&&v(f);e=iat(n,f,r,u);break;default:c&&v(f);var o=new btt,d=a[a.length-1].currentNSMap,e=glt(n,f,o,d,p,u),ft=o.length;if(!o.closed&&tat(n,e,o.tagName,ht)&&(o.closed=!0,i.nbsp||u.warning("unclosed xml attribute")),c&&ft){for(et=ytt(c,{}),y=0;y<ft;y++)g=o[y],v(g.offset),g.locator=ytt(c,{});r.locator=et;ptt(o,r,d)&&a.push(o);r.locator=c}else ptt(o,r,d)&&a.push(o);o.uri!=="http://www.w3.org/1999/xhtml"||o.closed?e++:e=nat(n,e,o.tagName,p,r)}}catch(lt){u.error("element parse error: "+lt);e=-1}e>s?s=e:nt(Math.max(f,s)+1)}}function ytt(n,t){return t.lineNumber=n.lineNumber,t.columnNumber=n.columnNumber,t}function glt(n,t,i,r,u,f){for(var h,o=++t,e=eo,c,s,l;;){c=n.charAt(o);switch(c){case"=":if(e===sr)h=n.slice(t,o),e=oo;else if(e===of)e=oo;else throw new Error("attribute equal must after attrName");break;case"'":case'"':if(e===oo||e===sr)if(e===sr&&(f.warning('attribute value must after "="'),h=n.slice(t,o)),t=o+1,o=n.indexOf(c,t),o>0)s=n.slice(t,o).replace(/&#?\w+;/g,u),i.add(h,s,t-1),e=hf;else throw new Error("attribute value no end '"+c+"' match");else if(e==sf)s=n.slice(t,o).replace(/&#?\w+;/g,u),i.add(h,s,t),f.warning('attribute "'+h+'" missed start quot('+c+")!!"),t=o+1,e=hf;else throw new Error('attribute value must after "="');break;case"/":switch(e){case eo:i.setTagName(n.slice(t,o));case hf:case so:case oc:e=oc;i.closed=!0;case sf:case sr:case of:break;default:throw new Error("attribute invalid close char('/')");}break;case"":return f.error("unexpected end of input"),e==eo&&i.setTagName(n.slice(t,o)),o;case">":switch(e){case eo:i.setTagName(n.slice(t,o));break;case sf:case sr:s=n.slice(t,o);s.slice(-1)==="/"&&(i.closed=!0,s=s.slice(0,-1));case of:e===of&&(s=h);e==sf?(f.warning('attribute "'+s+'" missed quot(")!!'),i.add(h,s.replace(/&#?\w+;/g,u),t)):(r[""]==="http://www.w3.org/1999/xhtml"&&s.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+s+'" missed value!! "'+s+'" instead!!'),i.add(s,s,t));break;case oo:throw new Error("attribute value missed!!");}return o;case"":c=" ";default:if(c<=" ")switch(e){case eo:i.setTagName(n.slice(t,o));e=so;break;case sr:h=n.slice(t,o);e=of;break;case sf:s=n.slice(t,o).replace(/&#?\w+;/g,u);f.warning('attribute "'+s+'" missed quot(")!!');i.add(h,s,t);case hf:e=so}else switch(e){case of:l=i.tagName;r[""]==="http://www.w3.org/1999/xhtml"&&h.match(/^(?:disabled|checked|selected)$/i)||f.warning('attribute "'+h+'" missed value!! "'+h+'" instead2!!');i.add(h,h,t);t=o;e=sr;break;case hf:f.warning('attribute space is required"'+h+'"!!');case so:e=sr;t=o;break;case oo:e=sf;t=o;break;case oc:throw new Error("elements closed character '/' and '>' must be connected to");}}o++}}function ptt(n,t,i){for(var o=n.tagName,s=null,h=n.length,r,f,a;h--;){var u=n[h],c=u.qName,v=u.value,f=c.indexOf(":");if(f>0)var r=u.prefix=c.slice(0,f),e=c.slice(f+1),l=r==="xmlns"&&e;else e=c,r=null,l=c==="xmlns"&&"";u.localName=e;l!==!1&&(s==null&&(s={},wtt(i,i={})),i[l]=s[l]=v,u.uri="http://www.w3.org/2000/xmlns/",t.startPrefixMapping(l,v))}for(h=n.length;h--;)u=n[h],r=u.prefix,r&&(r==="xml"&&(u.uri="http://www.w3.org/XML/1998/namespace"),r!=="xmlns"&&(u.uri=i[r||""]));if(f=o.indexOf(":"),f>0?(r=n.prefix=o.slice(0,f),e=n.localName=o.slice(f+1)):(r=null,e=n.localName=o),a=n.uri=i[r||""],t.startElement(a,e,o,n),n.closed){if(t.endElement(a,e,o),s)for(r in s)t.endPrefixMapping(r)}else return n.currentNSMap=i,n.localNSMap=s,!0}function nat(n,t,i,r,u){if(/^(?:script|textarea)$/i.test(i)){var e=n.indexOf("<\/"+i+">",t),f=n.substring(t+1,e);if(/[&<]/.test(f))return/^script$/i.test(i)?(u.characters(f,0,f.length),e):(f=f.replace(/&#?\w+;/g,r),u.characters(f,0,f.length),e)}return t+1}function tat(n,t,i,r){var u=r[i];return u==null&&(u=n.lastIndexOf("<\/"+i+">"),u<t&&(u=n.lastIndexOf("<\/"+i)),r[i]=u),u<t}function wtt(n,t){for(var i in n)t[i]=n[i]}function iat(n,t,i,r){var c=n.charAt(t+2),f,u,e;switch(c){case"-":return n.charAt(t+3)==="-"?(f=n.indexOf("-->",t+4),f>t?(i.comment(n,t+4,f-t-4),f+3):(r.error("Unclosed comment"),-1)):-1;default:if(n.substr(t+3,6)=="CDATA[")return f=n.indexOf("]\]>",t+9),i.startCDATA(),i.characters(n,t+9,f-t-9),i.endCDATA(),f+3;if(u=uat(n,t),e=u.length,e>1&&/!doctype/i.test(u[0][0])){var l=u[1][0],o=e>3&&/^public$/i.test(u[2][0])&&u[3][0],s=e>4&&u[4][0],h=u[e-1];return i.startDTD(l,o&&o.replace(/^(['"])(.*?)\1$/,"$2"),s&&s.replace(/^(['"])(.*?)\1$/,"$2")),i.endDTD(),h.index+h[0].length}}return-1}function rat(n,t,i){var u=n.indexOf("?>",t),r,f;return u?(r=n.substring(t,u).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/),r?(f=r[0].length,i.processingInstruction(r[1],r[2]),u+2):-1):-1}function btt(){}function sc(n,t){return n.__proto__=t,n}function uat(n,t){var i,u=[],r=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;for(r.lastIndex=t,r.exec(n);i=r.exec(n);)if(u.push(i),i[1])return u}function ho(n,t){for(var i in n)t[i]=n[i]}function pt(n,t){var i=n.prototype,u,r;Object.create&&(u=Object.create(t.prototype),i.__proto__=u);i instanceof t||(r=function(){},r.prototype=t.prototype,r=new r,ho(i,r),n.prototype=i=r);i.constructor!=n&&(typeof n!="function"&&console.error("unknow Class:"+n),i.constructor=n)}function lf(n,t){if(t instanceof Error)var i=t;else i=this,Error.call(this,tt[n]),this.message=tt[n],Error.captureStackTrace&&Error.captureStackTrace(this,lf);return i.code=n,t&&(this.message=this.message+": "+t),i}function hr(){}function co(n,t){this._node=n;this._refresh=t;py(this)}function py(n){var i=n._node._inc||n._node.ownerDocument._inc,t;n._inc!=i&&(t=n._refresh(n._node),git(n,"length",t.length),ho(t,n),n._inc=i)}function cc(){}function eit(n,t){for(var i=n.length;i--;)if(n[i]===t)return i}function oit(n,t,i,r){if(r?t[eit(t,r)]=i:t[t.length++]=i,n){i.ownerElement=n;var u=n.ownerDocument;u&&(r&&lit(u,n,r),cat(u,n,i))}}function sit(n,t,i){var r=eit(t,i),u,f;if(r>=0){for(u=t.length-1;r<u;)t[r]=t[++r];t.length=u;n&&(f=n.ownerDocument,f&&(lit(f,n,i),i.ownerElement=null))}else throw lf(hat,new Error(n.tagName+"@"+i));}function hit(n){if(this._features={},n)for(var t in n)this._features=n[t]}function lt(){}function cit(n){return n=="<"&&"&lt;"||n==">"&&"&gt;"||n=="&"&&"&amp;"||n=='"'&&"&quot;"||"&#"+n.charCodeAt()+";"}function lc(n,t){if(t(n))return!0;if(n=n.firstChild)do if(lc(n,t))return!0;while(n=n.nextSibling)}function lo(){}function cat(n,t,i){n&&n._inc++;var r=i.namespaceURI;r=="http://www.w3.org/2000/xmlns/"&&(t._nsMap[i.prefix?i.localName:""]=i.value)}function lit(n,t,i){n&&n._inc++;var r=i.namespaceURI;r=="http://www.w3.org/2000/xmlns/"&&delete t._nsMap[i.prefix?i.localName:""]}function wy(n,t,i){var r,u,f;if(n&&n._inc)if(n._inc++,r=t.childNodes,i)r[r.length++]=i;else{for(u=t.firstChild,f=0;u;)r[f++]=u,u=u.nextSibling;r.length=f}}function ait(n,t){var i=t.previousSibling,r=t.nextSibling;return i?i.nextSibling=r:n.firstChild=r,r?r.previousSibling=i:n.lastChild=i,wy(n.ownerDocument,n),t}function vit(n,t,i){var e=t.parentNode,r,u,f;if(e&&e.removeChild(t),t.nodeType===rr){if(r=t.firstChild,r==null)return t;u=t.lastChild}else r=u=t;f=i?i.previousSibling:n.lastChild;r.previousSibling=f;u.nextSibling=i;f?f.nextSibling=r:n.firstChild=r;i==null?n.lastChild=u:i.previousSibling=u;do r.parentNode=n;while(r!==u&&(r=r.nextSibling));return wy(n.ownerDocument||n,n),t.nodeType==rr&&(t.firstChild=t.lastChild=null),t}function lat(n,t){var r=t.parentNode,i;return r&&(i=n.lastChild,r.removeChild(t),i=n.lastChild),i=n.lastChild,t.parentNode=n,t.previousSibling=i,t.nextSibling=null,i?i.nextSibling=t:n.firstChild=t,n.lastChild=t,wy(n.ownerDocument,n,t),t}function af(){this._nsMap={}}function ac(){}function ao(){}function by(){}function ky(){}function dy(){}function gy(){}function yit(){}function pit(){}function np(){}function vc(){}function tp(){}function wit(){}function bit(n,t){var f=[],i=this.nodeType==9?this.documentElement:this,r=i.prefix,u=i.namespaceURI,e;return u&&r==null&&(r=i.lookupPrefix(u),r==null&&(e=[{namespace:u,prefix:null}])),vf(this,f,n,t,e),f.join("")}function kit(n,t,i){var u=n.prefix||"",r=n.namespaceURI,f,e;if(!u&&!r||u==="xml"&&r==="http://www.w3.org/XML/1998/namespace"||r=="http://www.w3.org/2000/xmlns/")return!1;for(f=i.length;f--;)if(e=i[f],e.prefix==u)return e.namespace!=r;return!0}function vf(n,t,i,r,u){var o,e,f,v,s,y;if(r)if(n=r(n),n){if(typeof n=="string"){t.push(n);return}}else return;switch(n.nodeType){case yi:u||(u=[]);var b=u.length,a=n.attributes,p=a.length,f=n.firstChild,c=n.tagName;for(i=fat===n.namespaceURI||i,t.push("<",c),o=0;o<p;o++)e=a.item(o),e.prefix=="xmlns"?u.push({prefix:e.localName,namespace:e.value}):e.nodeName=="xmlns"&&u.push({prefix:"",namespace:e.value});for(o=0;o<p;o++){if(e=a.item(o),kit(e,i,u)){var h=e.prefix||"",l=e.namespaceURI,w=h?" xmlns:"+h:" xmlns";t.push(w,'="',l,'"');u.push({prefix:h,namespace:l})}vf(e,t,i,r,u)}if(kit(n,i,u)){var h=n.prefix||"",l=n.namespaceURI,w=h?" xmlns:"+h:" xmlns";t.push(w,'="',l,'"');u.push({prefix:h,namespace:l})}if(f||i&&!/^(?:meta|link|img|br|hr|input)$/i.test(c)){if(t.push(">"),i&&/^script$/i.test(c))while(f)f.data?t.push(f.data):vf(f,t,i,r,u),f=f.nextSibling;else while(f)vf(f,t,i,r,u),f=f.nextSibling;t.push("<\/",c,">")}else t.push("/>");return;case rit:case rr:for(f=n.firstChild;f;)vf(f,t,i,r,u),f=f.nextSibling;return;case cf:return t.push(" ",n.name,'="',n.value.replace(/[<&"]/g,cit),'"');case hc:return t.push(n.data.replace(/[<&]/g,cit));case gtt:return t.push("<![CDATA[",n.data,"]\]>");case iit:return t.push("<!--",n.data,"-->");case uit:v=n.publicId;s=n.systemId;t.push("<!DOCTYPE ",n.name);v?(t.push(' PUBLIC "',v),s&&s!="."&&t.push('" "',s),t.push('">')):s&&s!="."?t.push(' SYSTEM "',s,'">'):(y=n.internalSubset,y&&t.push(" [",y,"]"),t.push(">"));return;case tit:return t.push("<?",n.target," ",n.data,"?>");case nit:return t.push("&",n.nodeName,";");default:t.push("??",n.nodeName)}}function dit(n,t,i){var r,u;switch(t.nodeType){case yi:r=t.cloneNode(!1);r.ownerDocument=n;break;case cf:i=!0}if(r||(r=t.cloneNode(!1)),r.ownerDocument=n,r.parentNode=null,i)for(u=t.firstChild;u;)r.appendChild(dit(n,u,i)),u=u.nextSibling;return r}function ip(n,t,i){var r=new t.constructor,f,e,o,u;for(f in t)e=t[f],typeof e!="object"&&e!=r[f]&&(r[f]=e);t.childNodes&&(r.childNodes=new hr);r.ownerDocument=n;switch(r.nodeType){case yi:var s=t.attributes,h=r.attributes=new cc,c=s.length;for(h._ownerElement=r,o=0;o<c;o++)r.setAttributeNode(ip(n,s.item(o),!0));break;case cf:i=!0}if(i)for(u=t.firstChild;u;)r.appendChild(ip(n,u,i)),u=u.nextSibling;return r}function git(n,t,i){n[t]=i}function net(n,t){return function(i){var u=this,e,f,r;if(t){if(te&&!i)return e=t.toString().replace(/^function.+?{/,"").slice(0,-1),f=tet(e),this[vw]=new te(f),odt(this[vw],f),this[vw];r={postMessage:function(n){u.onmessage&&setTimeout(function(){u.onmessage({data:n,target:r})})}};t.call(r);this.postMessage=function(n){setTimeout(function(){r.onmessage({data:n,target:u})})};this.isThisThread=!0}else return new te(n)}}function tet(n){try{return ne.createObjectURL(new Blob([n],{type:fdt}))}catch(i){var t=new edt;return t.append(n),ne.createObjectURL(t.getBlob(type))}}function odt(n,t){if(n&&t){var i=n.terminate;n.objURL=t;n.terminate=function(){n.objURL&&ne.revokeObjectURL(n.objURL);i.call(n)}}}function cr(){}var nb="7.11.5",li=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},tb,fe,ee,st,fb,lk,ut,cs,vk,yk,pe,kk,f,pr,td,br,rd,ti,kr,et,ws,da,ng,tg,a,eg,to,og,hg,cg,oi,uv,lg,fv,ev,nh,nu,th,ih,ag,rh,vg,ov,uh,fh,eh,yg,pg,oh,sv,cv,lv,av,bg,kg,hh,vv,dg,yv,pv,ch,lh,ah,gg,tf,rf,wv,tu,bv,vh,yh,ph,wh,bh,kv,kh,dv,gv,dh,ny,ty,nn,io,iy,an,vn,yn,pn,gh,dn,b,uf,cy,ro,fc,ri,vi,ly,uo,si,itt,u,rtt,vy,ott,ktt,dtt,rp,kp,yt,fl,yw,pw;tb=typeof window!="undefined"?window:typeof li!="undefined"?li:typeof self!="undefined"?self:{};var t=tb,ib={},rb=typeof li!="undefined"?li:typeof window!="undefined"?window:{},re;typeof document!="undefined"?re=document:(re=rb["__GLOBAL_DOCUMENT_CACHE@4"],re||(re=rb["__GLOBAL_DOCUMENT_CACHE@4"]=ib));var r=re,fs={prefixed:!0},es=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],ub=es[0],ue;for(fe=0;fe<es.length;fe++)if(es[fe][1]in r){ue=es[fe];break}if(ue){for(ee=0;ee<ue.length;ee++)fs[ub[ee]]=ue[ee];fs.prefixed=ue[0]!==ub[0]}st=[];fb=function(n,i){return function(r,u,f){var s=i.levels[u],h=new RegExp("^("+s+")$"),o,e;(r!=="log"&&f.unshift(r.toUpperCase()+":"),f.unshift(n+":"),st&&(st.push([].concat(f)),o=st.length-1e3,st.splice(0,o>0?o:0)),t.console)&&(e=t.console[r],e||r!=="debug"||(e=t.console.info||t.console.log),e&&s&&h.test(r))&&e[Array.isArray(f)?"apply":"call"](t.console,f)}};var h=eb("VIDEOJS"),ob=h.createLogger,oe=dt(function(n){function t(){return n.exports=t=Object.assign||function(n){for(var i,r,t=1;t<arguments.length;t++){i=arguments[t];for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])}return n},t.apply(this,arguments)}n.exports=t}),eot=Object.prototype.toString,sb=function(n){return ur(n)?Object.keys(n):[]};var g=t.navigator&&t.navigator.userAgent||"",hb=/AppleWebKit\/([\d.]+)/i.exec(g),sot=hb?parseFloat(hb.pop()):null,cb=/iPod/i.test(g),hot=function(){var n=g.match(/OS (\d+)_/i);return n&&n[1]?n[1]:null}(),fr=/Android/i.test(g),al=function(){var n=g.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i),t,i;return n?(t=n[1]&&parseFloat(n[1]),i=n[2]&&parseFloat(n[2]),t&&i)?parseFloat(n[1]+"."+n[2]):t?t:null:null}(),lb=fr&&al<5&&sot<537,ab=/Firefox/i.test(g),ce=/Edg/i.test(g),ki=!ce&&(/Chrome/i.test(g)||/CriOS/i.test(g)),vb=function(){var n=g.match(/(Chrome|CriOS)\/(\d+)/);return n&&n[2]?parseFloat(n[2]):null}(),le=function(){var t=/MSIE\s(\d+)\.\d/.exec(g),n=t&&parseFloat(t[1]);return!n&&/Trident\/7.0/i.test(g)&&/rv:11.0/.test(g)&&(n=11),n}(),vl=/Safari/i.test(g)&&!ki&&!fr&&!ce,yb=/Windows/i.test(g),au=Boolean(vu()&&("ontouchstart"in t||t.navigator.maxTouchPoints||t.DocumentTouch&&t.document instanceof t.DocumentTouch)),yl=/iPad/i.test(g)||vl&&au&&!/iPhone/i.test(g),pl=/iPhone/i.test(g)&&!yl,gt=pl||yl||cb,os=(vl||gt)&&!ki,cot=Object.freeze({__proto__:null,IS_IPOD:cb,IOS_VERSION:hot,IS_ANDROID:fr,ANDROID_VERSION:al,IS_NATIVE_ANDROID:lb,IS_FIREFOX:ab,IS_EDGE:ce,IS_CHROME:ki,CHROME_VERSION:vb,IE_VERSION:le,IS_SAFARI:vl,IS_WINDOWS:yb,TOUCH_ENABLED:au,IS_IPAD:yl,IS_IPHONE:pl,IS_IOS:gt,IS_ANY_SAFARI:os});var er=kb("querySelector"),ek=kb("querySelectorAll"),ok=Object.freeze({__proto__:null,isReal:vu,isEl:yu,isInFrame:bb,createEl:p,textContent:pu,prependTo:wl,hasClass:lr,addClass:di,removeClass:ae,toggleClass:db,setAttributes:gb,getAttributes:gi,getAttribute:nk,setAttribute:ve,removeAttribute:ss,blockTextSelection:tk,unblockTextSelection:ik,getBoundingClientRect:bl,findPosition:ye,getPointerPosition:kl,isTextNode:rk,emptyEl:dl,normalizeContent:uk,appendContent:gl,insertContent:fk,isSingleLeftClick:wu,$:er,$$:ek}),sk=!1,na,aot=function(){var i,u,n,f;if(vu()&&na.options.autoSetup!==!1){var e=Array.prototype.slice.call(r.getElementsByTagName("video")),o=Array.prototype.slice.call(r.getElementsByTagName("audio")),s=Array.prototype.slice.call(r.getElementsByTagName("video-js")),t=e.concat(o,s);if(t&&t.length>0)for(i=0,u=t.length;i<u;i++)if(n=t[i],n&&n.getAttribute)n.player===undefined&&(f=n.getAttribute("data-setup"),f!==null&&na(n));else{ta(1);break}else sk||ta(1)}};vu()&&(r.readyState==="complete"?ia():t.addEventListener("load",ia));var hk=function(n){var t=r.createElement("style");return t.className=n,t},ck=function(n,t){n.styleSheet?n.styleSheet.cssText=t:n.textContent=t},vot=3;t.WeakMap||(lk=function(){function i(){this.vdata="vdata"+Math.floor(t.performance&&t.performance.now()||Date.now());this.data={}}var n=i.prototype;return n.set=function(n,t){var i=n[this.vdata]||or();return n[this.vdata]||(n[this.vdata]=i),this.data[i]=t,this},n.get=function(n){var t=n[this.vdata];return t?this.data[t]:(h("We have no data for this element",n),undefined)},n.has=function(n){var t=n[this.vdata];return t in this.data},n["delete"]=function(n){var t=n[this.vdata];t&&(delete this.data[t],delete n[this.vdata])},i}());ut=t.WeakMap?new WeakMap:new lk;vk=function(){if(typeof cs!="boolean"){cs=!1;try{var n=Object.defineProperty({},"passive",{get:function(){cs=!0}});t.addEventListener("test",null,n);t.removeEventListener("test",null,n)}catch(r){}}return cs};yk=["touchstart","touchmove"];var yot=Object.freeze({__proto__:null,fixEvent:hs,on:ni,off:ft,trigger:bu,one:ls,any:pk}),nr=30,c=function(n,t,i){t.guid||(t.guid=or());var r=t.bind(n);return r.guid=i?i+"_"+t.guid:t.guid,r},ar=function(n,i){var r=t.performance.now();return function(){var u=t.performance.now();u-r>=i&&(n.apply(void 0,arguments),r=u)}},pot=function(n,i,r,u){u===void 0&&(u=t);var f,o=function(){u.clearTimeout(f);f=null},e=function(){var t=this,e=arguments,o=function(){f=null;o=null;r||n.apply(t,e)};!f&&r&&n.apply(t,e);u.clearTimeout(f);f=u.setTimeout(o,i)};return e.cancel=o,e},nt=function(){};nt.prototype.allowedEvents_={};nt.prototype.on=function(n,t){var i=this.addEventListener;this.addEventListener=function(){};ni(this,n,t);this.addEventListener=i};nt.prototype.addEventListener=nt.prototype.on;nt.prototype.off=function(n,t){ft(this,n,t)};nt.prototype.removeEventListener=nt.prototype.off;nt.prototype.one=function(n,t){var i=this.addEventListener;this.addEventListener=function(){};ls(this,n,t);this.addEventListener=i};nt.prototype.any=function(n,t){var i=this.addEventListener;this.addEventListener=function(){};pk(this,n,t);this.addEventListener=i};nt.prototype.trigger=function(n){var t=n.type||n;typeof n=="string"&&(n={type:t});n=hs(n);this.allowedEvents_[t]&&this["on"+t]&&this["on"+t](n);bu(this,n)};nt.prototype.dispatchEvent=nt.prototype.trigger;nt.prototype.queueTrigger=function(n){var u=this,r,i,f,e;pe||(pe=new Map);r=n.type||n;i=pe.get(this);i||(i=new Map,pe.set(this,i));f=i.get(r);i["delete"](r);t.clearTimeout(f);e=t.setTimeout(function(){i.size===0&&(i=null,pe["delete"](u));u.trigger(n)},0);i.set(r,e)};var as=function(n){return typeof n.name=="function"?n.name():typeof n.name=="string"?n.name:n.name_?n.name_:n.constructor&&n.constructor.name?n.constructor.name:typeof n},tr=function(n){return n instanceof nt||!!n.eventBusEl_&&["on","one","off","trigger"].every(function(t){return typeof n[t]=="function"})},wot=function(n,t){tr(n)?t():(n.eventedCallbacks||(n.eventedCallbacks=[]),n.eventedCallbacks.push(t))},ua=function(n){return typeof n=="string"&&/\S/.test(n)||Array.isArray(n)&&!!n.length},vs=function(n,t,i){if(!n||!n.nodeName&&!tr(n))throw new Error("Invalid target for "+as(t)+"#"+i+"; must be a DOM node or evented object.");},wk=function(n,t,i){if(!ua(n))throw new Error("Invalid event type for "+as(t)+"#"+i+"; must be a non-empty string or array.");},bk=function(n,t,i){if(typeof n!="function")throw new Error("Invalid listener for "+as(t)+"#"+i+"; must be a function.");},fa=function(n,t,i){var e=t.length<3||t[0]===n||t[0]===n.eventBusEl_,u,f,r;return e?(u=n.eventBusEl_,t.length>=3&&t.shift(),f=t[0],r=t[1]):(u=t[0],f=t[1],r=t[2]),vs(u,n,i),wk(f,n,i),bk(r,n,i),r=c(n,r),{isTargetingSelf:e,target:u,type:f,listener:r}},vr=function(n,t,i,r){vs(n,n,t);n.nodeName?yot[t](n,i,r):n[t](i,r)},bot={on:function(){for(var r,f,e=this,o=arguments.length,s=new Array(o),n=0;n<o;n++)s[n]=arguments[n];var t=fa(this,s,"on"),c=t.isTargetingSelf,u=t.target,h=t.type,i=t.listener;vr(u,"on",h,i);c||(r=function(){return e.off(u,h,i)},r.guid=i.guid,f=function(){return e.off("dispose",r)},f.guid=i.guid,vr(this,"on","dispose",r),vr(u,"on","dispose",f))},one:function(){for(var i,s=this,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];var t=fa(this,o,"one"),h=t.isTargetingSelf,r=t.target,u=t.type,f=t.listener;h?vr(r,"one",u,f):(i=function i(){s.off(r,u,i);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];f.apply(null,e)},i.guid=f.guid,vr(r,"one",u,i))},any:function(){for(var i,s=this,e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];var t=fa(this,o,"any"),h=t.isTargetingSelf,r=t.target,u=t.type,f=t.listener;h?vr(r,"any",u,f):(i=function i(){s.off(r,u,i);for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];f.apply(null,e)},i.guid=f.guid,vr(r,"any",u,i))},off:function(n,t,i){if(!n||ua(n))ft(this.eventBusEl_,n,t);else{var r=n,u=t;vs(r,this,"off");wk(u,this,"off");bk(i,this,"off");i=c(this,i);this.off("dispose",i);r.nodeName?(ft(r,u,i),ft(r,"dispose",i)):tr(r)&&(r.off(u,i),r.off("dispose",i))}},trigger:function(n,t){var r,i;if(vs(this.eventBusEl_,this,"trigger"),r=n&&typeof n!="string"?n.type:n,!ua(r))if(i="Invalid event type for "+as(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.",n)(this.log||h).error(i);else throw new Error(i);return bu(this.eventBusEl_,n,t)}};kk={state:{},setState:function(n){var i=this,t;return typeof n=="function"&&(n=n()),lu(n,function(n,r){i.state[r]!==n&&(t=t||{},t[r]={from:i.state[r],to:n});i.state[r]=n}),t&&tr(this)&&this.trigger({changes:t,type:"statechanged"}),t}};var ys=function(n){return typeof n!="string"?n:n.replace(/./,function(n){return n.toLowerCase()})},w=function(n){return typeof n!="string"?n:n.replace(/./,function(n){return n.toUpperCase()})},kot=function(n,t){return w(n)===w(t)};var dot=function(){function t(){this.map_={}}var n=t.prototype;return n.has=function(n){return n in this.map_},n["delete"]=function(n){var t=this.has(n);return delete this.map_[n],t},n.set=function(n,t){return this.map_[n]=t,this},n.forEach=function(n,t){for(var i in this.map_)n.call(t,this.map_[i],i,this)},t}(),got=t.Map?t.Map:dot,nst=function(){function t(){this.set_={}}var n=t.prototype;return n.has=function(n){return n in this.set_},n["delete"]=function(n){var t=this.has(n);return delete this.set_[n],t},n.add=function(n){return this.set_[n]=1,this},n.forEach=function(n,t){for(var i in this.set_)n.call(t,i,i,this)},t}(),oa=t.Set?t.Set:nst,i=function(){function i(n,t,i){if(this.player_=!n&&this.play?n=this:n,this.isDisposed_=!1,this.parentComponent_=null,this.options_=v({},this.options_),t=this.options_=v(this.options_,t),this.id_=t.id||t.el&&t.el.id,!this.id_){var r=n&&n.id&&n.id()||"no_player";this.id_=r+"_component_"+or()}if(this.name_=t.name||null,t.el?this.el_=t.el:t.createEl!==!1&&(this.el_=this.createEl()),t.evented!==!1){ea(this,{eventBusKey:this.el_?"el_":null});this.handleLanguagechange=this.handleLanguagechange.bind(this);this.on(this.player_,"languagechange",this.handleLanguagechange)}dk(this,this.constructor.defaultState);this.children_=[];this.childIndex_={};this.childNameIndex_={};this.setTimeoutIds_=new oa;this.setIntervalIds_=new oa;this.rafIds_=new oa;this.namedRafs_=new got;this.clearingTimersOnDispose_=!1;t.initChildren!==!1&&this.initChildren();this.ready(i);t.reportTouchActivity!==!1&&this.enableTouchActivity()}var n=i.prototype;return n.dispose=function(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var n=this.children_.length-1;n>=0;n--)this.children_[n].dispose&&this.children_[n].dispose();this.children_=null;this.childIndex_=null;this.childNameIndex_=null;this.parentComponent_=null;this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),ut.has(this.el_)&&ut["delete"](this.el_),this.el_=null);this.player_=null}},n.isDisposed=function(){return Boolean(this.isDisposed_)},n.player=function(){return this.player_},n.options=function(n){return n?(this.options_=v(this.options_,n),this.options_):this.options_},n.el=function(){return this.el_},n.createEl=function(n,t,i){return p(n,t,i)},n.localize=function(n,t,i){i===void 0&&(i=n);var f=this.player_.language&&this.player_.language(),u=this.player_.languages&&this.player_.languages(),e=u&&u[f],s=f&&f.split("-")[0],o=u&&u[s],r=i;return e&&e[n]?r=e[n]:o&&o[n]&&(r=o[n]),t&&(r=r.replace(/\{(\d+)\}/g,function(n,i){var r=t[i-1],u=r;return typeof r=="undefined"&&(u=n),u})),r},n.handleLanguagechange=function(){},n.contentEl=function(){return this.contentEl_||this.el_},n.id=function(){return this.id_},n.name=function(){return this.name_},n.children=function(){return this.children_},n.getChildById=function(n){return this.childIndex_[n]},n.getChild=function(n){if(n)return this.childNameIndex_[n]},n.getDescendant=function(){for(var n,r,u=arguments.length,t=new Array(u),i=0;i<u;i++)t[i]=arguments[i];for(t=t.reduce(function(n,t){return n.concat(t)},[]),n=this,r=0;r<t.length;r++)if(n=n.getChild(t[r]),!n||!n.getChild)return;return n},n.addChild=function(n,t,r){var u,f,s,e,o;if(t===void 0&&(t={}),r===void 0&&(r=this.children_.length),typeof n=="string"){if(f=w(n),s=t.componentClass||f,t.name=f,e=i.getComponent(s),!e)throw new Error("Component "+s+" does not exist");if(typeof e!="function")return null;u=new e(this.player_||this,t)}else u=n;return u.parentComponent_&&u.parentComponent_.removeChild(u),this.children_.splice(r,0,u),u.parentComponent_=this,typeof u.id=="function"&&(this.childIndex_[u.id()]=u),f=f||u.name&&w(u.name()),f&&(this.childNameIndex_[f]=u,this.childNameIndex_[ys(f)]=u),typeof u.el=="function"&&u.el()&&(o=null,this.children_[r+1]&&(this.children_[r+1].el_?o=this.children_[r+1].el_:yu(this.children_[r+1])&&(o=this.children_[r+1])),this.contentEl().insertBefore(u.el(),o)),u},n.removeChild=function(n){var i,t,r;if(typeof n=="string"&&(n=this.getChild(n)),n&&this.children_){for(i=!1,t=this.children_.length-1;t>=0;t--)if(this.children_[t]===n){i=!0;this.children_.splice(t,1);break}i&&(n.parentComponent_=null,this.childIndex_[n.id()]=null,this.childNameIndex_[w(n.name())]=null,this.childNameIndex_[ys(n.name())]=null,r=n.el(),r&&r.parentNode===this.contentEl()&&this.contentEl().removeChild(n.el()))}},n.initChildren=function(){var t=this,n=this.options_.children;if(n){var u=this.options_,f=function(n){var r=n.name,i=n.opts,f;(u[r]!==undefined&&(i=u[r]),i!==!1)&&(i===!0&&(i={}),i.playerOptions=t.options_.playerOptions,f=t.addChild(r,i),f&&(t[r]=f))},r,e=i.getComponent("Tech");r=Array.isArray(n)?n:Object.keys(n);r.concat(Object.keys(this.options_).filter(function(n){return!r.some(function(t){return typeof t=="string"?n===t:n===t.name})})).map(function(i){var r,u;return typeof i=="string"?(r=i,u=n[r]||t.options_[r]||{}):(r=i.name,u=i),{name:r,opts:u}}).filter(function(n){var t=i.getComponent(n.opts.componentClass||w(n.name));return t&&!e.isTech(t)}).forEach(f)}},n.buildCSSClass=function(){return""},n.ready=function(n,t){if(t===void 0&&(t=!1),n){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[];this.readyQueue_.push(n);return}t?n.call(this):this.setTimeout(n,1)}},n.triggerReady=function(){this.isReady_=!0;this.setTimeout(function(){var n=this.readyQueue_;this.readyQueue_=[];n&&n.length>0&&n.forEach(function(n){n.call(this)},this);this.trigger("ready")},1)},n.$=function(n,t){return er(n,t||this.contentEl())},n.$$=function(n,t){return ek(n,t||this.contentEl())},n.hasClass=function(n){return lr(this.el_,n)},n.addClass=function(n){di(this.el_,n)},n.removeClass=function(n){ae(this.el_,n)},n.toggleClass=function(n,t){db(this.el_,n,t)},n.show=function(){this.removeClass("vjs-hidden")},n.hide=function(){this.addClass("vjs-hidden")},n.lockShowing=function(){this.addClass("vjs-lock-showing")},n.unlockShowing=function(){this.removeClass("vjs-lock-showing")},n.getAttribute=function(n){return nk(this.el_,n)},n.setAttribute=function(n,t){ve(this.el_,n,t)},n.removeAttribute=function(n){ss(this.el_,n)},n.width=function(n,t){return this.dimension("width",n,t)},n.height=function(n,t){return this.dimension("height",n,t)},n.dimensions=function(n,t){this.width(n,!0);this.height(t)},n.dimension=function(n,t,i){if(t!==undefined){(t===null||t!==t)&&(t=0);this.el_.style[n]=(""+t).indexOf("%")!==-1||(""+t).indexOf("px")!==-1?t:t==="auto"?"":t+"px";i||this.trigger("componentresize");return}if(!this.el_)return 0;var r=this.el_.style[n],u=r.indexOf("px");return u!==-1?parseInt(r.slice(0,u),10):parseInt(this.el_["offset"+w(n)],10)},n.currentDimension=function(n){var t=0,i;if(n!=="width"&&n!=="height")throw new Error("currentDimension only accepts width or height value");return t=he(this.el_,n),t=parseFloat(t),(t===0||isNaN(t))&&(i="offset"+w(n),t=this.el_[i]),t},n.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},n.currentWidth=function(){return this.currentDimension("width")},n.currentHeight=function(){return this.currentDimension("height")},n.focus=function(){this.el_.focus()},n.blur=function(){this.el_.blur()},n.handleKeyDown=function(n){this.player_&&(n.stopPropagation(),this.player_.handleKeyDown(n))},n.handleKeyPress=function(n){this.handleKeyDown(n)},n.emitTapEvents=function(){var u=0,n=null,f=10,e=200,i,r;this.on("touchstart",function(r){r.touches.length===1&&(n={pageX:r.touches[0].pageX,pageY:r.touches[0].pageY},u=t.performance.now(),i=!0)});this.on("touchmove",function(t){if(t.touches.length>1)i=!1;else if(n){var r=t.touches[0].pageX-n.pageX,u=t.touches[0].pageY-n.pageY,e=Math.sqrt(r*r+u*u);e>f&&(i=!1)}});r=function(){i=!1};this.on("touchleave",r);this.on("touchcancel",r);this.on("touchend",function(r){if(n=null,i===!0){var f=t.performance.now()-u;f<e&&(r.preventDefault(),this.trigger("tap"))}})},n.enableTouchActivity=function(){var n,t,i;if(this.player()&&this.player().reportUserActivity){n=c(this.player(),this.player().reportUserActivity);this.on("touchstart",function(){n();this.clearInterval(t);t=this.setInterval(n,250)});i=function(){n();this.clearInterval(t)};this.on("touchmove",n);this.on("touchend",i);this.on("touchcancel",i)}},n.setTimeout=function(n,i){var u=this,r;return n=c(this,n),this.clearTimersOnDispose_(),r=t.setTimeout(function(){u.setTimeoutIds_.has(r)&&u.setTimeoutIds_["delete"](r);n()},i),this.setTimeoutIds_.add(r),r},n.clearTimeout=function(n){return this.setTimeoutIds_.has(n)&&(this.setTimeoutIds_["delete"](n),t.clearTimeout(n)),n},n.setInterval=function(n,i){n=c(this,n);this.clearTimersOnDispose_();var r=t.setInterval(n,i);return this.setIntervalIds_.add(r),r},n.clearInterval=function(n){return this.setIntervalIds_.has(n)&&(this.setIntervalIds_["delete"](n),t.clearInterval(n)),n},n.requestAnimationFrame=function(n){var r=this,i;return this.supportsRaf_?(this.clearTimersOnDispose_(),n=c(this,n),i=t.requestAnimationFrame(function(){r.rafIds_.has(i)&&r.rafIds_["delete"](i);n()}),this.rafIds_.add(i),i):this.setTimeout(n,1e3/60)},n.requestNamedAnimationFrame=function(n,t){var i=this,r;if(!this.namedRafs_.has(n))return this.clearTimersOnDispose_(),t=c(this,t),r=this.requestAnimationFrame(function(){t();i.namedRafs_.has(n)&&i.namedRafs_["delete"](n)}),this.namedRafs_.set(n,r),n},n.cancelNamedAnimationFrame=function(n){this.namedRafs_.has(n)&&(this.cancelAnimationFrame(this.namedRafs_.get(n)),this.namedRafs_["delete"](n))},n.cancelAnimationFrame=function(n){return this.supportsRaf_?(this.rafIds_.has(n)&&(this.rafIds_["delete"](n),t.cancelAnimationFrame(n)),n):this.clearTimeout(n)},n.clearTimersOnDispose_=function(){var n=this;if(!this.clearingTimersOnDispose_){this.clearingTimersOnDispose_=!0;this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(t){var i=t[0],r=t[1];n[i].forEach(function(t,i){return n[r](i)})});n.clearingTimersOnDispose_=!1})}},i.registerComponent=function(n,t){var s,r,u,f;if(typeof n!="string"||!n)throw new Error('Illegal component name, "'+n+'"; must be a non-empty string.');var e=i.getComponent("Tech"),o=e&&e.isTech(t),h=i===t||i.prototype.isPrototypeOf(t.prototype);if(o||!h){s=o?"techs must be registered using Tech.registerTech()":"must be a Component subclass";throw new Error('Illegal component, "'+n+'"; '+s+".");}if(n=w(n),i.components_||(i.components_={}),r=i.getComponent("Player"),n==="Player"&&r&&r.players&&(u=r.players,f=Object.keys(u),u&&f.length>0&&f.map(function(n){return u[n]}).every(Boolean)))throw new Error("Can not register Player component after player has been created.");return i.components_[n]=t,i.components_[ys(n)]=t,t},i.getComponent=function(n){if(n&&i.components_)return i.components_[n]},i}();i.prototype.supportsRaf_=typeof t.requestAnimationFrame=="function"&&typeof t.cancelAnimationFrame=="function";i.registerComponent("Component",i);var s=tst,ati=dt(function(n){function t(i){"@babel/helpers - typeof";return n.exports=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?t=function(n){return typeof n}:t=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},t(i)}n.exports=t}),vti=dt(function(n){function t(i){return n.exports=t=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},t(i)}n.exports=t});for(f=ist,ht.prototype.code=0,ht.prototype.message="",ht.prototype.status=null,ht.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],ht.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."},pr=0;pr<ht.errorTypes.length;pr++)ht[ht.errorTypes[pr]]=pr,ht.prototype[ht.errorTypes[pr]]=pr;td=ust;var ha=function(n){return["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(t,i){return n[i]&&(t[i]=n[i]),t},{cues:n.cues&&Array.prototype.map.call(n.cues,function(n){return{startTime:n.startTime,endTime:n.endTime,text:n.text,id:n.id}})})},fst=function(n){var t=n.$$("track"),i=Array.prototype.map.call(t,function(n){return n.track}),r=Array.prototype.map.call(t,function(n){var t=ha(n.track);return n.src&&(t.src=n.src),t});return r.concat(Array.prototype.filter.call(n.textTracks(),function(n){return i.indexOf(n)===-1}).map(ha))},est=function(n,t){return n.forEach(function(n){var i=t.addRemoteTextTrack(n).track;!n.src&&n.cues&&n.cues.forEach(function(n){return i.addCue(n)})}),t.textTracks()},id={textTracksToJson:fst,jsonToTextTracks:est,trackToJson_:ha},o=dt(function(n,t){function o(n){var e,i,t;return(n&&"object"==typeof n&&(e=n.which||n.keyCode||n.charCode,e&&(n=e)),"number"==typeof n)?f[n]:(i=String(n),t=r[i.toLowerCase()],t)?t:(t=u[i.toLowerCase()],t)?t:i.length===1?i.charCodeAt(0):undefined}var r,u,i,f,e;for(o.isEventKey=function(n,t){var i,f;if(n&&"object"==typeof n){if(i=n.which||n.keyCode||n.charCode,i===null||i===undefined)return!1;if(typeof t=="string"){if((f=r[t.toLowerCase()],f)||(f=u[t.toLowerCase()],f))return f===i}else if(typeof t=="number")return t===i;return!1}},t=n.exports=o,r=t.code=t.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},u=t.aliases={windows:91,"⇧":16,"⌥":18,"⌃":17,"⌘":91,ctl:17,control:17,option:18,pause:19,"break":19,caps:20,"return":13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91},i=97;i<123;i++)r[String.fromCharCode(i)]=i-32;for(i=48;i<58;i++)r[i-48]=i;for(i=1;i<13;i++)r["f"+i]=i+111;for(i=0;i<10;i++)r["numpad "+i]=i+96;f=t.names=t.title={};for(i in r)f[r[i]]=i;for(e in u)r[e]=u[e]}),yti=o.code,pti=o.codes,wti=o.aliases,bti=o.names,kti=o.title,ca="vjs-modal-dialog",ku=function(n){function u(t,i){var r;return r=n.call(this,t,i)||this,r.opened_=r.hasBeenOpened_=r.hasBeenFilled_=!1,r.closeable(!r.options_.uncloseable),r.content(r.options_.content),r.contentEl_=p("div",{className:ca+"-content"},{role:"document"}),r.descEl_=p("p",{className:ca+"-description vjs-control-text",id:r.el().getAttribute("aria-describedby")}),pu(r.descEl_,r.description()),r.el_.appendChild(r.descEl_),r.el_.appendChild(r.contentEl_),r}f(u,n);var i=u.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},i.dispose=function(){this.contentEl_=null;this.descEl_=null;this.previouslyActiveEl_=null;n.prototype.dispose.call(this)},i.buildCSSClass=function(){return ca+" vjs-hidden "+n.prototype.buildCSSClass.call(this)},i.label=function(){return this.localize(this.options_.label||"Modal Window")},i.description=function(){var n=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(n+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),n},i.open=function(){if(!this.opened_){var n=this.player();this.trigger("beforemodalopen");this.opened_=!0;!this.options_.fillAlways&&(this.hasBeenOpened_||this.hasBeenFilled_)||this.fill();this.wasPlaying_=!n.paused();this.options_.pauseOnOpen&&this.wasPlaying_&&n.pause();this.on("keydown",this.handleKeyDown);this.hadControls_=n.controls();n.controls(!1);this.show();this.conditionalFocus_();this.el().setAttribute("aria-hidden","false");this.trigger("modalopen");this.hasBeenOpened_=!0}},i.opened=function(n){return typeof n=="boolean"&&this[n?"open":"close"](),this.opened_},i.close=function(){if(this.opened_){var n=this.player();this.trigger("beforemodalclose");this.opened_=!1;this.wasPlaying_&&this.options_.pauseOnOpen&&n.play();this.off("keydown",this.handleKeyDown);this.hadControls_&&n.controls(!0);this.hide();this.el().setAttribute("aria-hidden","true");this.trigger("modalclose");this.conditionalBlur_();this.options_.temporary&&this.dispose()}},i.closeable=function(n){var i,t,r;if(typeof n=="boolean"){if(i=this.closeable_=!!n,t=this.getChild("closeButton"),i&&!t){r=this.contentEl_;this.contentEl_=this.el_;t=this.addChild("closeButton",{controlText:"Close Modal Dialog"});this.contentEl_=r;this.on(t,"close",this.close)}!i&&t&&(this.off(t,"close",this.close),this.removeChild(t),t.dispose())}return this.closeable_},i.fill=function(){this.fillWith(this.content())},i.fillWith=function(n){var t=this.contentEl(),i=t.parentNode,u=t.nextSibling,r;this.trigger("beforemodalfill");this.hasBeenFilled_=!0;i.removeChild(t);this.empty();fk(t,n);this.trigger("modalfill");u?i.insertBefore(t,u):i.appendChild(t);r=this.getChild("closeButton");r&&i.appendChild(r.el_)},i.empty=function(){this.trigger("beforemodalempty");dl(this.contentEl());this.trigger("modalempty")},i.content=function(n){return typeof n!="undefined"&&(this.content_=n),this.content_},i.conditionalFocus_=function(){var n=r.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null;(t.contains(n)||t===n)&&(this.previouslyActiveEl_=n,this.focus())},i.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},i.handleKeyDown=function(n){var t,f,u,i;if(n.stopPropagation(),o.isEventKey(n,"Escape")&&this.closeable()){n.preventDefault();this.close();return}if(o.isEventKey(n,"Tab")){for(t=this.focusableEls_(),f=this.el_.querySelector(":focus"),i=0;i<t.length;i++)if(f===t[i]){u=i;break}r.activeElement===this.el_&&(u=0);n.shiftKey&&u===0?(t[t.length-1].focus(),n.preventDefault()):n.shiftKey||u!==t.length-1||(t[0].focus(),n.preventDefault())}},i.focusableEls_=function(){var n=this.el_.querySelectorAll("*");return Array.prototype.filter.call(n,function(n){return(n instanceof t.HTMLAnchorElement||n instanceof t.HTMLAreaElement)&&n.hasAttribute("href")||(n instanceof t.HTMLInputElement||n instanceof t.HTMLSelectElement||n instanceof t.HTMLTextAreaElement||n instanceof t.HTMLButtonElement)&&!n.hasAttribute("disabled")||n instanceof t.HTMLIFrameElement||n instanceof t.HTMLObjectElement||n instanceof t.HTMLEmbedElement||n.hasAttribute("tabindex")&&n.getAttribute("tabindex")!==-1||n.hasAttribute("contenteditable")})},u}(i);ku.prototype.options_={pauseOnOpen:!0,temporary:!0};i.registerComponent("ModalDialog",ku);br=function(n){function t(t){var i,r;for(t===void 0&&(t=[]),i=n.call(this)||this,i.tracks_=[],Object.defineProperty(s(i),"length",{get:function(){return this.tracks_.length}}),r=0;r<t.length;r++)i.addTrack(t[r]);return i}f(t,n);var i=t.prototype;return i.addTrack=function(n){var i=this,t=this.tracks_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.tracks_[t]}});this.tracks_.indexOf(n)===-1&&(this.tracks_.push(n),this.trigger({track:n,type:"addtrack",target:this}));n.labelchange_=function(){i.trigger({track:n,type:"labelchange",target:i})};tr(n)&&n.addEventListener("labelchange",n.labelchange_)},i.removeTrack=function(n){for(var t,i=0,r=this.length;i<r;i++)if(this[i]===n){t=this[i];t.off&&t.off();this.tracks_.splice(i,1);break}t&&this.trigger({track:t,type:"removetrack",target:this})},i.getTrackById=function(n){for(var i,r=null,t=0,u=this.length;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},t}(nt);br.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(rd in br.prototype.allowedEvents_)br.prototype["on"+rd]=null;var la=function(n,t){for(var i=0;i<n.length;i++)Object.keys(n[i]).length&&t.id!==n[i].id&&(n[i].enabled=!1)},ost=function(n){function t(t){var r,i;for(t===void 0&&(t=[]),i=t.length-1;i>=0;i--)if(t[i].enabled){la(t,t[i]);break}return r=n.call(this,t)||this,r.changing_=!1,r}f(t,n);var i=t.prototype;return i.addTrack=function(t){var i=this;(t.enabled&&la(this,t),n.prototype.addTrack.call(this,t),t.addEventListener)&&(t.enabledChange_=function(){i.changing_||(i.changing_=!0,la(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("enabledchange",t.enabledChange_))},i.removeTrack=function(t){n.prototype.removeTrack.call(this,t);t.removeEventListener&&t.enabledChange_&&(t.removeEventListener("enabledchange",t.enabledChange_),t.enabledChange_=null)},t}(br),aa=function(n,t){for(var i=0;i<n.length;i++)Object.keys(n[i]).length&&t.id!==n[i].id&&(n[i].selected=!1)},sst=function(n){function t(t){var r,i;for(t===void 0&&(t=[]),i=t.length-1;i>=0;i--)if(t[i].selected){aa(t,t[i]);break}return r=n.call(this,t)||this,r.changing_=!1,Object.defineProperty(s(r),"selectedIndex",{get:function(){for(var n=0;n<this.length;n++)if(this[n].selected)return n;return-1},set:function(){}}),r}f(t,n);var i=t.prototype;return i.addTrack=function(t){var i=this;(t.selected&&aa(this,t),n.prototype.addTrack.call(this,t),t.addEventListener)&&(t.selectedChange_=function(){i.changing_||(i.changing_=!0,aa(i,t),i.changing_=!1,i.trigger("change"))},t.addEventListener("selectedchange",t.selectedChange_))},i.removeTrack=function(t){n.prototype.removeTrack.call(this,t);t.removeEventListener&&t.selectedChange_&&(t.removeEventListener("selectedchange",t.selectedChange_),t.selectedChange_=null)},t}(br),ud=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.addTrack=function(t){var i=this,r;n.prototype.addTrack.call(this,t);this.queueChange_||(this.queueChange_=function(){return i.queueTrigger("change")});this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return i.trigger("selectedlanguagechange")});t.addEventListener("modechange",this.queueChange_);r=["metadata","chapters"];r.indexOf(t.kind)===-1&&t.addEventListener("modechange",this.triggerSelectedlanguagechange_)},i.removeTrack=function(t){n.prototype.removeTrack.call(this,t);t.removeEventListener&&(this.queueChange_&&t.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&t.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},t}(br),hst=function(){function t(n){n===void 0&&(n=[]);this.trackElements_=[];Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var t=0,i=n.length;t<i;t++)this.addTrackElement_(n[t])}var n=t.prototype;return n.addTrackElement_=function(n){var t=this.trackElements_.length;""+t in this||Object.defineProperty(this,t,{get:function(){return this.trackElements_[t]}});this.trackElements_.indexOf(n)===-1&&this.trackElements_.push(n)},n.getTrackElementByTrack_=function(n){for(var i,t=0,r=this.trackElements_.length;t<r;t++)if(n===this.trackElements_[t].track){i=this.trackElements_[t];break}return i},n.removeTrackElement_=function(n){for(var t=0,i=this.trackElements_.length;t<i;t++)if(n===this.trackElements_[t]){this.trackElements_[t].track&&typeof this.trackElements_[t].track.off=="function"&&this.trackElements_[t].track.off();typeof this.trackElements_[t].off=="function"&&this.trackElements_[t].off();this.trackElements_.splice(t,1);break}},t}(),fd=function(){function n(t){n.prototype.setCues_.call(this,t);Object.defineProperty(this,"length",{get:function(){return this.length_}})}var t=n.prototype;return t.setCues_=function(n){var i=this.length||0,t=0,r=n.length,u;if(this.cues_=n,this.length_=n.length,u=function(n){""+n in this||Object.defineProperty(this,""+n,{get:function(){return this.cues_[n]}})},i<r)for(t=i;t<r;t++)u.call(this,t)},t.getCueById=function(n){for(var i,r=null,t=0,u=this.length;t<u;t++)if(i=this[t],i.id===n){r=i;break}return r},n}(),cst={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},lst={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},ast={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},ed={disabled:"disabled",hidden:"hidden",showing:"showing"},va=function(n){function t(t){var i,f;t===void 0&&(t={});i=n.call(this)||this;var u={id:t.id||"vjs_track_"+or(),kind:t.kind||"",language:t.language||""},r=t.label||"",e=function(n){Object.defineProperty(s(i),n,{get:function(){return u[n]},set:function(){}})};for(f in u)e(f);return Object.defineProperty(s(i),"label",{get:function(){return r},set:function(n){n!==r&&(r=n,this.trigger("labelchange"))}}),i}return f(t,n),t}(nt),ya=function(n){var o=["protocol","hostname","port","pathname","search","hash","host"],f=r.createElement("a"),s,u,i,e;for(f.href=n,s=f.host===""&&f.protocol!=="file:",s&&(u=r.createElement("div"),u.innerHTML='<a href="'+n+'"><\/a>',f=u.firstChild,u.setAttribute("style","display:none; position:absolute;"),r.body.appendChild(u)),i={},e=0;e<o.length;e++)i[o[e]]=f[o[e]];return i.protocol==="http:"&&(i.host=i.host.replace(/:80$/,"")),i.protocol==="https:"&&(i.host=i.host.replace(/:443$/,"")),i.protocol||(i.protocol=t.location.protocol),s&&r.body.removeChild(u),i},od=function(n){if(!n.match(/^https?:\/\//)){var t=r.createElement("div");t.innerHTML='<a href="'+n+'">x<\/a>';n=t.firstChild.href}return n},pa=function(n){if(typeof n=="string"){var t=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/.exec(n);if(t)return t.pop().toLowerCase()}return""},ps=function(n,i){i===void 0&&(i=t.location);var r=ya(n),u=r.protocol===":"?i.protocol:r.protocol;return u+r.host!==i.protocol+i.host},vst=Object.freeze({__proto__:null,parseUrl:ya,getAbsoluteURL:od,getFileExtension:pa,isCrossOrigin:ps}),yst=typeof window!="undefined"?window:typeof li!="undefined"?li:typeof self!="undefined"?self:{};var sd=yst,pst=bst,wst=Object.prototype.toString;var kst=function(n){var t={};return n?(n.trim().split("\n").forEach(function(n){var u=n.indexOf(":"),i=n.slice(0,u).trim().toLowerCase(),r=n.slice(u+1).trim();typeof t[i]=="undefined"?t[i]=r:Array.isArray(t[i])?t[i].push(r):t[i]=[t[i],r]}),t):t},wa=ir,dst=ir;ir.XMLHttpRequest=sd.XMLHttpRequest||iht;ir.XDomainRequest="withCredentials"in new ir.XMLHttpRequest?ir.XMLHttpRequest:sd.XDomainRequest;gst(["get","put","post","patch","head","delete"],function(n){ir[n==="delete"?"del":n]=function(t,i,r){return i=hd(t,i,r),i.method=n.toUpperCase(),cd(i)}});wa["default"]=dst;var ld=function(n,i){var r=new t.WebVTT.Parser(t,t.vttjs,t.WebVTT.StringDecoder()),u=[];r.oncue=function(n){i.addCue(n)};r.onparsingerror=function(n){u.push(n)};r.onflush=function(){i.trigger({type:"loadeddata",target:i})};r.parse(n);u.length>0&&(t.console&&t.console.groupCollapsed&&t.console.groupCollapsed("Text Track parsing errors for "+i.src),u.forEach(function(n){return h.error(n)}),t.console&&t.console.groupEnd&&t.console.groupEnd());r.flush()},ad=function(n,i){var r={uri:n},f=ps(n),u;f&&(r.cors=f);u=i.tech_.crossOrigin()==="use-credentials";u&&(r.withCredentials=u);wa(r,c(this,function(n,r,u){if(n)return h.error(n,r);i.loaded_=!0;typeof t.WebVTT!="function"?i.tech_&&i.tech_.any(["vttjsloaded","vttjserror"],function(n){if(n.type==="vttjserror"){h.error("vttjs failed to load, stopping trying to process "+i.src);return}return ld(u,i)}):ld(u,i)}))},be=function(n){function i(t){var i;if(t===void 0&&(t={}),!t.tech)throw new Error("A tech was not provided.");var r=v(t,{kind:ast[t.kind]||"subtitles",language:t.language||t.srclang||""}),u=ed[r.mode]||"disabled",h=r["default"];(r.kind==="metadata"||r.kind==="chapters")&&(u="hidden");i=n.call(this,r)||this;i.tech_=r.tech;i.cues_=[];i.activeCues_=[];i.preload_=i.tech_.preloadTextTracks!==!1;var l=new fd(i.cues_),o=new fd(i.activeCues_),f=!1,e=c(s(i),function(){this.tech_.isReady_&&!this.tech_.isDisposed()&&(this.activeCues=this.activeCues,f&&(this.trigger("cuechange"),f=!1))}),a=function(){i.tech_.off("timeupdate",e)};i.tech_.one("dispose",a);if(u!=="disabled")i.tech_.on("timeupdate",e);return Object.defineProperties(s(i),{"default":{get:function(){return h},set:function(){}},mode:{get:function(){return u},set:function(n){if(ed[n]&&u!==n){if(u=n,this.preload_||u==="disabled"||this.cues.length!==0||ad(this.src,this),this.tech_.off("timeupdate",e),u!=="disabled")this.tech_.on("timeupdate",e);this.trigger("modechange")}}},cues:{get:function(){return this.loaded_?l:null},set:function(){}},activeCues:{get:function(){var i,t,r,e,n,u;if(!this.loaded_)return null;if(this.cues.length===0)return o;for(i=this.tech_.currentTime(),t=[],r=0,e=this.cues.length;r<e;r++)n=this.cues[r],n.startTime<=i&&n.endTime>=i?t.push(n):n.startTime===n.endTime&&n.startTime<=i&&n.startTime+.5>=i&&t.push(n);if(f=!1,t.length!==this.activeCues_.length)f=!0;else for(u=0;u<t.length;u++)this.activeCues_.indexOf(t[u])===-1&&(f=!0);return this.activeCues_=t,o.setCues_(this.activeCues_),o},set:function(){}}}),r.src?(i.src=r.src,i.preload_||(i.loaded_=!0),(i.preload_||h||r.kind!=="subtitles"&&r.kind!=="captions")&&ad(i.src,s(i))):i.loaded_=!0,i}f(i,n);var r=i.prototype;return r.addCue=function(n){var i=n,u,f,r;if(t.vttjs&&!(n instanceof t.vttjs.VTTCue)){i=new t.vttjs.VTTCue(n.startTime,n.endTime,n.text);for(u in n)u in i||(i[u]=n[u]);i.id=n.id;i.originalCue_=n}for(f=this.tech_.textTracks(),r=0;r<f.length;r++)f[r]!==this&&f[r].removeCue(i);this.cues_.push(i);this.cues.setCues_(this.cues_)},r.removeCue=function(n){for(var i=this.cues_.length,t;i--;)if(t=this.cues_[i],t===n||t.originalCue_&&t.originalCue_===n){this.cues_.splice(i,1);this.cues.setCues_(this.cues_);break}},i}(va);be.prototype.allowedEvents_={cuechange:"cuechange"};var vd=function(n){function t(t){var i,r,u;return t===void 0&&(t={}),r=v(t,{kind:lst[t.kind]||""}),i=n.call(this,r)||this,u=!1,Object.defineProperty(s(i),"enabled",{get:function(){return u},set:function(n){typeof n=="boolean"&&n!==u&&(u=n,this.trigger("enabledchange"))}}),r.enabled&&(i.enabled=r.enabled),i.loaded_=!0,i}return f(t,n),t}(va),yd=function(n){function t(t){var i,r,u;return t===void 0&&(t={}),r=v(t,{kind:cst[t.kind]||""}),i=n.call(this,r)||this,u=!1,Object.defineProperty(s(i),"selected",{get:function(){return u},set:function(n){typeof n=="boolean"&&n!==u&&(u=n,this.trigger("selectedchange"))}}),r.selected&&(i.selected=r.selected),i}return f(t,n),t}(va),pd=0,wd=2,du=function(n){function t(t){var i,u,r;return t===void 0&&(t={}),i=n.call(this)||this,r=new be(t),i.kind=r.kind,i.src=r.src,i.srclang=r.language,i.label=r.label,i["default"]=r["default"],Object.defineProperties(s(i),{readyState:{get:function(){return u}},track:{get:function(){return r}}}),u=pd,r.addEventListener("loadeddata",function(){u=wd;i.trigger({type:"load",target:s(i)})}),i}return f(t,n),t}(nt);du.prototype.allowedEvents_={load:"load"};du.NONE=pd;du.LOADING=1;du.LOADED=wd;du.ERROR=3;ti={audio:{ListClass:ost,TrackClass:vd,capitalName:"Audio"},video:{ListClass:sst,TrackClass:yd,capitalName:"Video"},text:{ListClass:ud,TrackClass:be,capitalName:"Text"}};Object.keys(ti).forEach(function(n){ti[n].getterName=n+"Tracks";ti[n].privateName=n+"Tracks_"});kr={remoteText:{ListClass:ud,TrackClass:be,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:hst,TrackClass:du,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}};et=oe({},ti,kr);kr.names=Object.keys(kr);ti.names=Object.keys(ti);et.names=[].concat(kr.names).concat(ti.names);ws=Object.create||function(){function n(){}return function(t){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=t,new n}}();ii.prototype=ws(Error.prototype);ii.prototype.constructor=ii;ii.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};ke.prototype={set:function(n,t){this.get(n)||t===""||(this.values[n]=t)},get:function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},has:function(n){return n in this.values},alt:function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},integer:function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},percent:function(n,t){var i;return(i=t.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(t=parseFloat(t),t>=0&&t<=100)?(this.set(n,t),!0):!1}};var ka=r.createElement("textarea"),uht={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},bd={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},fht={v:"title",lang:"lang"},kd={rt:"ruby"};da=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];bs.prototype.applyStyles=function(n,t){t=t||this.div;for(var i in n)n.hasOwnProperty(i)&&(t.style[i]=n[i])};bs.prototype.formatStyle=function(n,t){return n===0?0:n+t};ks.prototype=ws(bs.prototype);ks.prototype.constructor=ks;ct.prototype.move=function(n,t){t=t!==undefined?t:this.lineHeight;switch(n){case"+x":this.left+=t;this.right+=t;break;case"-x":this.left-=t;this.right-=t;break;case"+y":this.top+=t;this.bottom+=t;break;case"-y":this.top-=t;this.bottom-=t}};ct.prototype.overlaps=function(n){return this.left<n.right&&this.right>n.left&&this.top<n.bottom&&this.bottom>n.top};ct.prototype.overlapsAny=function(n){for(var t=0;t<n.length;t++)if(this.overlaps(n[t]))return!0;return!1};ct.prototype.within=function(n){return this.top>=n.top&&this.bottom<=n.bottom&&this.left>=n.left&&this.right<=n.right};ct.prototype.overlapsOppositeAxis=function(n,t){switch(t){case"+x":return this.left<n.left;case"-x":return this.right>n.right;case"+y":return this.top<n.top;case"-y":return this.bottom>n.bottom}};ct.prototype.intersectPercentage=function(n){var t=Math.max(0,Math.min(this.right,n.right)-Math.max(this.left,n.left)),i=Math.max(0,Math.min(this.bottom,n.bottom)-Math.max(this.top,n.top)),r=t*i;return r/(this.height*this.width)};ct.prototype.toCSSCompatValues=function(n){return{top:this.top-n.top,bottom:n.bottom-this.bottom,left:this.left-n.left,right:n.right-this.right,height:this.height,width:this.width}};ct.getSimpleBoxPosition=function(n){var t=n.div?n.div.offsetHeight:n.tagName?n.offsetHeight:0,r=n.div?n.div.offsetWidth:n.tagName?n.offsetWidth:0,i=n.div?n.div.offsetTop:n.tagName?n.offsetTop:0;return n=n.div?n.div.getBoundingClientRect():n.tagName?n.getBoundingClientRect():n,{left:n.left,right:n.right,top:n.top||i,height:n.height||t,bottom:n.bottom||i+(n.height||t),width:n.width||r}};gu.StringDecoder=function(){return{decode:function(n){if(!n)return"";if(typeof n!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}};gu.convertCueToDOMTree=function(n,t){return!n||!t?null:dd(n,t)};var cht=.05,lht="sans-serif",aht="1.5%";gu.processCues=function(n,t,i){function o(n){for(var t=0;t<n.length;t++)if(n[t].hasBeenReset||!n[t].displayState)return!0;return!1}var r,u;if(!n||!t||!i)return null;while(i.firstChild)i.removeChild(i.firstChild);if(r=n.document.createElement("div"),r.style.position="absolute",r.style.left="0",r.style.right="0",r.style.top="0",r.style.bottom="0",r.style.margin=aht,i.appendChild(r),!o(t)){for(u=0;u<t.length;u++)r.appendChild(t[u].displayState);return}var f=[],e=ct.getSimpleBoxPosition(r),s=Math.round(e.height*cht*100)/100,h={font:s+"px "+lht};(function(){for(var i,u,o=0;o<t.length;o++)u=t[o],i=new ks(n,u,h),r.appendChild(i.div),hht(n,i,e,f),u.displayState=i.div,f.push(ct.getSimpleBoxPosition(i))})()};gu.Parser=function(n,t,i){i||(i=t,t={});t||(t={});this.window=n;this.vttjs=t;this.state="INITIAL";this.buffer="";this.decoder=i||new TextDecoder("utf8");this.regionList=[]};gu.Parser.prototype={reportOrThrowError:function(n){if(n instanceof ii)this.onparsingerror&&this.onparsingerror(n);else throw n;},parse:function(n){function f(){for(var i=t.buffer,n=0,r;n<i.length&&i[n]!=="\r"&&i[n]!=="\n";)++n;return r=i.substr(0,n),i[n]==="\r"&&++n,i[n]==="\n"&&++n,t.buffer=i.substr(n),r}function s(n){var i=new ke,r;de(n,function(n,t){var u,r;switch(n){case"id":i.set(n,t);break;case"width":i.percent(n,t);break;case"lines":i.integer(n,t);break;case"regionanchor":case"viewportanchor":if(u=t.split(","),u.length!==2)break;if(r=new ke,r.percent("x",u[0]),r.percent("y",u[1]),!r.has("x")||!r.has("y"))break;i.set(n+"X",r.get("x"));i.set(n+"Y",r.get("y"));break;case"scroll":i.alt(n,t,["up"])}},/=/,/\s/);i.has("id")&&(r=new(t.vttjs.VTTRegion||t.window.VTTRegion),r.width=i.get("width",100),r.lines=i.get("lines",3),r.regionAnchorX=i.get("regionanchorX",0),r.regionAnchorY=i.get("regionanchorY",100),r.viewportAnchorX=i.get("viewportanchorX",0),r.viewportAnchorY=i.get("viewportanchorY",100),r.scroll=i.get("scroll",""),t.onregion&&t.onregion(r),t.regionList.push({id:i.get("id"),region:r}))}function h(n){var i=new ke;de(n,function(n,t){switch(n){case"MPEGT":i.integer(n+"S",t);break;case"LOCA":i.set(n+"L",ba(t))}},/[^\d]:/,/,/);t.ontimestampmap&&t.ontimestampmap({MPEGTS:i.get("MPEGTS"),LOCAL:i.get("LOCAL")})}function c(n){n.match(/X-TIMESTAMP-MAP/)?de(n,function(n,t){switch(n){case"X-TIMESTAMP-MAP":h(t)}},/=/):de(n,function(n,t){switch(n){case"Region":s(t)}},/:/)}var t=this,i,u,r,o;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if(t.state==="INITIAL"){if(!/\r\n|\n/.test(t.buffer))return this;if(i=f(),u=i.match(/^WEBVTT([ \t].*)?$/),!u||!u[0])throw new ii(ii.Errors.BadSignature);t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;r?r=!1:i=f();switch(t.state){case"HEADER":/:/.test(i)?c(i):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;t.cue=new(t.vttjs.VTTCue||t.window.VTTCue)(0,0,"");try{t.cue.align="center"}catch(e){t.cue.align="middle"}if(t.state="CUE",i.indexOf("-->")===-1){t.cue.id=i;continue}case"CUE":try{rht(i,t.cue,t.regionList)}catch(e){t.reportOrThrowError(e);t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(o=i.indexOf("-->")!==-1,!i||o&&(r=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=i.replace(/\u2028/g,"\n").replace(/u2029/g,"\n");continue;case"BADCUE":i||(t.state="ID");continue}}}catch(e){if(t.reportOrThrowError(e),t.state==="CUETEXT"&&t.cue&&t.oncue)t.oncue(t.cue);t.cue=null;t.state=t.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var n=this;try{if(n.buffer+=n.decoder.decode(),(n.cue||n.state==="HEADER")&&(n.buffer+="\n\n",n.parse()),n.state==="INITIAL")throw new ii(ii.Errors.BadSignature);}catch(t){n.reportOrThrowError(t)}return n.onflush&&n.onflush(),this}};var vht=gu,yht="auto",pht={"":1,lr:1,rl:1},wht={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};gd.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)};ng=gd;tg={"":!0,up:!0};var ght=dht,no=dt(function(n){var i=n.exports={WebVTT:vht,VTTCue:ng,VTTRegion:ght};t.vttjs=i;t.WebVTT=i.WebVTT;var r=i.VTTCue,u=i.VTTRegion,f=t.VTTCue,e=t.VTTRegion;i.shim=function(){t.VTTCue=r;t.VTTRegion=u};i.restore=function(){t.VTTCue=f;t.VTTRegion=e};t.VTTCue||i.shim()}),uii=no.WebVTT,fii=no.VTTCue,eii=no.VTTRegion;a=function(n){function u(t,i){var r;t===void 0&&(t={});i===void 0&&(i=function(){});t.reportTouchActivity=!1;r=n.call(this,null,t,i)||this;r.hasStarted_=!1;r.on("playing",function(){this.hasStarted_=!0});r.on("loadstart",function(){this.hasStarted_=!1});return et.names.forEach(function(n){var i=et[n];t&&t[i.getterName]&&(r[i.privateName]=t[i.getterName])}),r.featuresProgressEvents||r.manualProgressOn(),r.featuresTimeupdateEvents||r.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(n){t["native"+n+"Tracks"]===!1&&(r["featuresNative"+n+"Tracks"]=!1)}),t.nativeCaptions===!1||t.nativeTextTracks===!1?r.featuresNativeTextTracks=!1:(t.nativeCaptions===!0||t.nativeTextTracks===!0)&&(r.featuresNativeTextTracks=!0),r.featuresNativeTextTracks||r.emulateTextTracks(),r.preloadTextTracks=t.preloadTextTracks!==!1,r.autoRemoteTextTracks_=new et.text.ListClass,r.initTrackListeners(),t.nativeControlsForTouch||r.emitTapEvents(),r.constructor&&(r.name_=r.constructor.name||"Unknown Tech"),r}f(u,n);var i=u.prototype;return i.triggerSourceset=function(n){var t=this;if(!this.isReady_)this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(n)},1)});this.trigger({src:n,type:"sourceset"})},i.manualProgressOn=function(){this.on("durationchange",this.onDurationChange);this.manualProgress=!0;this.one("ready",this.trackProgress)},i.manualProgressOff=function(){this.manualProgress=!1;this.stopTrackingProgress();this.off("durationchange",this.onDurationChange)},i.trackProgress=function(){this.stopTrackingProgress();this.progressInterval=this.setInterval(c(this,function(){var n=this.bufferedPercent();this.bufferedPercent_!==n&&this.trigger("progress");this.bufferedPercent_=n;n===1&&this.stopTrackingProgress()}),500)},i.onDurationChange=function(){this.duration_=this.duration()},i.buffered=function(){return yr(0,0)},i.bufferedPercent=function(){return nd(this.buffered(),this.duration_)},i.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},i.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0;this.on("play",this.trackCurrentTime);this.on("pause",this.stopTrackingCurrentTime)},i.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1;this.stopTrackingCurrentTime();this.off("play",this.trackCurrentTime);this.off("pause",this.stopTrackingCurrentTime)},i.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime();this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},i.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval);this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.dispose=function(){this.clearTracks(ti.names);this.manualProgress&&this.manualProgressOff();this.manualTimeUpdates&&this.manualTimeUpdatesOff();n.prototype.dispose.call(this)},i.clearTracks=function(n){var t=this;n=[].concat(n);n.forEach(function(n){for(var i=t[n+"Tracks"]()||[],u=i.length,r;u--;)r=i[u],n==="text"&&t.removeRemoteTextTrack(r),i.removeTrack(r)})},i.cleanupAutoTextTracks=function(){for(var n=this.autoRemoteTextTracks_||[],t=n.length,i;t--;)i=n[t],this.removeRemoteTextTrack(i)},i.reset=function(){},i.crossOrigin=function(){},i.setCrossOrigin=function(){},i.error=function(n){return n!==undefined&&(this.error_=new ht(n),this.trigger("error")),this.error_},i.played=function(){return this.hasStarted_?yr(0,0):yr()},i.play=function(){},i.setScrubbing=function(){},i.scrubbing=function(){},i.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},i.initTrackListeners=function(){var n=this;ti.names.forEach(function(t){var u=ti[t],i=function(){n.trigger(t+"trackchange")},r=n[u.getterName]();r.addEventListener("removetrack",i);r.addEventListener("addtrack",i);n.on("dispose",function(){r.removeEventListener("removetrack",i);r.removeEventListener("addtrack",i)})})},i.addWebVttScript_=function(){var i=this,n;if(!t.WebVTT)if(r.body.contains(this.el())){if(!this.options_["vtt.js"]&&se(no)&&Object.keys(no).length>0){this.trigger("vttjsloaded");return}n=r.createElement("script");n.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js";n.onload=function(){i.trigger("vttjsloaded")};n.onerror=function(){i.trigger("vttjserror")};this.on("dispose",function(){n.onload=null;n.onerror=null});t.WebVTT=!0;this.el().parentNode.appendChild(n)}else this.ready(this.addWebVttScript_)},i.emulateTextTracks=function(){var e=this,n=this.textTracks(),r=this.remoteTextTracks(),u=function(t){return n.addTrack(t.track)},f=function(t){return n.removeTrack(t.track)},i,t;r.on("addtrack",u);r.on("removetrack",f);this.addWebVttScript_();i=function(){return e.trigger("texttrackchange")};t=function(){var t,r;for(i(),t=0;t<n.length;t++)r=n[t],r.removeEventListener("cuechange",i),r.mode==="showing"&&r.addEventListener("cuechange",i)};t();n.addEventListener("change",t);n.addEventListener("addtrack",t);n.addEventListener("removetrack",t);this.on("dispose",function(){var e,o;for(r.off("addtrack",u),r.off("removetrack",f),n.removeEventListener("change",t),n.removeEventListener("addtrack",t),n.removeEventListener("removetrack",t),e=0;e<n.length;e++)o=n[e],o.removeEventListener("cuechange",i)})},i.addTextTrack=function(n,t,i){if(!n)throw new Error("TextTrack kind is required but was not provided");return nct(this,n,t,i)},i.createRemoteTextTrack=function(n){var t=v(n,{tech:this});return new kr.remoteTextEl.TrackClass(t)},i.addRemoteTextTrack=function(n,t){var r=this,i;return n===void 0&&(n={}),i=this.createRemoteTextTrack(n),t!==!0&&t!==!1&&(h.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(i),this.remoteTextTracks().addTrack(i.track),t!==!0&&this.ready(function(){return r.autoRemoteTextTracks_.addTrack(i.track)}),i},i.removeRemoteTextTrack=function(n){var t=this.remoteTextTrackEls().getTrackElementByTrack_(n);this.remoteTextTrackEls().removeTrackElement_(t);this.remoteTextTracks().removeTrack(n);this.autoRemoteTextTracks_.removeTrack(n)},i.getVideoPlaybackQuality=function(){return{}},i.requestPictureInPicture=function(){var n=this.options_.Promise||t.Promise;if(n)return n.reject()},i.disablePictureInPicture=function(){return!0},i.setDisablePictureInPicture=function(){},i.setPoster=function(){},i.playsinline=function(){},i.setPlaysinline=function(){},i.overrideNativeAudioTracks=function(){},i.overrideNativeVideoTracks=function(){},i.canPlayType=function(){return""},u.canPlayType=function(){return""},u.canPlaySource=function(n){return u.canPlayType(n.type)},u.isTech=function(n){return n.prototype instanceof u||n instanceof u||n===u},u.registerTech=function(n,t){if(u.techs_||(u.techs_={}),!u.isTech(t))throw new Error("Tech "+n+" must be a Tech");if(!u.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!u.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return n=w(n),u.techs_[n]=t,u.techs_[ys(n)]=t,n!=="Tech"&&u.defaultTechOrder_.push(n),t},u.getTech=function(n){if(n)return u.techs_&&u.techs_[n]?u.techs_[n]:(n=w(n),t&&t.videojs&&t.videojs[n]?(h.warn("The "+n+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),t.videojs[n]):void 0)},u}(i);et.names.forEach(function(n){var t=et[n];a.prototype[t.getterName]=function(){return this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName]}});a.prototype.featuresVolumeControl=!0;a.prototype.featuresMuteControl=!0;a.prototype.featuresFullscreenResize=!1;a.prototype.featuresPlaybackRate=!1;a.prototype.featuresProgressEvents=!1;a.prototype.featuresSourceset=!1;a.prototype.featuresTimeupdateEvents=!1;a.prototype.featuresNativeTextTracks=!1;a.withSourceHandlers=function(n){n.registerSourceHandler=function(t,i){var r=n.sourceHandlers;r||(r=n.sourceHandlers=[]);i===undefined&&(i=r.length);r.splice(i,0,t)};n.canPlayType=function(t){for(var u=n.sourceHandlers||[],i,r=0;r<u.length;r++)if(i=u[r].canPlayType(t),i)return i;return""};n.selectSourceHandler=function(t,i){for(var u=n.sourceHandlers||[],f,r=0;r<u.length;r++)if(f=u[r].canHandleSource(t,i),f)return u[r];return null};n.canPlaySource=function(t,i){var r=n.selectSourceHandler(t,i);return r?r.canHandleSource(t,i):""};["seekable","seeking","duration"].forEach(function(n){var t=this[n];typeof t=="function"&&(this[n]=function(){return this.sourceHandler_&&this.sourceHandler_[n]?this.sourceHandler_[n].apply(this.sourceHandler_,arguments):t.apply(this,arguments)})},n.prototype);n.prototype.setSource=function(t){var i=n.selectSourceHandler(t,this.options_);i||(n.nativeSourceHandler?i=n.nativeSourceHandler:h.error("No source handler found for the current source."));this.disposeSourceHandler();this.off("dispose",this.disposeSourceHandler);i!==n.nativeSourceHandler&&(this.currentSource_=t);this.sourceHandler_=i.handleSource(t,this,this.options_);this.one("dispose",this.disposeSourceHandler)};n.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null);this.cleanupAutoTextTracks();this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}};i.registerComponent("Tech",a);a.registerTech("Tech",a);a.defaultTechOrder_=[];var dr={},nv={},ds={};var ect={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1},oct={setCurrentTime:1,setMuted:1,setVolume:1},rg={play:1,pause:1};var lct={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},gs=function(n){n===void 0&&(n="");var t=pa(n),i=lct[t.toLowerCase()];return i||""},act=function(n,t){var u,f,r,i;if(!t)return"";if(n.cache_.source.src===t&&n.cache_.source.type)return n.cache_.source.type;if(u=n.cache_.sources.filter(function(n){return n.src===t}),u.length)return u[0].type;for(f=n.$$("source"),r=0;r<f.length;r++)if(i=f[r],i.type&&i.src&&i.src===t)return i.type;return gs(t)},ug=function ug(n){if(Array.isArray(n)){var t=[];n.forEach(function(n){n=ug(n);Array.isArray(n)?t=t.concat(n):ur(n)&&t.push(n)});n=t}else n=typeof n=="string"&&n.trim()?[fg({src:n})]:ur(n)&&typeof n.src=="string"&&n.src&&n.src.trim()?[fg(n)]:[];return n};eg=function(n){function t(t,r,u){var h,c=v({createEl:!1},r),e,s,f,o;if(h=n.call(this,t,c,u)||this,r.playerOptions.sources&&r.playerOptions.sources.length!==0)t.src(r.playerOptions.sources);else for(e=0,s=r.playerOptions.techOrder;e<s.length;e++)if(f=w(s[e]),o=a.getTech(f),f||(o=i.getComponent(f)),o&&o.isSupported()){t.loadTech_(f);break}return h}return f(t,n),t}(i);i.registerComponent("MediaLoader",eg);to=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.emitTapEvents(),r.enable(),r}f(i,n);var t=i.prototype;return t.createEl=function(t,i,r){t===void 0&&(t="div");i===void 0&&(i={});r===void 0&&(r={});i=y({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>',className:this.buildCSSClass(),tabIndex:0},i);t==="button"&&h.error("Creating a ClickableComponent with an HTML element of "+t+" is not supported; use a Button instead.");r=y({role:"button"},r);this.tabIndex_=i.tabIndex;var u=n.prototype.createEl.call(this,t,i,r);return this.createControlTextEl(u),u},t.dispose=function(){this.controlTextEl_=null;n.prototype.dispose.call(this)},t.createControlTextEl=function(n){return this.controlTextEl_=p("span",{className:"vjs-control-text"},{"aria-live":"polite"}),n&&n.appendChild(this.controlTextEl_),this.controlText(this.controlText_,n),this.controlTextEl_},t.controlText=function(n,t){if(t===void 0&&(t=this.el()),n===undefined)return this.controlText_||"Need Text";var i=this.localize(n);this.controlText_=n;pu(this.controlTextEl_,i);this.nonIconControl||t.setAttribute("title",i)},t.buildCSSClass=function(){return"vjs-control vjs-button "+n.prototype.buildCSSClass.call(this)},t.enable=function(){if(!this.enabled_){this.enabled_=!0;this.removeClass("vjs-disabled");this.el_.setAttribute("aria-disabled","false");typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_);this.on(["tap","click"],this.handleClick);this.on("keydown",this.handleKeyDown)}},t.disable=function(){this.enabled_=!1;this.addClass("vjs-disabled");this.el_.setAttribute("aria-disabled","true");typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex");this.off("mouseover",this.handleMouseOver);this.off("mouseout",this.handleMouseOut);this.off(["tap","click"],this.handleClick);this.off("keydown",this.handleKeyDown)},t.handleLanguagechange=function(){this.controlText(this.controlText_)},t.handleClick=function(){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},t.handleKeyDown=function(t){o.isEventKey(t,"Space")||o.isEventKey(t,"Enter")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):n.prototype.handleKeyDown.call(this,t)},i}(i);i.registerComponent("ClickableComponent",to);og=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.update();t.on("posterchange",c(s(r),r.update));return r}f(i,n);var t=i.prototype;return t.dispose=function(){this.player().off("posterchange",this.update);n.prototype.dispose.call(this)},t.createEl=function(){return p("div",{className:"vjs-poster",tabIndex:-1})},t.update=function(){var n=this.player().poster();this.setSrc(n);n?this.show():this.hide()},t.setSrc=function(n){var t="";n&&(t='url("'+n+'")');this.el_.style.backgroundImage=t},t.handleClick=function(){if(this.player_.controls()){var n=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;!this.player_.tech(!0)||(le||ce)&&n||this.player_.tech(!0).focus();this.player_.paused()?wr(this.player_.play()):this.player_.pause()}},i}(to);i.registerComponent("PosterImage",og);var ei="#222",sg="#ccc",vct={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};hg=function(n){function r(i,r,u){var f,e;f=n.call(this,i,r,u)||this;e=c(s(f),f.updateDisplay);i.on("loadstart",c(s(f),f.toggleDisplay));i.on("texttrackchange",e);i.on("loadedmetadata",c(s(f),f.preselectTrack));return i.ready(c(s(f),function(){var r,n;if(i.tech_&&i.tech_.featuresNativeTextTracks){this.hide();return}i.on("fullscreenchange",e);i.on("playerresize",e);t.addEventListener("orientationchange",e);i.on("dispose",function(){return t.removeEventListener("orientationchange",e)});for(r=this.options_.playerOptions.tracks||[],n=0;n<r.length;n++)this.player_.addRemoteTextTrack(r[n],!0);this.preselectTrack()})),f}f(r,n);var i=r.prototype;return i.preselectTrack=function(){for(var n,e={captions:1,subtitles:1},o=this.player_.textTracks(),t=this.player_.cache_.selectedLanguage,r,u,i,f=0;f<o.length;f++)n=o[f],t&&t.enabled&&t.language&&t.language===n.language&&n.kind in e?n.kind===t.kind?i=n:i||(i=n):t&&!t.enabled?(i=null,r=null,u=null):n["default"]&&(n.kind!=="descriptions"||r?n.kind in e&&!u&&(u=n):r=n);i?i.mode="showing":u?u.mode="showing":r&&(r.mode="showing")},i.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{"aria-live":"off","aria-atomic":"true"})},i.clearDisplay=function(){typeof t.WebVTT=="function"&&t.WebVTT.processCues(t,[],this.el_)},i.updateDisplay=function(){var t=this.player_.textTracks(),s=this.options_.allowMultipleShowingTracks,r,i,u,n;if(this.clearDisplay(),s){for(r=[],i=0;i<t.length;++i)(u=t[i],u.mode==="showing")&&r.push(u);this.updateForTrack(r);return}for(var f=null,e=null,o=t.length;o--;)n=t[o],n.mode==="showing"&&(n.kind==="descriptions"?f=n:e=n);e?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(e)):f&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(f))},i.updateDisplayState=function(n){for(var i=this.player_.textTrackSettings.getValues(),f=n.activeCues,e=f.length,u,r,o;e--;)(u=f[e],u)&&(r=u.displayState,i.color&&(r.firstChild.style.color=i.color),i.textOpacity&&rv(r.firstChild,"color",iv(i.color||"#fff",i.textOpacity)),i.backgroundColor&&(r.firstChild.style.backgroundColor=i.backgroundColor),i.backgroundOpacity&&rv(r.firstChild,"backgroundColor",iv(i.backgroundColor||"#000",i.backgroundOpacity)),i.windowColor&&(i.windowOpacity?rv(r,"backgroundColor",iv(i.windowColor,i.windowOpacity)):r.style.backgroundColor=i.windowColor),i.edgeStyle&&(i.edgeStyle==="dropshadow"?r.firstChild.style.textShadow="2px 2px 3px "+ei+", 2px 2px 4px "+ei+", 2px 2px 5px "+ei:i.edgeStyle==="raised"?r.firstChild.style.textShadow="1px 1px "+ei+", 2px 2px "+ei+", 3px 3px "+ei:i.edgeStyle==="depressed"?r.firstChild.style.textShadow="1px 1px "+sg+", 0 1px "+sg+", -1px -1px "+ei+", 0 -1px "+ei:i.edgeStyle==="uniform"&&(r.firstChild.style.textShadow="0 0 4px "+ei+", 0 0 4px "+ei+", 0 0 4px "+ei+", 0 0 4px "+ei)),i.fontPercent&&i.fontPercent!==1&&(o=t.parseFloat(r.style.fontSize),r.style.fontSize=o*i.fontPercent+"px",r.style.height="auto",r.style.top="auto"),i.fontFamily&&i.fontFamily!=="default"&&(i.fontFamily==="small-caps"?r.firstChild.style.fontVariant="small-caps":r.firstChild.style.fontFamily=vct[i.fontFamily]))},i.updateForTrack=function(n){var o,u,s,f,r,i,e,h;if(Array.isArray(n)||(n=[n]),typeof t.WebVTT=="function"&&!n.every(function(n){return!n.activeCues})){for(o=[],u=0;u<n.length;++u)for(s=n[u],f=0;f<s.activeCues.length;++f)o.push(s.activeCues[f]);for(t.WebVTT.processCues(t,o,this.el_),r=0;r<n.length;++r){for(i=n[r],e=0;e<i.activeCues.length;++e)h=i.activeCues[e].displayState,di(h,"vjs-text-track-cue"),di(h,"vjs-text-track-cue-"+(i.language?i.language:r));this.player_.textTrackSettings&&this.updateDisplayState(i)}}},r}(i);i.registerComponent("TextTrackDisplay",hg);cg=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.createEl=function(){var i=this.player_.isAudio(),r=this.localize(i?"Audio Player":"Video Player"),u=p("span",{className:"vjs-control-text",innerHTML:this.localize("{1} is loading.",[r])}),t=n.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return t.appendChild(u),t},t}(i);i.registerComponent("LoadingSpinner",cg);oi=function(n){function r(){return n.apply(this,arguments)||this}f(r,n);var t=r.prototype;return t.createEl=function(n,t,r){t===void 0&&(t={});r===void 0&&(r={});n="button";t=y({innerHTML:'<span aria-hidden="true" class="vjs-icon-placeholder"><\/span>',className:this.buildCSSClass()},t);r=y({type:"button"},r);var u=i.prototype.createEl.call(this,n,t,r);return this.createControlTextEl(u),u},t.addChild=function(n,t){t===void 0&&(t={});var r=this.constructor.name;return h.warn("Adding an actionable (user controllable) child to a Button ("+r+") is not supported; use a ClickableComponent instead."),i.prototype.addChild.call(this,n,t)},t.enable=function(){n.prototype.enable.call(this);this.el_.removeAttribute("disabled")},t.disable=function(){n.prototype.disable.call(this);this.el_.setAttribute("disabled","disabled")},t.handleKeyDown=function(t){if(o.isEventKey(t,"Space")||o.isEventKey(t,"Enter")){t.stopPropagation();return}n.prototype.handleKeyDown.call(this,t)},r}(to);i.registerComponent("Button",oi);uv=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.mouseused_=!1;r.on("mousedown",r.handleMouseDown);return r}f(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-big-play-button"},t.handleClick=function(n){var t=this.player_.play(),f,i,r,u;if(this.mouseused_&&n.clientX&&n.clientY){f=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;wr(t);!this.player_.tech(!0)||(le||ce)&&f||this.player_.tech(!0).focus();return}if(i=this.player_.getChild("controlBar"),r=i&&i.getChild("playToggle"),!r){this.player_.tech(!0).focus();return}u=function(){return r.focus()};we(t)?t.then(u,function(){}):this.setTimeout(u,1)},t.handleKeyDown=function(t){this.mouseused_=!1;n.prototype.handleKeyDown.call(this,t)},t.handleMouseDown=function(){this.mouseused_=!0},i}(oi);uv.prototype.controlText_="Play Video";i.registerComponent("BigPlayButton",uv);lg=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.controlText(i&&i.controlText||r.localize("Close")),r}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-close-button "+n.prototype.buildCSSClass.call(this)},i.handleClick=function(){this.trigger({type:"close",bubbles:!1})},i.handleKeyDown=function(t){o.isEventKey(t,"Esc")?(t.preventDefault(),t.stopPropagation(),this.trigger("click")):n.prototype.handleKeyDown.call(this,t)},t}(oi);i.registerComponent("CloseButton",lg);fv=function(n){function i(t,i){var r;i===void 0&&(i={});r=n.call(this,t,i)||this;i.replay=i.replay===undefined||i.replay;r.on(t,"play",r.handlePlay);r.on(t,"pause",r.handlePause);if(i.replay)r.on(t,"ended",r.handleEnded);return r}f(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-play-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleSeeked=function(n){this.removeClass("vjs-ended");this.player_.paused()?this.handlePause(n):this.handlePlay(n)},t.handlePlay=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.controlText("Pause")},t.handlePause=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.controlText("Play")},t.handleEnded=function(){this.removeClass("vjs-playing");this.addClass("vjs-ended");this.controlText("Replay");this.one(this.player_,"seeked",this.handleSeeked)},i}(oi);fv.prototype.controlText_="Play";i.registerComponent("PlayToggle",fv);ev=function(n,t){n=n<0?0:n;var i=Math.floor(n%60),r=Math.floor(n/60%60),u=Math.floor(n/3600),f=Math.floor(t/60%60),e=Math.floor(t/3600);return(isNaN(n)||n===Infinity)&&(u=r=i="-"),u=u>0||e>0?u+":":"",r=((u||f>=10)&&r<10?"0"+r:r)+":",i=i<10?"0"+i:i,u+r+i};nh=ev;nu=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on(t,["timeupdate","ended"],r.updateContent);return r.updateTextNode_(),r}f(i,n);var t=i.prototype;return t.createEl=function(){var t=this.buildCSSClass(),i=n.prototype.createEl.call(this,"div",{className:t+" vjs-time-control vjs-control",innerHTML:'<span class="vjs-control-text" role="presentation">'+this.localize(this.labelText_)+" <\/span>"});return this.contentEl_=p("span",{className:t+"-display"},{"aria-live":"off",role:"presentation"}),i.appendChild(this.contentEl_),i},t.dispose=function(){this.contentEl_=null;this.textNode_=null;n.prototype.dispose.call(this)},t.updateTextNode_=function(n){var t=this;(n===void 0&&(n=0),n=nf(n),this.formattedTime_!==n)&&(this.formattedTime_=n,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(t.contentEl_){var n=t.textNode_;(n&&t.contentEl_.firstChild!==n&&(n=null,h.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),t.textNode_=r.createTextNode(t.formattedTime_),t.textNode_)&&(n?t.contentEl_.replaceChild(t.textNode_,n):t.contentEl_.appendChild(t.textNode_))}}))},t.updateContent=function(){},i}(i);nu.prototype.labelText_="Time";nu.prototype.controlText_="Time";i.registerComponent("TimeDisplay",nu);th=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-current-time"},i.updateContent=function(){var n;n=this.player_.ended()?this.player_.duration():this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();this.updateTextNode_(n)},t}(nu);th.prototype.labelText_="Current Time";th.prototype.controlText_="Current Time";i.registerComponent("CurrentTimeDisplay",th);ih=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"durationchange",r.updateContent);r.on(t,"loadstart",r.updateContent);r.on(t,"loadedmetadata",r.updateContent);return r}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-duration"},i.updateContent=function(){var n=this.player_.duration();this.updateTextNode_(n)},t}(nu);ih.prototype.labelText_="Duration";ih.prototype.controlText_="Duration";i.registerComponent("DurationDisplay",ih);ag=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider",innerHTML:"<div><span>/<\/span><\/div>"},{"aria-hidden":!0})},t}(i);i.registerComponent("TimeDivider",ag);rh=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"durationchange",r.updateContent);return r}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-remaining-time"},i.createEl=function(){var t=n.prototype.createEl.call(this);return t.insertBefore(p("span",{},{"aria-hidden":!0},"-"),this.contentEl_),t},i.updateContent=function(){if(typeof this.player_.duration()=="number"){var n;n=this.player_.ended()?0:this.player_.remainingTimeDisplay?this.player_.remainingTimeDisplay():this.player_.remainingTime();this.updateTextNode_(n)}},t}(nu);rh.prototype.labelText_="Remaining Time";rh.prototype.controlText_="Remaining Time";i.registerComponent("RemainingTimeDisplay",rh);vg=function(n){function t(t,i){var r;r=n.call(this,t,i)||this;r.updateShowing();r.on(r.player(),"durationchange",r.updateShowing);return r}f(t,n);var i=t.prototype;return i.createEl=function(){var t=n.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=p("div",{className:"vjs-live-display",innerHTML:'<span class="vjs-control-text">'+this.localize("Stream Type")+" <\/span>"+this.localize("LIVE")},{"aria-live":"off"}),t.appendChild(this.contentEl_),t},i.dispose=function(){this.contentEl_=null;n.prototype.dispose.call(this)},i.updateShowing=function(){this.player().duration()===Infinity?this.show():this.hide()},t}(i);i.registerComponent("LiveDisplay",vg);ov=function(n){function i(t,i){var r;if(r=n.call(this,t,i)||this,r.updateLiveEdgeStatus(),r.player_.liveTracker)r.on(r.player_.liveTracker,"liveedgechange",r.updateLiveEdgeStatus);return r}f(i,n);var t=i.prototype;return t.createEl=function(){var t=n.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=p("span",{className:"vjs-seek-to-live-text",innerHTML:this.localize("LIVE")},{"aria-hidden":"true"}),t.appendChild(this.textEl_),t},t.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},t.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},t.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatus);this.textEl_=null;n.prototype.dispose.call(this)},i}(oi);ov.prototype.controlText_="Seek to live, currently playing live";i.registerComponent("SeekToLive",ov);uh=function(n,t,i){return n=Number(n),Math.min(i,Math.max(t,isNaN(n)?t:n))};fh=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.bar=r.getChild(r.options_.barName),r.vertical(!!r.options_.vertical),r.enable(),r}f(i,n);var t=i.prototype;return t.enabled=function(){return this.enabled_},t.enable=function(){if(!this.enabled()){this.on("mousedown",this.handleMouseDown);this.on("touchstart",this.handleMouseDown);this.on("keydown",this.handleKeyDown);this.on("click",this.handleClick);this.on(this.player_,"controlsvisible",this.update);if(this.playerEvent)this.on(this.player_,this.playerEvent,this.update);this.removeClass("disabled");this.setAttribute("tabindex",0);this.enabled_=!0}},t.disable=function(){if(this.enabled()){var n=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown);this.off("touchstart",this.handleMouseDown);this.off("keydown",this.handleKeyDown);this.off("click",this.handleClick);this.off(this.player_,"controlsvisible",this.update);this.off(n,"mousemove",this.handleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchmove",this.handleMouseMove);this.off(n,"touchend",this.handleMouseUp);this.removeAttribute("tabindex");this.addClass("disabled");this.playerEvent&&this.off(this.player_,this.playerEvent,this.update);this.enabled_=!1}},t.createEl=function(t,i,r){return i===void 0&&(i={}),r===void 0&&(r={}),i.className=i.className+" vjs-slider",i=y({tabIndex:0},i),r=y({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},r),n.prototype.createEl.call(this,t,i,r)},t.handleMouseDown=function(n){var t=this.bar.el_.ownerDocument;n.type==="mousedown"&&n.preventDefault();n.type!=="touchstart"||ki||n.preventDefault();tk();this.addClass("vjs-sliding");this.trigger("slideractive");this.on(t,"mousemove",this.handleMouseMove);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchmove",this.handleMouseMove);this.on(t,"touchend",this.handleMouseUp);this.handleMouseMove(n)},t.handleMouseMove=function(){},t.handleMouseUp=function(){var n=this.bar.el_.ownerDocument;ik();this.removeClass("vjs-sliding");this.trigger("sliderinactive");this.off(n,"mousemove",this.handleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchmove",this.handleMouseMove);this.off(n,"touchend",this.handleMouseUp);this.update()},t.update=function(){var t=this,n;if(this.el_&&this.bar)return(n=this.getProgress(),n===this.progress_)?n:(this.progress_=n,this.requestNamedAnimationFrame("Slider#update",function(){var i=t.vertical()?"height":"width";t.bar.el().style[i]=(n*100).toFixed(2)+"%"}),n)},t.getProgress=function(){return Number(uh(this.getPercent(),0,1).toFixed(4))},t.calculateDistance=function(n){var t=kl(this.el_,n);return this.vertical()?t.y:t.x},t.handleKeyDown=function(t){o.isEventKey(t,"Left")||o.isEventKey(t,"Down")?(t.preventDefault(),t.stopPropagation(),this.stepBack()):o.isEventKey(t,"Right")||o.isEventKey(t,"Up")?(t.preventDefault(),t.stopPropagation(),this.stepForward()):n.prototype.handleKeyDown.call(this,t)},t.handleClick=function(n){n.stopPropagation();n.preventDefault()},t.vertical=function(n){if(n===undefined)return this.vertical_||!1;this.vertical_=!!n;this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},i}(i);i.registerComponent("Slider",fh);eh=function(n,t){return uh(n/t*100,0,100).toFixed(2)+"%"};yg=function(n){function t(t,i){var r;r=n.call(this,t,i)||this;r.partEls_=[];r.on(t,"progress",r.update);return r}f(t,n);var i=t.prototype;return i.createEl=function(){var i=n.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),t=p("span",{className:"vjs-control-text"}),u=p("span",{textContent:this.localize("Loaded")}),f=r.createTextNode(": ");return this.percentageEl_=p("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),i.appendChild(t),t.appendChild(u),t.appendChild(f),t.appendChild(this.percentageEl_),i},i.dispose=function(){this.partEls_=null;this.percentageEl_=null;n.prototype.dispose.call(this)},i.update=function(){var n=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var s=n.player_.liveTracker,r=n.player_.buffered(),l=s&&s.isLive()?s.seekableEnd():n.player_.duration(),h=n.player_.bufferedEnd(),u=n.partEls_,f=eh(h,l),i,o;for(n.percent_!==f&&(n.el_.style.width=f,pu(n.percentageEl_,f),n.percent_=f),i=0;i<r.length;i++){var e=r.start(i),c=r.end(i),t=u[i];(t||(t=n.el_.appendChild(p()),u[i]=t),t.dataset.start!==e||t.dataset.end!==c)&&(t.dataset.start=e,t.dataset.end=c,t.style.left=eh(e,h),t.style.width=eh(c-e,h))}for(o=u.length;o>r.length;o--)n.el_.removeChild(u[o-1]);u.length=r.length})},t}(i);i.registerComponent("LoadProgressBar",yg);pg=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.update=ar(c(s(r),r.update),nr),r}f(i,n);var t=i.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},t.update=function(n,t,i){var u=ye(this.el_),f=bl(this.player_.el()),e=n.width*t;if(f&&u){var o=n.left-f.left+e,s=n.width-e+(f.right-n.right),r=u.width/2;o<r?r+=r-o:s<r&&(r=s);r<0?r=0:r>u.width&&(r=u.width);r=Math.round(r);this.el_.style.right="-"+r+"px";this.write(i)}},t.write=function(n){pu(this.el_,n)},t.updateTime=function(n,t,i,r){var u=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var e,s=u.player_.duration(),f,o;u.player_.liveTracker&&u.player_.liveTracker.isLive()?(f=u.player_.liveTracker.liveWindow(),o=f-t*f,e=(o<1?"":"-")+nf(o,f)):e=nf(i,s);u.update(n,t,e);r&&r()})},i}(i);i.registerComponent("TimeTooltip",pg);oh=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.update=ar(c(s(r),r.update),nr),r}f(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},i.update=function(n,t){var i=this.getChild("timeTooltip"),r;i&&(r=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),i.updateTime(n,t,r))},t}(i);oh.prototype.options_={children:[]};gt||fr||oh.prototype.options_.children.push("timeTooltip");i.registerComponent("PlayProgressBar",oh);sv=function(n){function t(t,i){var r;return r=n.call(this,t,i)||this,r.update=ar(c(s(r),r.update),nr),r}f(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},i.update=function(n,t){var i=this,r=t*this.player_.duration();this.getChild("timeTooltip").updateTime(n,t,r,function(){i.el_.style.left=n.width*t+"px"})},t}(i);sv.prototype.options_={children:["timeTooltip"]};i.registerComponent("MouseTimeDisplay",sv);var sh=5,wg=12,hv=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.setEventHandlers_(),r}f(i,n);var t=i.prototype;return t.setEventHandlers_=function(){this.update_=c(this,this.update);this.update=ar(this.update_,nr);this.on(this.player_,["ended","durationchange","timeupdate"],this.update);if(this.player_.liveTracker)this.on(this.player_.liveTracker,"liveedgechange",this.update);this.updateInterval=null;this.on(this.player_,["playing"],this.enableInterval_);this.on(this.player_,["ended","pause","waiting"],this.disableInterval_);if("hidden"in r&&"visibilityState"in r)this.on(r,"visibilitychange",this.toggleVisibility_)},t.toggleVisibility_=function(n){r.hidden?this.disableInterval_(n):(this.enableInterval_(),this.update())},t.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,nr))},t.disableInterval_=function(n){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&n&&n.type!=="ended"||this.updateInterval&&(this.clearInterval(this.updateInterval),this.updateInterval=null)},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},t.update=function(){var t=this,i=n.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var r=t.player_.ended()?t.player_.duration():t.getCurrentTime_(),u=t.player_.liveTracker,n=t.player_.duration();u&&u.isLive()&&(n=t.player_.liveTracker.liveCurrentTime());t.percent_!==i&&(t.el_.setAttribute("aria-valuenow",(i*100).toFixed(2)),t.percent_=i);(t.currentTime_!==r||t.duration_!==n)&&(t.el_.setAttribute("aria-valuetext",t.localize("progress bar timing: currentTime={1} duration={2}",[nf(r,n),nf(n,n)],"{1} of {2}")),t.currentTime_=r,t.duration_=n);t.bar&&t.bar.update(bl(t.el()),t.getProgress())}),i},t.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},t.getPercent=function(){var i=this.getCurrentTime_(),t,n=this.player_.liveTracker;return n&&n.isLive()?(t=(i-n.seekableStart())/n.liveWindow(),n.atLiveEdge()&&(t=1)):t=i/this.player_.duration(),t},t.handleMouseDown=function(t){wu(t)&&(t.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),n.prototype.handleMouseDown.call(this,t))},t.handleMouseMove=function(n){var t,r,i,u,f;if(wu(n)){if(r=this.calculateDistance(n),i=this.player_.liveTracker,i&&i.isLive()){if(r>=.99){i.seekToLiveEdge();return}if(u=i.seekableStart(),f=i.liveCurrentTime(),t=u+r*i.liveWindow(),t>=f&&(t=f),t<=u&&(t=u+.1),t===Infinity)return}else t=r*this.player_.duration(),t===this.player_.duration()&&(t=t-.1);this.player_.currentTime(t)}},t.enable=function(){n.prototype.enable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.show()},t.disable=function(){n.prototype.disable.call(this);var t=this.getChild("mouseTimeDisplay");t&&t.hide()},t.handleMouseUp=function(t){n.prototype.handleMouseUp.call(this,t);t&&t.stopPropagation();this.player_.scrubbing(!1);this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0});this.videoWasPlaying?wr(this.player_.play()):this.update_()},t.stepForward=function(){this.player_.currentTime(this.player_.currentTime()+sh)},t.stepBack=function(){this.player_.currentTime(this.player_.currentTime()-sh)},t.handleAction=function(){this.player_.paused()?this.player_.play():this.player_.pause()},t.handleKeyDown=function(t){if(o.isEventKey(t,"Space")||o.isEventKey(t,"Enter"))t.preventDefault(),t.stopPropagation(),this.handleAction(t);else if(o.isEventKey(t,"Home"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(0);else if(o.isEventKey(t,"End"))t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.duration());else if(/^[0-9]$/.test(o(t))){t.preventDefault();t.stopPropagation();var i=(o.codes[o(t)]-o.codes["0"])/10;this.player_.currentTime(this.player_.duration()*i)}else o.isEventKey(t,"PgDn")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()-sh*wg)):o.isEventKey(t,"PgUp")?(t.preventDefault(),t.stopPropagation(),this.player_.currentTime(this.player_.currentTime()+sh*wg)):n.prototype.handleKeyDown.call(this,t)},t.dispose=function(){if(this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker)this.on(this.player_.liveTracker,"liveedgechange",this.update);this.off(this.player_,["playing"],this.enableInterval_);this.off(this.player_,["ended","pause","waiting"],this.disableInterval_);"hidden"in r&&"visibilityState"in r&&this.off(r,"visibilitychange",this.toggleVisibility_);n.prototype.dispose.call(this)},i}(fh);hv.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"};gt||fr||hv.prototype.options_.children.splice(1,0,"mouseTimeDisplay");i.registerComponent("SeekBar",hv);cv=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.handleMouseMove=ar(c(s(r),r.handleMouseMove),nr),r.throttledHandleMouseSeek=ar(c(s(r),r.handleMouseSeek),nr),r.enable(),r}f(i,n);var t=i.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},t.handleMouseMove=function(n){var t=this.getChild("seekBar"),i,r;if(t&&(i=t.getChild("playProgressBar"),r=t.getChild("mouseTimeDisplay"),i||r)){var f=t.el(),e=ye(f),u=kl(f,n).x;u=uh(u,0,1);r&&r.update(e,u);i&&i.update(e,t.getProgress())}},t.handleMouseSeek=function(n){var t=this.getChild("seekBar");t&&t.handleMouseMove(n)},t.enabled=function(){return this.enabled_},t.disable=function(){(this.children().forEach(function(n){return n.disable&&n.disable()}),this.enabled())&&(this.off(["mousedown","touchstart"],this.handleMouseDown),this.off(this.el_,"mousemove",this.handleMouseMove),this.handleMouseUp(),this.addClass("disabled"),this.enabled_=!1)},t.enable=function(){if(this.children().forEach(function(n){return n.enable&&n.enable()}),!this.enabled()){this.on(["mousedown","touchstart"],this.handleMouseDown);this.on(this.el_,"mousemove",this.handleMouseMove);this.removeClass("disabled");this.enabled_=!0}},t.handleMouseDown=function(n){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseDown(n);this.on(t,"mousemove",this.throttledHandleMouseSeek);this.on(t,"touchmove",this.throttledHandleMouseSeek);this.on(t,"mouseup",this.handleMouseUp);this.on(t,"touchend",this.handleMouseUp)},t.handleMouseUp=function(n){var t=this.el_.ownerDocument,i=this.getChild("seekBar");i&&i.handleMouseUp(n);this.off(t,"mousemove",this.throttledHandleMouseSeek);this.off(t,"touchmove",this.throttledHandleMouseSeek);this.off(t,"mouseup",this.handleMouseUp);this.off(t,"touchend",this.handleMouseUp)},i}(i);cv.prototype.options_={children:["seekBar"]};i.registerComponent("ProgressControl",cv);lv=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on(t,["enterpictureinpicture","leavepictureinpicture"],r.handlePictureInPictureChange);r.on(t,["disablepictureinpicturechanged","loadedmetadata"],r.handlePictureInPictureEnabledChange);return r.disable(),r}f(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-picture-in-picture-control "+n.prototype.buildCSSClass.call(this)},t.handlePictureInPictureEnabledChange=function(){r.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()},t.handlePictureInPictureChange=function(){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture");this.handlePictureInPictureEnabledChange()},t.handleClick=function(){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},i}(oi);lv.prototype.controlText_="Picture-in-Picture";i.registerComponent("PictureInPictureToggle",lv);av=function(n){function t(t,i){var u=n.call(this,t,i)||this;u.on(t,"fullscreenchange",u.handleFullscreenChange);return r[t.fsApi_.fullscreenEnabled]===!1&&u.disable(),u}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-fullscreen-control "+n.prototype.buildCSSClass.call(this)},i.handleFullscreenChange=function(){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},i.handleClick=function(){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},t}(oi);av.prototype.controlText_="Fullscreen";i.registerComponent("FullscreenToggle",av);bg=function(n,t){t.tech_&&!t.tech_.featuresVolumeControl&&n.addClass("vjs-hidden");n.on(t,"loadstart",function(){t.tech_.featuresVolumeControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};kg=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-level",innerHTML:'<span class="vjs-control-text"><\/span>'})},t}(i);i.registerComponent("VolumeLevel",kg);hh=function(n){function i(t,i){var r=n.call(this,t,i)||this;r.on("slideractive",r.updateLastVolume_);r.on(t,"volumechange",r.updateARIAAttributes);return t.ready(function(){return r.updateARIAAttributes()}),r}f(i,n);var t=i.prototype;return t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},t.handleMouseDown=function(t){wu(t)&&n.prototype.handleMouseDown.call(this,t)},t.handleMouseMove=function(n){wu(n)&&(this.checkMuted(),this.player_.volume(this.calculateDistance(n)))},t.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},t.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},t.stepForward=function(){this.checkMuted();this.player_.volume(this.player_.volume()+.1)},t.stepBack=function(){this.checkMuted();this.player_.volume(this.player_.volume()-.1)},t.updateARIAAttributes=function(){var n=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",n);this.el_.setAttribute("aria-valuetext",n+"%")},t.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},t.updateLastVolume_=function(){var n=this,t=this.player_.volume();this.one("sliderinactive",function(){n.player_.volume()===0&&n.player_.lastVolume_(t)})},i}(fh);hh.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"};hh.prototype.playerEvent="volumechange";i.registerComponent("VolumeBar",hh);vv=function(n){function i(t,i){var r;i===void 0&&(i={});i.vertical=i.vertical||!1;(typeof i.volumeBar=="undefined"||se(i.volumeBar))&&(i.volumeBar=i.volumeBar||{},i.volumeBar.vertical=i.vertical);r=n.call(this,t,i)||this;bg(s(r),t);r.throttledHandleMouseMove=ar(c(s(r),r.handleMouseMove),nr);r.on("mousedown",r.handleMouseDown);r.on("touchstart",r.handleMouseDown);r.on(r.volumeBar,["focus","slideractive"],function(){r.volumeBar.addClass("vjs-slider-active");r.addClass("vjs-slider-active");r.trigger("slideractive")});r.on(r.volumeBar,["blur","sliderinactive"],function(){r.volumeBar.removeClass("vjs-slider-active");r.removeClass("vjs-slider-active");r.trigger("sliderinactive")});return r}f(i,n);var t=i.prototype;return t.createEl=function(){var t="vjs-volume-horizontal";return this.options_.vertical&&(t="vjs-volume-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+t})},t.handleMouseDown=function(){var n=this.el_.ownerDocument;this.on(n,"mousemove",this.throttledHandleMouseMove);this.on(n,"touchmove",this.throttledHandleMouseMove);this.on(n,"mouseup",this.handleMouseUp);this.on(n,"touchend",this.handleMouseUp)},t.handleMouseUp=function(){var n=this.el_.ownerDocument;this.off(n,"mousemove",this.throttledHandleMouseMove);this.off(n,"touchmove",this.throttledHandleMouseMove);this.off(n,"mouseup",this.handleMouseUp);this.off(n,"touchend",this.handleMouseUp)},t.handleMouseMove=function(n){this.volumeBar.handleMouseMove(n)},i}(i);vv.prototype.options_={children:["volumeBar"]};i.registerComponent("VolumeControl",vv);dg=function(n,t){t.tech_&&!t.tech_.featuresMuteControl&&n.addClass("vjs-hidden");n.on(t,"loadstart",function(){t.tech_.featuresMuteControl?n.removeClass("vjs-hidden"):n.addClass("vjs-hidden")})};yv=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;dg(s(r),t);r.on(t,["loadstart","volumechange"],r.update);return r}f(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-mute-control "+n.prototype.buildCSSClass.call(this)},t.handleClick=function(){var i=this.player_.volume(),n=this.player_.lastVolume_(),t;i===0?(t=n<.1?.1:n,this.player_.volume(t),this.player_.muted(!1)):this.player_.muted(this.player_.muted()?!1:!0)},t.update=function(){this.updateIcon_();this.updateControlText_()},t.updateIcon_=function(){var i=this.player_.volume(),n=3,t;for(gt&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),i===0||this.player_.muted()?n=0:i<.33?n=1:i<.67&&(n=2),t=0;t<4;t++)ae(this.el_,"vjs-vol-"+t);di(this.el_,"vjs-vol-"+n)},t.updateControlText_=function(){var t=this.player_.muted()||this.player_.volume()===0,n=t?"Unmute":"Mute";this.controlText()!==n&&this.controlText(n)},i}(oi);yv.prototype.controlText_="Mute";i.registerComponent("MuteToggle",yv);pv=function(n){function i(t,i){var r;i===void 0&&(i={});i.inline=typeof i.inline!="undefined"?i.inline:!0;(typeof i.volumeControl=="undefined"||se(i.volumeControl))&&(i.volumeControl=i.volumeControl||{},i.volumeControl.vertical=!i.inline);r=n.call(this,t,i)||this;r.on(t,["loadstart"],r.volumePanelState_);r.on(r.muteToggle,"keyup",r.handleKeyPress);r.on(r.volumeControl,"keyup",r.handleVolumeControlKeyUp);r.on("keydown",r.handleKeyPress);r.on("mouseover",r.handleMouseOver);r.on("mouseout",r.handleMouseOut);r.on(r.volumeControl,["slideractive"],r.sliderActive_);r.on(r.volumeControl,["sliderinactive"],r.sliderInactive_);return r}f(i,n);var t=i.prototype;return t.sliderActive_=function(){this.addClass("vjs-slider-active")},t.sliderInactive_=function(){this.removeClass("vjs-slider-active")},t.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden");this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},t.createEl=function(){var t="vjs-volume-panel-horizontal";return this.options_.inline||(t="vjs-volume-panel-vertical"),n.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+t})},t.dispose=function(){this.handleMouseOut();n.prototype.dispose.call(this)},t.handleVolumeControlKeyUp=function(n){o.isEventKey(n,"Esc")&&this.muteToggle.focus()},t.handleMouseOver=function(){this.addClass("vjs-hover");ni(r,"keyup",c(this,this.handleKeyPress))},t.handleMouseOut=function(){this.removeClass("vjs-hover");ft(r,"keyup",c(this,this.handleKeyPress))},t.handleKeyPress=function(n){o.isEventKey(n,"Esc")&&this.handleMouseOut()},i}(i);pv.prototype.options_={children:["muteToggle","volumeControl"]};i.registerComponent("VolumePanel",pv);ch=function(n){function u(t,i){var r;r=n.call(this,t,i)||this;i&&(r.menuButton_=i.menuButton);r.focusedChild_=-1;r.on("keydown",r.handleKeyDown);return r.boundHandleBlur_=c(s(r),r.handleBlur),r.boundHandleTapClick_=c(s(r),r.handleTapClick),r}f(u,n);var t=u.prototype;return t.addEventListenerForItem=function(n){if(n instanceof i){this.on(n,"blur",this.boundHandleBlur_);this.on(n,["tap","click"],this.boundHandleTapClick_)}},t.removeEventListenerForItem=function(n){n instanceof i&&(this.off(n,"blur",this.boundHandleBlur_),this.off(n,["tap","click"],this.boundHandleTapClick_))},t.removeChild=function(t){typeof t=="string"&&(t=this.getChild(t));this.removeEventListenerForItem(t);n.prototype.removeChild.call(this,t)},t.addItem=function(n){var t=this.addChild(n);t&&this.addEventListenerForItem(t)},t.createEl=function(){var i=this.options_.contentElType||"ul",t;return this.contentEl_=p(i,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu"),t=n.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"}),t.appendChild(this.contentEl_),ni(t,"click",function(n){n.preventDefault();n.stopImmediatePropagation()}),t},t.dispose=function(){this.contentEl_=null;this.boundHandleBlur_=null;this.boundHandleTapClick_=null;n.prototype.dispose.call(this)},t.handleBlur=function(n){var i=n.relatedTarget||r.activeElement,t;this.children().some(function(n){return n.el()===i})||(t=this.menuButton_,t&&t.buttonPressed_&&i!==t.el().firstChild&&t.unpressButton())},t.handleTapClick=function(n){var t,i;if(this.menuButton_){if(this.menuButton_.unpressButton(),t=this.children(),!Array.isArray(t))return;if(i=t.filter(function(t){return t.el()===n.target})[0],!i)return;i.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},t.handleKeyDown=function(n){o.isEventKey(n,"Left")||o.isEventKey(n,"Down")?(n.preventDefault(),n.stopPropagation(),this.stepForward()):(o.isEventKey(n,"Right")||o.isEventKey(n,"Up"))&&(n.preventDefault(),n.stopPropagation(),this.stepBack())},t.stepForward=function(){var n=0;this.focusedChild_!==undefined&&(n=this.focusedChild_+1);this.focus(n)},t.stepBack=function(){var n=0;this.focusedChild_!==undefined&&(n=this.focusedChild_-1);this.focus(n)},t.focus=function(n){n===void 0&&(n=0);var t=this.children().slice(),i=t.length&&t[0].hasClass("vjs-menu-title");i&&t.shift();t.length>0&&(n<0?n=0:n>=t.length&&(n=t.length-1),this.focusedChild_=n,t[n].el_.focus())},u}(i);i.registerComponent("Menu",ch);lh=function(n){function u(t,i){var u,f;i===void 0&&(i={});u=n.call(this,t,i)||this;u.menuButton_=new oi(t,i);u.menuButton_.controlText(u.controlText_);u.menuButton_.el_.setAttribute("aria-haspopup","true");f=oi.prototype.buildCSSClass();u.menuButton_.el_.className=u.buildCSSClass()+" "+f;u.menuButton_.removeClass("vjs-control");u.addChild(u.menuButton_);u.update();u.enabled_=!0;u.on(u.menuButton_,"tap",u.handleClick);u.on(u.menuButton_,"click",u.handleClick);u.on(u.menuButton_,"keydown",u.handleKeyDown);u.on(u.menuButton_,"mouseenter",function(){u.addClass("vjs-hover");u.menu.show();ni(r,"keyup",c(s(u),u.handleMenuKeyUp))});u.on("mouseleave",u.handleMouseLeave);u.on("keydown",u.handleSubmenuKeyDown);return u}f(u,n);var t=u.prototype;return t.update=function(){var n=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu));this.menu=n;this.addChild(n);this.buttonPressed_=!1;this.menuButton_.el_.setAttribute("aria-expanded","false");this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},t.createMenu=function(){var t=new ch(this.player_,{menuButton:this}),r,u,n;if(this.hideThreshold_=0,this.options_.title&&(r=p("li",{className:"vjs-menu-title",innerHTML:w(this.options_.title),tabIndex:-1}),this.hideThreshold_+=1,u=new i(this.player_,{el:r}),t.addItem(u)),this.items=this.createItems(),this.items)for(n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},t.createItems=function(){},t.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},t.buildWrapperCSSClass=function(){var t="vjs-menu-button",i;return t+=this.options_.inline===!0?"-inline":"-popup",i=oi.prototype.buildCSSClass(),"vjs-menu-button "+t+" "+i+" "+n.prototype.buildCSSClass.call(this)},t.buildCSSClass=function(){var t="vjs-menu-button";return t+=this.options_.inline===!0?"-inline":"-popup","vjs-menu-button "+t+" "+n.prototype.buildCSSClass.call(this)},t.controlText=function(n,t){return t===void 0&&(t=this.menuButton_.el()),this.menuButton_.controlText(n,t)},t.dispose=function(){this.handleMouseLeave();n.prototype.dispose.call(this)},t.handleClick=function(){this.buttonPressed_?this.unpressButton():this.pressButton()},t.handleMouseLeave=function(){this.removeClass("vjs-hover");ft(r,"keyup",c(this,this.handleMenuKeyUp))},t.focus=function(){this.menuButton_.focus()},t.blur=function(){this.menuButton_.blur()},t.handleKeyDown=function(n){o.isEventKey(n,"Esc")||o.isEventKey(n,"Tab")?(this.buttonPressed_&&this.unpressButton(),o.isEventKey(n,"Tab")||(n.preventDefault(),this.menuButton_.focus())):(o.isEventKey(n,"Up")||o.isEventKey(n,"Down"))&&(this.buttonPressed_||(n.preventDefault(),this.pressButton()))},t.handleMenuKeyUp=function(n){(o.isEventKey(n,"Esc")||o.isEventKey(n,"Tab"))&&this.removeClass("vjs-hover")},t.handleSubmenuKeyPress=function(n){this.handleSubmenuKeyDown(n)},t.handleSubmenuKeyDown=function(n){(o.isEventKey(n,"Esc")||o.isEventKey(n,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),o.isEventKey(n,"Tab")||(n.preventDefault(),this.menuButton_.focus()))},t.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),gt&&bb())return;this.menu.focus()}},t.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},t.disable=function(){this.unpressButton();this.enabled_=!1;this.addClass("vjs-disabled");this.menuButton_.disable()},t.enable=function(){this.enabled_=!0;this.removeClass("vjs-disabled");this.menuButton_.enable()},u}(i);i.registerComponent("MenuButton",lh);ah=function(n){function t(t,i){var r,f=i.tracks,u;if(r=n.call(this,t,i)||this,r.items.length<=1&&r.hide(),!f)return s(r);u=c(s(r),r.update);f.addEventListener("removetrack",u);f.addEventListener("addtrack",u);f.addEventListener("labelchange",u);r.player_.on("ready",u);r.player_.on("dispose",function(){f.removeEventListener("removetrack",u);f.removeEventListener("addtrack",u);f.removeEventListener("labelchange",u)});return r}return f(t,n),t}(lh);i.registerComponent("TrackButton",ah);gg=["Tab","Esc","Up","Down","Right","Left"];tf=function(n){function i(t,i){var r;return r=n.call(this,t,i)||this,r.selectable=i.selectable,r.isSelected_=i.selected||!1,r.multiSelectable=i.multiSelectable,r.selected(r.isSelected_),r.selectable?r.multiSelectable?r.el_.setAttribute("role","menuitemcheckbox"):r.el_.setAttribute("role","menuitemradio"):r.el_.setAttribute("role","menuitem"),r}f(i,n);var t=i.prototype;return t.createEl=function(t,i,r){return this.nonIconControl=!0,n.prototype.createEl.call(this,"li",y({className:"vjs-menu-item",innerHTML:'<span class="vjs-menu-item-text">'+this.localize(this.options_.label)+"<\/span>",tabIndex:-1},i),r)},t.handleKeyDown=function(t){gg.some(function(n){return o.isEventKey(t,n)})||n.prototype.handleKeyDown.call(this,t)},t.handleClick=function(){this.selected(!0)},t.selected=function(n){this.selectable&&(n?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},i}(to);i.registerComponent("MenuItem",tf);rf=function(n){function u(i,u){var f,c=u.track,e=i.textTracks(),o,l,h;u.label=c.label||c.language||"Unknown";u.selected=c.mode==="showing";f=n.call(this,i,u)||this;f.track=c;f.kinds=(u.kinds||[u.kind||f.track.kind]).filter(Boolean);o=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];f.handleTracksChange.apply(s(f),i)};l=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];f.handleSelectedLanguageChange.apply(s(f),i)};i.on(["loadstart","texttrackchange"],o);e.addEventListener("change",o);e.addEventListener("selectedlanguagechange",l);f.on("dispose",function(){i.off(["loadstart","texttrackchange"],o);e.removeEventListener("change",o);e.removeEventListener("selectedlanguagechange",l)});if(e.onchange===undefined)f.on(["tap","click"],function(){if(typeof t.Event!="object")try{h=new t.Event("change")}catch(n){}h||(h=r.createEvent("Event"),h.initEvent("change",!0,!0));e.dispatchEvent(h)});return f.handleTracksChange(),f}f(u,n);var i=u.prototype;return i.handleClick=function(t){var f=this.track,u=this.player_.textTracks(),r,i;if(n.prototype.handleClick.call(this,t),u)for(r=0;r<u.length;r++)(i=u[r],this.kinds.indexOf(i.kind)!==-1)&&(i===f?i.mode!=="showing"&&(i.mode="showing"):i.mode!=="disabled"&&(i.mode="disabled"))},i.handleTracksChange=function(){var n=this.track.mode==="showing";n!==this.isSelected_&&this.selected(n)},i.handleSelectedLanguageChange=function(){if(this.track.mode==="showing"){var n=this.player_.cache_.selectedLanguage;if(n&&n.enabled&&n.language===this.track.language&&n.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},i.dispose=function(){this.track=null;n.prototype.dispose.call(this)},u}(tf);i.registerComponent("TextTrackMenuItem",rf);wv=function(n){function t(t,i){return i.track={player:t,kind:i.kind,kinds:i.kinds,"default":!1,mode:"disabled"},i.kinds||(i.kinds=[i.kind]),i.track.label=i.label?i.label:i.kinds.join(" and ")+" off",i.selectable=!0,i.multiSelectable=!1,n.call(this,t,i)||this}f(t,n);var i=t.prototype;return i.handleTracksChange=function(){for(var i,r=this.player().textTracks(),n=!0,t=0,u=r.length;t<u;t++)if(i=r[t],this.options_.kinds.indexOf(i.kind)>-1&&i.mode==="showing"){n=!1;break}n!==this.isSelected_&&this.selected(n)},i.handleSelectedLanguageChange=function(){for(var t,i=this.player().textTracks(),r=!0,n=0,u=i.length;n<u;n++)if(t=i[n],["captions","descriptions","subtitles"].indexOf(t.kind)>-1&&t.mode==="showing"){r=!1;break}r&&(this.player_.cache_.selectedLanguage={enabled:!1})},t}(rf);i.registerComponent("OffTextTrackMenuItem",wv);tu=function(n){function t(t,i){return i===void 0&&(i={}),i.tracks=t.textTracks(),n.call(this,t,i)||this}f(t,n);var i=t.prototype;return i.createItems=function(n,t){var e,u,i,r,f;for(n===void 0&&(n=[]),t===void 0&&(t=rf),this.label_&&(e=this.label_+" off"),n.push(new wv(this.player_,{kinds:this.kinds_,kind:this.kind_,label:e})),this.hideThreshold_+=1,u=this.player_.textTracks(),Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]),i=0;i<u.length;i++)r=u[i],this.kinds_.indexOf(r.kind)>-1&&(f=new t(this.player_,{track:r,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1}),f.addClass("vjs-"+r.kind+"-menu-item"),n.push(f));return n},t}(ah);i.registerComponent("TextTrackButton",tu);bv=function(n){function t(t,i){var r,f=i.track,u=i.cue,e=t.currentTime();return i.selectable=!0,i.multiSelectable=!1,i.label=u.text,i.selected=u.startTime<=e&&e<u.endTime,r=n.call(this,t,i)||this,r.track=f,r.cue=u,f.addEventListener("cuechange",c(s(r),r.update)),r}f(t,n);var i=t.prototype;return i.handleClick=function(){n.prototype.handleClick.call(this);this.player_.currentTime(this.cue.startTime);this.update(this.cue.startTime)},i.update=function(){var n=this.cue,t=this.player_.currentTime();this.selected(n.startTime<=t&&t<n.endTime)},t}(tf);i.registerComponent("ChaptersTrackMenuItem",bv);vh=function(n){function i(t,i,r){return n.call(this,t,i,r)||this}f(i,n);var t=i.prototype;return t.buildCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-chapters-button "+n.prototype.buildWrapperCSSClass.call(this)},t.update=function(t){(!this.track_||t&&(t.type==="addtrack"||t.type==="removetrack"))&&this.setTrack(this.findChaptersTrack());n.prototype.update.call(this)},t.setTrack=function(n){var t,i;this.track_!==n&&(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_&&(t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_),t&&t.removeEventListener("load",this.updateHandler_),this.track_=null),this.track_=n,this.track_&&(this.track_.mode="hidden",i=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_),i&&i.addEventListener("load",this.updateHandler_)))},t.findChaptersTrack=function(){for(var t,i=this.player_.textTracks()||[],n=i.length-1;n>=0;n--)if(t=i[n],t.kind===this.kind_)return t},t.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(w(this.kind_))},t.createMenu=function(){return this.options_.title=this.getMenuCaption(),n.prototype.createMenu.call(this)},t.createItems=function(){var i=[],n,t,r,u,f;if(!this.track_||(n=this.track_.cues,!n))return i;for(t=0,r=n.length;t<r;t++)u=n[t],f=new bv(this.player_,{track:this.track_,cue:u}),i.push(f);return i},i}(tu);vh.prototype.kind_="chapters";vh.prototype.controlText_="Chapters";i.registerComponent("ChaptersButton",vh);yh=function(n){function t(t,i,r){var u,f,e;u=n.call(this,t,i,r)||this;f=t.textTracks();e=c(s(u),u.handleTracksChange);f.addEventListener("change",e);u.on("dispose",function(){f.removeEventListener("change",e)});return u}f(t,n);var i=t.prototype;return i.handleTracksChange=function(){for(var t,i=this.player().textTracks(),r=!1,n=0,u=i.length;n<u;n++)if(t=i[n],t.kind!==this.kind_&&t.mode==="showing"){r=!0;break}r?this.disable():this.enable()},i.buildCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(tu);yh.prototype.kind_="descriptions";yh.prototype.controlText_="Descriptions";i.registerComponent("DescriptionsButton",yh);ph=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+n.prototype.buildWrapperCSSClass.call(this)},t}(tu);ph.prototype.kind_="subtitles";ph.prototype.controlText_="Subtitles";i.registerComponent("SubtitlesButton",ph);wh=function(n){function t(t,i){var r;return i.track={player:t,kind:i.kind,label:i.kind+" settings",selectable:!1,"default":!1,mode:"disabled"},i.selectable=!1,i.name="CaptionSettingsMenuItem",r=n.call(this,t,i)||this,r.addClass("vjs-texttrack-settings"),r.controlText(", opens "+i.kind+" settings dialog"),r}f(t,n);var i=t.prototype;return i.handleClick=function(){this.player().getChild("textTrackSettings").open()},t}(rf);i.registerComponent("CaptionSettingsMenuItem",wh);bh=function(n){function t(t,i,r){return n.call(this,t,i,r)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-captions-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-captions-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new wh(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,t)},t}(tu);bh.prototype.kind_="captions";bh.prototype.controlText_="Captions";i.registerComponent("CaptionsButton",bh);kv=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.createEl=function(t,i,r){var u='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="captions"&&(u+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> '+this.localize("Captions")+"<\/span>\n      "),u+="<\/span>",n.prototype.createEl.call(this,t,y({innerHTML:u},i),r)},t}(rf);i.registerComponent("SubsCapsMenuItem",kv);kh=function(n){function t(t,i){var r;return i===void 0&&(i={}),r=n.call(this,t,i)||this,r.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(r.player_.language_)>-1&&(r.label_="captions"),r.menuButton_.controlText(w(r.label_)),r}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(){var t=[];return this.player().tech_&&this.player().tech_.featuresNativeTextTracks||!this.player().getChild("textTrackSettings")||(t.push(new wh(this.player_,{kind:this.label_})),this.hideThreshold_+=1),n.prototype.createItems.call(this,t,kv)},t}(tu);kh.prototype.kinds_=["captions","subtitles"];kh.prototype.controlText_="Subtitles";i.registerComponent("SubsCapsButton",kh);dv=function(n){function t(t,i){var r,u=i.track,e=t.audioTracks(),f;i.label=u.label||u.language||"Unknown";i.selected=u.enabled;r=n.call(this,t,i)||this;r.track=u;r.addClass("vjs-"+u.kind+"-menu-item");f=function(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];r.handleTracksChange.apply(s(r),i)};e.addEventListener("change",f);r.on("dispose",function(){e.removeEventListener("change",f)});return r}f(t,n);var i=t.prototype;return i.createEl=function(t,i,r){var u='<span class="vjs-menu-item-text">'+this.localize(this.options_.label);return this.options_.track.kind==="main-desc"&&(u+='\n        <span aria-hidden="true" class="vjs-icon-placeholder"><\/span>\n        <span class="vjs-control-text"> '+this.localize("Descriptions")+"<\/span>\n      "),u+="<\/span>",n.prototype.createEl.call(this,t,y({innerHTML:u},i),r)},i.handleClick=function(t){var u=this.player_.audioTracks(),i,r;for(n.prototype.handleClick.call(this,t),i=0;i<u.length;i++)r=u[i],r.enabled=r===this.track},i.handleTracksChange=function(){this.selected(this.track.enabled)},t}(tf);i.registerComponent("AudioTrackMenuItem",dv);gv=function(n){function t(t,i){return i===void 0&&(i={}),i.tracks=t.audioTracks(),n.call(this,t,i)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-audio-button "+n.prototype.buildCSSClass.call(this)},i.buildWrapperCSSClass=function(){return"vjs-audio-button "+n.prototype.buildWrapperCSSClass.call(this)},i.createItems=function(n){var i,t,r;for(n===void 0&&(n=[]),this.hideThreshold_=1,i=this.player_.audioTracks(),t=0;t<i.length;t++)r=i[t],n.push(new dv(this.player_,{track:r,selectable:!0,multiSelectable:!1}));return n},t}(ah);gv.prototype.controlText_="Audio Track";i.registerComponent("AudioTrackButton",gv);dh=function(n){function t(t,i){var r,u=i.rate,f=parseFloat(u,10);i.label=u;i.selected=f===1;i.selectable=!0;i.multiSelectable=!1;r=n.call(this,t,i)||this;r.label=u;r.rate=f;r.on(t,"ratechange",r.update);return r}f(t,n);var i=t.prototype;return i.handleClick=function(){n.prototype.handleClick.call(this);this.player().playbackRate(this.rate)},i.update=function(){this.selected(this.player().playbackRate()===this.rate)},t}(tf);dh.prototype.contentElType="button";i.registerComponent("PlaybackRateMenuItem",dh);ny=function(n){function i(t,i){var r;r=n.call(this,t,i)||this;r.updateVisibility();r.updateLabel();r.on(t,"loadstart",r.updateVisibility);r.on(t,"ratechange",r.updateLabel);return r}f(i,n);var t=i.prototype;return t.createEl=function(){var t=n.prototype.createEl.call(this);return this.labelEl_=p("div",{className:"vjs-playback-rate-value",innerHTML:"1x"}),t.appendChild(this.labelEl_),t},t.dispose=function(){this.labelEl_=null;n.prototype.dispose.call(this)},t.buildCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildCSSClass.call(this)},t.buildWrapperCSSClass=function(){return"vjs-playback-rate "+n.prototype.buildWrapperCSSClass.call(this)},t.createMenu=function(){var i=new ch(this.player()),t=this.playbackRates(),n;if(t)for(n=t.length-1;n>=0;n--)i.addChild(new dh(this.player(),{rate:t[n]+"x"}));return i},t.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},t.handleClick=function(){for(var r=this.player().playbackRate(),n=this.playbackRates(),i=n[0],t=0;t<n.length;t++)if(n[t]>r){i=n[t];break}this.player().playbackRate(i)},t.playbackRates=function(){return this.options_.playbackRates||this.options_.playerOptions&&this.options_.playerOptions.playbackRates},t.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},t.updateVisibility=function(){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},t.updateLabel=function(){this.playbackRateSupported()&&(this.labelEl_.innerHTML=this.player().playbackRate()+"x")},i}(lh);ny.prototype.controlText_="Playback Rate";i.registerComponent("PlaybackRateMenuButton",ny);ty=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-spacer "+n.prototype.buildCSSClass.call(this)},i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:this.buildCSSClass()})},t}(i);i.registerComponent("Spacer",ty);nn=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-custom-control-spacer "+n.prototype.buildCSSClass.call(this)},i.createEl=function(){var t=n.prototype.createEl.call(this,{className:this.buildCSSClass()});return t.innerHTML=" ",t},t}(ty);i.registerComponent("CustomControlSpacer",nn);io=function(n){function t(){return n.apply(this,arguments)||this}f(t,n);var i=t.prototype;return i.createEl=function(){return n.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},t}(i);io.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]};"exitPictureInPicture"in r&&io.prototype.options_.children.splice(io.prototype.options_.children.length-1,0,"pictureInPictureToggle");i.registerComponent("ControlBar",io);iy=function(n){function t(t,i){var r=n.call(this,t,i)||this;r.on(t,"error",r.open);return r}f(t,n);var i=t.prototype;return i.buildCSSClass=function(){return"vjs-error-display "+n.prototype.buildCSSClass.call(this)},i.content=function(){var n=this.player().error();return n?this.localize(n.message):""},t}(ku);iy.prototype.options_=oe({},ku.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0});i.registerComponent("ErrorDisplay",iy);var ry="vjs-text-track-settings",tn=["#000","Black"],rn=["#00F","Blue"],un=["#0FF","Cyan"],fn=["#0F0","Green"],en=["#F0F","Magenta"],on=["#F00","Red"],sn=["#FFF","White"],hn=["#FF0","Yellow"],uy=["1","Opaque"],fy=["0.5","Semi-Transparent"],cn=["0","Transparent"],iu={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[tn,sn,on,fn,rn,hn,en,un]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[uy,fy,cn]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[sn,tn,on,fn,rn,hn,en,un]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],"default":2,parser:function(n){return n==="1.00"?null:Number(n)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[uy,fy]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[cn,fy,uy]}};iu.windowColor.options=iu.backgroundColor.options;an=function(n){function r(t,i){var r;i.temporary=!1;r=n.call(this,t,i)||this;r.updateDisplay=c(s(r),r.updateDisplay);r.fill();r.hasBeenOpened_=r.hasBeenFilled_=!0;r.endDialog=p("p",{className:"vjs-control-text",textContent:r.localize("End of dialog window.")});r.el().appendChild(r.endDialog);r.setDefaults();i.persistTextTrackSettings===undefined&&(r.options_.persistTextTrackSettings=r.options_.playerOptions.persistTextTrackSettings);r.on(r.$(".vjs-done-button"),"click",function(){r.saveSettings();r.close()});r.on(r.$(".vjs-default-button"),"click",function(){r.setDefaults();r.updateDisplay()});return lu(iu,function(n){r.on(r.$(n.selector),"change",r.updateDisplay)}),r.options_.persistTextTrackSettings&&r.restoreSettings(),r}f(r,n);var i=r.prototype;return i.dispose=function(){this.endDialog=null;n.prototype.dispose.call(this)},i.createElSelect_=function(n,t,i){var e=this;t===void 0&&(t="");i===void 0&&(i="label");var r=iu[n],u=r.id.replace("%s",this.id_),f=[t,u].join(" ").trim();return["<"+i+' id="'+u+'" class="'+(i==="label"?"vjs-label":"")+'">',this.localize(r.label),"<\/"+i+">",'<select aria-labelledby="'+f+'">'].concat(r.options.map(function(n){var t=u+"-"+n[1].replace(/\W+/g,"");return['<option id="'+t+'" value="'+n[0]+'" ','aria-labelledby="'+f+" "+t+'">',e.localize(n[1]),"<\/option>"].join("")})).concat("<\/select>").join("")},i.createElFgColor_=function(){var n="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Text"),"<\/legend>",this.createElSelect_("color",n),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",n),"<\/span>","<\/fieldset>"].join("")},i.createElBgColor_=function(){var n="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Background"),"<\/legend>",this.createElSelect_("backgroundColor",n),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",n),"<\/span>","<\/fieldset>"].join("")},i.createElWinColor_=function(){var n="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+n+'">',this.localize("Window"),"<\/legend>",this.createElSelect_("windowColor",n),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",n),"<\/span>","<\/fieldset>"].join("")},i.createElColors_=function(){return p("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},i.createElFont_=function(){return p("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"<\/fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"<\/fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"<\/fieldset>"].join("")})},i.createElControls_=function(){var n=this.localize("restore all settings to the default values");return p("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+n+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+n+"<\/span>","<\/button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"<\/button>"].join("")})},i.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},i.label=function(){return this.localize("Caption Settings Dialog")},i.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},i.buildCSSClass=function(){return n.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},i.getValues=function(){var n=this;return oot(iu,function(t,i,r){var u=wct(n.$(i.selector),i.parser);return u!==undefined&&(t[r]=u),t},{})},i.setValues=function(n){var t=this;lu(iu,function(i,r){bct(t.$(i.selector),n[r],i.parser)})},i.setDefaults=function(){var n=this;lu(iu,function(t){var i=t.hasOwnProperty("default")?t["default"]:0;n.$(t.selector).selectedIndex=i})},i.restoreSettings=function(){var n;try{n=JSON.parse(t.localStorage.getItem(ry))}catch(i){h.warn(i)}n&&this.setValues(n)},i.saveSettings=function(){if(this.options_.persistTextTrackSettings){var n=this.getValues();try{Object.keys(n).length?t.localStorage.setItem(ry,JSON.stringify(n)):t.localStorage.removeItem(ry)}catch(i){h.warn(i)}}},i.updateDisplay=function(){var n=this.player_.getChild("textTrackDisplay");n&&n.updateDisplay()},i.conditionalBlur_=function(){this.previouslyActiveEl_=null;var n=this.player_.controlBar,t=n&&n.subsCapsButton,i=n&&n.captionsButton;t?t.focus():i&&i.focus()},r}(ku);i.registerComponent("TextTrackSettings",an);vn=function(n){function i(i,r){var u,f=r.ResizeObserver||t.ResizeObserver,e;if(r.ResizeObserver===null&&(f=!1),e=v({createEl:!f,reportTouchActivity:!1},r),u=n.call(this,i,e)||this,u.ResizeObserver=r.ResizeObserver||t.ResizeObserver,u.loadListener_=null,u.resizeObserver_=null,u.debouncedHandler_=pot(function(){u.resizeHandler()},100,!1,s(u)),f)u.resizeObserver_=new u.ResizeObserver(u.debouncedHandler_),u.resizeObserver_.observe(i.el());else{u.loadListener_=function(){if(u.el_&&u.el_.contentWindow){var t=u.debouncedHandler_,n=u.unloadListener_=function(){ft(this,"resize",t);ft(this,"unload",n);n=null};ni(u.el_.contentWindow,"unload",n);ni(u.el_.contentWindow,"resize",t)}};u.one("load",u.loadListener_)}return u}f(i,n);var r=i.prototype;return r.createEl=function(){return n.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},r.resizeHandler=function(){this.player_&&this.player_.trigger&&this.player_.trigger("playerresize")},r.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel();this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect());this.loadListener_&&this.off("load",this.loadListener_);this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow);this.ResizeObserver=null;this.resizeObserver=null;this.debouncedHandler_=null;this.loadListener_=null;n.prototype.dispose.call(this)},i}(i);i.registerComponent("ResizeManager",vn);yn={trackingThreshold:30,liveTolerance:15};pn=function(n){function u(t,i){var u,f=v(yn,i,{createEl:!1});u=n.call(this,t,f)||this;u.reset_();u.on(u.player_,"durationchange",u.handleDurationchange);if(le&&"hidden"in r&&"visibilityState"in r)u.on(r,"visibilitychange",u.handleVisibilityChange);return u}f(u,n);var i=u.prototype;return i.handleVisibilityChange=function(){this.player_.duration()===Infinity&&(r.hidden?this.stopTracking():this.startTracking())},i.trackLive_=function(){var r=this.player_.seekable(),n,u;if(r&&r.length){n=Number(t.performance.now().toFixed(4));u=this.lastTime_===-1?0:(n-this.lastTime_)/1e3;this.lastTime_=n;this.pastSeekEnd_=this.pastSeekEnd()+u;var f=this.liveCurrentTime(),e=this.player_.currentTime(),i=this.player_.paused()||this.seekedBehindLive_||Math.abs(f-e)>this.options_.liveTolerance;this.timeupdateSeen_&&f!==Infinity||(i=!1);i!==this.behindLiveEdge_&&(this.behindLiveEdge_=i,this.trigger("liveedgechange"))}},i.handleDurationchange=function(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},i.startTracking=function(){if(!this.isTracking()){this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted());this.trackingInterval_=this.setInterval(this.trackLive_,nr);this.trackLive_();this.on(this.player_,["play","pause"],this.trackLive_);if(this.timeupdateSeen_)this.on(this.player_,"seeked",this.handleSeeked);else{this.one(this.player_,"play",this.handlePlay);this.one(this.player_,"timeupdate",this.handleFirstTimeupdate)}}},i.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0;this.on(this.player_,"seeked",this.handleSeeked)},i.handleSeeked=function(){var n=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.skipNextSeeked_?!1:n>2;this.skipNextSeeked_=!1;this.trackLive_()},i.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge)},i.reset_=function(){this.lastTime_=-1;this.pastSeekEnd_=0;this.lastSeekEnd_=-1;this.behindLiveEdge_=!0;this.timeupdateSeen_=!1;this.seekedBehindLive_=!1;this.skipNextSeeked_=!1;this.clearInterval(this.trackingInterval_);this.trackingInterval_=null;this.off(this.player_,["play","pause"],this.trackLive_);this.off(this.player_,"seeked",this.handleSeeked);this.off(this.player_,"play",this.handlePlay);this.off(this.player_,"timeupdate",this.handleFirstTimeupdate);this.off(this.player_,"timeupdate",this.seekToLiveEdge)},i.stopTracking=function(){this.isTracking()&&(this.reset_(),this.trigger("liveedgechange"))},i.seekableEnd=function(){for(var t=this.player_.seekable(),n=[],i=t?t.length:0;i--;)n.push(t.end(i));return n.length?n.sort()[n.length-1]:Infinity},i.seekableStart=function(){for(var n=this.player_.seekable(),t=[],i=n?n.length:0;i--;)t.push(n.start(i));return t.length?t.sort()[0]:0},i.liveWindow=function(){var n=this.liveCurrentTime();return n===Infinity?0:n-this.seekableStart()},i.isLive=function(){return this.isTracking()},i.atLiveEdge=function(){return!this.behindLiveEdge()},i.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},i.pastSeekEnd=function(){var n=this.seekableEnd();return this.lastSeekEnd_!==-1&&n!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=n,this.pastSeekEnd_},i.behindLiveEdge=function(){return this.behindLiveEdge_},i.isTracking=function(){return typeof this.trackingInterval_=="number"},i.seekToLiveEdge=function(){(this.seekedBehindLive_=!1,this.atLiveEdge())||(this.skipNextSeeked_=!0,this.player_.currentTime(this.liveCurrentTime()))},i.dispose=function(){this.off(r,"visibilitychange",this.handleVisibilityChange);this.stopTracking();n.prototype.dispose.call(this)},u}(i);i.registerComponent("LiveTracker",pn);var ey=function(n){var f=n.el(),i,r;if(f.hasAttribute("src"))return n.triggerSourceset(f.src),!0;var u=n.$$("source"),t=[],e="";if(!u.length)return!1;for(i=0;i<u.length;i++)r=u[i].src,r&&t.indexOf(r)===-1&&t.push(r);return t.length?(t.length===1&&(e=t[0]),n.triggerSourceset(e),!0):!1},kct=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(n){var i=r.createElement(this.nodeName.toLowerCase()),u;for(i.innerHTML=n,u=r.createDocumentFragment();i.childNodes.length;)u.appendChild(i.childNodes[0]);return this.innerText="",t.Element.prototype.appendChild.call(this,u),this.innerHTML}}),wn=function(n,t){for(var i={},r=0;r<n.length;r++)if(i=Object.getOwnPropertyDescriptor(n[r],t),i&&i.set&&i.get)break;return i.enumerable=!0,i.configurable=!0,i},dct=function(n){return wn([n.el(),t.HTMLMediaElement.prototype,t.Element.prototype,kct],"innerHTML")},bn=function(n){var t=n.el();if(!t.resetSourceWatch_){var i={},r=dct(n),u=function(i){return function(){for(var e,u=arguments.length,f=new Array(u),r=0;r<u;r++)f[r]=arguments[r];return e=i.apply(t,f),ey(n),e}};["append","appendChild","insertAdjacentHTML"].forEach(function(n){t[n]&&(i[n]=t[n],t[n]=u(i[n]))});Object.defineProperty(t,"innerHTML",v(r,{set:u(r.set)}));t.resetSourceWatch_=function(){t.resetSourceWatch_=null;Object.keys(i).forEach(function(n){t[n]=i[n]});Object.defineProperty(t,"innerHTML",r)};n.one("sourceset",t.resetSourceWatch_)}},gct=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?od(t.Element.prototype.getAttribute.call(this,"src")):""},set:function(n){return t.Element.prototype.setAttribute.call(this,"src",n),n}}),nlt=function(n){return wn([n.el(),t.HTMLMediaElement.prototype,gct],"src")},tlt=function(n){var t;if(n.featuresSourceset&&(t=n.el(),!t.resetSourceset_)){var i=nlt(n),r=t.setAttribute,u=t.load;Object.defineProperty(t,"src",v(i,{set:function(r){var u=i.set.call(t,r);return n.triggerSourceset(t.src),u}}));t.setAttribute=function(i,u){var f=r.call(t,i,u);return/src/i.test(i)&&n.triggerSourceset(t.src),f};t.load=function(){var i=u.call(t);return ey(n)||(n.triggerSourceset(""),bn(n)),i};t.currentSrc?n.triggerSourceset(t.currentSrc):ey(n)||bn(n);t.resetSourceset_=function(){t.resetSourceset_=null;t.load=u;t.setAttribute=r;Object.defineProperty(t,"src",i);t.resetSourceWatch_&&t.resetSourceWatch_()}}},oy=function(n,t,i,r){r===void 0&&(r=!0);var u=function(i){return Object.defineProperty(n,t,{value:i,enumerable:!0,writable:!0})},f={configurable:!0,enumerable:!0,get:function(){var n=i();return u(n),n}};return r&&(f.set=u),Object.defineProperty(n,t,f)},e=function(n){function u(t,i){var r,f,e,u,a,o;if(r=n.call(this,t,i)||this,f=t.source,e=!1,f&&(r.el_.currentSrc!==f.src||t.tag&&t.tag.initNetworkState_===3)?r.setSource(f):r.handleLateInit_(r.el_),t.enableSourceset&&r.setupSourcesetHandling_(),r.isScrubbing_=!1,r.el_.hasChildNodes()){for(var c=r.el_.childNodes,l=c.length,s=[];l--;)u=c[l],a=u.nodeName.toLowerCase(),a==="track"&&(r.featuresNativeTextTracks?(r.remoteTextTrackEls().addTrackElement_(u),r.remoteTextTracks().addTrack(u.track),r.textTracks().addTrack(u.track),e||r.el_.hasAttribute("crossorigin")||!ps(u.src)||(e=!0)):s.push(u));for(o=0;o<s.length;o++)r.el_.removeChild(s[o])}return r.proxyNativeTracks_(),r.featuresNativeTextTracks&&e&&h.warn("Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.\nThis may prevent text tracks from loading."),r.restoreMetadataTracksInIOSNativePlayer_(),(au||pl||lb)&&t.nativeControlsForTouch===!0&&r.setControls(!0),r.proxyWebkitFullscreen_(),r.triggerReady(),r}f(u,n);var i=u.prototype;return i.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_();u.disposeMediaElement(this.el_);this.options_=null;n.prototype.dispose.call(this)},i.setupSourcesetHandling_=function(){tlt(this)},i.restoreMetadataTracksInIOSNativePlayer_=function(){var n=this.textTracks(),r,t=function(){var t,i;for(r=[],t=0;t<n.length;t++)i=n[t],i.kind==="metadata"&&r.push({track:i,storedMode:i.mode})},i;t();n.addEventListener("change",t);this.on("dispose",function(){return n.removeEventListener("change",t)});i=function i(){for(var t,u=0;u<r.length;u++)t=r[u],t.track.mode==="disabled"&&t.track.mode!==t.storedMode&&(t.track.mode=t.storedMode);n.removeEventListener("change",i)};this.on("webkitbeginfullscreen",function(){n.removeEventListener("change",t);n.removeEventListener("change",i);n.addEventListener("change",i)});this.on("webkitendfullscreen",function(){n.removeEventListener("change",t);n.addEventListener("change",t);n.removeEventListener("change",i)})},i.overrideNative_=function(n,t){var r=this,i;t===this["featuresNative"+n+"Tracks"]&&(i=n.toLowerCase(),this[i+"TracksListeners_"]&&Object.keys(this[i+"TracksListeners_"]).forEach(function(n){var t=r.el()[i+"Tracks"];t.removeEventListener(n,r[i+"TracksListeners_"][n])}),this["featuresNative"+n+"Tracks"]=!t,this[i+"TracksListeners_"]=null,this.proxyNativeTracksForType_(i))},i.overrideNativeAudioTracks=function(n){this.overrideNative_("Audio",n)},i.overrideNativeVideoTracks=function(n){this.overrideNative_("Video",n)},i.proxyNativeTracksForType_=function(n){var f=this,r=ti[n],i=this.el()[r.getterName],t=this[r.getterName](),u,e;if(this["featuresNative"+r.capitalName+"Tracks"]&&i&&i.addEventListener){u={change:function(){var i={type:"change",target:t,currentTarget:t,srcElement:t};t.trigger(i);n==="text"&&f[kr.remoteText.getterName]().trigger(i)},addtrack:function(n){t.addTrack(n.track)},removetrack:function(n){t.removeTrack(n.track)}};e=function(){for(var f,r,u=[],n=0;n<t.length;n++){for(f=!1,r=0;r<i.length;r++)if(i[r]===t[n]){f=!0;break}f||u.push(t[n])}while(u.length)t.removeTrack(u.shift())};this[r.getterName+"Listeners_"]=u;Object.keys(u).forEach(function(n){var t=u[n];i.addEventListener(n,t);f.on("dispose",function(){return i.removeEventListener(n,t)})});this.on("loadstart",e);this.on("dispose",function(){return f.off("loadstart",e)})}},i.proxyNativeTracks_=function(){var n=this;ti.names.forEach(function(t){n.proxyNativeTracksForType_(t)})},i.createEl=function(){var n=this.options_.tag,e,h,o,s,i,t,f;for(n&&(this.options_.playerElIngest||this.movingMediaElementInDOM)||(n?(e=n.cloneNode(!0),n.parentNode&&n.parentNode.insertBefore(e,n),u.disposeMediaElement(n),n=e):(n=r.createElement("video"),h=this.options_.tag&&gi(this.options_.tag),o=v({},h),au&&this.options_.nativeControlsForTouch===!0||delete o.controls,gb(n,y(o,{id:this.options_.techId,"class":"vjs-tech"}))),n.playerId=this.options_.playerId),typeof this.options_.preload!="undefined"&&ve(n,"preload",this.options_.preload),this.options_.disablePictureInPicture!==undefined&&(n.disablePictureInPicture=this.options_.disablePictureInPicture),s=["loop","muted","playsinline","autoplay"],i=0;i<s.length;i++)t=s[i],f=this.options_[t],typeof f!="undefined"&&(f?ve(n,t,t):ss(n,t),n[t]=f);return n},i.handleLateInit_=function(n){var i,r,u,t;if(n.networkState!==0&&n.networkState!==3){if(n.readyState===0){i=!1;r=function(){i=!0};this.on("loadstart",r);u=function(){i||this.trigger("loadstart")};this.on("loadedmetadata",u);this.ready(function(){this.off("loadstart",r);this.off("loadedmetadata",u);i||this.trigger("loadstart")});return}t=["loadstart"];t.push("loadedmetadata");n.readyState>=2&&t.push("loadeddata");n.readyState>=3&&t.push("canplay");n.readyState>=4&&t.push("canplaythrough");this.ready(function(){t.forEach(function(n){this.trigger(n)},this)})}},i.setScrubbing=function(n){this.isScrubbing_=n},i.scrubbing=function(){return this.isScrubbing_},i.setCurrentTime=function(n){try{this.isScrubbing_&&this.el_.fastSeek&&os?this.el_.fastSeek(n):this.el_.currentTime=n}catch(t){h(t,"Video is not ready. (Video.js)")}},i.duration=function(){var n=this,t;if(this.el_.duration===Infinity&&fr&&ki&&this.el_.currentTime===0){t=function t(){n.el_.currentTime>0&&(n.el_.duration===Infinity&&n.trigger("durationchange"),n.off("timeupdate",t))};this.on("timeupdate",t);return NaN}return this.el_.duration||NaN},i.width=function(){return this.el_.offsetWidth},i.height=function(){return this.el_.offsetHeight},i.proxyWebkitFullscreen_=function(){var i=this,n,t;if("webkitDisplayingFullscreen"in this.el_){n=function(){this.trigger("fullscreenchange",{isFullscreen:!1})};t=function(){if("webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"){this.one("webkitendfullscreen",n);this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0})}};this.on("webkitbeginfullscreen",t);this.on("dispose",function(){i.off("webkitbeginfullscreen",t);i.off("webkitendfullscreen",n)})}},i.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var n=t.navigator&&t.navigator.userAgent||"";if(/Android/.test(n)||!/Chrome|Mac OS X 10.5/.test(n))return!0}return!1},i.enterFullScreen=function(){var n=this.el_;if(n.paused&&n.networkState<=n.HAVE_METADATA)wr(this.el_.play()),this.setTimeout(function(){n.pause();try{n.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{n.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},i.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},i.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},i.src=function(n){if(n===undefined)return this.el_.src;this.setSrc(n)},i.reset=function(){u.resetMediaElement(this.el_)},i.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},i.setControls=function(n){this.el_.controls=!!n},i.addTextTrack=function(t,i,r){return this.featuresNativeTextTracks?this.el_.addTextTrack(t,i,r):n.prototype.addTextTrack.call(this,t,i,r)},i.createRemoteTextTrack=function(t){if(!this.featuresNativeTextTracks)return n.prototype.createRemoteTextTrack.call(this,t);var i=r.createElement("track");return t.kind&&(i.kind=t.kind),t.label&&(i.label=t.label),(t.language||t.srclang)&&(i.srclang=t.language||t.srclang),t["default"]&&(i["default"]=t["default"]),t.id&&(i.id=t.id),t.src&&(i.src=t.src),i},i.addRemoteTextTrack=function(t,i){var r=n.prototype.addRemoteTextTrack.call(this,t,i);return this.featuresNativeTextTracks&&this.el().appendChild(r),r},i.removeRemoteTextTrack=function(t){if(n.prototype.removeRemoteTextTrack.call(this,t),this.featuresNativeTextTracks)for(var i=this.$$("track"),r=i.length;r--;)(t===i[r]||t===i[r].track)&&this.el().removeChild(i[r])},i.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var n={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(n.droppedVideoFrames=this.el().webkitDroppedFrameCount,n.totalVideoFrames=this.el().webkitDecodedFrameCount),t.performance&&typeof t.performance.now=="function"?n.creationTime=t.performance.now():t.performance&&t.performance.timing&&typeof t.performance.timing.navigationStart=="number"&&(n.creationTime=t.Date.now()-t.performance.timing.navigationStart),n},u}(a);oy(e,"TEST_VID",function(){if(vu()){var t=r.createElement("video"),n=r.createElement("track");return n.kind="captions",n.srclang="en",n.label="English",t.appendChild(n),t}});e.isSupported=function(){try{e.TEST_VID.volume=.5}catch(n){return!1}return!!(e.TEST_VID&&e.TEST_VID.canPlayType)};e.canPlayType=function(n){return e.TEST_VID.canPlayType(n)};e.canPlaySource=function(n){return e.canPlayType(n.type)};e.canControlVolume=function(){try{var n=e.TEST_VID.volume;return e.TEST_VID.volume=n/2+.1,n!==e.TEST_VID.volume}catch(t){return!1}};e.canMuteVolume=function(){try{var n=e.TEST_VID.muted;return e.TEST_VID.muted=!n,e.TEST_VID.muted?ve(e.TEST_VID,"muted","muted"):ss(e.TEST_VID,"muted","muted"),n!==e.TEST_VID.muted}catch(t){return!1}};e.canControlPlaybackRate=function(){if(fr&&ki&&vb<58)return!1;try{var n=e.TEST_VID.playbackRate;return e.TEST_VID.playbackRate=n/2+.1,n!==e.TEST_VID.playbackRate}catch(t){return!1}};e.canOverrideAttributes=function(){try{var n=function(){};Object.defineProperty(r.createElement("video"),"src",{get:n,set:n});Object.defineProperty(r.createElement("audio"),"src",{get:n,set:n});Object.defineProperty(r.createElement("video"),"innerHTML",{get:n,set:n});Object.defineProperty(r.createElement("audio"),"innerHTML",{get:n,set:n})}catch(t){return!1}return!0};e.supportsNativeTextTracks=function(){return os||gt&&ki};e.supportsNativeVideoTracks=function(){return!!(e.TEST_VID&&e.TEST_VID.videoTracks)};e.supportsNativeAudioTracks=function(){return!!(e.TEST_VID&&e.TEST_VID.audioTracks)};e.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"];[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(n){var t=n[0],i=n[1];oy(e.prototype,t,function(){return e[i]()},!0)});e.prototype.movingMediaElementInDOM=!gt;e.prototype.featuresFullscreenResize=!0;e.prototype.featuresProgressEvents=!0;e.prototype.featuresTimeupdateEvents=!0;e.patchCanPlayType=function(){al>=4&&!ab&&!ki&&(gh=e.TEST_VID&&e.TEST_VID.constructor.prototype.canPlayType,e.TEST_VID.constructor.prototype.canPlayType=function(n){return n&&/^application\/(?:x-|vnd\.apple\.)mpegurl/i.test(n)?"maybe":gh.call(this,n)})};e.unpatchCanPlayType=function(){var n=e.TEST_VID.constructor.prototype.canPlayType;return gh&&(e.TEST_VID.constructor.prototype.canPlayType=gh),n};e.patchCanPlayType();e.disposeMediaElement=function(n){if(n){for(n.parentNode&&n.parentNode.removeChild(n);n.hasChildNodes();)n.removeChild(n.firstChild);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}};e.resetMediaElement=function(n){if(n){for(var t=n.querySelectorAll("source"),i=t.length;i--;)n.removeChild(t[i]);n.removeAttribute("src");typeof n.load=="function"&&function(){try{n.load()}catch(t){}}()}};["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(n){e.prototype[n]=function(){return this.el_[n]||this.el_.hasAttribute(n)}});["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(n){e.prototype["set"+w(n)]=function(t){this.el_[n]=t;t?this.el_.setAttribute(n,n):this.el_.removeAttribute(n)}});["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(n){e.prototype[n]=function(){return this.el_[n]}});["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(n){e.prototype["set"+w(n)]=function(t){this.el_[n]=t}});["pause","load","play"].forEach(function(n){e.prototype[n]=function(){return this.el_[n]()}});a.withSourceHandlers(e);e.nativeSourceHandler={};e.nativeSourceHandler.canPlayType=function(n){try{return e.TEST_VID.canPlayType(n)}catch(t){return""}};e.nativeSourceHandler.canHandleSource=function(n){if(n.type)return e.nativeSourceHandler.canPlayType(n.type);if(n.src){var t=pa(n.src);return e.nativeSourceHandler.canPlayType("video/"+t)}return""};e.nativeSourceHandler.handleSource=function(n,t){t.setSrc(n.src)};e.nativeSourceHandler.dispose=function(){};e.registerSourceHandler(e.nativeSourceHandler);a.registerTech("Html5",e);var kn=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],sy={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},hy=["tiny","xsmall","small","medium","large","xlarge","huge"],nc={};hy.forEach(function(n){var t=n.charAt(0)==="x"?"x-"+n.substring(1):n;nc[n]="vjs-layout-"+t});dn={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity};b=function(n){function e(t,i,u){var f,h,o,c,l,a;if(t.id=t.id||i.id||"vjs_video_"+or(),i=y(e.getTagSettings(t),i),i.initChildren=!1,i.createEl=!1,i.evented=!1,i.reportTouchActivity=!1,!i.language)if(typeof t.closest=="function")h=t.closest("[lang]"),h&&h.getAttribute&&(i.language=h.getAttribute("lang"));else for(o=t;o&&o.nodeType===1;){if(gi(o).hasOwnProperty("lang")){i.language=o.getAttribute("lang");break}o=o.parentNode}if(f=n.call(this,null,i,u)||this,f.boundDocumentFullscreenChange_=function(n){return f.documentFullscreenChange_(n)},f.boundFullWindowOnEscKey_=function(n){return f.fullWindowOnEscKey(n)},f.isFullscreen_=!1,f.log=ob(f.id_),f.fsApi_=fs,f.isPosterFromTech_=!1,f.queuedCallbacks_=[],f.isReady_=!1,f.hasStarted_=!1,f.userActive_=!1,f.debugEnabled_=!1,!f.options_||!f.options_.techOrder||!f.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(f.tag=t,f.tagAttributes=t&&gi(t),f.language(f.options_.language),i.languages?(c={},Object.getOwnPropertyNames(i.languages).forEach(function(n){c[n.toLowerCase()]=i.languages[n]}),f.languages_=c):f.languages_=e.prototype.options_.languages,f.resetCache_(),f.poster_=i.poster||"",f.controls_=!!i.controls,t.controls=!1,t.removeAttribute("controls"),f.changingSrc_=!1,f.playCallbacks_=[],f.playTerminatedQueue_=[],t.hasAttribute("autoplay")?f.autoplay(!0):f.autoplay(f.options_.autoplay),i.plugins&&Object.keys(i.plugins).forEach(function(n){if(typeof f[n]!="function")throw new Error('plugin "'+n+'" does not exist');}),f.scrubbing_=!1,f.el_=f.createEl(),ea(s(f),{eventBusKey:"el_"}),f.fsApi_.requestFullscreen){ni(r,f.fsApi_.fullscreenchange,f.boundDocumentFullscreenChange_);f.on(f.fsApi_.fullscreenchange,f.boundDocumentFullscreenChange_)}if(f.fluid_)f.on(["playerreset","resize"],f.updateStyleEl_);l=v(f.options_);i.plugins&&Object.keys(i.plugins).forEach(function(n){f[n](i.plugins[n])});i.debug&&f.debug(!0);f.options_.playerOptions=l;f.middleware_=[];f.initChildren();f.isAudio(t.nodeName.toLowerCase()==="audio");f.controls()?f.addClass("vjs-controls-enabled"):f.addClass("vjs-controls-disabled");f.el_.setAttribute("role","region");f.isAudio()?f.el_.setAttribute("aria-label",f.localize("Audio Player")):f.el_.setAttribute("aria-label",f.localize("Video Player"));f.isAudio()&&f.addClass("vjs-audio");f.flexNotSupported_()&&f.addClass("vjs-no-flex");au&&f.addClass("vjs-touch-enabled");gt||f.addClass("vjs-workinghover");e.players[f.id_]=s(f);a=nb.split(".")[0];f.addClass("vjs-v"+a);f.userActive(!0);f.reportUserActivity();f.one("play",f.listenForUserActivity_);f.on("stageclick",f.handleStageClick_);f.on("keydown",f.handleKeyDown);f.on("languagechange",f.handleLanguagechange);return f.breakpoints(f.options_.breakpoints),f.responsive(f.options_.responsive),f}f(e,n);var u=e.prototype;return u.dispose=function(){var t=this;this.trigger("dispose");this.off("dispose");ft(r,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_);ft(r,"keydown",this.boundFullWindowOnEscKey_);this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null);e.players[this.id_]=null;this.tag&&this.tag.player&&(this.tag.player=null);this.el_&&this.el_.player&&(this.el_.player=null);this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_="");this.playerElIngest_&&(this.playerElIngest_=null);this.tag&&(this.tag=null);hct(this);et.names.forEach(function(n){var r=et[n],i=t[r.getterName]();i&&i.off&&i.off()});n.prototype.dispose.call(this)},u.createEl=function(){var i=this.tag,u,s=this.playerElIngest_=i.parentNode&&i.parentNode.hasAttribute&&i.parentNode.hasAttribute("data-vjs-player"),e=this.tag.tagName.toLowerCase()==="video-js",f,h,c,l,o,a;if(s?u=this.el_=i.parentNode:e||(u=this.el_=n.prototype.createEl.call(this,"div")),f=gi(i),e){for(u=this.el_=i,i=this.tag=r.createElement("video");u.children.length;)i.appendChild(u.firstChild);lr(u,"video-js")||di(u,"video-js");u.appendChild(i);s=this.playerElIngest_=u;Object.keys(u).forEach(function(n){try{i[n]=u[n]}catch(t){}})}for(i.setAttribute("tabindex","-1"),f.tabindex="-1",(le||ki&&yb)&&(i.setAttribute("role","application"),f.role="application"),i.removeAttribute("width"),i.removeAttribute("height"),("width"in f)&&delete f.width,("height"in f)&&delete f.height,Object.getOwnPropertyNames(f).forEach(function(n){e&&n==="class"||u.setAttribute(n,f[n]);e&&i.setAttribute(n,f[n])}),i.playerId=i.id,i.id+="_html5_api",i.className="vjs-tech",i.player=u.player=this,this.addClass("vjs-paused"),t.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&(this.styleEl_=hk("vjs-styles-dimensions"),h=er(".vjs-styles-defaults"),c=er("head"),c.insertBefore(this.styleEl_,h?h.nextSibling:c.firstChild)),this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin),l=i.getElementsByTagName("a"),o=0;o<l.length;o++)a=l.item(o),di(a,"vjs-hidden"),a.setAttribute("hidden","hidden");return i.initNetworkState_=i.networkState,i.parentNode&&!s&&i.parentNode.insertBefore(u,i),wl(i,u),this.children_.unshift(i),this.el_.setAttribute("lang",this.language_),this.el_=u,u},u.crossOrigin=function(n){if(!n)return this.techGet_("crossOrigin");if(n!=="anonymous"&&n!=="use-credentials"){h.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+n+'"');return}this.techCall_("setCrossOrigin",n);return},u.width=function(n){return this.dimension("width",n)},u.height=function(n){return this.dimension("height",n)},u.dimension=function(n,t){var i=n+"_",r;if(t===undefined)return this[i]||0;if(t===""||t==="auto"){this[i]=undefined;this.updateStyleEl_();return}if(r=parseFloat(t),isNaN(r)){h.error('Improper value "'+t+'" supplied for for '+n);return}this[i]=r;this.updateStyleEl_()},u.fluid=function(n){var t=this;if(n===undefined)return!!this.fluid_;this.fluid_=!!n;tr(this)&&this.off(["playerreset","resize"],this.updateStyleEl_);n?(this.addClass("vjs-fluid"),this.fill(!1),wot(this,function(){t.on(["playerreset","resize"],t.updateStyleEl_)})):this.removeClass("vjs-fluid");this.updateStyleEl_()},u.fill=function(n){if(n===undefined)return!!this.fill_;this.fill_=!!n;n?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},u.aspectRatio=function(n){if(n===undefined)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(n))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=n;this.fluid(!0);this.updateStyleEl_()},u.updateStyleEl_=function(){var u,s,h,n,f,i;if(t.VIDEOJS_NO_DYNAMIC_STYLE===!0){var e=typeof this.width_=="number"?this.width_:this.options_.width,o=typeof this.height_=="number"?this.height_:this.options_.height,r=this.tech_&&this.tech_.el();r&&(e>=0&&(r.width=e),o>=0&&(r.height=o));return}h=this.aspectRatio_!==undefined&&this.aspectRatio_!=="auto"?this.aspectRatio_:this.videoWidth()>0?this.videoWidth()+":"+this.videoHeight():"16:9";f=h.split(":");i=f[1]/f[0];u=this.width_!==undefined?this.width_:this.height_!==undefined?this.height_/i:this.videoWidth()||300;s=this.height_!==undefined?this.height_:u*i;n=/^[^a-zA-Z]/.test(this.id())?"dimensions-"+this.id():this.id()+"-dimensions";this.addClass(n);ck(this.styleEl_,"\n      ."+n+" {\n        width: "+u+"px;\n        height: "+s+"px;\n      }\n\n      ."+n+".vjs-fluid {\n        padding-top: "+i*100+"%;\n      }\n    ")},u.loadTech_=function(n,t){var i=this,u,f,o,r,e;if(this.tech_&&this.unloadTech_(),u=w(n),f=n.charAt(0).toLowerCase()+n.slice(1),u!=="Html5"&&this.tag&&(a.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=u,this.isReady_=!1,o=typeof this.autoplay()=="string"?!1:this.autoplay(),r={source:t,autoplay:o,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+f+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise},et.names.forEach(function(n){var t=et[n];r[t.getterName]=i[t.privateName]}),y(r,this.options_[u]),y(r,this.options_[f]),y(r,this.options_[n.toLowerCase()]),this.tag&&(r.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(r.startTime=this.cache_.currentTime),e=a.getTech(n),!e)throw new Error("No Tech named '"+u+"' exists! '"+u+"' should be registered using videojs.registerTech()'");this.tech_=new e(r);this.tech_.ready(c(this,this.handleTechReady_),!0);id.jsonToTextTracks(this.textTracksJson_||[],this.tech_);kn.forEach(function(n){i.on(i.tech_,n,i["handleTech"+w(n)+"_"])});Object.keys(sy).forEach(function(n){i.on(i.tech_,n,function(t){if(i.tech_.playbackRate()===0&&i.tech_.seeking()){i.queuedCallbacks_.push({callback:i["handleTech"+sy[n]+"_"].bind(i),event:t});return}i["handleTech"+sy[n]+"_"](t)})});this.on(this.tech_,"loadstart",this.handleTechLoadStart_);this.on(this.tech_,"sourceset",this.handleTechSourceset_);this.on(this.tech_,"waiting",this.handleTechWaiting_);this.on(this.tech_,"ended",this.handleTechEnded_);this.on(this.tech_,"seeking",this.handleTechSeeking_);this.on(this.tech_,"play",this.handleTechPlay_);this.on(this.tech_,"firstplay",this.handleTechFirstPlay_);this.on(this.tech_,"pause",this.handleTechPause_);this.on(this.tech_,"durationchange",this.handleTechDurationChange_);this.on(this.tech_,"fullscreenchange",this.handleTechFullscreenChange_);this.on(this.tech_,"fullscreenerror",this.handleTechFullscreenError_);this.on(this.tech_,"enterpictureinpicture",this.handleTechEnterPictureInPicture_);this.on(this.tech_,"leavepictureinpicture",this.handleTechLeavePictureInPicture_);this.on(this.tech_,"error",this.handleTechError_);this.on(this.tech_,"loadedmetadata",this.updateStyleEl_);this.on(this.tech_,"posterchange",this.handleTechPosterChange_);this.on(this.tech_,"textdata",this.handleTechTextData_);this.on(this.tech_,"ratechange",this.handleTechRateChange_);this.usingNativeControls(this.techGet_("controls"));this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_();this.tech_.el().parentNode===this.el()||u==="Html5"&&this.tag||wl(this.tech_.el(),this.el());this.tag&&(this.tag.player=null,this.tag=null)},u.unloadTech_=function(){var n=this;et.names.forEach(function(t){var i=et[t];n[i.privateName]=n[i.getterName]()});this.textTracksJson_=id.textTracksToJson(this.tech_);this.isReady_=!1;this.tech_.dispose();this.tech_=!1;this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange"));this.isPosterFromTech_=!1},u.tech=function(n){return n===undefined&&h.warn("Using the tech directly can be dangerous. I hope you know what you're doing.\nSee https://github.com/videojs/video.js/issues/2617 for more info.\n"),this.tech_},u.addTechControlsListeners_=function(){this.removeTechControlsListeners_();this.on(this.tech_,"mouseup",this.handleTechClick_);this.on(this.tech_,"dblclick",this.handleTechDoubleClick_);this.on(this.tech_,"touchstart",this.handleTechTouchStart_);this.on(this.tech_,"touchmove",this.handleTechTouchMove_);this.on(this.tech_,"touchend",this.handleTechTouchEnd_);this.on(this.tech_,"tap",this.handleTechTap_)},u.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.handleTechTap_);this.off(this.tech_,"touchstart",this.handleTechTouchStart_);this.off(this.tech_,"touchmove",this.handleTechTouchMove_);this.off(this.tech_,"touchend",this.handleTechTouchEnd_);this.off(this.tech_,"mouseup",this.handleTechClick_);this.off(this.tech_,"dblclick",this.handleTechDoubleClick_)},u.handleTechReady_=function(){this.triggerReady();this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume);this.handleTechPosterChange_();this.handleTechDurationChange_()},u.handleTechLoadStart_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-seeking");this.error(null);this.handleTechDurationChange_();this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay"));this.manualAutoplay_(this.autoplay())},u.manualAutoplay_=function(n){var t=this,r,i;if(this.tech_&&typeof n=="string")return(r=function(){var r=t.muted(),n,i;if(t.muted(!0),n=function(){t.muted(r)},t.playTerminatedQueue_.push(n),i=t.play(),we(i))return i["catch"](n)},n==="any"&&this.muted()!==!0?(i=this.play(),we(i)&&(i=i["catch"](r))):i=n==="muted"&&this.muted()!==!0?r():this.play(),!we(i))?void 0:i.then(function(){t.trigger({type:"autoplay-success",autoplay:n})})["catch"](function(){t.trigger({type:"autoplay-failure",autoplay:n})})},u.updateSourceCaches_=function(n){var t,i,u,r;n===void 0&&(n="");t=n;i="";typeof t!="string"&&(t=n.src,i=n.type);this.cache_.source=this.cache_.source||{};this.cache_.sources=this.cache_.sources||[];t&&!i&&(i=act(this,t));this.cache_.source=v({},n,{src:t,type:i});var f=this.cache_.sources.filter(function(n){return n.src&&n.src===t}),e=[],o=this.$$("source"),s=[];for(u=0;u<o.length;u++)r=gi(o[u]),e.push(r),r.src&&r.src===t&&s.push(r.src);s.length&&!f.length?this.cache_.sources=e:f.length||(this.cache_.sources=[this.cache_.source]);this.cache_.src=t},u.handleTechSourceset_=function(n){var t=this;if(!this.changingSrc_){var u=function(n){return t.updateSourceCaches_(n)},i=this.currentSource().src,r=n.src;i&&!/^blob:/.test(i)&&/^blob:/.test(r)&&(this.lastSource_&&(this.lastSource_.tech===r||this.lastSource_.player===i)||(u=function(){}));u(r);n.src||this.tech_.any(["sourceset","loadstart"],function(n){if(n.type!=="sourceset"){var i=t.techGet("currentSrc");t.lastSource_.tech=i;t.updateSourceCaches_(i)}})}this.lastSource_={player:this.currentSource().src,tech:n.src};this.trigger({src:n.src,type:"sourceset"})},u.hasStarted=function(n){if(n===undefined)return this.hasStarted_;n!==this.hasStarted_&&(this.hasStarted_=n,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},u.handleTechPlay_=function(){this.removeClass("vjs-ended");this.removeClass("vjs-paused");this.addClass("vjs-playing");this.hasStarted(!0);this.trigger("play")},u.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(n){return n.callback(n.event)}),this.queuedCallbacks_=[]);this.cache_.lastPlaybackRate=this.tech_.playbackRate();this.trigger("ratechange")},u.handleTechWaiting_=function(){var n=this,i,t;this.addClass("vjs-waiting");this.trigger("waiting");i=this.currentTime();t=function t(){i!==n.currentTime()&&(n.removeClass("vjs-waiting"),n.off("timeupdate",t))};this.on("timeupdate",t)},u.handleTechCanPlay_=function(){this.removeClass("vjs-waiting");this.trigger("canplay")},u.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting");this.trigger("canplaythrough")},u.handleTechPlaying_=function(){this.removeClass("vjs-waiting");this.trigger("playing")},u.handleTechSeeking_=function(){this.addClass("vjs-seeking");this.trigger("seeking")},u.handleTechSeeked_=function(){this.removeClass("vjs-seeking");this.removeClass("vjs-ended");this.trigger("seeked")},u.handleTechFirstPlay_=function(){this.options_.starttime&&(h.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime));this.addClass("vjs-has-started");this.trigger("firstplay")},u.handleTechPause_=function(){this.removeClass("vjs-playing");this.addClass("vjs-paused");this.trigger("pause")},u.handleTechEnded_=function(){this.addClass("vjs-ended");this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause();this.trigger("ended")},u.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},u.handleTechClick_=function(n){wu(n)&&this.controls_&&(this.paused()?wr(this.play()):this.pause())},u.handleTechDoubleClick_=function(n){if(this.controls_){var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(t){return t.contains(n.target)});t||(this.options_===undefined||this.options_.userActions===undefined||this.options_.userActions.doubleClick===undefined||this.options_.userActions.doubleClick!==!1)&&(this.options_!==undefined&&this.options_.userActions!==undefined&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,n):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},u.handleTechTap_=function(){this.userActive(!this.userActive())},u.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},u.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},u.handleTechTouchEnd_=function(n){n.cancelable&&n.preventDefault()},u.handleStageClick_=function(){this.reportUserActivity()},u.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},u.documentFullscreenChange_=function(n){var u=n.target.player,t,i;u&&u!==this||(t=this.el(),i=r[this.fsApi_.fullscreenElement]===t,!i&&t.matches?i=t.matches(":"+this.fsApi_.fullscreen):!i&&t.msMatchesSelector&&(i=t.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(i))},u.handleTechFullscreenChange_=function(n,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},u.handleTechFullscreenError_=function(n,t){this.trigger("fullscreenerror",t)},u.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},u.handleTechEnterPictureInPicture_=function(){this.isInPictureInPicture(!0)},u.handleTechLeavePictureInPicture_=function(){this.isInPictureInPicture(!1)},u.handleTechError_=function(){var n=this.tech_.error();this.error(n)},u.handleTechTextData_=function(){var n=null;arguments.length>1&&(n=arguments[1]);this.trigger("textdata",n)},u.getCache=function(){return this.cache_},u.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],volume:1}},u.techCall_=function(n,t){this.ready(function(){if(n in oct)return fct(this.middleware_,this.tech_,n,t);if(n in rg)return ig(this.middleware_,this.tech_,n,t);try{this.tech_&&this.tech_[n](t)}catch(i){h(i);throw i;}},!0)},u.techGet_=function(n){if(this.tech_&&this.tech_.isReady_){if(n in ect)return uct(this.middleware_,this.tech_,n);if(n in rg)return ig(this.middleware_,this.tech_,n);try{return this.tech_[n]()}catch(t){if(this.tech_[n]===undefined){h("Video.js: "+n+" method not defined for "+this.techName_+" playback technology.",t);throw t;}if(t.name==="TypeError"){h("Video.js: "+n+" unavailable on "+this.techName_+" playback technology element.",t);this.tech_.isReady_=!1;throw t;}h(t);throw t;}}},u.play=function(){var i=this,n=this.options_.Promise||t.Promise;return n?new n(function(n){i.play_(n)}):this.play_()},u.play_=function(n){var r=this,t,i;if(n===void 0&&(n=wr),this.playCallbacks_.push(n),t=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc())),this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!t){this.waitToPlay_=function(){r.play_()};this.one(["ready","loadstart"],this.waitToPlay_);!t&&(os||gt)&&this.load();return}i=this.techGet_("play");i===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(i)},u.runPlayTerminatedQueue_=function(){var n=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[];n.forEach(function(n){n()})},u.runPlayCallbacks_=function(n){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[];this.playTerminatedQueue_=[];t.forEach(function(t){t(n)})},u.pause=function(){this.techCall_("pause")},u.paused=function(){return this.techGet_("paused")===!1?!1:!0},u.played=function(){return this.techGet_("played")||yr(0,0)},u.scrubbing=function(n){if(typeof n=="undefined")return this.scrubbing_;this.scrubbing_=!!n;this.techCall_("setScrubbing",this.scrubbing_);n?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},u.currentTime=function(n){if(typeof n!="undefined"){if(n<0&&(n=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=n;this.off("canplay",this.applyInitTime_);this.one("canplay",this.applyInitTime_);return}this.techCall_("setCurrentTime",n);this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},u.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},u.duration=function(n){if(n===undefined)return this.cache_.duration!==undefined?this.cache_.duration:NaN;n=parseFloat(n);n<0&&(n=Infinity);n!==this.cache_.duration&&(this.cache_.duration=n,n===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(n)||this.trigger("durationchange"))},u.remainingTime=function(){return this.duration()-this.currentTime()},u.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},u.buffered=function(){var n=this.techGet_("buffered");return n&&n.length||(n=yr(0,0)),n},u.bufferedPercent=function(){return nd(this.buffered(),this.duration())},u.bufferedEnd=function(){var t=this.buffered(),i=this.duration(),n=t.end(t.length-1);return n>i&&(n=i),n},u.volume=function(n){var t;if(n!==undefined){t=Math.max(0,Math.min(1,parseFloat(n)));this.cache_.volume=t;this.techCall_("setVolume",t);t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t},u.muted=function(n){if(n!==undefined){this.techCall_("setMuted",n);return}return this.techGet_("muted")||!1},u.defaultMuted=function(n){return n!==undefined?this.techCall_("setDefaultMuted",n):this.techGet_("defaultMuted")||!1},u.lastVolume_=function(n){if(n!==undefined&&n!==0){this.cache_.lastVolume=n;return}return this.cache_.lastVolume},u.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},u.isFullscreen=function(n){if(n!==undefined){var t=this.isFullscreen_;this.isFullscreen_=Boolean(n);this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange");this.toggleFullscreenClass_();return}return this.isFullscreen_},u.requestFullscreen=function(n){var r=this.options_.Promise||t.Promise,i;return r?(i=this,new r(function(t,r){function u(){i.off("fullscreenerror",o);i.off("fullscreenchange",e)}function e(){u();t()}function o(n,t){u();r(t)}i.one("fullscreenchange",e);i.one("fullscreenerror",o);var f=i.requestFullscreenHelper_(n);if(f)return f.then(u,u),f})):this.requestFullscreenHelper_()},u.requestFullscreenHelper_=function(n){var r=this,i,t;if(this.fsApi_.prefixed||(i=this.options_.fullscreen&&this.options_.fullscreen.options||{},n!==undefined&&(i=n)),this.fsApi_.requestFullscreen)return t=this.el_[this.fsApi_.requestFullscreen](i),t&&t.then(function(){return r.isFullscreen(!0)},function(){return r.isFullscreen(!1)}),t;this.tech_.supportsFullScreen()?this.techCall_("enterFullScreen"):this.enterFullWindow()},u.exitFullscreen=function(){var i=this.options_.Promise||t.Promise,n;return i?(n=this,new i(function(t,i){function r(){n.off("fullscreenerror",e);n.off("fullscreenchange",f)}function f(){r();t()}function e(n,t){r();i(t)}n.one("fullscreenchange",f);n.one("fullscreenerror",e);var u=n.exitFullscreenHelper_();if(u)return u.then(r,r),u})):this.exitFullscreenHelper_()},u.exitFullscreenHelper_=function(){var t=this,n;if(this.fsApi_.requestFullscreen)return n=r[this.fsApi_.exitFullscreen](),n&&n.then(function(){return t.isFullscreen(!1)}),n;this.tech_.supportsFullScreen()?this.techCall_("exitFullScreen"):this.exitFullWindow()},u.enterFullWindow=function(){this.isFullscreen(!0);this.isFullWindow=!0;this.docOrigOverflow=r.documentElement.style.overflow;ni(r,"keydown",this.boundFullWindowOnEscKey_);r.documentElement.style.overflow="hidden";di(r.body,"vjs-full-window");this.trigger("enterFullWindow")},u.fullWindowOnEscKey=function(n){o.isEventKey(n,"Esc")&&(this.isFullscreen()===!0?this.exitFullscreen():this.exitFullWindow())},u.exitFullWindow=function(){this.isFullscreen(!1);this.isFullWindow=!1;ft(r,"keydown",this.boundFullWindowOnEscKey_);r.documentElement.style.overflow=this.docOrigOverflow;ae(r.body,"vjs-full-window");this.trigger("exitFullWindow")},u.disablePictureInPicture=function(n){if(n===undefined)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",n);this.options_.disablePictureInPicture=n;this.trigger("disablepictureinpicturechanged")},u.isInPictureInPicture=function(n){if(n!==undefined){this.isInPictureInPicture_=!!n;this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},u.requestPictureInPicture=function(){if("pictureInPictureEnabled"in r&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")},u.exitPictureInPicture=function(){if("pictureInPictureEnabled"in r)return r.exitPictureInPicture()},u.handleKeyDown=function(n){var t=this.options_.userActions,i;t&&t.hotkeys&&((i=function(n){var t=n.tagName.toLowerCase(),i,r;return n.isContentEditable?!0:(i=["button","checkbox","hidden","radio","reset","submit"],t==="input")?i.indexOf(n.type)===-1:(r=["textarea"],r.indexOf(t)!==-1)},i(this.el_.ownerDocument.activeElement))||(typeof t.hotkeys=="function"?t.hotkeys.call(this,n):this.handleHotkeys(n)))},u.handleHotkeys=function(n){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},u=t.fullscreenKey,l=u===void 0?function(n){return o.isEventKey(n,"f")}:u,f=t.muteKey,a=f===void 0?function(n){return o.isEventKey(n,"m")}:f,e=t.playPauseKey,v=e===void 0?function(n){return o.isEventKey(n,"k")||o.isEventKey(n,"Space")}:e,s,h,c;l.call(this,n)?(n.preventDefault(),n.stopPropagation(),s=i.getComponent("FullscreenToggle"),r[this.fsApi_.fullscreenEnabled]!==!1&&s.prototype.handleClick.call(this,n)):a.call(this,n)?(n.preventDefault(),n.stopPropagation(),h=i.getComponent("MuteToggle"),h.prototype.handleClick.call(this,n)):v.call(this,n)&&(n.preventDefault(),n.stopPropagation(),c=i.getComponent("PlayToggle"),c.prototype.handleClick.call(this,n))},u.canPlayType=function(n){for(var r,t,u,f=0,e=this.options_.techOrder;f<e.length;f++){if(r=e[f],t=a.getTech(r),t||(t=i.getComponent(r)),!t){h.error('The "'+r+'" tech is undefined. Skipped browser support check for that tech.');continue}if(t.isSupported()&&(u=t.canPlayType(n),u))return u}return""},u.selectSource=function(n){var f=this,t=this.options_.techOrder.map(function(n){return[n,a.getTech(n)]}).filter(function(n){var i=n[0],t=n[1];return t?t.isSupported():(h.error('The "'+i+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),i=function(n,t,i){var r;return n.some(function(n){return t.some(function(t){return r=i(n,t),r?!0:void 0})}),r},r,e=function(n){return function(t,i){return n(i,t)}},u=function(n,t){var i=n[0],r=n[1];if(r.canPlaySource(t,f.options_[i.toLowerCase()]))return{source:t,tech:i}};return r=this.options_.sourceOrder?i(n,t,e(u)):i(t,n,u),r||!1},u.src=function(n){var t=this,i;if(typeof n=="undefined")return this.cache_.src||"";if(i=ug(n),!i.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}this.changingSrc_=!0;this.cache_.sources=i;this.updateSourceCaches_(i[0]);ict(this,i[0],function(n,r){t.middleware_=r;t.cache_.sources=i;t.updateSourceCaches_(n);var u=t.src_(n);if(u){if(i.length>1)return t.src(i.slice(1));t.changingSrc_=!1;t.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);t.triggerReady();return}rct(r,t.tech_)})},u.src_=function(n){var i=this,t=this.selectSource([n]);return t?kot(t.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",n):this.techCall_("src",n.src);this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(t.tech,t.source),this.tech_.ready(function(){i.changingSrc_=!1}),!1):!0},u.load=function(){this.techCall_("load")},u.reset=function(){var i=this,r=this.options_.Promise||t.Promise,n;this.paused()||!r?this.doReset_():(n=this.play(),wr(n.then(function(){return i.doReset_()})))},u.doReset_=function(){this.tech_&&this.tech_.clearTracks("text");this.resetCache_();this.poster("");this.loadTech_(this.options_.techOrder[0],null);this.techCall_("reset");this.resetControlBarUI_();tr(this)&&this.trigger("playerreset")},u.resetControlBarUI_=function(){this.resetProgressBar_();this.resetPlaybackRate_();this.resetVolumeBar_()},u.resetProgressBar_=function(){this.currentTime(0);var n=this.controlBar,t=n.durationDisplay,i=n.remainingTimeDisplay;t&&t.updateContent();i&&i.updateContent()},u.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate());this.handleTechRateChange_()},u.resetVolumeBar_=function(){this.volume(1);this.trigger("volumechange")},u.currentSources=function(){var n=this.currentSource(),t=[];return Object.keys(n).length!==0&&t.push(n),this.cache_.sources||t},u.currentSource=function(){return this.cache_.source||{}},u.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},u.currentType=function(){return this.currentSource()&&this.currentSource().type||""},u.preload=function(n){if(n!==undefined){this.techCall_("setPreload",n);this.options_.preload=n;return}return this.techGet_("preload")},u.autoplay=function(n){if(n===undefined)return this.options_.autoplay||!1;var t;typeof n=="string"&&/(any|play|muted)/.test(n)?(this.options_.autoplay=n,this.manualAutoplay_(n),t=!1):this.options_.autoplay=n?!0:!1;t=typeof t=="undefined"?this.options_.autoplay:t;this.tech_&&this.techCall_("setAutoplay",t)},u.playsinline=function(n){return n!==undefined?(this.techCall_("setPlaysinline",n),this.options_.playsinline=n,this):this.techGet_("playsinline")},u.loop=function(n){if(n!==undefined){this.techCall_("setLoop",n);this.options_.loop=n;return}return this.techGet_("loop")},u.poster=function(n){if(n===undefined)return this.poster_;(n||(n=""),n!==this.poster_)&&(this.poster_=n,this.techCall_("setPoster",n),this.isPosterFromTech_=!1,this.trigger("posterchange"))},u.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var n=this.tech_.poster()||"";n!==this.poster_&&(this.poster_=n,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},u.controls=function(n){if(n===undefined)return!!this.controls_;(n=!!n,this.controls_!==n)&&(this.controls_=n,this.usingNativeControls()&&this.techCall_("setControls",n),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},u.usingNativeControls=function(n){if(n===undefined)return!!this.usingNativeControls_;(n=!!n,this.usingNativeControls_!==n)&&(this.usingNativeControls_=n,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},u.error=function(n){if(n===undefined)return this.error_||null;if(this.options_.suppressNotSupportedError&&n&&n.code===4){var t=function(){this.error(n)};this.options_.suppressNotSupportedError=!1;this.any(["click","touchstart"],t);this.one("loadstart",function(){this.off(["click","touchstart"],t)});return}if(n===null){this.error_=n;this.removeClass("vjs-error");this.errorDisplay&&this.errorDisplay.close();return}this.error_=new ht(n);this.addClass("vjs-error");h.error("(CODE:"+this.error_.code+" "+ht.errorTypes[this.error_.code]+")",this.error_.message,this.error_);this.trigger("error");return},u.reportUserActivity=function(){this.userActivity_=!0},u.userActive=function(n){if(n===undefined)return this.userActive_;if(n=!!n,n!==this.userActive_){if(this.userActive_=n,this.userActive_){this.userActivity_=!0;this.removeClass("vjs-user-inactive");this.addClass("vjs-user-active");this.trigger("useractive");return}if(this.tech_)this.tech_.one("mousemove",function(n){n.stopPropagation();n.preventDefault()});this.userActivity_=!1;this.removeClass("vjs-user-active");this.addClass("vjs-user-inactive");this.trigger("userinactive")}},u.listenForUserActivity_=function(){var i,r,u,n=c(this,this.reportUserActivity),o=function(t){(t.screenX!==r||t.screenY!==u)&&(r=t.screenX,u=t.screenY,n())},s=function(){n();this.clearInterval(i);i=this.setInterval(n,250)},f=function(){n();this.clearInterval(i)},t,e;this.on("mousedown",s);this.on("mousemove",o);this.on("mouseup",f);this.on("mouseleave",f);if(t=this.getChild("controlBar"),t&&!gt&&!fr){t.on("mouseenter",function(){this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout;this.player().options_.inactivityTimeout=0});t.on("mouseleave",function(){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})}this.on("keydown",n);this.on("keyup",n);this.setInterval(function(){if(this.userActivity_){this.userActivity_=!1;this.userActive(!0);this.clearTimeout(e);var n=this.options_.inactivityTimeout;n<=0||(e=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},n))}},250)},u.playbackRate=function(n){if(n!==undefined){this.techCall_("setPlaybackRate",n);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},u.defaultPlaybackRate=function(n){return n!==undefined?this.techCall_("setDefaultPlaybackRate",n):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},u.isAudio=function(n){if(n!==undefined){this.isAudio_=!!n;return}return!!this.isAudio_},u.addTextTrack=function(n,t,i){if(this.tech_)return this.tech_.addTextTrack(n,t,i)},u.addRemoteTextTrack=function(n,t){if(this.tech_)return this.tech_.addRemoteTextTrack(n,t)},u.removeRemoteTextTrack=function(n){n===void 0&&(n={});var i=n,t=i.track;return t||(t=n),this.tech_?this.tech_.removeRemoteTextTrack(t):void 0},u.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},u.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},u.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},u.language=function(n){if(n===undefined)return this.language_;this.language_!==String(n).toLowerCase()&&(this.language_=String(n).toLowerCase(),tr(this)&&this.trigger("languagechange"))},u.languages=function(){return v(e.prototype.options_.languages,this.languages_)},u.toJSON=function(){var i=v(this.options_),r=i.tracks,n,t;for(i.tracks=[],n=0;n<r.length;n++)t=r[n],t=v(t),t.player=undefined,i.tracks[n]=t;return i},u.createModal=function(n,t){var r=this,i;t=t||{};t.content=n||"";i=new ku(this,t);this.addChild(i);i.on("dispose",function(){r.removeChild(i)});return i.open(),i},u.updateCurrentBreakpoint_=function(){var t,r,i,n,u;if(this.responsive())for(t=this.currentBreakpoint(),r=this.currentWidth(),i=0;i<hy.length;i++)if(n=hy[i],u=this.breakpoints_[n],r<=u){if(t===n)return;t&&this.removeClass(nc[t]);this.addClass(nc[n]);this.breakpoint_=n;break}},u.removeCurrentBreakpoint_=function(){var n=this.currentBreakpointClass();this.breakpoint_="";n&&this.removeClass(n)},u.breakpoints=function(n){return n===undefined?y(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=y({},dn,n),this.updateCurrentBreakpoint_(),y(this.breakpoints_))},u.responsive=function(n){if(n===undefined)return this.responsive_;n=Boolean(n);var t=this.responsive_;if(n!==t){if(this.responsive_=n,n){this.on("playerresize",this.updateCurrentBreakpoint_);this.updateCurrentBreakpoint_()}else this.off("playerresize",this.updateCurrentBreakpoint_),this.removeCurrentBreakpoint_();return n}},u.currentBreakpoint=function(){return this.breakpoint_},u.currentBreakpointClass=function(){return nc[this.breakpoint_]||""},u.loadMedia=function(n,t){var e=this;if(n&&typeof n=="object"){this.reset();this.cache_.media=v(n);var r=this.cache_.media,o=r.artwork,i=r.poster,u=r.src,f=r.textTracks;!o&&i&&(this.cache_.media.artwork=[{src:i,type:gs(i)}]);u&&this.src(u);i&&this.poster(i);Array.isArray(f)&&f.forEach(function(n){return e.addRemoteTextTrack(n,!1)});this.ready(t)}},u.getMedia=function(){if(!this.cache_.media){var t=this.poster(),i=this.currentSources(),r=Array.prototype.map.call(this.remoteTextTracks(),function(n){return{kind:n.kind,label:n.label,language:n.language,src:n.src}}),n={src:i,textTracks:r};return t&&(n.poster=t,n.artwork=[{src:n.poster,type:gs(n.poster)}]),n}return v(this.cache_.media)},e.getTagSettings=function(n){var i={sources:[],tracks:[]},t=gi(n),o=t["data-setup"],f,r,l,u,e;if(lr(n,"vjs-fill")&&(t.fill=!0),lr(n,"vjs-fluid")&&(t.fluid=!0),o!==null){var s=td(o||"{}"),c=s[0],a=s[1];c&&h.error(c);y(t,a)}if(y(i,t),n.hasChildNodes())for(f=n.childNodes,r=0,l=f.length;r<l;r++)u=f[r],e=u.nodeName.toLowerCase(),e==="source"?i.sources.push(gi(u)):e==="track"&&i.tracks.push(gi(u));return i},u.flexNotSupported_=function(){var n=r.createElement("i");return!("flexBasis"in n.style||"webkitFlexBasis"in n.style||"mozFlexBasis"in n.style||"msFlexBasis"in n.style||"msFlexOrder"in n.style)},u.debug=function(n){if(n===undefined)return this.debugEnabled_;n?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=undefined,this.debugEnabled_=!1)},e}(i);et.names.forEach(function(n){var t=et[n];b.prototype[t.getterName]=function(){return this.tech_?this.tech_[t.getterName]():(this[t.privateName]=this[t.privateName]||new t.ListClass,this[t.privateName])}});b.prototype.crossorigin=b.prototype.crossOrigin;b.players={};uf=t.navigator;b.prototype.options_={techOrder:a.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:uf&&(uf.languages&&uf.languages[0]||uf.userLanguage||uf.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1};["ended","seeking","seekable","networkState","readyState"].forEach(function(n){b.prototype[n]=function(){return this.techGet_(n)}});kn.forEach(function(n){b.prototype["handleTech"+w(n)+"_"]=function(){return this.trigger(n)}});i.registerComponent("Player",b);cy=dt(function(n){function t(i,r){return n.exports=t=Object.setPrototypeOf||function(n,t){return n.__proto__=t,n},t(i,r)}n.exports=t});var rlt=ilt,ult=dt(function(n){function t(){return n.exports=rlt()?t=Reflect.construct:t=function(n,t,i){var r=[null],f,u;return r.push.apply(r,t),f=Function.bind.apply(n,r),u=new f,i&&cy(u,i.prototype),u},t.apply(null,arguments)}n.exports=t}),tc="plugin",ff="activePlugins_",ef={},ic=function(n){return ef.hasOwnProperty(n)},rc=function(n){return ic(n)?ef[n]:undefined},gn=function(n,t){n[ff]=n[ff]||{};n[ff][t]=!0},uc=function(n,t,i){var r=(i?"before":"")+"pluginsetup";n.trigger(r,t);n.trigger(r+":"+t.name,t)},flt=function(n,t){var i=function(){uc(this,{name:n,plugin:t,instance:null},!0);var i=t.apply(this,arguments);return gn(this,n),uc(this,{name:n,plugin:t,instance:i}),i};return Object.keys(t).forEach(function(n){i[n]=t[n]}),i},ntt=function(n,t){return t.prototype.name=n,function(){var r;uc(this,{name:n,plugin:t,instance:null},!0);for(var u=arguments.length,f=new Array(u),i=0;i<u;i++)f[i]=arguments[i];return r=ult(t,[this].concat(f)),this[n]=function(){return r},uc(this,r.getEventHash()),r}},ai=function(){function n(t){if(this.constructor===n)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=t;this.log||(this.log=this.player.log.createLogger(this.name));ea(this);delete this.trigger;dk(this,this.constructor.defaultState);gn(t,this.name);this.dispose=c(this,this.dispose);t.on("dispose",this.dispose)}var t=n.prototype;return t.version=function(){return this.constructor.VERSION},t.getEventHash=function(n){return n===void 0&&(n={}),n.name=this.name,n.plugin=this.constructor,n.instance=this,n},t.trigger=function(n,t){return t===void 0&&(t={}),bu(this.eventBusEl_,n,this.getEventHash(t))},t.handleStateChanged=function(){},t.dispose=function(){var n=this.name,t=this.player;this.trigger("dispose");this.off();t.off("dispose",this.dispose);t[ff][n]=!1;this.player=this.state=null;t[n]=ntt(n,ef[n])},n.isBasic=function(t){var i=typeof t=="string"?rc(t):t;return typeof i=="function"&&!n.prototype.isPrototypeOf(i.prototype)},n.registerPlugin=function(t,i){if(typeof t!="string")throw new Error('Illegal plugin name, "'+t+'", must be a string, was '+typeof t+".");if(ic(t))h.warn('A plugin named "'+t+'" already exists. You may want to avoid re-registering plugins!');else if(b.prototype.hasOwnProperty(t))throw new Error('Illegal plugin name, "'+t+'", cannot share a name with an existing player method!');if(typeof i!="function")throw new Error('Illegal plugin for "'+t+'", must be a function, was '+typeof i+".");return ef[t]=i,t!==tc&&(b.prototype[t]=n.isBasic(i)?flt(t,i):ntt(t,i)),i},n.deregisterPlugin=function(n){if(n===tc)throw new Error("Cannot de-register base plugin.");ic(n)&&(delete ef[n],delete b.prototype[n])},n.getPlugins=function(n){n===void 0&&(n=Object.keys(ef));var t;return n.forEach(function(n){var i=rc(n);i&&(t=t||{},t[n]=i)}),t},n.getPluginVersion=function(n){var t=rc(n);return t&&t.VERSION||""},n}();ai.getPlugin=rc;ai.BASE_PLUGIN_NAME=tc;ai.registerPlugin(tc,ai);b.prototype.usingPlugin=function(n){return!!this[ff]&&this[ff][n]===!0};b.prototype.hasPlugin=function(n){return!!ic(n)};var olt=elt,slt=function(n,t){var i,r,u;t===void 0&&(t={});i=function(){n.apply(this,arguments)};r={};typeof t=="object"?(t.constructor!==Object.prototype.constructor&&(i=t.constructor),r=t):typeof t=="function"&&(i=t);olt(i,n);n&&(i.super_=n);for(u in r)r.hasOwnProperty(u)&&(i.prototype[u]=r[u]);return i},ttt=function(n){return n.indexOf("#")===0?n.slice(1):n};n.hooks_={};n.hooks=function(t,i){return n.hooks_[t]=n.hooks_[t]||[],i&&(n.hooks_[t]=n.hooks_[t].concat(i)),n.hooks_[t]};n.hook=function(t,i){n.hooks(t,i)};n.hookOnce=function(t,i){n.hooks(t,[].concat(i).map(function(i){var r=function r(){return n.removeHook(t,r),i.apply(void 0,arguments)};return r}))};n.removeHook=function(t,i){var r=n.hooks(t).indexOf(i);return r<=-1?!1:(n.hooks_[t]=n.hooks_[t].slice(),n.hooks_[t].splice(r,1),!0)};t.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&vu()&&(ro=er(".vjs-styles-defaults"),ro||(ro=hk("vjs-styles-defaults"),fc=er("head"),fc&&fc.insertBefore(ro,fc.firstChild),ck(ro,"\n      .video-js {\n        width: 300px;\n        height: 150px;\n      }\n\n      .vjs-fluid {\n        padding-top: 56.25%\n      }\n    ")));ta(1,n);n.VERSION=nb;n.options=b.prototype.options_;n.getPlayers=function(){return b.players};n.getPlayer=function(n){var i=b.players,t,r,u;if(typeof n=="string"){if(r=ttt(n),u=i[r],u)return u;t=er("#"+r)}else t=n;if(yu(t)){var f=t,e=f.player,o=f.playerId;if(e||i[o])return e||i[o]}};n.getAllPlayers=function(){return Object.keys(b.players).map(function(n){return b.players[n]}).filter(Boolean)};n.players=b.players;n.getComponent=i.getComponent;n.registerComponent=function(n,t){a.isTech(t)&&h.warn("The "+n+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)");i.registerComponent.call(i,n,t)};n.getTech=a.getTech;n.registerTech=a.registerTech;n.use=tct;Object.defineProperty(n,"middleware",{value:{},writeable:!1,enumerable:!0});Object.defineProperty(n.middleware,"TERMINATOR",{value:ds,writeable:!1,enumerable:!0});n.browser=cot;n.TOUCH_ENABLED=au;n.extend=slt;n.mergeOptions=v;n.bind=c;n.registerPlugin=ai.registerPlugin;n.deregisterPlugin=ai.deregisterPlugin;n.plugin=function(n,t){return h.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),ai.registerPlugin(n,t)};n.getPlugins=ai.getPlugins;n.getPlugin=ai.getPlugin;n.getPluginVersion=ai.getPluginVersion;n.addLanguage=function(t,i){var r;return t=(""+t).toLowerCase(),n.options.languages=v(n.options.languages,(r={},r[t]=i,r)),n.options.languages[t]};n.log=h;n.createLogger=ob;n.createTimeRange=n.createTimeRanges=yr;n.formatTime=nf;n.setFormatTime=yct;n.resetFormatTime=pct;n.parseUrl=ya;n.isCrossOrigin=ps;n.EventTarget=nt;n.on=ni;n.one=ls;n.off=ft;n.trigger=bu;n.xhr=wa;n.TextTrack=be;n.AudioTrack=vd;n.VideoTrack=yd;["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(t){n[t]=function(){return h.warn("videojs."+t+"() is deprecated; use videojs.dom."+t+"() instead"),ok[t].apply(null,arguments)}});n.computedStyle=he;n.dom=ok;n.url=vst;n.defineLazyProperty=oy;ri=hlt;vi=clt;ly=typeof li!="undefined"?li:typeof window!="undefined"?window:{};typeof document!="undefined"?uo=document:(uo=ly["__GLOBAL_DOCUMENT_CACHE@4"],uo||(uo=ly["__GLOBAL_DOCUMENT_CACHE@4"]=ib));si=uo;itt=typeof window!="undefined"?window:typeof li!="undefined"?li:typeof self!="undefined"?self:{};u=itt;rtt=dt(function(n){(function(){var i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#.*)?$/,r=/^([^\/?#]*)(.*)$/,u=/(?:\/|^)\.(?=\/)/g,f=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,t={buildAbsoluteURL:function(n,i,u){var s,f,e,h,o,c,l;if(u=u||{},n=n.trim(),i=i.trim(),!i){if(!u.alwaysNormalize)return n;if(s=t.parseURL(n),!s)throw new Error("Error trying to parse base URL.");return s.path=t.normalizePath(s.path),t.buildURLFromParts(s)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(e=t.parseURL(n),!e)throw new Error("Error trying to parse base URL.");return!e.netLoc&&e.path&&e.path[0]!=="/"&&(h=r.exec(e.path),e.netLoc=h[1],e.path=h[2]),e.netLoc&&!e.path&&(e.path="/"),o={scheme:e.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(o.netLoc=e.netLoc,f.path[0]!=="/"&&(f.path?(c=e.path,l=c.substring(0,c.lastIndexOf("/")+1)+f.path,o.path=t.normalizePath(l)):(o.path=e.path,f.params||(o.params=e.params,f.query||(o.query=e.query))))),o.path===null&&(o.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(o)},parseURL:function(n){var t=i.exec(n);return t?{scheme:t[1]||"",netLoc:t[2]||"",path:t[3]||"",params:t[4]||"",query:t[5]||"",fragment:t[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t})()});var ftt=utt(rtt),ett=utt(t),llt=function(n,t){return/^[a-z]+:/i.test(t)?t:(/\/\//i.test(n)||(n=ftt.buildAbsoluteURL(ett.location&&ett.location.href||"",n)),ftt.buildAbsoluteURL(n,t))},ec=llt,alt=function(){function t(){this.listeners={}}var n=t.prototype;return n.on=function(n,t){this.listeners[n]||(this.listeners[n]=[]);this.listeners[n].push(t)},n.off=function(n,t){if(!this.listeners[n])return!1;var i=this.listeners[n].indexOf(t);return this.listeners[n]=this.listeners[n].slice(0),this.listeners[n].splice(i,1),i>-1},n.trigger=function(n){var t=this.listeners[n],u,i,f,e,r;if(t)if(arguments.length===2)for(u=t.length,i=0;i<u;++i)t[i].call(this,arguments[1]);else for(f=Array.prototype.slice.call(arguments,1),e=t.length,r=0;r<e;++r)t[r].apply(this,f)},n.dispose=function(){this.listeners={}},n.pipe=function(n){this.on("data",function(t){n.push(t)})},t}(),ay=alt;vy=vlt(t);ott=function(n){return vy.atob?vy.atob(n):Buffer.from(n,"base64").toString("binary")};var stt=ylt,plt=function(n){function t(){var t;return t=n.call(this)||this,t.buffer="",t}f(t,n);var i=t.prototype;return i.push=function(n){var t;for(this.buffer+=n,t=this.buffer.indexOf("\n");t>-1;t=this.buffer.indexOf("\n"))this.trigger("data",this.buffer.substring(0,t)),this.buffer=this.buffer.substring(t+1)},t}(ay),wlt=function(){return new RegExp('(?:^|,)((?:[^=]*)=(?:"[^"]*"|[^,]*))')},fo=function(n){for(var i=n.split(wlt()),u={},r=i.length,t;r--;)i[r]!==""&&(t=/([^=]*)=(.*)/.exec(i[r]).slice(1),t[0]=t[0].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^\s+|\s+$/g,""),t[1]=t[1].replace(/^['"](.*)['"]$/g,"$1"),u[t[0]]=t[1]);return u},blt=function(n){function t(){var t;return t=n.call(this)||this,t.customParsers=[],t.tagMappers=[],t}f(t,n);var i=t.prototype;return i.push=function(n){var r=this,i,t,u;if(n=n.trim(),n.length!==0){if(n[0]!=="#"){this.trigger("data",{type:"uri",uri:n});return}u=this.tagMappers.reduce(function(t,i){var r=i(n);return r===n?t:t.concat([r])},[n]);u.forEach(function(n){for(var u,f,o,e=0;e<r.customParsers.length;e++)if(r.customParsers[e].call(r,n))return;if(n.indexOf("#EXT")!==0){r.trigger("data",{type:"comment",text:n.slice(1)});return}if(n=n.replace("\r",""),i=/^#EXTM3U/.exec(n),i){r.trigger("data",{type:"tag",tagType:"m3u"});return}if(i=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(n),i){t={type:"tag",tagType:"inf"};i[1]&&(t.duration=parseFloat(i[1]));i[2]&&(t.title=i[2]);r.trigger("data",t);return}if(i=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"targetduration"};i[1]&&(t.duration=parseInt(i[1],10));r.trigger("data",t);return}if(i=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"totalduration"};i[1]&&(t.duration=parseInt(i[1],10));r.trigger("data",t);return}if(i=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"version"};i[1]&&(t.version=parseInt(i[1],10));r.trigger("data",t);return}if(i=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"media-sequence"};i[1]&&(t.number=parseInt(i[1],10));r.trigger("data",t);return}if(i=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"discontinuity-sequence"};i[1]&&(t.number=parseInt(i[1],10));r.trigger("data",t);return}if(i=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"playlist-type"};i[1]&&(t.playlistType=i[1]);r.trigger("data",t);return}if(i=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(n),i){t={type:"tag",tagType:"byterange"};i[1]&&(t.length=parseInt(i[1],10));i[2]&&(t.offset=parseInt(i[2],10));r.trigger("data",t);return}if(i=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(n),i){t={type:"tag",tagType:"allow-cache"};i[1]&&(t.allowed=!/NO/.test(i[1]));r.trigger("data",t);return}if(i=/^#EXT-X-MAP:?(.*)$/.exec(n),i){if(t={type:"tag",tagType:"map"},i[1]&&(u=fo(i[1]),u.URI&&(t.uri=u.URI),u.BYTERANGE)){var s=u.BYTERANGE.split("@"),h=s[0],c=s[1];t.byterange={};h&&(t.byterange.length=parseInt(h,10));c&&(t.byterange.offset=parseInt(c,10))}r.trigger("data",t);return}if(i=/^#EXT-X-STREAM-INF:?(.*)$/.exec(n),i){t={type:"tag",tagType:"stream-inf"};i[1]&&(t.attributes=fo(i[1]),t.attributes.RESOLUTION&&(f=t.attributes.RESOLUTION.split("x"),o={},f[0]&&(o.width=parseInt(f[0],10)),f[1]&&(o.height=parseInt(f[1],10)),t.attributes.RESOLUTION=o),t.attributes.BANDWIDTH&&(t.attributes.BANDWIDTH=parseInt(t.attributes.BANDWIDTH,10)),t.attributes["PROGRAM-ID"]&&(t.attributes["PROGRAM-ID"]=parseInt(t.attributes["PROGRAM-ID"],10)));r.trigger("data",t);return}if(i=/^#EXT-X-MEDIA:?(.*)$/.exec(n),i){t={type:"tag",tagType:"media"};i[1]&&(t.attributes=fo(i[1]));r.trigger("data",t);return}if(i=/^#EXT-X-ENDLIST/.exec(n),i){r.trigger("data",{type:"tag",tagType:"endlist"});return}if(i=/^#EXT-X-DISCONTINUITY/.exec(n),i){r.trigger("data",{type:"tag",tagType:"discontinuity"});return}if(i=/^#EXT-X-PROGRAM-DATE-TIME:?(.*)$/.exec(n),i){t={type:"tag",tagType:"program-date-time"};i[1]&&(t.dateTimeString=i[1],t.dateTimeObject=new Date(i[1]));r.trigger("data",t);return}if(i=/^#EXT-X-KEY:?(.*)$/.exec(n),i){t={type:"tag",tagType:"key"};i[1]&&(t.attributes=fo(i[1]),t.attributes.IV&&(t.attributes.IV.substring(0,2).toLowerCase()==="0x"&&(t.attributes.IV=t.attributes.IV.substring(2)),t.attributes.IV=t.attributes.IV.match(/.{8}/g),t.attributes.IV[0]=parseInt(t.attributes.IV[0],16),t.attributes.IV[1]=parseInt(t.attributes.IV[1],16),t.attributes.IV[2]=parseInt(t.attributes.IV[2],16),t.attributes.IV[3]=parseInt(t.attributes.IV[3],16),t.attributes.IV=new Uint32Array(t.attributes.IV)));r.trigger("data",t);return}if(i=/^#EXT-X-START:?(.*)$/.exec(n),i){t={type:"tag",tagType:"start"};i[1]&&(t.attributes=fo(i[1]),t.attributes["TIME-OFFSET"]=parseFloat(t.attributes["TIME-OFFSET"]),t.attributes.PRECISE=/YES/.test(t.attributes.PRECISE));r.trigger("data",t);return}if(i=/^#EXT-X-CUE-OUT-CONT:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-out-cont"};t.data=i[1]?i[1]:"";r.trigger("data",t);return}if(i=/^#EXT-X-CUE-OUT:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-out"};t.data=i[1]?i[1]:"";r.trigger("data",t);return}if(i=/^#EXT-X-CUE-IN:?(.*)?$/.exec(n),i){t={type:"tag",tagType:"cue-in"};t.data=i[1]?i[1]:"";r.trigger("data",t);return}r.trigger("data",{type:"tag",data:n.slice(4)})})}},i.addParser=function(n){var i=this,r=n.expression,u=n.customType,t=n.dataParser,f=n.segment;typeof t!="function"&&(t=function(n){return n});this.customParsers.push(function(n){var e=r.exec(n);if(e)return i.trigger("data",{type:"custom",data:t(n),customType:u,segment:f}),!0})},i.addTagMapper=function(n){var t=n.expression,i=n.map,r=function(n){return t.test(n)?i(n):n};this.tagMappers.push(r)},t}(ay),klt=function(n){function i(){var i,o;i=n.call(this)||this;i.lineStream=new plt;i.parseStream=new blt;i.lineStream.pipe(i.parseStream);var h=s(i),f=[],t={},r,u,l=function(){},c={AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},a="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",e=0;i.manifest={allowCache:!0,discontinuityStarts:[],segments:[]};o=0;i.parseStream.on("data",function(n){var s,i;({tag:function(){({"allow-cache":function(){this.manifest.allowCache=n.allowed;"allowed"in n||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var i={};"length"in n&&(t.byterange=i,i.length=n.length,"offset"in n||(n.offset=o));"offset"in n&&(t.byterange=i,i.offset=n.offset);o=i.offset+i.length},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"}));"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"}));n.duration>0&&(t.duration=n.duration);n.duration===0&&(t.duration=.01,this.trigger("info",{message:"updating zero segment duration to a small value"}));this.manifest.segments=f},key:function(){if(!n.attributes){this.trigger("warn",{message:"ignoring key declaration without attribute list"});return}if(n.attributes.METHOD==="NONE"){u=null;return}if(!n.attributes.URI){this.trigger("warn",{message:"ignoring key declaration without URI"});return}if(n.attributes.KEYFORMAT===a){if(["SAMPLE-AES","SAMPLE-AES-CTR","SAMPLE-AES-CENC"].indexOf(n.attributes.METHOD)===-1){this.trigger("warn",{message:"invalid key method provided for Widevine"});return}if(n.attributes.METHOD==="SAMPLE-AES-CENC"&&this.trigger("warn",{message:"SAMPLE-AES-CENC is deprecated, please use SAMPLE-AES-CTR instead"}),n.attributes.URI.substring(0,23)!=="data:text/plain;base64,"){this.trigger("warn",{message:"invalid key URI provided for Widevine"});return}if(!(n.attributes.KEYID&&n.attributes.KEYID.substring(0,2)==="0x")){this.trigger("warn",{message:"invalid key ID provided for Widevine"});return}this.manifest.contentProtection={"com.widevine.alpha":{attributes:{schemeIdUri:n.attributes.KEYFORMAT,keyId:n.attributes.KEYID.substring(2)},pssh:stt(n.attributes.URI.split(",")[1])}};return}n.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"});u={method:n.attributes.METHOD||"AES-128",uri:n.attributes.URI};typeof n.attributes.IV!="undefined"&&(u.iv=n.attributes.IV)},"media-sequence":function(){if(!isFinite(n.number)){this.trigger("warn",{message:"ignoring invalid media sequence: "+n.number});return}this.manifest.mediaSequence=n.number},"discontinuity-sequence":function(){if(!isFinite(n.number)){this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+n.number});return}this.manifest.discontinuitySequence=n.number;e=n.number},"playlist-type":function(){if(!/VOD|EVENT/.test(n.playlistType)){this.trigger("warn",{message:"ignoring unknown playlist type: "+n.playlist});return}this.manifest.playlistType=n.playlistType},map:function(){r={};n.uri&&(r.uri=n.uri);n.byterange&&(r.byterange=n.byterange)},"stream-inf":function(){if(this.manifest.playlists=f,this.manifest.mediaGroups=this.manifest.mediaGroups||c,!n.attributes){this.trigger("warn",{message:"ignoring empty stream-inf attributes"});return}t.attributes||(t.attributes={});oe(t.attributes,n.attributes)},media:function(){if(this.manifest.mediaGroups=this.manifest.mediaGroups||c,!(n.attributes&&n.attributes.TYPE&&n.attributes["GROUP-ID"]&&n.attributes.NAME)){this.trigger("warn",{message:"ignoring incomplete or missing media group"});return}var t=this.manifest.mediaGroups[n.attributes.TYPE];t[n.attributes["GROUP-ID"]]=t[n.attributes["GROUP-ID"]]||{};s=t[n.attributes["GROUP-ID"]];i={"default":/yes/i.test(n.attributes.DEFAULT)};i.autoselect=i["default"]?!0:/yes/i.test(n.attributes.AUTOSELECT);n.attributes.LANGUAGE&&(i.language=n.attributes.LANGUAGE);n.attributes.URI&&(i.uri=n.attributes.URI);n.attributes["INSTREAM-ID"]&&(i.instreamId=n.attributes["INSTREAM-ID"]);n.attributes.CHARACTERISTICS&&(i.characteristics=n.attributes.CHARACTERISTICS);n.attributes.FORCED&&(i.forced=/yes/i.test(n.attributes.FORCED));s[n.attributes.NAME]=i},discontinuity:function(){e+=1;t.discontinuity=!0;this.manifest.discontinuityStarts.push(f.length)},"program-date-time":function(){typeof this.manifest.dateTimeString=="undefined"&&(this.manifest.dateTimeString=n.dateTimeString,this.manifest.dateTimeObject=n.dateTimeObject);t.dateTimeString=n.dateTimeString;t.dateTimeObject=n.dateTimeObject},targetduration:function(){if(!isFinite(n.duration)||n.duration<0){this.trigger("warn",{message:"ignoring invalid target duration: "+n.duration});return}this.manifest.targetDuration=n.duration},totalduration:function(){if(!isFinite(n.duration)||n.duration<0){this.trigger("warn",{message:"ignoring invalid total duration: "+n.duration});return}this.manifest.totalDuration=n.duration},start:function(){if(!n.attributes||isNaN(n.attributes["TIME-OFFSET"])){this.trigger("warn",{message:"ignoring start declaration without appropriate attribute list"});return}this.manifest.start={timeOffset:n.attributes["TIME-OFFSET"],precise:n.attributes.PRECISE}},"cue-out":function(){t.cueOut=n.data},"cue-out-cont":function(){t.cueOutCont=n.data},"cue-in":function(){t.cueIn=n.data}}[n.tagType]||l).call(h)},uri:function(){t.uri=n.uri;f.push(t);!this.manifest.targetDuration||"duration"in t||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),t.duration=this.manifest.targetDuration);u&&(t.key=u);t.timeline=e;r&&(t.map=r);t={}},comment:function(){},custom:function(){n.segment?(t.custom=t.custom||{},t.custom[n.customType]=n.data):(this.manifest.custom=this.manifest.custom||{},this.manifest.custom[n.customType]=n.data)}})[n.type].call(h)});return i}f(i,n);var t=i.prototype;return t.push=function(n){this.lineStream.push(n)},t.end=function(){this.lineStream.push("\n")},t.addParser=function(n){this.parseStream.addParser(n)},t.addTagMapper=function(n){this.parseStream.addTagMapper(n)},i}(ay),htt=dt(function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var i=/^(audio|video|application)\/(x-|vnd\.apple\.)?mpegurl/i,r=/^application\/dash\+xml/i,u=function(n){return i.test(n)?"hls":r.test(n)?"dash":n==="application/vnd.videojs.vhs+json"?"vhs-json":null};t.simpleTypeFromSourceType=u});us(htt);var ctt=htt.simpleTypeFromSourceType,yy=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,ltt=new RegExp("[\\-\\.0-9"+yy.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),att=new RegExp("^"+yy.source+ltt.source+"*(?::"+yy.source+ltt.source+"*)?$"),eo=0,sr=1,of=2,oo=3,sf=4,hf=5,so=6,oc=7;vtt.prototype={parse:function(n,t,i){var r=this.domBuilder;r.startDocument();wtt(t,t={});dlt(n,t,i,r,this.errorHandler);r.endDocument()}};btt.prototype={setTagName:function(n){if(!att.test(n))throw new Error("invalid tagName:"+n);this.tagName=n},add:function(n,t,i){if(!att.test(n))throw new Error("invalid attribute:"+n);this[this.length++]={qName:n,value:t,offset:i}},length:0,getLocalName:function(n){return this[n].localName},getLocator:function(n){return this[n].locator},getQName:function(n){return this[n].qName},getURI:function(n){return this[n].uri},getValue:function(n){return this[n].value}};sc({},sc.prototype)instanceof sc||(sc=function(n,t){function i(){}i.prototype=t;i=new i;for(t in n)i[t]=n[t];return i});ktt=vtt;dtt={XMLReader:ktt};var fat="http://www.w3.org/1999/xhtml",wt={},yi=wt.ELEMENT_NODE=1,cf=wt.ATTRIBUTE_NODE=2,hc=wt.TEXT_NODE=3,gtt=wt.CDATA_SECTION_NODE=4,nit=wt.ENTITY_REFERENCE_NODE=5,eat=wt.ENTITY_NODE=6,tit=wt.PROCESSING_INSTRUCTION_NODE=7,iit=wt.COMMENT_NODE=8,rit=wt.DOCUMENT_NODE=9,uit=wt.DOCUMENT_TYPE_NODE=10,rr=wt.DOCUMENT_FRAGMENT_NODE=11,oat=wt.NOTATION_NODE=12,ot={},tt={},pii=ot.INDEX_SIZE_ERR=(tt[1]="Index size error",1),wii=ot.DOMSTRING_SIZE_ERR=(tt[2]="DOMString size error",2),sat=ot.HIERARCHY_REQUEST_ERR=(tt[3]="Hierarchy request error",3),bii=ot.WRONG_DOCUMENT_ERR=(tt[4]="Wrong document",4),kii=ot.INVALID_CHARACTER_ERR=(tt[5]="Invalid character",5),dii=ot.NO_DATA_ALLOWED_ERR=(tt[6]="No data allowed",6),gii=ot.NO_MODIFICATION_ALLOWED_ERR=(tt[7]="No modification allowed",7),hat=ot.NOT_FOUND_ERR=(tt[8]="Not found",8),nri=ot.NOT_SUPPORTED_ERR=(tt[9]="Not supported",9),fit=ot.INUSE_ATTRIBUTE_ERR=(tt[10]="Attribute in use",10),tri=ot.INVALID_STATE_ERR=(tt[11]="Invalid state",11),iri=ot.SYNTAX_ERR=(tt[12]="Syntax error",12),rri=ot.INVALID_MODIFICATION_ERR=(tt[13]="Invalid modification",13),uri=ot.NAMESPACE_ERR=(tt[14]="Invalid namespace",14),fri=ot.INVALID_ACCESS_ERR=(tt[15]="Invalid access",15);lf.prototype=Error.prototype;ho(ot,lf);hr.prototype={length:0,item:function(n){return this[n]||null},toString:function(n,t){for(var r=[],i=0;i<this.length;i++)vf(this[i],r,n,t);return r.join("")}};co.prototype.item=function(n){return py(this),this[n]};pt(co,hr);cc.prototype={length:0,item:hr.prototype.item,getNamedItem:function(n){for(var i=this.length,t;i--;)if(t=this[i],t.nodeName==n)return t},setNamedItem:function(n){var i=n.ownerElement,t;if(i&&i!=this._ownerElement)throw new lf(fit);return t=this.getNamedItem(n.nodeName),oit(this._ownerElement,this,n,t),t},setNamedItemNS:function(n){var i=n.ownerElement,t;if(i&&i!=this._ownerElement)throw new lf(fit);return t=this.getNamedItemNS(n.namespaceURI,n.localName),oit(this._ownerElement,this,n,t),t},removeNamedItem:function(n){var t=this.getNamedItem(n);return sit(this._ownerElement,this,t),t},removeNamedItemNS:function(n,t){var i=this.getNamedItemNS(n,t);return sit(this._ownerElement,this,i),i},getNamedItemNS:function(n,t){for(var r=this.length,i;r--;)if(i=this[r],i.localName==t&&i.namespaceURI==n)return i;return null}};hit.prototype={hasFeature:function(n,t){var i=this._features[n.toLowerCase()];return i&&(!t||t in i)?!0:!1},createDocument:function(n,t,i){var r=new lo,u;return r.implementation=this,r.childNodes=new hr,r.doctype=i,i&&r.appendChild(i),t&&(u=r.createElementNS(n,t),r.appendChild(u)),r},createDocumentType:function(n,t,i){var r=new gy;return r.name=n,r.nodeName=n,r.publicId=t,r.systemId=i,r}};lt.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(n,t){return vit(this,n,t)},replaceChild:function(n,t){this.insertBefore(n,t);t&&this.removeChild(t)},removeChild:function(n){return ait(this,n)},appendChild:function(n){return this.insertBefore(n,null)},hasChildNodes:function(){return this.firstChild!=null},cloneNode:function(n){return ip(this.ownerDocument||this,this,n)},normalize:function(){for(var n=this.firstChild,t;n;)t=n.nextSibling,t&&t.nodeType==hc&&n.nodeType==hc?(this.removeChild(t),n.appendData(t.data)):(n.normalize(),n=t)},isSupported:function(n,t){return this.ownerDocument.implementation.hasFeature(n,t)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(n){for(var t=this,i,r;t;){if(i=t._nsMap,i)for(r in i)if(i[r]==n)return r;t=t.nodeType==cf?t.ownerDocument:t.parentNode}return null},lookupNamespaceURI:function(n){for(var t=this,i;t;){if(i=t._nsMap,i&&n in i)return i[n];t=t.nodeType==cf?t.ownerDocument:t.parentNode}return null},isDefaultNamespace:function(n){var t=this.lookupPrefix(n);return t==null}};ho(wt,lt);ho(wt,lt.prototype);lo.prototype={nodeName:"#document",nodeType:rit,doctype:null,documentElement:null,_inc:1,insertBefore:function(n,t){var i,r;if(n.nodeType==rr){for(i=n.firstChild;i;)r=i.nextSibling,this.insertBefore(i,t),i=r;return n}return this.documentElement==null&&n.nodeType==yi&&(this.documentElement=n),vit(this,n,t),n.ownerDocument=this,n},removeChild:function(n){return this.documentElement==n&&(this.documentElement=null),ait(this,n)},importNode:function(n,t){return dit(this,n,t)},getElementById:function(n){var t=null;return lc(this.documentElement,function(i){if(i.nodeType==yi&&i.getAttribute("id")==n)return t=i,!0}),t},createElement:function(n){var t=new af,i;return t.ownerDocument=this,t.nodeName=n,t.tagName=n,t.childNodes=new hr,i=t.attributes=new cc,i._ownerElement=t,t},createDocumentFragment:function(){var n=new vc;return n.ownerDocument=this,n.childNodes=new hr,n},createTextNode:function(n){var t=new by;return t.ownerDocument=this,t.appendData(n),t},createComment:function(n){var t=new ky;return t.ownerDocument=this,t.appendData(n),t},createCDATASection:function(n){var t=new dy;return t.ownerDocument=this,t.appendData(n),t},createProcessingInstruction:function(n,t){var i=new tp;return i.ownerDocument=this,i.tagName=i.target=n,i.nodeValue=i.data=t,i},createAttribute:function(n){var t=new ac;return t.ownerDocument=this,t.name=n,t.nodeName=n,t.localName=n,t.specified=!0,t},createEntityReference:function(n){var t=new np;return t.ownerDocument=this,t.nodeName=n,t},createElementNS:function(n,t){var i=new af,r=t.split(":"),u=i.attributes=new cc;return i.childNodes=new hr,i.ownerDocument=this,i.nodeName=t,i.tagName=t,i.namespaceURI=n,r.length==2?(i.prefix=r[0],i.localName=r[1]):i.localName=t,u._ownerElement=i,i},createAttributeNS:function(n,t){var i=new ac,r=t.split(":");return i.ownerDocument=this,i.nodeName=t,i.name=t,i.namespaceURI=n,i.specified=!0,r.length==2?(i.prefix=r[0],i.localName=r[1]):i.localName=t,i}};pt(lo,lt);af.prototype={nodeType:yi,hasAttribute:function(n){return this.getAttributeNode(n)!=null},getAttribute:function(n){var t=this.getAttributeNode(n);return t&&t.value||""},getAttributeNode:function(n){return this.attributes.getNamedItem(n)},setAttribute:function(n,t){var i=this.ownerDocument.createAttribute(n);i.value=i.nodeValue=""+t;this.setAttributeNode(i)},removeAttribute:function(n){var t=this.getAttributeNode(n);t&&this.removeAttributeNode(t)},appendChild:function(n){return n.nodeType===rr?this.insertBefore(n,null):lat(this,n)},setAttributeNode:function(n){return this.attributes.setNamedItem(n)},setAttributeNodeNS:function(n){return this.attributes.setNamedItemNS(n)},removeAttributeNode:function(n){return this.attributes.removeNamedItem(n.nodeName)},removeAttributeNS:function(n,t){var i=this.getAttributeNodeNS(n,t);i&&this.removeAttributeNode(i)},hasAttributeNS:function(n,t){return this.getAttributeNodeNS(n,t)!=null},getAttributeNS:function(n,t){var i=this.getAttributeNodeNS(n,t);return i&&i.value||""},setAttributeNS:function(n,t,i){var r=this.ownerDocument.createAttributeNS(n,t);r.value=r.nodeValue=""+i;this.setAttributeNode(r)},getAttributeNodeNS:function(n,t){return this.attributes.getNamedItemNS(n,t)},getElementsByTagName:function(n){return new co(this,function(t){var i=[];return lc(t,function(r){r!==t&&r.nodeType==yi&&(n==="*"||r.tagName==n)&&i.push(r)}),i})},getElementsByTagNameNS:function(n,t){return new co(this,function(i){var r=[];return lc(i,function(u){u!==i&&u.nodeType===yi&&(n==="*"||u.namespaceURI===n)&&(t==="*"||u.localName==t)&&r.push(u)}),r})}};lo.prototype.getElementsByTagName=af.prototype.getElementsByTagName;lo.prototype.getElementsByTagNameNS=af.prototype.getElementsByTagNameNS;pt(af,lt);ac.prototype.nodeType=cf;pt(ac,lt);ao.prototype={data:"",substringData:function(n,t){return this.data.substring(n,n+t)},appendData:function(n){n=this.data+n;this.nodeValue=this.data=n;this.length=n.length},insertData:function(n,t){this.replaceData(n,0,t)},appendChild:function(){throw new Error(tt[sat]);},deleteData:function(n,t){this.replaceData(n,t,"")},replaceData:function(n,t,i){var r=this.data.substring(0,n),u=this.data.substring(n+t);i=r+i+u;this.nodeValue=this.data=i;this.length=i.length}};pt(ao,lt);by.prototype={nodeName:"#text",nodeType:hc,splitText:function(n){var t=this.data,r=t.substring(n),i;return t=t.substring(0,n),this.data=this.nodeValue=t,this.length=t.length,i=this.ownerDocument.createTextNode(r),this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}};pt(by,ao);ky.prototype={nodeName:"#comment",nodeType:iit};pt(ky,ao);dy.prototype={nodeName:"#cdata-section",nodeType:gtt};pt(dy,ao);gy.prototype.nodeType=uit;pt(gy,lt);yit.prototype.nodeType=oat;pt(yit,lt);pit.prototype.nodeType=eat;pt(pit,lt);np.prototype.nodeType=nit;pt(np,lt);vc.prototype.nodeName="#document-fragment";vc.prototype.nodeType=rr;pt(vc,lt);tp.prototype.nodeType=tit;pt(tp,lt);wit.prototype.serializeToString=function(n,t,i){return bit.call(n,t,i)};lt.prototype.toString=bit;try{Object.defineProperty&&(rp=function rp(n){switch(n.nodeType){case yi:case rr:var t=[];for(n=n.firstChild;n;)n.nodeType!==7&&n.nodeType!==8&&t.push(rp(n)),n=n.nextSibling;return t.join("");default:return n.nodeValue}},Object.defineProperty(co.prototype,"length",{get:function(){return py(this),this.$$length}}),Object.defineProperty(lt.prototype,"textContent",{get:function(){return rp(this)},set:function(n){switch(this.nodeType){case yi:case rr:while(this.firstChild)this.removeChild(this.firstChild);(n||String(n))&&this.appendChild(this.ownerDocument.createTextNode(n));break;default:this.data=n;this.value=n;this.nodeValue=n}}}),git=function(n,t,i){n["$$"+t]=i})}catch(pfi){}var aat=hit,vat=wit,nrt={DOMImplementation:aat,XMLSerializer:vat},up=dt(function(n,t){function e(n){this.options=n||{locator:{}}}function s(n,t,i){function f(t){var r=n[t];!r&&o&&(r=n.length==2?function(i){n(t,i)}:n);e[t]=r&&function(n){r("[xmldom "+t+"]\t"+n+u(i))}||function(){}}if(!n){if(t instanceof r)return t;n=t}var e={},o=n instanceof Function;return i=i||{},f("warning"),f("error"),f("fatalError"),e}function r(){this.cdata=!1}function i(n,t){t.lineNumber=n.lineNumber;t.columnNumber=n.columnNumber}function u(n){if(n)return"\n@"+(n.systemId||"")+"#[line:"+n.lineNumber+",col:"+n.columnNumber+"]"}function o(n,t,i){return typeof n=="string"?n.substr(t,i):n.length>=t+i||t?new java.lang.String(n,t,i)+"":n}function f(n,t){n.currentElement?n.currentElement.appendChild(t):n.doc.appendChild(t)}e.prototype.parseFromString=function(n,t){var i=this.options,u=new h,f=i.domBuilder||new r,l=i.errorHandler,o=i.locator,e=i.xmlns||{},c={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return o&&f.setDocumentLocator(o),u.errorHandler=s(l,f,o),u.domBuilder=i.domBuilder||f,/\/x?html?$/.test(t)&&(c.nbsp=" ",c.copy="©",e[""]="http://www.w3.org/1999/xhtml"),e.xml=e.xml||"http://www.w3.org/XML/1998/namespace",n?u.parse(n,e,c):u.errorHandler.error("invalid doc source"),f.doc};r.prototype={startDocument:function(){this.doc=(new c).createDocument(null,null,null);this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(n,t,r,u){var h=this.doc,o=h.createElementNS(n,r||t),c=u.length,e;for(f(this,o),this.currentElement=o,this.locator&&i(this.locator,o),e=0;e<c;e++){var n=u.getURI(e),l=u.getValue(e),r=u.getQName(e),s=h.createAttributeNS(n,r);this.locator&&i(u.getLocator(e),s);s.value=s.nodeValue=l;o.setAttributeNode(s)}},endElement:function(){var n=this.currentElement,t=n.tagName;this.currentElement=n.parentNode},startPrefixMapping:function(){},endPrefixMapping:function(){},processingInstruction:function(n,t){var r=this.doc.createProcessingInstruction(n,t);this.locator&&i(this.locator,r);f(this,r)},ignorableWhitespace:function(){},characters:function(n){var t;n=o.apply(this,arguments);n&&(t=this.cdata?this.doc.createCDATASection(n):this.doc.createTextNode(n),this.currentElement?this.currentElement.appendChild(t):/^\s*$/.test(n)&&this.doc.appendChild(t),this.locator&&i(this.locator,t))},skippedEntity:function(){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(n){(this.locator=n)&&(n.lineNumber=0)},comment:function(n){n=o.apply(this,arguments);var t=this.doc.createComment(n);this.locator&&i(this.locator,t);f(this,t)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(n,t,r){var u=this.doc.implementation,e;u&&u.createDocumentType&&(e=u.createDocumentType(n,t,r),this.locator&&i(this.locator,e),f(this,e))},warning:function(n){console.warn("[xmldom warning]\t"+n,u(this.locator))},error:function(n){console.error("[xmldom error]\t"+n,u(this.locator))},fatalError:function(n){console.error("[xmldom fatalError]\t"+n,u(this.locator));throw n;}};"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,function(n){r.prototype[n]=function(){return null}});var h=dtt.XMLReader,c=t.DOMImplementation=nrt.DOMImplementation;t.XMLSerializer=nrt.XMLSerializer;t.DOMParser=e}),wfi=up.DOMImplementation,bfi=up.XMLSerializer,yat=up.DOMParser,trt=function(n){return!!n&&typeof n=="object"},bt=function bt(){for(var t=arguments.length,i=new Array(t),n=0;n<t;n++)i[n]=arguments[n];return i.reduce(function(n,t){return typeof t!="object"?n:(Object.keys(t).forEach(function(i){n[i]=Array.isArray(n[i])&&Array.isArray(t[i])?n[i].concat(t[i]):trt(n[i])&&trt(t[i])?bt(n[i],t[i]):t[i]}),n)},{})},pat=function(n){return Object.keys(n).map(function(t){return n[t]})},wat=function(n,t){for(var r=[],i=n;i<t;i++)r.push(i);return r},yc=function(n){return n.reduce(function(n,t){return n.concat(t)},[])},irt=function(n){var i,t;if(!n.length)return[];for(i=[],t=0;t<n.length;t++)i.push(n[t]);return i},bat=function(n,t){return n.reduce(function(n,i,r){return i[t]&&n.push(r),n},[])},yf={INVALID_NUMBER_OF_PERIOD:"INVALID_NUMBER_OF_PERIOD",DASH_EMPTY_MANIFEST:"DASH_EMPTY_MANIFEST",DASH_INVALID_XML:"DASH_INVALID_XML",NO_BASE_URL:"NO_BASE_URL",MISSING_SEGMENT_INFORMATION:"MISSING_SEGMENT_INFORMATION",SEGMENT_TIME_UNSPECIFIED:"SEGMENT_TIME_UNSPECIFIED",UNSUPPORTED_UTC_TIMING_SCHEME:"UNSUPPORTED_UTC_TIMING_SCHEME"},vo=function(n){var i=n.baseUrl,l=i===void 0?"":i,r=n.source,u=r===void 0?"":r,f=n.range,t=f===void 0?"":f,e=n.indexRange,o=e===void 0?"":e,s={uri:u,resolvedUri:ec(l||"",u)};if(t||o){var a=t?t:o,h=a.split("-"),c=parseInt(h[0],10),v=parseInt(h[1],10);s.byterange={length:v-c+1,offset:c}}return s},kat=function(n){var t=n.offset+n.length-1;return n.offset+"-"+t},dat={"static":function(n){var i=n.duration,t=n.timescale,r=t===void 0?1:t,u=n.sourceDuration;return{start:0,end:Math.ceil(u/(i/r))}},dynamic:function(n){var h=n.NOW,c=n.clientOffset,l=n.availabilityStartTime,f=n.timescale,t=f===void 0?1:f,i=n.duration,e=n.start,a=e===void 0?0:e,o=n.minimumUpdatePeriod,v=o===void 0?0:o,s=n.timeShiftBufferDepth,y=s===void 0?Infinity:s,r=(h+c)/1e3,u=l+a,p=r+v,w=p-u,b=Math.ceil(w*t/i),k=Math.floor((r-u-y)*t/i),d=Math.floor((r-u)*t/i);return{start:Math.max(0,k),end:Math.min(b,d)}}},gat=function(n){return function(t,i){var r=n.duration,u=n.timescale,e=u===void 0?1:u,o=n.periodIndex,f=n.startNumber,s=f===void 0?1:f;return{number:s+t,duration:r/e,timeline:o,time:i*r}}},fp=function(n){var r=n.type,u=r===void 0?"static":r,o=n.duration,f=n.timescale,s=f===void 0?1:f,h=n.sourceDuration,e=dat[u](n),c=e.start,l=e.end,t=wat(c,l).map(gat(n)),i;return u==="static"&&(i=t.length-1,t[i].duration=h-o/s*i),t},rrt=function(n){var i=n.baseUrl,u=n.initialization,f=u===void 0?{}:u,e=n.sourceDuration,o=n.indexRange,h=o===void 0?"":o,c=n.duration,s,t,r;if(!i)throw new Error(yf.NO_BASE_URL);return s=vo({baseUrl:i,source:f.sourceURL,range:f.range}),t=vo({baseUrl:i,source:i,indexRange:h}),t.map=s,c?(r=fp(n),r.length&&(t.duration=r[0].duration,t.timeline=r[0].timeline)):e&&(t.duration=e,t.timeline=0),t.number=0,[t]},urt=function(n,t,i){for(var f=n.sidx.map?n.sidx.map:null,a=n.sidx.duration,e=n.timeline||0,o=n.sidx.byterange,v=o.offset+o.length,y=t.timescale,p=t.references.filter(function(n){return n.referenceType!==1}),s=[],r=v+t.firstOffset,u=0;u<p.length;u++){var h=t.references[u],c=h.referencedSize,w=h.subsegmentDuration,b=r+c-1,k=r+"-"+b,d={baseUrl:i,timescale:y,timeline:e,periodIndex:e,duration:w,sourceDuration:a,indexRange:k},l=rrt(d)[0];f&&(l.map=f);s.push(l);r+=c}return n.segments=s,n},frt=function(n){var t=pat(n.reduce(function(n,t){var i=t.attributes.id+(t.attributes.lang||""),r;return n[i]?(t.segments[0]&&(t.segments[0].discontinuity=!0),(r=n[i].segments).push.apply(r,t.segments),t.attributes.contentProtection&&(n[i].attributes.contentProtection=t.attributes.contentProtection)):n[i]=t,n},{}));return t.map(function(n){return n.discontinuityStarts=bat(n.segments,"discontinuity"),n})},ep=function(n,t){var f,i,r,u;if(t===void 0&&(t={}),!Object.keys(t).length)return n;for(f in n)(i=n[f],i.sidx)&&(r=i.sidx.uri+"-"+kat(i.sidx.byterange),u=t[r]&&t[r].sidx,i.sidx&&u&&urt(i,u,i.sidx.resolvedUri));return n},nvt=function(n){var i,t=n.attributes,r=n.segments,f=n.sidx,u={attributes:(i={NAME:t.id,BANDWIDTH:t.bandwidth,CODECS:t.codecs},i["PROGRAM-ID"]=1,i),uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:"",targetDuration:t.duration,segments:r,mediaSequence:r.length?r[0].number:1};return t.contentProtection&&(u.contentProtection=t.contentProtection),f&&(u.sidx=f),u},tvt=function(n){var r,t=n.attributes,i=n.segments,u;return typeof i=="undefined"&&(i=[{uri:t.baseUrl,timeline:t.periodIndex,resolvedUri:t.baseUrl||"",duration:t.sourceDuration,number:0}],t.duration=t.sourceDuration),u=(r={NAME:t.id,BANDWIDTH:t.bandwidth},r["PROGRAM-ID"]=1,r),t.codecs&&(u.CODECS=t.codecs),{attributes:u,uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:t.baseUrl||"",targetDuration:t.duration,segments:i,mediaSequence:i.length?i[0].number:1}},ivt=function(n,t){var i,r,u;return t===void 0&&(t={}),r=n.reduce(function(n,r){var u=r.attributes.role&&r.attributes.role.value||"",e=r.attributes.lang||"",f="main",o;return(e&&(o=u?" ("+u+")":"",f=""+r.attributes.lang+o),n[f]&&n[f].playlists[0].attributes.BANDWIDTH>r.attributes.bandwidth)?n:(n[f]={language:e,autoselect:!0,"default":u==="main",playlists:ep([nvt(r)],t),uri:""},typeof i=="undefined"&&u==="main"&&(i=r,i["default"]=!0),n)},{}),i||(u=Object.keys(r)[0],r[u]["default"]=!0),r},rvt=function(n,t){return t===void 0&&(t={}),n.reduce(function(n,i){var r=i.attributes.lang||"text";return n[r]?n:(n[r]={language:r,"default":!1,autoselect:!1,playlists:ep([tvt(i)],t),uri:""},n)},{})},uvt=function(n){var i,t=n.attributes,r=n.segments,f=n.sidx,u={attributes:(i={NAME:t.id,AUDIO:"audio",SUBTITLES:"subs",RESOLUTION:{width:t.width,height:t.height},CODECS:t.codecs,BANDWIDTH:t.bandwidth},i["PROGRAM-ID"]=1,i),uri:"",endList:(t.type||"static")==="static",timeline:t.periodIndex,resolvedUri:"",targetDuration:t.duration,segments:r,mediaSequence:r.length?r[0].number:1};return t.contentProtection&&(u.contentProtection=t.contentProtection),f&&(u.sidx=f),u},fvt=function(n,t,i){var u;if(i===void 0&&(i={}),!n.length)return{};var f=n[0].attributes,c=f.sourceDuration,e=f.type,l=e===void 0?"static":e,a=f.suggestedPresentationDelay,o=f.minimumUpdatePeriod,v=function(n){var t=n.attributes;return t.mimeType==="video/mp4"||t.mimeType==="video/webm"||t.contentType==="video"},y=function(n){var t=n.attributes;return t.mimeType==="audio/mp4"||t.mimeType==="audio/webm"||t.contentType==="audio"},p=function(n){var t=n.attributes;return t.mimeType==="text/vtt"||t.contentType==="text"},w=frt(n.filter(v)).map(uvt),s=frt(n.filter(y)),h=n.filter(p),r={allowCache:!0,discontinuityStarts:[],segments:[],endList:!0,mediaGroups:(u={AUDIO:{},VIDEO:{}},u["CLOSED-CAPTIONS"]={},u.SUBTITLES={},u),uri:"",duration:c,playlists:ep(w,i)};return o>=0&&(r.minimumUpdatePeriod=o*1e3),t&&(r.locations=t),l==="dynamic"&&(r.suggestedPresentationDelay=a),s.length&&(r.mediaGroups.AUDIO.audio=ivt(s,i)),h.length&&(r.mediaGroups.SUBTITLES.subs=rvt(h,i)),r},evt=function(n,t,i){var e=n.NOW,o=n.clientOffset,s=n.availabilityStartTime,r=n.timescale,h=r===void 0?1:r,u=n.start,c=u===void 0?0:u,f=n.minimumUpdatePeriod,l=f===void 0?0:f,a=(e+o)/1e3,v=s+c,y=a+l,p=y-v;return Math.ceil((p*h-t)/i)},ert=function(n,t){for(var o,c,d,s,l=n.type,g=l===void 0?"static":l,a=n.minimumUpdatePeriod,nt=a===void 0?0:a,v=n.media,tt=v===void 0?"":v,it=n.sourceDuration,y=n.timescale,p=y===void 0?1:y,w=n.startNumber,b=w===void 0?1:w,rt=n.periodIndex,u=[],i=-1,f=0;f<t.length;f++){var h=t[f],r=h.d,k=h.r||0,e=h.t||0;for(i<0&&(i=e),e&&e>i&&(i=e),o=void 0,k<0?(c=f+1,o=c===t.length?g==="dynamic"&&nt>0&&tt.indexOf("$Number$")>0?evt(n,i,r):(it*p-i)/r:(t[c].t-i)/r):o=k+1,d=b+u.length+o,s=b+u.length;s<d;)u.push({number:s,duration:r/p,time:i,timeline:rt}),i+=r,s++}return u},ovt=/\$([A-z]*)(?:(%0)([0-9]+)d)?\$/g,svt=function(n){return function(t,i,r,u){if(t==="$$")return"$";if(typeof n[i]=="undefined")return t;var f=""+n[i];return i==="RepresentationID"?f:(u=r?parseInt(u,10):1,f.length>=u)?f:""+new Array(u-f.length+1).join("0")+f}},ort=function(n,t){return n.replace(ovt,svt(t))},hvt=function(n,t){return!n.duration&&!t?[{number:n.startNumber||1,duration:n.sourceDuration,time:0,timeline:n.periodIndex}]:n.duration?fp(n):ert(n,t)},cvt=function(n,t){var i={RepresentationID:n.id,Bandwidth:n.bandwidth||0},r=n.initialization,u=r===void 0?{sourceURL:"",range:""}:r,f=vo({baseUrl:n.baseUrl,source:ort(u.sourceURL,i),range:u.range}),e=hvt(n,t);return e.map(function(t){i.Number=t.number;i.Time=t.time;var r=ort(n.media||"",i);return{uri:r,timeline:t.timeline,duration:t.duration,resolvedUri:ec(n.baseUrl||"",r),map:f,number:t.number}})},lvt=function(n,t){var i=n.baseUrl,r=n.initialization,u=r===void 0?{}:r,e=vo({baseUrl:i,source:u.sourceURL,range:u.range}),f=vo({baseUrl:i,source:t.media,range:t.mediaRange});return f.map=e,f},avt=function(n,t){var i=n.duration,f=n.segmentUrls,e=f===void 0?[]:f,r,u;if(!i&&!t||i&&t)throw new Error(yf.SEGMENT_TIME_UNSPECIFIED);return r=e.map(function(t){return lvt(n,t)}),i&&(u=fp(n)),t&&(u=ert(n,t)),u.map(function(n,t){if(r[t]){var i=r[t];return i.timeline=n.timeline,i.duration=n.duration,i.number=n.number,i}}).filter(function(n){return n})},vvt=function(n){var e=n.attributes,i=n.segmentInfo,t,u,r,f;if(i.template?(u=cvt,t=bt(e,i.template)):i.base?(u=rrt,t=bt(e,i.base)):i.list&&(u=avt,t=bt(e,i.list)),r={attributes:e},!u)return r;if(f=u(t,i.timeline),t.duration){var o=t,h=o.duration,s=o.timescale,c=s===void 0?1:s;t.duration=h/c}else t.duration=f.length?f.reduce(function(n,t){return Math.max(n,Math.ceil(t.duration))},0):0;return r.attributes=t,r.segments=f,i.base&&t.indexRange&&(r.sidx=f[0],r.segments=[]),r},yvt=function(n){return n.map(vvt)},d=function(n,t){return irt(n.childNodes).filter(function(n){var i=n.tagName;return i===t})},op=function(n){return n.textContent.trim()},pf=function(n){var i=/P(?:(\d*)Y)?(?:(\d*)M)?(?:(\d*)D)?(?:T(?:(\d*)H)?(?:(\d*)M)?(?:([\d.]*)S)?)?/.exec(n);if(!i)return 0;var t=i.slice(1),r=t[0],u=t[1],f=t[2],e=t[3],o=t[4],s=t[5];return parseFloat(r||0)*31536e3+parseFloat(u||0)*2592e3+parseFloat(f||0)*86400+parseFloat(e||0)*3600+parseFloat(o||0)*60+parseFloat(s||0)},pvt=function(n){return/^\d+-\d+-\d+T\d+:\d+:\d+(\.\d+)?$/.test(n)&&(n+="Z"),Date.parse(n)},srt={mediaPresentationDuration:function(n){return pf(n)},availabilityStartTime:function(n){return pvt(n)/1e3},minimumUpdatePeriod:function(n){return pf(n)},suggestedPresentationDelay:function(n){return pf(n)},type:function(n){return n},timeShiftBufferDepth:function(n){return pf(n)},start:function(n){return pf(n)},width:function(n){return parseInt(n,10)},height:function(n){return parseInt(n,10)},bandwidth:function(n){return parseInt(n,10)},startNumber:function(n){return parseInt(n,10)},timescale:function(n){return parseInt(n,10)},duration:function(n){var t=parseInt(n,10);return isNaN(t)?pf(n):t},d:function(n){return parseInt(n,10)},t:function(n){return parseInt(n,10)},r:function(n){return parseInt(n,10)},DEFAULT:function(n){return n}},at=function(n){return(n&&n.attributes)?irt(n.attributes).reduce(function(n,t){var i=srt[t.name]||srt.DEFAULT;return n[t.name]=i(t.value),n},{}):{}},wvt={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"},pc=function(n,t){return t.length?yc(n.map(function(n){return t.map(function(t){return ec(n,op(t))})})):n},sp=function(n){var f=d(n,"SegmentTemplate")[0],i=d(n,"SegmentList")[0],c=i&&d(i,"SegmentURL").map(function(n){return bt({tag:"SegmentURL"},at(n))}),e=d(n,"SegmentBase")[0],o=i||f,s=o&&d(o,"SegmentTimeline")[0],h=i||e||f,r=h&&d(h,"Initialization")[0],t=f&&at(f),u;return t&&r?t.initialization=r&&at(r):t&&t.initialization&&(t.initialization={sourceURL:t.initialization}),u={template:t,timeline:s&&d(s,"S").map(function(n){return at(n)}),list:i&&bt(at(i),{segmentUrls:c,initialization:at(r)}),base:e&&bt(at(e),{initialization:at(r)})},Object.keys(u).forEach(function(n){u[n]||delete u[n]}),u},bvt=function(n,t,i){return function(r){var u=d(r,"BaseURL"),f=pc(t,u),e=bt(n,at(r)),o=sp(r);return f.map(function(n){return{segmentInfo:bt(i,o),attributes:bt(e,{baseUrl:n})}})}},kvt=function(n){return n.reduce(function(n,t){var f=at(t),i=wvt[f.schemeIdUri],r,u,e;return i&&(n[i]={attributes:f},r=d(t,"cenc:pssh")[0],r&&(u=op(r),e=u&&stt(u),n[i].pssh=e)),n},{})},dvt=function(n,t,i){return function(r){var e=at(r),o=pc(t,d(r,"BaseURL")),s=d(r,"Role")[0],h={role:at(s)},u=bt(n,e,h),f=kvt(d(r,"ContentProtection"));Object.keys(f).length&&(u=bt(u,{contentProtection:f}));var c=sp(r),l=d(r,"Representation"),a=bt(i,c);return yc(l.map(bvt(u,o,a)))}},gvt=function(n,i){return function(r,u){var e=pc(i,d(r,"BaseURL")),o=at(r),f=parseInt(o.id,10),s=t.isNaN(f)?u:f,h=bt(n,{periodIndex:s}),c=d(r,"AdaptationSet"),l=sp(r);return yc(c.map(dvt(h,e,l)))}},nyt=function(n,t){t===void 0&&(t={});var r=t,u=r.manifestUri,h=u===void 0?"":u,f=r.NOW,c=f===void 0?Date.now():f,e=r.clientOffset,l=e===void 0?0:e,o=d(n,"Period");if(!o.length)throw new Error(yf.INVALID_NUMBER_OF_PERIOD);var s=d(n,"Location"),i=at(n),a=pc([h],d(n,"BaseURL"));return i.sourceDuration=i.mediaPresentationDuration||0,i.NOW=c,i.clientOffset=l,s.length&&(i.locations=s.map(op)),{locations:i.locations,representationInfo:yc(o.map(gvt(i,a)))}},hrt=function(n){if(n==="")throw new Error(yf.DASH_EMPTY_MANIFEST);var r=new yat,i,t;try{i=r.parseFromString(n,"application/xml");t=i&&i.documentElement.tagName==="MPD"?i.documentElement:null}catch(u){}if(!t||t&&t.getElementsByTagName("parsererror").length>0)throw new Error(yf.DASH_INVALID_XML);return t},tyt=function(n){var i=d(n,"UTCTiming")[0],t;if(!i)return null;t=at(i);switch(t.schemeIdUri){case"urn:mpeg:dash:utc:http-head:2014":case"urn:mpeg:dash:utc:http-head:2012":t.method="HEAD";break;case"urn:mpeg:dash:utc:http-xsdate:2014":case"urn:mpeg:dash:utc:http-iso:2014":case"urn:mpeg:dash:utc:http-xsdate:2012":case"urn:mpeg:dash:utc:http-iso:2012":t.method="GET";break;case"urn:mpeg:dash:utc:direct:2014":case"urn:mpeg:dash:utc:direct:2012":t.method="DIRECT";t.value=Date.parse(t.value);break;case"urn:mpeg:dash:utc:http-ntp:2014":case"urn:mpeg:dash:utc:ntp:2014":case"urn:mpeg:dash:utc:sntp:2014":default:throw new Error(yf.UNSUPPORTED_UTC_TIMING_SCHEME);}return t},iyt=function(n,t){t===void 0&&(t={});var i=nyt(hrt(n),t),r=yvt(i.representationInfo);return fvt(r,i.locations,t.sidxMapping)},ryt=function(n){return tyt(hrt(n))},crt=urt,lrt=Math.pow(2,32),uyt=function(n){var i=new DataView(n.buffer,n.byteOffset,n.byteLength),r={version:n[0],flags:new Uint8Array(n.subarray(1,4)),references:[],referenceId:i.getUint32(4),timescale:i.getUint32(8)},t=12,u;for(r.version===0?(r.earliestPresentationTime=i.getUint32(t),r.firstOffset=i.getUint32(t+4),t+=8):(r.earliestPresentationTime=i.getUint32(t)*lrt+i.getUint32(t+4),r.firstOffset=i.getUint32(t+8)*lrt+i.getUint32(t+12),t+=16),t+=2,u=i.getUint16(t),t+=2;u>0;t+=12,u--)r.references.push({referenceType:(n[t]&128)>>>7,referencedSize:i.getUint32(t)&2147483647,subsegmentDuration:i.getUint32(t+4),startsWithSap:!!(n[t+8]&128),sapType:(n[t+8]&112)>>>4,sapDeltaTime:i.getUint32(t+8)&268435455});return r},fyt=uyt,wf=dt(function(n,t){var s,h;Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){return n instanceof Uint8Array?n:new Uint8Array(n&&n.buffer||n,n&&n.byteOffset||0,n&&n.byteLength||0)},i=function(n){if(!n)return"";n=Array.prototype.slice.call(n);var t=String.fromCharCode.apply(null,r(n));try{return decodeURIComponent(escape(t))}catch(i){}return t},o=function(n,t){t===void 0&&(t=0);n=r(n);var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],u=n[t+5],f=(u&16)>>4;return f?i+20:i+10},f=function f(n,t){return(t===void 0&&(t=0),n=r(n),n.length-t<10||i(n.subarray(t,t+3))!=="ID3")?t:(t+=o(n,t),f(n,t))},u={aac:function(n){var t=f(n);return n.length>=t+2&&(n[t]&255)==255&&(n[t+1]&224)==224&&(n[t+1]&22)==16},mp3:function(n){var t=f(n);return n.length>=t+2&&(n[t]&255)==255&&(n[t+1]&224)==224&&(n[t+1]&6)==2},webm:function(n){return n.length>=4&&(n[0]&255)==26&&(n[1]&255)==69&&(n[2]&255)==223&&(n[3]&255)==163},mp4:function(n){return n.length>=8&&/^(f|s)typ$/.test(i(n.subarray(4,8)))&&!/^ftyp3g$/.test(i(n.subarray(4,10)))},"3gp":function(n){return n.length>=10&&/^ftyp3g$/.test(i(n.subarray(4,10)))},ts:function(n){if(n.length<189&&n.length>=1)return n[0]===71;for(var t=0;t+188<n.length&&t<188;){if(n[t]===71&&n[t+188]===71)return!0;t+=1}return!1},flac:function(n){return n.length>=4&&/^fLaC$/.test(i(n.subarray(0,4)))},ogg:function(n){return n.length>=4&&/^OggS$/.test(i(n.subarray(0,4)))}},e=Object.keys(u).filter(function(n){return n!=="ts"}).concat("ts");e.forEach(function(n){var t=u[n];u[n]=function(n){return t(r(n))}});s=function(n){var t,i;for(n=r(n),t=0;t<e.length;t++)if(i=e[t],u[i](n))return i;return""};h=function(n){var t,u,f;for(n=r(n),t=0;t<n.length;){if(u=(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])>>>0,f=i(n.subarray(t+4,t+8)),f==="moof")return!0;u===0||u+t>n.length?t=n.length:t+=u}return!1};t.detectContainerForBytes=s;t.getId3Offset=f;t.id3Size=o;t.isLikely=u;t.isLikelyFmp4MediaSegment=h});us(wf);var hp=wf.detectContainerForBytes,eyt=wf.getId3Offset,vei=wf.id3Size,yei=wf.isLikely,art=wf.isLikelyFmp4MediaSegment,bf=dt(function(n,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(n){return ArrayBuffer.isView(n)},i=function(n){return n instanceof Uint8Array?n:new Uint8Array(n&&n.buffer||n,n&&n.byteOffset||0,n&&n.byteLength||0)},u=function(n){if(!n)return"";n=Array.prototype.slice.call(n);var t=String.fromCharCode.apply(null,i(n));try{return decodeURIComponent(escape(t))}catch(r){}return t},f=function(n,t){t===void 0&&(t=!1);return(typeof n!="string"&&n&&typeof n.toString=="function"&&(n=n.toString()),typeof n!="string")?[]:(t||(n=unescape(encodeURIComponent(n))),n.split("").map(function(n){return n.charCodeAt(0)&255}))},e=function(){for(var r=arguments.length,t=new Array(r),n=0;n<r;n++)t[n]=arguments[n];var e=t.reduce(function(n,t){var i=t&&(t.byteLength||t.length);return n+(i||0)},0),u=new Uint8Array(e),f=0;return t.forEach(function(n){n=i(n);u.set(n,f);f+=n.byteLength}),u};t.bytesToString=u;t.concatTypedArrays=e;t.isTypedArray=r;t.stringToBytes=f;t.toUint8=i});us(bf);var pei=bf.bytesToString,oyt=bf.concatTypedArrays,wei=bf.isTypedArray,syt=bf.stringToBytes,hyt=bf.toUint8,yo={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},ru=function(){this.init=function(){var n={};this.on=function(t,i){n[t]||(n[t]=[]);n[t]=n[t].concat(i)};this.off=function(t,i){var r;return n[t]?(r=n[t].indexOf(i),n[t]=n[t].slice(),n[t].splice(r,1),r>-1):!1};this.trigger=function(t){var r,i,u,f;if(r=n[t],r)if(arguments.length===2)for(u=r.length,i=0;i<u;++i)r[i].call(this,arguments[1]);else{for(f=[],i=arguments.length,i=1;i<arguments.length;++i)f.push(arguments[i]);for(u=r.length,i=0;i<u;++i)r[i].apply(this,f)}};this.dispose=function(){n={}}}};ru.prototype.pipe=function(n){this.on("data",function(t){n.push(t)});this.on("done",function(t){n.flush(t)});this.on("partialdone",function(t){n.partialFlush(t)});this.on("endedtimeline",function(t){n.endTimeline(t)});this.on("reset",function(t){n.reset(t)});return n};ru.prototype.push=function(n){this.trigger("data",n)};ru.prototype.flush=function(n){this.trigger("done",n)};ru.prototype.partialFlush=function(n){this.trigger("partialdone",n)};ru.prototype.endTimeline=function(n){this.trigger("endedtimeline",n)};ru.prototype.reset=function(n){this.trigger("reset",n)};var cyt=ru,lyt=8589934592,ayt=4294967296,vrt="shared",cp=function(n,t){var i=1;for(n>t&&(i=-1);Math.abs(t-n)>ayt;)n+=i*lyt;return n},lp=function lp(n){var i,t;lp.prototype.init.call(this);this.type_=n||vrt;this.push=function(n){(this.type_===vrt||n.type===this.type_)&&(t===undefined&&(t=n.dts),n.dts=cp(n.dts,t),n.pts=cp(n.pts,t),i=n.dts,this.trigger("data",n))};this.flush=function(){t=i;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){t=void 0;i=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};lp.prototype=new cyt;var vyt={TimestampRolloverStream:lp,handleRollover:cp},yrt=function(n){var t=n[1]&31;return t<<=8,t|n[2]},wc=function(n){return!!(n[1]&64)},bc=function(n){var t=0;return(n[3]&48)>>>4>1&&(t+=n[4]+1),t},yyt=function(n,t){var i=yrt(n);return i===0?"pat":i===t?"pmt":t?"pes":null},pyt=function(n){var i=wc(n),t=4+bc(n);return i&&(t+=n[t]+1),(n[t+10]&31)<<8|n[t+11]},wyt=function(n){var u={},s=wc(n),t=4+bc(n),f,e,o,r,i;if(s&&(t+=n[t]+1),n[t+5]&1){for(f=(n[t+1]&15)<<8|n[t+2],e=3+f-4,o=(n[t+10]&15)<<8|n[t+11],r=12+o;r<e;)i=t+r,u[(n[i+1]&31)<<8|n[i+2]]=n[i],r+=((n[i+3]&15)<<8|n[i+4])+5;return u}},byt=function(n,t){var i=yrt(n),r=t[i];switch(r){case yo.H264_STREAM_TYPE:return"video";case yo.ADTS_STREAM_TYPE:return"audio";case yo.METADATA_STREAM_TYPE:return"timed-metadata";default:return null}},kyt=function(n){var u=wc(n),t,i,r;return u?(t=4+bc(n),t>=n.byteLength)?null:(i=null,r=n[t+7],r&192&&(i={},i.pts=(n[t+9]&14)<<27|(n[t+10]&255)<<20|(n[t+11]&254)<<12|(n[t+12]&255)<<5|(n[t+13]&254)>>>3,i.pts*=4,i.pts+=(n[t+13]&6)>>>1,i.dts=i.pts,r&64&&(i.dts=(n[t+14]&14)<<27|(n[t+15]&255)<<20|(n[t+16]&254)<<12|(n[t+17]&255)<<5|(n[t+18]&254)>>>3,i.dts*=4,i.dts+=(n[t+18]&6)>>>1)),i):null},ap=function(n){switch(n){case 5:return"slice_layer_without_partitioning_rbsp_idr";case 6:return"sei_rbsp";case 7:return"seq_parameter_set_rbsp";case 8:return"pic_parameter_set_rbsp";case 9:return"access_unit_delimiter_rbsp";default:return null}},dyt=function(n){for(var e=4+bc(n),i=n.subarray(e),t=0,r=0,f=!1,u;r<i.byteLength-3;r++)if(i[r+2]===1){t=r+5;break}while(t<i.byteLength)switch(i[t]){case 0:if(i[t-1]!==0){t+=2;break}else if(i[t-2]!==0){t++;break}r+3!==t-2&&(u=ap(i[r+3]&31),u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0));do t++;while(i[t]!==1&&t<i.length);r=t-2;t+=3;break;case 1:if(i[t-1]!==0||i[t-2]!==0){t+=3;break}u=ap(i[r+3]&31);u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0);r=t-2;t+=3;break;default:t+=3}return i=i.subarray(r),t-=r,r=0,i&&i.byteLength>3&&(u=ap(i[r+3]&31),u==="slice_layer_without_partitioning_rbsp_idr"&&(f=!0)),f},gyt={parseType:yyt,parsePat:pyt,parsePmt:wyt,parsePayloadUnitStartIndicator:wc,parsePesType:byt,parsePesTime:kyt,videoPacketContainsKeyFrame:dyt},npt=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],prt=function(n,t){var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],r=n[t+5],u=(r&16)>>4;return(i=i>=0?i:0,u)?i+20:i+10},wrt=function wrt(n,t){return n.length-t<10||n[t]!=="I".charCodeAt(0)||n[t+1]!=="D".charCodeAt(0)||n[t+2]!=="3".charCodeAt(0)?t:(t+=prt(n,t),wrt(n,t))},tpt=function(n){var t=wrt(n,0);return n.length>=t+2&&(n[t]&255)==255&&(n[t+1]&240)==240&&(n[t+1]&22)==16},brt=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},ipt=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},rpt=function(n,t,i){return unescape(ipt(n,t,i))},upt=function(n,t){var i=(n[t+5]&224)>>5,r=n[t+4]<<3,u=n[t+3]&6144;return u|r|i},fpt=function(n,t){return n[t]==="I".charCodeAt(0)&&n[t+1]==="D".charCodeAt(0)&&n[t+2]==="3".charCodeAt(0)?"timed-metadata":n[t]&!0&&(n[t+1]&240)==240?"audio":null},ept=function(n){for(var t=0;t+5<n.length;){if(n[t]!==255||(n[t+1]&246)!=240){t++;continue}return npt[(n[t+2]&60)>>>2]}return null},opt=function(n){var t,f,u,o,r,s,i,e;t=10;n[5]&64&&(t+=4,t+=brt(n.subarray(10,14)));do{if(f=brt(n.subarray(t+4,t+8)),f<1)return null;if(o=String.fromCharCode(n[t],n[t+1],n[t+2],n[t+3]),o==="PRIV")for(u=n.subarray(t+10,t+f+10),r=0;r<u.byteLength;r++)if(u[r]===0){if(s=rpt(u,0,r),s==="com.apple.streaming.transportStreamTimestamp")return i=u.subarray(r+1),e=(i[3]&1)<<30|i[4]<<22|i[5]<<14|i[6]<<6|i[7]>>>2,e*=4,e+(i[7]&3);break}t+=10;t+=f}while(t<n.byteLength);return null},spt={isLikelyAacData:tpt,parseId3TagSize:prt,parseAdtsSize:upt,parseType:fpt,parseSampleRate:ept,parseAacTimestamp:opt},vp=9e4,yp,pp,kc,wp,krt,drt,grt;yp=function(n){return n*vp};pp=function(n,t){return n*t};kc=function(n){return n/vp};wp=function(n,t){return n/t};krt=function(n,t){return yp(wp(n,t))};drt=function(n,t){return pp(kc(n),t)};grt=function(n,t,i){return kc(i?n:n-t)};var nut={ONE_SECOND_IN_TS:vp,secondsToVideoTs:yp,secondsToAudioTs:pp,videoTsToSeconds:kc,audioTsToSeconds:wp,audioTsToVideoTs:krt,videoTsToAudioTs:drt,metadataTsToSeconds:grt},po=nut.ONE_SECOND_IN_TS,kf=vyt.handleRollover,l={};l.ts=gyt;l.aac=spt;var uu=nut.ONE_SECOND_IN_TS,vt=188,pi=71,hpt=function(n,t){for(var r=0,i=vt,u,f;i<n.byteLength;){if(n[r]===pi&&n[i]===pi){u=n.subarray(r,i);f=l.ts.parseType(u,t.pid);switch(f){case"pat":t.pid||(t.pid=l.ts.parsePat(u));break;case"pmt":t.table||(t.table=l.ts.parsePmt(u))}if(t.pid&&t.table)return;r+=vt;i+=vt;continue}r++;i++}},tut=function(n,t,i){for(var u=0,r=vt,f,s,h,c,e,o=!1;r<=n.byteLength;){if(n[u]===pi&&(n[r]===pi||r===n.byteLength)){f=n.subarray(u,r);s=l.ts.parseType(f,t.pid);switch(s){case"pes":h=l.ts.parsePesType(f,t.table);c=l.ts.parsePayloadUnitStartIndicator(f);h==="audio"&&c&&(e=l.ts.parsePesTime(f),e&&(e.type="audio",i.audio.push(e),o=!0))}if(o)break;u+=vt;r+=vt;continue}u++;r++}for(r=n.byteLength,u=r-vt,o=!1;u>=0;){if(n[u]===pi&&(n[r]===pi||r===n.byteLength)){f=n.subarray(u,r);s=l.ts.parseType(f,t.pid);switch(s){case"pes":h=l.ts.parsePesType(f,t.table);c=l.ts.parsePayloadUnitStartIndicator(f);h==="audio"&&c&&(e=l.ts.parsePesTime(f),e&&(e.type="audio",i.audio.push(e),o=!0))}if(o)break;u-=vt;r-=vt;continue}u--;r--}},cpt=function(n,t,i){for(var f=0,u=vt,r,c,a,h,e,v,y,p,s=!1,o={data:[],size:0},w;u<n.byteLength;){if(n[f]===pi&&n[u]===pi){r=n.subarray(f,u);c=l.ts.parseType(r,t.pid);switch(c){case"pes":if(a=l.ts.parsePesType(r,t.table),h=l.ts.parsePayloadUnitStartIndicator(r),a==="video"&&(h&&!s&&(e=l.ts.parsePesTime(r),e&&(e.type="video",i.video.push(e),s=!0)),!i.firstKeyFrame)){if(h&&o.size!==0){for(v=new Uint8Array(o.size),y=0;o.data.length;)p=o.data.shift(),v.set(p,y),y+=p.byteLength;l.ts.videoPacketContainsKeyFrame(v)&&(w=l.ts.parsePesTime(v),w?(i.firstKeyFrame=w,i.firstKeyFrame.type="video"):console.warn("Failed to extract PTS/DTS from PES at first keyframe. This could be an unusual TS segment, or else mux.js did not parse your TS segment correctly. If you know your TS segments do contain PTS/DTS on keyframes please file a bug report! You can try ffprobe to double check for yourself."));o.size=0}o.data.push(r);o.size+=r.byteLength}}if(s&&i.firstKeyFrame)break;f+=vt;u+=vt;continue}f++;u++}for(u=n.byteLength,f=u-vt,s=!1;f>=0;){if(n[f]===pi&&n[u]===pi){r=n.subarray(f,u);c=l.ts.parseType(r,t.pid);switch(c){case"pes":a=l.ts.parsePesType(r,t.table);h=l.ts.parsePayloadUnitStartIndicator(r);a==="video"&&h&&(e=l.ts.parsePesTime(r),e&&(e.type="video",i.video.push(e),s=!0))}if(s)break;f-=vt;u-=vt;continue}f--;u--}},lpt=function(n,t){var u,r,i;n.audio&&n.audio.length&&(u=t,typeof u=="undefined"&&(u=n.audio[0].dts),n.audio.forEach(function(n){n.dts=kf(n.dts,u);n.pts=kf(n.pts,u);n.dtsTime=n.dts/uu;n.ptsTime=n.pts/uu}));n.video&&n.video.length&&(r=t,typeof r=="undefined"&&(r=n.video[0].dts),n.video.forEach(function(n){n.dts=kf(n.dts,r);n.pts=kf(n.pts,r);n.dtsTime=n.dts/uu;n.ptsTime=n.pts/uu}),n.firstKeyFrame&&(i=n.firstKeyFrame,i.dts=kf(i.dts,r),i.pts=kf(i.pts,r),i.dtsTime=i.dts/uu,i.ptsTime=i.dts/uu))},apt=function(n){for(var u=!1,o=0,f=null,r=null,i=0,t=0,e,h,s,c;n.length-t>=3;){h=l.aac.parseType(n,t);switch(h){case"timed-metadata":if(n.length-t<10){u=!0;break}if(i=l.aac.parseId3TagSize(n,t),i>n.length){u=!0;break}r===null&&(e=n.subarray(t,t+i),r=l.aac.parseAacTimestamp(e));t+=i;break;case"audio":if(n.length-t<7){u=!0;break}if(i=l.aac.parseAdtsSize(n,t),i>n.length){u=!0;break}f===null&&(e=n.subarray(t,t+i),f=l.aac.parseSampleRate(e));o++;t+=i;break;default:t++}if(u)return null}return f===null||r===null?null:(s=uu/f,c={audio:[{type:"audio",dts:r,pts:r},{type:"audio",dts:r+o*1024*s,pts:r+o*1024*s}]},c)},vpt=function(n){var i={pid:null,table:null},t={},r,u;hpt(n,i);for(r in i.table)if(i.table.hasOwnProperty(r)){u=i.table[r];switch(u){case yo.H264_STREAM_TYPE:t.video=[];cpt(n,i,t);t.video.length===0&&delete t.video;break;case yo.ADTS_STREAM_TYPE:t.audio=[];tut(n,i,t);t.audio.length===0&&delete t.audio}}return t},ypt=function(n,t){var r=l.aac.isLikelyAacData(n),i;return(i=r?apt(n):vpt(n),!i||!i.audio&&!i.video)?null:(lpt(i,t),i)},ppt={inspect:ypt,parseAudioPes_:tut},wpt=function(n){return n>>>0},bpt=function(n){return("00"+n.toString(16)).slice(-2)},dc={toUnsigned:wpt,toHexString:bpt},kpt=function(n){var t="";return t+=String.fromCharCode(n[0]),t+=String.fromCharCode(n[1]),t+=String.fromCharCode(n[2]),t+String.fromCharCode(n[3])},fu=kpt,dpt=dc.toUnsigned,iut=function iut(n,t){var r=[],i,f,o,u,e;if(!t.length)return null;for(i=0;i<n.byteLength;)f=dpt(n[i]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),o=fu(n.subarray(i+4,i+8)),u=f>1?i+f:n.byteLength,o===t[0]&&(t.length===1?r.push(n.subarray(i+8,u)):(e=iut(n.subarray(i+8,u),t.slice(1)),e.length&&(r=r.concat(e)))),i=u;return r},k=iut,gpt=function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:r.getUint32(4)},u=t.flags[2]&1,f=t.flags[2]&2,e=t.flags[2]&8,o=t.flags[2]&16,s=t.flags[2]&32,h=t.flags[0]&65536,c=t.flags[0]&131072,i;return i=8,u&&(i+=4,t.baseDataOffset=r.getUint32(12),i+=4),f&&(t.sampleDescriptionIndex=r.getUint32(i),i+=4),e&&(t.defaultSampleDuration=r.getUint32(i),i+=4),o&&(t.defaultSampleSize=r.getUint32(i),i+=4),s&&(t.defaultSampleFlags=r.getUint32(i)),h&&(t.durationIsEmpty=!0),!u&&c&&(t.baseDataOffsetIsMoof=!0),t},nwt=gpt,twt=function(n){return{isLeading:(n[0]&12)>>>2,dependsOn:n[0]&3,isDependedOn:(n[1]&192)>>>6,hasRedundancy:(n[1]&48)>>>4,paddingValue:(n[1]&14)>>>1,isNonSyncSample:n[1]&1,degradationPriority:n[2]<<8|n[3]}},rut=twt,iwt=function(n){var i={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},u=new DataView(n.buffer,n.byteOffset,n.byteLength),h=i.flags[2]&1,c=i.flags[2]&4,e=i.flags[1]&1,o=i.flags[1]&2,l=i.flags[1]&4,s=i.flags[1]&8,f=u.getUint32(4),t=8,r;for(h&&(i.dataOffset=u.getInt32(t),t+=4),c&&f&&(r={flags:rut(n.subarray(t,t+4))},t+=4,e&&(r.duration=u.getUint32(t),t+=4),o&&(r.size=u.getUint32(t),t+=4),s&&(r.compositionTimeOffset=i.version===1?u.getInt32(t):u.getUint32(t),t+=4),i.samples.push(r),f--);f--;)r={},e&&(r.duration=u.getUint32(t),t+=4),o&&(r.size=u.getUint32(t),t+=4),l&&(r.flags=rut(n.subarray(t,t+4)),t+=4),s&&(r.compositionTimeOffset=i.version===1?u.getInt32(t):u.getUint32(t),t+=4),i.samples.push(r);return i},rwt=iwt,uut=dc.toUnsigned,uwt=function(n){var t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),baseMediaDecodeTime:uut(n[4]<<24|n[5]<<16|n[6]<<8|n[7])};return t.version===1&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=uut(n[8]<<24|n[9]<<16|n[10]<<8|n[11])),t},fwt=uwt,df=dc.toUnsigned,wo=dc.toHexString,fut,eut,out,sut,hut,bp;fut=function(n){var t=k(n,["moov","trak"]);return t.reduce(function(n,t){var r,f,i,e,u;return(r=k(t,["tkhd"])[0],!r)?null:(f=r[0],i=f===0?12:20,e=df(r[i]<<24|r[i+1]<<16|r[i+2]<<8|r[i+3]),u=k(t,["mdia","mdhd"])[0],!u)?null:(f=u[0],i=f===0?12:20,n[e]=df(u[i]<<24|u[i+1]<<16|u[i+2]<<8|u[i+3]),n)},{})};eut=function(n,t){var r,u,i;return r=k(t,["moof","traf"]),u=[].concat.apply([],r.map(function(t){return k(t,["tfhd"]).map(function(i){var u,f,r;return u=df(i[4]<<24|i[5]<<16|i[6]<<8|i[7]),f=n[u]||9e4,r=k(t,["tfdt"]).map(function(n){var i,t;return i=n[0],t=df(n[4]<<24|n[5]<<16|n[6]<<8|n[7]),i===1&&(t*=Math.pow(2,32),t+=df(n[8]<<24|n[9]<<16|n[10]<<8|n[11])),t})[0],r=typeof r=="number"&&!isNaN(r)?r:Infinity,r/f})})),i=Math.min.apply(null,u),isFinite(i)?i:0};out=function(n,t){var i=k(t,["moof","traf"]),u=0,f=0,e,c,l,r,a;if(i&&i.length){var o=k(i[0],["tfhd"])[0],s=k(i[0],["trun"])[0],h=k(i[0],["tfdt"])[0];o&&(c=nwt(o),e=c.trackId);h&&(l=fwt(h),u=l.baseMediaDecodeTime);s&&(r=rwt(s),r.samples&&r.samples.length&&(f=r.samples[0].compositionTimeOffset||0))}return a=n[e]||9e4,(u+f)/a};sut=function(n){var i=k(n,["moov","trak"]),t=[];return i.forEach(function(n){var i=k(n,["mdia","hdlr"]),r=k(n,["tkhd"]);i.forEach(function(n,i){var s=fu(n.subarray(8,12)),f=r[i],u,e,o;s==="vide"&&(u=new DataView(f.buffer,f.byteOffset,f.byteLength),e=u.getUint8(0),o=e===0?u.getUint32(12):u.getUint32(20),t.push(o))})}),t};bp=function(n){var i=n[0],t=i===0?12:20;return df(n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3])};hut=function(n){var i=k(n,["moov","trak"]),t=[];return i.forEach(function(n){var i={},u=k(n,["tkhd"])[0],f,v,h,e,c,l,o,r,s,a;u&&(f=new DataView(u.buffer,u.byteOffset,u.byteLength),v=f.getUint8(0),i.id=v===0?f.getUint32(12):f.getUint32(20));h=k(n,["mdia","hdlr"])[0];h&&(e=fu(h.subarray(8,12)),i.type=e==="vide"?"video":e==="soun"?"audio":e);c=k(n,["mdia","minf","stbl","stsd"])[0];c&&(l=c.subarray(8),i.codec=fu(l.subarray(4,8)),o=k(l,[i.codec])[0],o&&(/^[a-z]vc[1-9]$/i.test(i.codec)?(r=o.subarray(78),s=fu(r.subarray(4,8)),s==="avcC"&&r.length>11?(i.codec+=".",i.codec+=wo(r[9]),i.codec+=wo(r[10]),i.codec+=wo(r[11])):i.codec="avc1.4d400d"):/^mp4[a,v]$/i.test(i.codec)?(r=o.subarray(28),s=fu(r.subarray(4,8)),s==="esds"&&r.length>20&&r[19]!==0?(i.codec+="."+wo(r[19]),i.codec+="."+wo(r[20]>>>2&63).replace(/^0/,"")):i.codec="mp4a.40.2"):i.codec=i.codec.toLowerCase()));a=k(n,["mdia","mdhd"])[0];a&&(i.timescale=bp(a));t.push(i)}),t};kp={findBox:k,parseType:fu,timescale:fut,startTime:eut,compositionStartTime:out,videoTrackIds:sut,tracks:hut,getTimescaleFromMediaHeader:bp};yt=dt(function(n,i){function a(n){return n&&typeof n=="object"&&"default"in n?n["default"]:n}Object.defineProperty(i,"__esModule",{value:!0});var u=a(t),r={mp4:/^(av0?1|avc0?[1234]|vp0?9|flac|opus|mp3|mp4a|mp4v|stpp.ttml.im1t)/,webm:/^(vp0?[89]|av0?1|opus|vorbis)/,ogg:/^(vp0?[89]|theora|flac|opus|vorbis)/,video:/^(av0?1|avc0?[1234]|vp0?[89]|hvc1|hev1|theora|mp4v)/,audio:/^(mp4a|flac|vorbis|opus|ac-[34]|ec-3|alac|mp3)/,text:/^(stpp.ttml.im1t)/,muxerVideo:/^(avc0?1)/,muxerAudio:/^(mp4a)/,muxerText:/a^/},v=["video","audio","text"],e=["Video","Audio","Text"],f=function(n){return n?n.replace(/avc1\.(\d+)\.(\d+)/i,function(n,t,i){var r=("00"+Number(t).toString(16)).slice(-2),u=("00"+Number(i).toString(16)).slice(-2);return"avc1."+r+"00"+u}):n},o=function(n){return n.map(f)},y=function(n){return n.replace(/avc1\.(\d+)\.(\d+)/i,function(n){return o([n])[0]})},s=function(n){n===void 0&&(n="");var u=n.split(","),t={},i=[];return u.forEach(function(n){n=n.trim();var u;v.forEach(function(i){var f=r[i].exec(n.toLowerCase()),e,o;!f||f.length<=1||(u=i,e=n.substring(0,f[1].length),o=n.replace(e,""),t[i]={type:e,details:o})});u||i.push(n)}),i.length&&(t.unknown=i),t},p=function(n,t){var i,u,r;if(!n.mediaGroups.AUDIO||!t||(i=n.mediaGroups.AUDIO[t],!i))return null;for(u in i)if(r=i[u],r["default"]&&r.playlists)return s(r.playlists[0].attributes.CODECS);return null},w=function(n){return n===void 0&&(n=""),r.video.test(n.trim().toLowerCase())},h=function(n){return n===void 0&&(n=""),r.audio.test(n.trim().toLowerCase())},c=function(n){return n===void 0&&(n=""),r.text.test(n.trim().toLowerCase())},l=function(n){var t,u,i;if(n&&typeof n=="string")return t=n.toLowerCase().split(",").map(function(n){return f(n.trim())}),u="video",t.length===1&&h(t[0])?u="audio":t.length===1&&c(t[0])&&(u="application"),i="mp4",t.every(function(n){return r.mp4.test(n)})?i="mp4":t.every(function(n){return r.webm.test(n)})?i="webm":t.every(function(n){return r.ogg.test(n)})&&(i="ogg"),u+"/"+i+';codecs="'+n+'"'},b=function(n){return n===void 0&&(n=""),u.MediaSource&&u.MediaSource.isTypeSupported&&u.MediaSource.isTypeSupported(l(n))||!1},k=function(n){return n===void 0&&(n=""),n.toLowerCase().split(",").every(function(n){var t,i;for(n=n.trim(),t=0;t<e.length;t++)if(i=e[t],r["muxer"+i].test(n))return!0;return!1})};i.DEFAULT_AUDIO_CODEC="mp4a.40.2";i.DEFAULT_VIDEO_CODEC="avc1.4d400d";i.browserSupportsCodec=b;i.codecsFromDefault=p;i.getMimeForCodec=l;i.isAudioCodec=h;i.isTextCodec=c;i.isVideoCodec=w;i.mapLegacyAvcCodecs=y;i.muxerSupportsCodec=k;i.parseCodecs=s;i.translateLegacyCodec=f;i.translateLegacyCodecs=o});us(yt);var cut=yt.DEFAULT_AUDIO_CODEC,ewt=yt.DEFAULT_VIDEO_CODEC,gc=yt.browserSupportsCodec,owt=yt.codecsFromDefault,lut=yt.getMimeForCodec,swt=yt.isAudioCodec,bei=yt.isTextCodec,hwt=yt.isVideoCodec,kei=yt.mapLegacyAvcCodecs,dp=yt.muxerSupportsCodec,bo=yt.parseCodecs,aut=yt.translateLegacyCodec,dei=yt.translateLegacyCodecs,eu=ec,nl=function(n,t,i){return n&&i&&i.responseURL&&t!==i.responseURL?i.responseURL:t},cwt=n.log,gp=function(n,t){return n+"-"+t},vut=function(n){var u=n.manifestString,i=n.customTagParsers,f=i===void 0?[]:i,r=n.customTagMappers,e=r===void 0?[]:r,t=new klt;return f.forEach(function(n){return t.addParser(n)}),e.forEach(function(n){return t.addTagMapper(n)}),t.push(u),t.end(),t.manifest},tl=function(n,t){["AUDIO","SUBTITLES"].forEach(function(i){var r,u,f;for(r in n.mediaGroups[i])for(u in n.mediaGroups[i][r])f=n.mediaGroups[i][r][u],t(f,i,r,u)})},yut=function(n){var t=n.playlist,i=n.uri,r=n.id;t.id=r;i&&(t.uri=i);t.attributes=t.attributes||{}},lwt=function(n){for(var i=n.playlists.length,t;i--;)t=n.playlists[i],yut({playlist:t,id:gp(i,t.uri)}),t.resolvedUri=eu(n.uri,t.uri),n.playlists[t.id]=t,n.playlists[t.uri]=t,t.attributes.BANDWIDTH||cwt.warn("Invalid playlist STREAM-INF detected. Missing BANDWIDTH attribute.")},awt=function(n){tl(n,function(t){t.uri&&(t.resolvedUri=eu(n.uri,t.uri))})},vwt=function(n,t){var r=gp(0,t),i={mediaGroups:{AUDIO:{},VIDEO:{},"CLOSED-CAPTIONS":{},SUBTITLES:{}},uri:u.location.href,resolvedUri:u.location.href,playlists:[{uri:t,id:r,resolvedUri:t,attributes:{}}]};return i.playlists[r]=i.playlists[0],i.playlists[t]=i.playlists[0],i},put=function(n,t){var i,r;for(n.uri=t,i=0;i<n.playlists.length;i++)n.playlists[i].uri||(r="placeholder-uri-"+i,n.playlists[i].uri=r);tl(n,function(t,i,r,u){if(t.playlists&&t.playlists.length&&!t.playlists[0].uri){var f="placeholder-uri-"+i+"-"+r+"-"+u,e=gp(0,f);t.playlists[0].uri=f;t.playlists[0].id=e;n.playlists[e]=t.playlists[0];n.playlists[f]=t.playlists[0]}});lwt(n);awt(n)},nw=n.mergeOptions,ywt=n.EventTarget,pwt=function(n,t,i){var u=t.slice(),f,r;for(i=i||0,f=Math.min(n.length,t.length+i),r=i;r<f;r++)u[r-i]=nw(n[r],u[r-i]);return u},wut=function(n,t){n.resolvedUri||(n.resolvedUri=eu(t,n.uri));n.key&&!n.key.resolvedUri&&(n.key.resolvedUri=eu(t,n.key.uri));n.map&&!n.map.resolvedUri&&(n.map.resolvedUri=eu(t,n.map.uri))},tw=function(n,t){var r=nw(n,{}),i=r.playlists[t.id],u,f;if(!i||i.segments&&t.segments&&i.segments.length===t.segments.length&&i.endList===t.endList&&i.mediaSequence===t.mediaSequence)return null;for(u=nw(i,t),i.segments&&(u.segments=pwt(i.segments,t.segments,t.mediaSequence-i.mediaSequence)),u.segments.forEach(function(n){wut(n,u.resolvedUri)}),f=0;f<r.playlists.length;f++)r.playlists[f].id===t.id&&(r.playlists[f]=u);return r.playlists[t.id]=u,r.playlists[t.uri]=u,r},but=function(n,t){var i=n.segments[n.segments.length-1];return t&&i&&i.duration?i.duration*1e3:(n.targetDuration||10)*500},gf=function(n){function i(t,i,r){var u,f;if(r===void 0&&(r={}),u=n.call(this)||this,!t)throw new Error("A non-empty playlist URL or object is required");var e=r,o=e.withCredentials,h=o===void 0?!1:o,s=e.handleManifestRedirects,c=s===void 0?!1:s;u.src=t;u.vhs_=i;u.withCredentials=h;u.handleManifestRedirects=c;f=i.options_;u.customTagParsers=f&&f.customTagParsers||[];u.customTagMappers=f&&f.customTagMappers||[];u.state="HAVE_NOTHING";u.on("mediaupdatetimeout",function(){u.state==="HAVE_METADATA"&&(u.state="HAVE_CURRENT_METADATA",u.request=u.vhs_.xhr({uri:eu(u.master.uri,u.media().uri),withCredentials:u.withCredentials},function(n){if(u.request){if(n)return u.playlistRequestError(u.request,u.media(),"HAVE_METADATA");u.haveMetadata({playlistString:u.request.responseText,url:u.media().uri,id:u.media().id})}}))});return u}vi(i,n);var t=i.prototype;return t.playlistRequestError=function(n,t,i){var r=t.uri,u=t.id;this.request=null;i&&(this.state=i);this.error={playlist:this.master.playlists[u],status:n.status,message:"HLS playlist request error at URL: "+r+".",responseText:n.responseText,code:n.status>=500?4:2};this.trigger("error")},t.haveMetadata=function(n){var f=this,e=n.playlistString,o=n.playlistObject,s=n.url,r=n.id,t,i;this.request=null;this.state="HAVE_METADATA";t=o||vut({manifestString:e,customTagParsers:this.customTagParsers,customTagMappers:this.customTagMappers});t.lastRequest=Date.now();yut({playlist:t,uri:s,id:r});i=tw(this.master,t);this.targetDuration=t.targetDuration;i?(this.master=i,this.media_=this.master.playlists[r]):this.trigger("playlistunchanged");this.media().endList||(u.clearTimeout(this.mediaUpdateTimeout),this.mediaUpdateTimeout=u.setTimeout(function(){f.trigger("mediaupdatetimeout")},but(this.media(),!!i)));this.trigger("loadedplaylist")},t.dispose=function(){this.trigger("dispose");this.stopRequest();u.clearTimeout(this.mediaUpdateTimeout);u.clearTimeout(this.finalRenditionTimeout);this.off()},t.stopRequest=function(){if(this.request){var n=this.request;this.request=null;n.onreadystatechange=null;n.abort()}},t.media=function(n,t){var i=this,e,r,f;if(!n)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(typeof n=="string"){if(!this.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.master.playlists[n]}if(u.clearTimeout(this.finalRenditionTimeout),t){e=n.targetDuration*500||5e3;this.finalRenditionTimeout=u.setTimeout(this.media.bind(this,n,!1),e);return}if(r=this.state,f=!this.media_||n.id!==this.media_.id,this.master.playlists[n.id].endList||n.endList&&n.segments.length){this.request&&(this.request.onreadystatechange=null,this.request.abort(),this.request=null);this.state="HAVE_METADATA";this.media_=n;f&&(this.trigger("mediachanging"),r==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange"));return}if(f){if(this.state="SWITCHING_MEDIA",this.request){if(n.resolvedUri===this.request.url)return;this.request.onreadystatechange=null;this.request.abort();this.request=null}this.media_&&this.trigger("mediachanging");this.request=this.vhs_.xhr({uri:n.resolvedUri,withCredentials:this.withCredentials},function(t,u){if(i.request){if(n.lastRequest=Date.now(),n.resolvedUri=nl(i.handleManifestRedirects,n.resolvedUri,u),t)return i.playlistRequestError(i.request,n,r);i.haveMetadata({playlistString:u.responseText,url:n.uri,id:n.id});r==="HAVE_MASTER"?i.trigger("loadedmetadata"):i.trigger("mediachange")}})}},t.pause=function(){this.stopRequest();u.clearTimeout(this.mediaUpdateTimeout);this.state==="HAVE_NOTHING"&&(this.started=!1);this.state==="SWITCHING_MEDIA"?this.state=this.media_?"HAVE_METADATA":"HAVE_MASTER":this.state==="HAVE_CURRENT_METADATA"&&(this.state="HAVE_METADATA")},t.load=function(n){var r=this,t,i;if(u.clearTimeout(this.mediaUpdateTimeout),t=this.media(),n){i=t?t.targetDuration*500:5e3;this.mediaUpdateTimeout=u.setTimeout(function(){return r.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")},t.start=function(){var n=this;if(this.started=!0,typeof this.src=="object"){this.src.uri||(this.src.uri=u.location.href);this.src.resolvedUri=this.src.uri;setTimeout(function(){n.setupInitialPlaylist(n.src)},0);return}this.request=this.vhs_.xhr({uri:this.src,withCredentials:this.withCredentials},function(t,i){if(n.request){if(n.request=null,t)return n.error={status:i.status,message:"HLS playlist request error at URL: "+n.src+".",responseText:i.responseText,code:2},n.state==="HAVE_NOTHING"&&(n.started=!1),n.trigger("error");n.src=nl(n.handleManifestRedirects,n.src,i);var r=vut({manifestString:i.responseText,customTagParsers:n.customTagParsers,customTagMappers:n.customTagMappers});n.setupInitialPlaylist(r)}})},t.srcUri=function(){return typeof this.src=="string"?this.src:this.src.uri},t.setupInitialPlaylist=function(n){if(this.state="HAVE_MASTER",n.playlists){this.master=n;put(this.master,this.srcUri());n.playlists.forEach(function(n){n.segments&&n.segments.forEach(function(t){wut(t,n.resolvedUri)})});this.trigger("loadedplaylist");this.request||this.media(this.master.playlists[0]);return}var t=this.srcUri()||u.location.href;this.master=vwt(n,t);this.haveMetadata({playlistObject:n,url:t,id:this.master.playlists[0].id});this.trigger("loadedmetadata")},i}(ywt),ou=1/30,wi=ou*3,kut=function(t,i){var u=[],r;if(t&&t.length)for(r=0;r<t.length;r++)i(t.start(r),t.end(r))&&u.push([t.start(r),t.end(r)]);return n.createTimeRanges(u)},ko=function(n,t){return kut(n,function(n,i){return n-wi<=t&&i+wi>=t})},iw=function(n,t){return kut(n,function(n){return n-ou>=t})},wwt=function(t){var r,i,u,f;if(t.length<2)return n.createTimeRanges();for(r=[],i=1;i<t.length;i++)u=t.end(i-1),f=t.start(i),r.push([u,f]);return n.createTimeRanges(r)},bwt=function(t,i){var f=null,e=null,o=0,u=[],s=[],r;if(!t||!t.length||!i||!i.length)return n.createTimeRange();for(r=t.length;r--;)u.push({time:t.start(r),type:"start"}),u.push({time:t.end(r),type:"end"});for(r=i.length;r--;)u.push({time:i.start(r),type:"start"}),u.push({time:i.end(r),type:"end"});for(u.sort(function(n,t){return n.time-t.time}),r=0;r<u.length;r++)u[r].type==="start"?(o++,o===2&&(f=u[r].time)):u[r].type==="end"&&(o--,o===1&&(e=u[r].time)),f!==null&&e!==null&&(s.push([f,e]),f=null,e=null);return n.createTimeRanges(s)},dut=function(n){var i=[],t;if(!n||!n.length)return"";for(t=0;t<n.length;t++)i.push(n.start(t)+" => "+n.end(t));return i.join(", ")},kwt=function(n,t,i){i===void 0&&(i=1);var r=n.length?n.end(n.length-1):0;return(r-t)/i},rw=function(n){for(var i=[],t=0;t<n.length;t++)i.push({start:n.start(t),end:n.end(t)});return i},dwt=function(n,t){if(n===t)return!1;if(!n&&t||!t&&n||n.length!==t.length)return!0;for(var i=0;i<n.length;i++)if(n.start(i)!==t.start(i)||n.end(i)!==t.end(i))return!0;return!1},gut=n.createTimeRange,gwt=function(n,t){var r=0,u=t-n.mediaSequence,i=n.segments[u];if(i){if(typeof i.start!="undefined")return{result:i.start,precise:!0};if(typeof i.end!="undefined")return{result:i.end-i.duration,precise:!0}}while(u--){if(i=n.segments[u],typeof i.end!="undefined")return{result:r+i.end,precise:!0};if(r+=i.duration,typeof i.start!="undefined")return{result:r+i.start,precise:!0}}return{result:r,precise:!1}},nbt=function(n,t){for(var r=0,i,u=t-n.mediaSequence;u<n.segments.length;u++){if(i=n.segments[u],typeof i.start!="undefined")return{result:i.start-r,precise:!0};if(r+=i.duration,typeof i.end!="undefined")return{result:i.end-r,precise:!0}}return{result:-1,precise:!1}},nft=function(n,t,i){var r,u;return(typeof t=="undefined"&&(t=n.mediaSequence+n.segments.length),t<n.mediaSequence)?0:(r=gwt(n,t),r.precise)?r.result:(u=nbt(n,t),u.precise)?u.result:r.result+i},tft=function(n,t,i){if(!n)return 0;if(typeof i!="number"&&(i=0),typeof t=="undefined"){if(n.totalDuration)return n.totalDuration;if(!n.endList)return u.Infinity}return nft(n,t,i)},go=function(n,t,i){var u=0,f,e,r;if(t>i&&(f=[i,t],t=f[0],i=f[1]),t<0){for(e=t;e<Math.min(0,i);e++)u+=n.targetDuration;t=0}for(r=t;r<i;r++)u+=n.segments[r].duration;return u},ift=function(n,t){var r;if(!n.segments.length)return 0;var i=n.segments.length,f=n.segments[i-1].duration||n.targetDuration,u=typeof t=="number"?t:f+n.targetDuration*2;if(u===0)return i;for(r=0;i--;)if(r+=n.segments[i].duration,r>=u)break;return Math.max(0,i)},rft=function(n,t,i,r){if(!n||!n.segments)return null;if(n.endList)return tft(n);if(t===null)return null;t=t||0;var u=i?ift(n,r):n.segments.length;return nft(n,n.mediaSequence+u,t)},tbt=function(n,t,i){var u=t||0,r=rft(n,t,!0,i);return r===null?gut():gut(u,r)},ibt=function(n,t,i,r){var u,e,o=n.segments.length,f=t-r;if(f<0){if(i>0)for(u=i-1;u>=0;u--)if(e=n.segments[u],f+=e.duration+ou,f>0)return{mediaIndex:u,startTime:r-go(n,i,u)};return{mediaIndex:0,startTime:t}}if(i<0){for(u=i;u<0;u++)if(f-=n.targetDuration,f<0)return{mediaIndex:0,startTime:t};i=0}for(u=i;u<o;u++)if(e=n.segments[u],f-=e.duration+ou,f<0)return{mediaIndex:u,startTime:r+go(n,i,u)};return{mediaIndex:o-1,startTime:t}},uft=function(n){return n.excludeUntil&&n.excludeUntil>Date.now()},uw=function(n){return n.excludeUntil&&n.excludeUntil===Infinity},il=function(n){var t=uft(n);return!n.disabled&&!t},rbt=function(n){return n.disabled},ubt=function(n){for(var t=0;t<n.segments.length;t++)if(n.segments[t].key)return!0;return!1},fft=function(n,t){return t.attributes&&t.attributes[n]},fbt=function(n,t,i,r){if(r===void 0&&(r=0),!fft("BANDWIDTH",i))return NaN;var u=n*i.attributes.BANDWIDTH;return(u-r*8)/t},fw=function(n,t){if(n.playlists.length===1)return!0;var i=t.attributes.BANDWIDTH||Number.MAX_VALUE;return n.playlists.filter(function(n){return il(n)?(n.attributes.BANDWIDTH||0)<i:!1}).length===0},kt={duration:tft,seekable:tbt,safeLiveIndex:ift,getMediaInfoForTime:ibt,isEnabled:il,isDisabled:rbt,isBlacklisted:uft,isIncompatible:uw,playlistEnd:rft,isAes:ubt,hasAttribute:fft,estimateSegmentRequestTime:fbt,isLowestEnabledRendition:fw},ebt=n.xhr,obt=n.mergeOptions,ew=function(n,t,i,r){var u=n.responseType==="arraybuffer"?n.response:n.responseText;!t&&u&&(n.responseTime=Date.now(),n.roundTripTime=n.responseTime-n.requestTime,n.bytesReceived=u.byteLength||u.length,n.bandwidth||(n.bandwidth=Math.floor(n.bytesReceived/n.roundTripTime*8e3)));i.headers&&(n.responseHeaders=i.headers);t&&t.code==="ETIMEDOUT"&&(n.timedout=!0);t||n.aborted||i.statusCode===200||i.statusCode===206||i.statusCode===0||(t=new Error("XHR Failed with a response of: "+(n&&(u||n.responseText))));r(t,n)},eft=function(){return function t(i,r){var f,e,u,o;return i=obt({timeout:45e3},i),f=t.beforeRequest||n.Vhs.xhr.beforeRequest,f&&typeof f=="function"&&(e=f(i),e&&(i=e)),u=ebt(i,function(n,t){return ew(u,n,t,r)}),o=u.abort,u.abort=function(){return u.aborted=!0,o.apply(u,arguments)},u.uri=i.uri,u.requestTime=Date.now(),u}},sbt=function(n){var t=n.offset+n.length-1,i=n.offset;return"bytes="+i+"-"+t},ow=function(n){var t={};return n.byterange&&(t.Range=sbt(n.byterange)),t},hbt=function(n,t){return n.start(t)+"-"+n.end(t)},cbt=function(n,t){var i=n.toString(16);return"00".substring(0,2-i.length)+i+(t%2?" ":"")},lbt=function(n){return n>=32&&n<126?String.fromCharCode(n):"."},oft=function(n){var t={};return Object.keys(n).forEach(function(i){var r=n[i];t[i]=ArrayBuffer.isView(r)?{bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:r}),t},rl=function(n){var t=n.byterange||{length:Infinity,offset:0};return[t.length,t.offset,n.resolvedUri].join(",")},sft=function(n){return n.resolvedUri},hft=function(n){for(var r=Array.prototype.slice.call(n),t=16,u="",f,e,i=0;i<r.length/t;i++)f=r.slice(i*t,i*t+t).map(cbt).join(""),e=r.slice(i*t,i*t+t).map(lbt).join(""),u+=f+" "+e+"\n";return u},abt=function(n){var t=n.bytes;return hft(t)},vbt=function(n){for(var i="",t=0;t<n.length;t++)i+=hbt(n,t)+" ";return i},ybt=Object.freeze({__proto__:null,createTransferableMessage:oft,initSegmentId:rl,segmentKeyId:sft,hexDump:hft,tagDump:abt,textRanges:vbt}),cft=.25,pbt=function(n,t){if(!t.dateTimeObject)return null;var i=t.videoTimingInfo.transmuxerPrependedSeconds,r=t.videoTimingInfo.transmuxedPresentationStart,u=r+i,f=n-u;return new Date(t.dateTimeObject.getTime()+f*1e3)},wbt=function(n){return n.transmuxedPresentationEnd-n.transmuxedPresentationStart-n.transmuxerPrependedSeconds},bbt=function(n,t){var u,i,f,e;try{u=new Date(n)}catch(c){return null}if(!t||!t.segments||t.segments.length===0||(i=t.segments[0],u<i.dateTimeObject))return null;for(f=0;f<t.segments.length-1;f++)if(i=t.segments[f],e=t.segments[f+1].dateTimeObject,u<e)break;var r=t.segments[t.segments.length-1],o=r.dateTimeObject,s=r.videoTimingInfo?wbt(r.videoTimingInfo):r.duration+r.duration*cft,h=new Date(o.getTime()+s*1e3);return u>h?null:(u>o&&(i=r),{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:kt.duration(t,t.mediaSequence+t.segments.indexOf(i)),type:i.videoTimingInfo?"accurate":"estimate"})},kbt=function(n,t){var r,i,f,u;if(!t||!t.segments||t.segments.length===0)return null;for(r=0,f=0;f<t.segments.length;f++)if(i=t.segments[f],r=i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationEnd:r+i.duration,n<=r)break;if(u=t.segments[t.segments.length-1],u.videoTimingInfo&&u.videoTimingInfo.transmuxedPresentationEnd<n)return null;if(n>r){if(n>r+u.duration*cft)return null;i=u}return{segment:i,estimatedStart:i.videoTimingInfo?i.videoTimingInfo.transmuxedPresentationStart:r-i.duration,type:i.videoTimingInfo?"accurate":"estimate"}},dbt=function(n,t){var i,r,u,f;try{i=new Date(n);r=new Date(t)}catch(e){}return u=i.getTime(),f=r.getTime(),(f-u)/1e3},gbt=function(n){var t,i;if(!n.segments||n.segments.length===0)return!1;for(t=0;t<n.segments.length;t++)if(i=n.segments[t],!i.dateTimeObject)return!1;return!0},nkt=function(n){var e=n.playlist,o=n.time,r=o===void 0?undefined:o,t=n.callback,i,u,f;if(!t)throw new Error("getProgramTime: callback must be provided");return!e||r===undefined?t({message:"getProgramTime: playlist and time must be provided"}):(i=kbt(r,e),!i)?t({message:"valid programTime was not found"}):i.type==="estimate"?t({message:"Accurate programTime could not be determined. Please seek to e.seekTime and try again",seekTime:i.estimatedStart}):(u={mediaSeconds:r},f=pbt(r,i.segment),f&&(u.programDateTime=f.toISOString()),t(null,u))},lft=function lft(n){var i=n.programTime,r=n.playlist,h=n.retryCount,c=h===void 0?2:h,e=n.seekTo,l=n.pauseAfterSeek,a=l===void 0?!0:l,u=n.tech,t=n.callback,f,o,s,v,y;if(!t)throw new Error("seekToProgramTime: callback must be provided");if(typeof i=="undefined"||!r||!e)return t({message:"seekToProgramTime: programTime, seekTo and playlist must be provided"});if(!r.endList&&!u.hasStarted_)return t({message:"player must be playing a live stream to start buffering"});if(!gbt(r))return t({message:"programDateTime tags must be provided in the manifest "+r.resolvedUri});if(f=bbt(i,r),!f)return t({message:i+" was not found in the stream"});if(o=f.segment,s=dbt(o.dateTimeObject,i),f.type==="estimate"){if(c===0)return t({message:i+" is not buffered yet. Try again"});e(f.estimatedStart+s);u.one("seeked",function(){lft({programTime:i,playlist:r,retryCount:c-1,seekTo:e,pauseAfterSeek:a,tech:u,callback:t})});return}v=o.start+s;y=function(){return t(null,u.currentTime())};u.one("seeked",y);a&&u.pause();e(v)},sw=function(n,t){if(n.readyState===4)return t()},tkt=function(n,t,i){var r=[],f,e=!1,u=function(n,t,r,u){return t.abort(),e=!0,i(n,t,r,u)},o=function(n,t){var o,i;if(!e)return n?u(n,t,"",r):(o=t.responseText.substring(r&&r.byteLength||0,t.responseText.length),r=oyt(r,syt(o,!0)),f=f||eyt(r),r.length<10||f&&r.length<f+2)?sw(t,function(){return u(n,t,"",r)}):(i=hp(r),i==="ts"&&r.length<188)?sw(t,function(){return u(n,t,"",r)}):!i&&r.length<376?sw(t,function(){return u(n,t,"",r)}):u(null,t,i,r)},h={uri:n,beforeSend:function(n){n.overrideMimeType("text/plain; charset=x-user-defined");n.addEventListener("progress",function(t){var i=t.total,r=t.loaded;return ew(n,null,{statusCode:n.status},o)})}},s=t(h,function(n,t){return ew(s,n,t,o)});return s},ikt=n.EventTarget,aft=n.mergeOptions,rkt=function(n){var r=n.masterXml,t=n.srcUrl,u=n.clientOffset,f=n.sidxMapping,i=iyt(r,{manifestUri:t,clientOffset:u,sidxMapping:f});return put(i,t),i},hw=function(n){var t=n.byterange.offset+n.byterange.length-1;return n.uri+"-"+n.byterange.offset+"-"+t},ukt=function(n,t,i){for(var u,o,s,f=!0,r=aft(n,{duration:t.duration,minimumUpdatePeriod:t.minimumUpdatePeriod}),e=0;e<t.playlists.length;e++)u=t.playlists[e],u.sidx&&(o=hw(u.sidx),i&&i[o]&&crt(u,i[o].sidx,u.sidx.resolvedUri)),s=tw(r,u),s&&(r=s,f=!1);return(tl(t,function(n,t,i,u){if(n.playlists&&n.playlists.length){var o=n.playlists[0].id,e=tw(r,n.playlists[0]);e&&(r=e,r.mediaGroups[t][i][u].playlists[0]=r.playlists[o],f=!1)}}),t.minimumUpdatePeriod!==n.minimumUpdatePeriod&&(f=!1),f)?null:r},fkt=function(n,t){var i=Boolean(!n.map&&!t.map),r=i||Boolean(n.map&&t.map&&n.map.byterange.offset===t.map.byterange.offset&&n.map.byterange.length===t.map.byterange.length);return r&&n.uri===t.uri&&n.byterange.offset===t.byterange.offset&&n.byterange.length===t.byterange.length},vft=function(n,t){var u={},f,e,r,i,o;for(f in n)if(e=n[f],r=e.sidx,r){if(i=hw(r),!t[i])break;o=t[i].sidxInfo;fkt(o,r)&&(u[i]=t[i])}return u},ekt=function(n,t){var r=vft(n.playlists,t),i=r;return tl(n,function(n){if(n.playlists&&n.playlists.length){var r=n.playlists;i=aft(i,vft(r,t))}}),i},cw=function(n){function i(t,i,r,u){var f;r===void 0&&(r={});f=n.call(this)||this;f.masterPlaylistLoader_=u||ri(f);u||(f.isMaster_=!0);var e=r,o=e.withCredentials,h=o===void 0?!1:o,s=e.handleManifestRedirects,c=s===void 0?!1:s;if(f.vhs_=i,f.withCredentials=h,f.handleManifestRedirects=c,!t)throw new Error("A non-empty playlist URL or object is required");f.on("minimumUpdatePeriod",function(){f.refreshXml_()});f.on("mediaupdatetimeout",function(){f.refreshMedia_(f.media().id)});return f.state="HAVE_NOTHING",f.loadedPlaylists_={},f.isMaster_?(f.masterPlaylistLoader_.srcUrl=t,f.masterPlaylistLoader_.sidxMapping_={}):f.childPlaylist_=t,f}vi(i,n);var t=i.prototype;return t.requestErrored_=function(n,t,i){return this.request?(this.request=null,n?(this.error=typeof n=="object"&&!(n instanceof Error)?n:{status:t.status,message:"DASH request error at URL: "+t.uri,response:t.response,code:2},i&&(this.state=i),this.trigger("error"),!0):void 0):!0},t.addSidxSegments_=function(n,t,i){var o=this,f=n.sidx&&hw(n.sidx),e,s,r;if(!n.sidx||!f||this.masterPlaylistLoader_.sidxMapping_[f]){this.mediaRequest_=u.setTimeout(function(){return i(!1)},0);return}e=nl(this.handleManifestRedirects,n.sidx.resolvedUri);s=this.masterPlaylistLoader_.sidxMapping_;s[f]={sidxInfo:n.sidx};r=function(r,u){if(!o.requestErrored_(r,u,t)){var e=fyt(hyt(u.response).subarray(8));return s[f].sidx=e,crt(n,e,n.sidx.resolvedUri),i(!0)}};this.request=tkt(e,this.vhs_.xhr,function(t,i,u,f){if(t)return r(t,i);if(!u||u!=="mp4")return r({status:i.status,message:"Unsupported "+(u||"unknown")+" container type for sidx segment at URL: "+e,response:"",playlist:n,internal:!0,blacklistDuration:Infinity,code:2},i);var h=n.sidx.byterange,s=h.offset,c=h.length;if(f.length>=c+s)return r(t,{response:f.subarray(s,s+c),status:i.status,uri:i.uri});o.request=o.vhs_.xhr({uri:e,responseType:"arraybuffer",headers:ow({byterange:n.sidx.byterange})},r)})},t.dispose=function(){this.trigger("dispose");this.stopRequest();this.loadedPlaylists_={};u.clearTimeout(this.minimumUpdatePeriodTimeout_);u.clearTimeout(this.mediaRequest_);u.clearTimeout(this.mediaUpdateTimeout);this.off()},t.hasPendingRequest=function(){return this.request||this.mediaRequest_},t.stopRequest=function(){if(this.request){var n=this.request;this.request=null;n.onreadystatechange=null;n.abort()}},t.media=function(n){var r=this,i,t;if(!n)return this.media_;if(this.state==="HAVE_NOTHING")throw new Error("Cannot switch media playlist from "+this.state);if(i=this.state,typeof n=="string"){if(!this.masterPlaylistLoader_.master.playlists[n])throw new Error("Unknown playlist URI: "+n);n=this.masterPlaylistLoader_.master.playlists[n]}if(t=!this.media_||n.id!==this.media_.id,t&&this.loadedPlaylists_[n.id]&&this.loadedPlaylists_[n.id].endList){this.state="HAVE_METADATA";this.media_=n;t&&(this.trigger("mediachanging"),this.trigger("mediachange"));return}t&&(this.media_&&this.trigger("mediachanging"),this.addSidxSegments_(n,i,function(){r.haveMetadata({startingState:i,playlist:n})}))},t.haveMetadata=function(n){var i=n.startingState,t=n.playlist;this.state="HAVE_METADATA";this.loadedPlaylists_[t.id]=t;this.mediaRequest_=null;this.refreshMedia_(t.id);i==="HAVE_MASTER"?this.trigger("loadedmetadata"):this.trigger("mediachange")},t.pause=function(){this.stopRequest();u.clearTimeout(this.mediaUpdateTimeout);u.clearTimeout(this.minimumUpdatePeriodTimeout_);this.state==="HAVE_NOTHING"&&(this.started=!1)},t.load=function(n){var r=this,t,i;if(u.clearTimeout(this.mediaUpdateTimeout),u.clearTimeout(this.minimumUpdatePeriodTimeout_),t=this.media(),n){i=t?t.targetDuration*500:5e3;this.mediaUpdateTimeout=u.setTimeout(function(){return r.load()},i);return}if(!this.started){this.start();return}t&&!t.endList?this.trigger("mediaupdatetimeout"):this.trigger("loadedplaylist")},t.start=function(){var n=this;if(this.started=!0,!this.isMaster_){this.mediaRequest_=u.setTimeout(function(){return n.haveMaster_()},0);return}this.requestMaster_(function(){n.haveMaster_();n.hasPendingRequest()||n.media_||n.media(n.masterPlaylistLoader_.master.playlists[0])})},t.requestMaster_=function(n){var t=this;this.request=this.vhs_.xhr({uri:this.masterPlaylistLoader_.srcUrl,withCredentials:this.withCredentials},function(i,r){if(t.requestErrored_(i,r)){t.state==="HAVE_NOTHING"&&(t.started=!1);return}var u=r.responseText!==t.masterPlaylistLoader_.masterXml_;if(t.masterPlaylistLoader_.masterXml_=r.responseText,t.masterLoaded_=r.responseHeaders&&r.responseHeaders.date?Date.parse(r.responseHeaders.date):Date.now(),t.masterPlaylistLoader_.srcUrl=nl(t.handleManifestRedirects,t.masterPlaylistLoader_.srcUrl,r),u){t.handleMaster_();t.syncClientServerClock_(function(){return n(r,u)});return}return n(r,u)})},t.syncClientServerClock_=function(n){var i=this,t=ryt(this.masterPlaylistLoader_.masterXml_);if(t===null)return this.masterPlaylistLoader_.clientOffset_=this.masterLoaded_-Date.now(),n();if(t.method==="DIRECT")return this.masterPlaylistLoader_.clientOffset_=t.value-Date.now(),n();this.request=this.vhs_.xhr({uri:eu(this.masterPlaylistLoader_.srcUrl,t.value),method:t.method,withCredentials:this.withCredentials},function(r,u){if(i.request){if(r)return i.masterPlaylistLoader_.clientOffset_=i.masterLoaded_-Date.now(),n();var f;f=t.method==="HEAD"?u.responseHeaders&&u.responseHeaders.date?Date.parse(u.responseHeaders.date):i.masterLoaded_:Date.parse(u.responseText);i.masterPlaylistLoader_.clientOffset_=f-Date.now();n()}})},t.haveMaster_=function(){this.state="HAVE_MASTER";this.isMaster_?this.trigger("loadedplaylist"):this.media_||this.media(this.childPlaylist_)},t.handleMaster_=function(){var n,t,i;return this.mediaRequest_=null,n=rkt({masterXml:this.masterPlaylistLoader_.masterXml_,srcUrl:this.masterPlaylistLoader_.srcUrl,clientOffset:this.masterPlaylistLoader_.clientOffset_,sidxMapping:this.masterPlaylistLoader_.sidxMapping_}),t=this.masterPlaylistLoader_.master,t&&(n=ukt(t,n,this.masterPlaylistLoader_.sidxMapping_)),this.masterPlaylistLoader_.master=n?n:t,i=this.masterPlaylistLoader_.master.locations&&this.masterPlaylistLoader_.master.locations[0],i&&i!==this.masterPlaylistLoader_.srcUrl&&(this.masterPlaylistLoader_.srcUrl=i),(!t||n&&t.minimumUpdatePeriod!==n.minimumUpdatePeriod)&&this.updateMinimumUpdatePeriodTimeout_(),Boolean(n)},t.updateMinimumUpdatePeriodTimeout_=function(){var i=this,n,t;if(u.clearTimeout(this.minimumUpdatePeriodTimeout_),n=function n(t){i.minimumUpdatePeriodTimeout_=u.setTimeout(function(){i.trigger("minimumUpdatePeriod");n(t)},t)},t=this.masterPlaylistLoader_.master&&this.masterPlaylistLoader_.master.minimumUpdatePeriod,t>0)n(t);else if(t===0)if(this.media())n(this.media().targetDuration*1e3);else this.one("loadedplaylist",function(){n(i.media().targetDuration*1e3)})},t.refreshXml_=function(){var n=this;this.requestMaster_(function(t,i){i&&(n.media_&&(n.media_=n.masterPlaylistLoader_.master.playlists[n.media_.id]),n.masterPlaylistLoader_.sidxMapping_=ekt(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.sidxMapping_),n.addSidxSegments_(n.media(),n.state,function(){n.refreshMedia_(n.media().id)}))})},t.refreshMedia_=function(n){var r=this,t,i;if(!n)throw new Error("refreshMedia_ must take a media id");this.media_&&this.isMaster_&&this.handleMaster_();t=this.masterPlaylistLoader_.master.playlists;i=!this.media_||this.media_!==t[n];i?this.media_=t[n]:this.trigger("playlistunchanged");this.media().endList||(this.mediaUpdateTimeout=u.setTimeout(function(){r.trigger("mediaupdatetimeout")},but(this.media(),Boolean(i))));this.trigger("loadedplaylist")},i}(ikt),it={GOAL_BUFFER_LENGTH:30,MAX_GOAL_BUFFER_LENGTH:60,BACK_BUFFER_LENGTH:30,GOAL_BUFFER_LENGTH_RATE:1,INITIAL_BANDWIDTH:4194304,BANDWIDTH_VARIANCE:1.2,BUFFER_LOW_WATER_LINE:0,MAX_BUFFER_LOW_WATER_LINE:30,EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:16,BUFFER_LOW_WATER_LINE_RATE:1,BUFFER_HIGH_WATER_LINE:30},yft=function(n){for(var i=new Uint8Array(new ArrayBuffer(n.length)),t=0;t<n.length;t++)i[t]=n.charCodeAt(t);return i.buffer},ns=[],hi,okt=function(n,t,i){var r=n.data.segment,h=r.type,e=r.initSegment,c=r.captions,l=r.captionStreams,a=r.metadata,o=r.videoFrameDtsTime,s=r.videoFramePtsTime,u,f;t.buffer.push({captions:c,captionStreams:l,metadata:a});u=n.data.segment.boxes||{data:n.data.segment.data};f={type:h,data:new Uint8Array(u.data,u.data.byteOffset,u.data.byteLength),initSegment:new Uint8Array(e.data,e.byteOffset,e.byteLength)};typeof o!="undefined"&&(f.videoFrameDtsTime=o);typeof s!="undefined"&&(f.videoFramePtsTime=s);i(f)},skt=function(n){var t=n.transmuxedData,i=n.callback;t.buffer=[];i(t)},hkt=function(n,t){t.gopInfo=n.data.gopInfo},pft=function(n){var t=n.transmuxer,i=n.bytes,f=n.audioAppendStart,e=n.gopsToAlignWith,o=n.isPartial,s=n.remux,c=n.onData,l=n.onTrackInfo,a=n.onAudioTimingInfo,v=n.onVideoTimingInfo,y=n.onVideoSegmentTimingInfo,p=n.onAudioSegmentTimingInfo,w=n.onId3,b=n.onCaptions,k=n.onDone,r={isPartial:o,buffer:[]},d=function(n){hi&&(n.data.action==="data"&&okt(n,r,c),n.data.action==="trackinfo"&&l(n.data.trackInfo),n.data.action==="gopInfo"&&hkt(n,r),n.data.action==="audioTimingInfo"&&a(n.data.audioTimingInfo),n.data.action==="videoTimingInfo"&&v(n.data.videoTimingInfo),n.data.action==="videoSegmentTimingInfo"&&y(n.data.videoSegmentTimingInfo),n.data.action==="audioSegmentTimingInfo"&&p(n.data.audioSegmentTimingInfo),n.data.action==="id3Frame"&&w([n.data.id3Frame],n.data.id3Frame.dispatchType),n.data.action==="caption"&&b(n.data.caption),n.data.type==="transmuxed")&&(t.onmessage=null,skt({transmuxedData:r,callback:k}),wft())},u,h;t.onmessage=d;f&&t.postMessage({action:"setAudioAppendStart",appendStart:f});Array.isArray(e)&&t.postMessage({action:"alignGopsWith",gopsToAlignWith:e});typeof s!="undefined"&&t.postMessage({action:"setRemux",remux:s});i.byteLength&&(u=i instanceof ArrayBuffer?i:i.buffer,h=i instanceof ArrayBuffer?0:i.byteOffset,t.postMessage({action:"push",data:u,byteOffset:h,byteLength:i.byteLength},[u]));t.postMessage({action:o?"partialFlush":"flush"})},wft=function(){hi=null;ns.length&&(hi=ns.shift(),typeof hi=="function"?hi():pft(hi))},bft=function(n,t){n.postMessage({action:t});wft()},kft=function(n,t){if(!hi){hi=n;bft(t,n);return}ns.push(bft.bind(null,t,n))},ckt=function(n){kft("reset",n)},lkt=function(n){kft("endTimeline",n)},dft=function(n){if(!hi){hi=n;pft(n);return}ns.push(n)},akt=function(){hi=null;ns.length=0},ul={reset:ckt,dispose:akt,endTimeline:lkt,transmux:dft},vkt=function(n,t){var i=ppt.inspect(n,t*po),r;return i?(r={hasVideo:i.video&&i.video.length===2||!1,hasAudio:i.audio&&i.audio.length===2||!1},r.hasVideo&&(r.videoStart=i.video[0].ptsTime),r.hasAudio&&(r.audioStart=i.audio[0].ptsTime),r):null},ykt=function(n){var i=0,t;return n.bytes&&(t=new Uint8Array(n.bytes),n.segments.forEach(function(n){t.set(n,i);i+=n.byteLength})),t},ci={FAILURE:2,TIMEOUT:-101,ABORTED:-102},gft=function(n){n.forEach(function(n){n.abort()})},pkt=function(n){return{bandwidth:n.bandwidth,bytesReceived:n.bytesReceived||0,roundTripTime:n.roundTripTime||0}},wkt=function(n){var i=n.target,r=Date.now()-i.requestTime,t={bandwidth:Infinity,bytesReceived:0,roundTripTime:r||0};return t.bytesReceived=n.loaded,t.bandwidth=Math.floor(t.bytesReceived/t.roundTripTime*8e3),t},lw=function(n,t){return t.timedout?{status:t.status,message:"HLS request timed-out at URL: "+t.uri,code:ci.TIMEOUT,xhr:t}:t.aborted?{status:t.status,message:"HLS request aborted at URL: "+t.uri,code:ci.ABORTED,xhr:t}:n?{status:t.status,message:"HLS request errored at URL: "+t.uri,code:ci.FAILURE,xhr:t}:null},bkt=function(n,t){return function(i,r){var f=r.response,e=lw(i,r),u;return e?t(e,n):f.byteLength!==16?t({status:r.status,message:"Invalid HLS key at URL: "+r.uri,code:ci.FAILURE,xhr:r},n):(u=new DataView(f),n.key.bytes=new Uint32Array([u.getUint32(0),u.getUint32(4),u.getUint32(8),u.getUint32(12)]),t(null,n))}},kkt=function(n){var t=n.segment,i=n.finishProcessingFn;return function(n,r){var o=r.response,f=lw(n,r),u,e;return f?i(f,t):o.byteLength===0?i({status:r.status,message:"Empty HLS segment content at URL: "+r.uri,code:ci.FAILURE,xhr:r},t):(t.map.bytes=new Uint8Array(r.response),u=hp(t.map.bytes),u!=="mp4")?i({status:r.status,message:"Found unsupported "+(u||"unknown")+" container for initialization segment at URL: "+r.uri,code:ci.FAILURE,internal:!0,xhr:r},t):(e=kp.tracks(t.map.bytes),e.forEach(function(n){(t.map.tracks=t.map.tracks||{},t.map.tracks[n.type])||(t.map.tracks[n.type]=n,typeof n.id=="number"&&n.timescale&&(t.map.timescales=t.map.timescales||{},t.map.timescales[n.id]=n.timescale))}),i(null,t))}},dkt=function(n){var t=n.segment,i=n.finishProcessingFn,r=n.responseType;return function(n,u){var o=u.response,e=lw(n,u),f;return e?i(e,t):(f=r==="arraybuffer"||!u.responseText?u.response:yft(u.responseText.substring(t.lastReachedChar||0)),o.byteLength===0)?i({status:u.status,message:"Empty HLS segment content at URL: "+u.uri,code:ci.FAILURE,xhr:u},t):(t.stats=pkt(u),t.key?t.encryptedBytes=new Uint8Array(f):t.bytes=new Uint8Array(f),i(null,t))}},gkt=function(n){var t=n.segment,h=n.bytes,s=n.isPartial,f=n.trackInfoFn,e=n.timingInfoFn,y=n.videoSegmentTimingInfoFn,p=n.audioSegmentTimingInfoFn,w=n.id3Fn,b=n.captionsFn,k=n.dataFn,c=n.doneFn,l=t.map&&t.map.tracks||{},o=Boolean(l.audio&&l.video),r=e.bind(null,t,"audio","start"),a=e.bind(null,t,"audio","end"),u=e.bind(null,t,"video","start"),v=e.bind(null,t,"video","end"),i;s||t.lastReachedChar||(i=vkt(h,t.baseStartTime),i&&(f(t,{hasAudio:i.hasAudio,hasVideo:i.hasVideo,isMuxed:o}),f=null,i.hasAudio&&!o&&r(i.audioStart),i.hasVideo&&u(i.videoStart),r=null,u=null));dft({bytes:h,transmuxer:t.transmuxer,audioAppendStart:t.audioAppendStart,gopsToAlignWith:t.gopsToAlignWith,isPartial:s,remux:o,onData:function(n){n.type=n.type==="combined"?"video":n.type;k(t,n)},onTrackInfo:function(n){f&&(o&&(n.isMuxed=!0),f(t,n))},onAudioTimingInfo:function(n){r&&typeof n.start!="undefined"&&(r(n.start),r=null);a&&typeof n.end!="undefined"&&a(n.end)},onVideoTimingInfo:function(n){u&&typeof n.start!="undefined"&&(u(n.start),u=null);v&&typeof n.end!="undefined"&&v(n.end)},onVideoSegmentTimingInfo:function(n){y(n)},onAudioSegmentTimingInfo:function(n){p(n)},onId3:function(n,i){w(t,n,i)},onCaptions:function(n){b(t,[n])},onDone:function(n){c&&!s&&(n.type=n.type==="combined"?"video":n.type,c(null,t,n))}})},aw=function(n){var t=n.segment,r=n.bytes,p=n.isPartial,e=n.trackInfoFn,o=n.timingInfoFn,w=n.videoSegmentTimingInfoFn,b=n.audioSegmentTimingInfoFn,k=n.id3Fn,l=n.captionsFn,a=n.dataFn,f=n.doneFn,s=new Uint8Array(r),i,u,h,c;if(art(s)){if(t.isFmp4=!0,i=t.map.tracks,u={isFmp4:!0,hasVideo:!!i.video,hasAudio:!!i.audio},i.audio&&i.audio.codec&&i.audio.codec!=="enca"&&(u.audioCodec=i.audio.codec),i.video&&i.video.codec&&i.video.codec!=="encv"&&(u.videoCodec=i.video.codec),i.video&&i.audio&&(u.isMuxed=!0),e(t,u),h=kp.startTime(t.map.timescales,s),u.hasAudio&&!u.isMuxed&&o(t,"audio","start",h),u.hasVideo&&o(t,"video","start",h),c=function(n){a(t,{data:r,type:u.hasAudio&&!u.isMuxed?"audio":"video"});n&&n.length&&l(t,n);f(null,t,{})},!i.video||!r.byteLength||!t.transmuxer){c();return}var v=r instanceof ArrayBuffer?r:r.buffer,d=r instanceof ArrayBuffer?0:r.byteOffset,y=function y(n){if(n.data.action==="mp4Captions"){t.transmuxer.removeEventListener("message",y);var i=n.data.data;t.bytes=r=new Uint8Array(i,i.byteOffset||0,i.byteLength);c(n.data.captions)}};t.transmuxer.addEventListener("message",y);t.transmuxer.postMessage({action:"pushMp4Captions",timescales:t.map.timescales,trackIds:[i.video.id],data:v,byteOffset:d,byteLength:r.byteLength},[v]);return}if(!t.transmuxer){f(null,t,{});return}if(typeof t.container=="undefined"&&(t.container=hp(s)),t.container!=="ts"&&t.container!=="aac"){e(t,{hasAudio:!1,hasVideo:!1});f(null,t,{});return}gkt({segment:t,bytes:r,isPartial:p,trackInfoFn:e,timingInfoFn:o,videoSegmentTimingInfoFn:w,audioSegmentTimingInfoFn:b,id3Fn:k,captionsFn:l,dataFn:a,doneFn:f})},ndt=function(n){var i=n.decryptionWorker,t=n.segment,f=n.trackInfoFn,e=n.timingInfoFn,o=n.videoSegmentTimingInfoFn,s=n.audioSegmentTimingInfoFn,h=n.id3Fn,c=n.captionsFn,l=n.dataFn,a=n.doneFn,u=function u(n){if(n.data.source===t.requestId){i.removeEventListener("message",u);var r=n.data.decrypted;t.bytes=new Uint8Array(r.bytes,r.byteOffset,r.byteLength);aw({segment:t,bytes:t.bytes,isPartial:!1,trackInfoFn:f,timingInfoFn:e,videoSegmentTimingInfoFn:o,audioSegmentTimingInfoFn:s,id3Fn:h,captionsFn:c,dataFn:l,doneFn:a})}},r;i.addEventListener("message",u);r=t.key.bytes.slice?t.key.bytes.slice():new Uint32Array(Array.prototype.slice.call(t.key.bytes));i.postMessage(oft({source:t.requestId,encrypted:t.encryptedBytes,key:r,iv:t.key.iv}),[t.encryptedBytes.buffer,r.buffer])},tdt=function(n){var i=n.activeXhrs,a=n.decryptionWorker,r=n.trackInfoFn,u=n.timingInfoFn,f=n.videoSegmentTimingInfoFn,e=n.audioSegmentTimingInfoFn,o=n.id3Fn,s=n.captionsFn,h=n.dataFn,t=n.doneFn,c=0,l=!1;return function(n,v){if(!l){if(n)return l=!0,gft(i),t(n,v);if(c+=1,c===i.length){if(v.endOfAllRequests=Date.now(),v.encryptedBytes)return ndt({decryptionWorker:a,segment:v,trackInfoFn:r,timingInfoFn:u,videoSegmentTimingInfoFn:f,audioSegmentTimingInfoFn:e,id3Fn:o,captionsFn:s,dataFn:h,doneFn:t});aw({segment:v,bytes:v.bytes,isPartial:!1,trackInfoFn:r,timingInfoFn:u,videoSegmentTimingInfoFn:f,audioSegmentTimingInfoFn:e,id3Fn:o,captionsFn:s,dataFn:h,doneFn:t})}}}},idt=function(n){var t=n.loadendState,i=n.abortFn;return function(n){var r=n.target;r.aborted&&i&&!t.calledAbortFn&&(i(),t.calledAbortFn=!0)}},rdt=function(t){var i=t.segment,r=t.progressFn,u=t.trackInfoFn,f=t.timingInfoFn,e=t.videoSegmentTimingInfoFn,o=t.audioSegmentTimingInfoFn,s=t.id3Fn,h=t.captionsFn,c=t.dataFn,l=t.handlePartialData;return function(t){var a=t.target,v;if(!a.aborted)return l&&!i.key&&a.responseText&&a.responseText.length>=8&&(v=yft(a.responseText.substring(i.lastReachedChar||0)),(i.lastReachedChar||!art(new Uint8Array(v)))&&(i.lastReachedChar=a.responseText.length,aw({segment:i,bytes:v,isPartial:!0,trackInfoFn:u,timingInfoFn:f,videoSegmentTimingInfoFn:e,audioSegmentTimingInfoFn:o,id3Fn:s,captionsFn:h,dataFn:c}))),i.stats=n.mergeOptions(i.stats,wkt(t)),!i.stats.firstBytesReceivedAt&&i.stats.bytesReceived&&(i.stats.firstBytesReceivedAt=Date.now()),r(t,i)}},udt=function(t){var f=t.xhr,e=t.xhrOptions,d=t.decryptionWorker,i=t.segment,g=t.abortFn,nt=t.progressFn,h=t.trackInfoFn,c=t.timingInfoFn,l=t.videoSegmentTimingInfoFn,a=t.audioSegmentTimingInfoFn,v=t.id3Fn,y=t.captionsFn,p=t.dataFn,tt=t.doneFn,w=t.handlePartialData,r=[],o=tdt({activeXhrs:r,decryptionWorker:d,trackInfoFn:h,timingInfoFn:c,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:a,id3Fn:v,captionsFn:y,dataFn:p,doneFn:tt}),u,b,s,k;if(i.key&&!i.key.bytes){var it=n.mergeOptions(e,{uri:i.key.resolvedUri,responseType:"arraybuffer"}),rt=bkt(i,o),ut=f(it,rt);r.push(ut)}if(i.map&&!i.map.bytes){var ft=n.mergeOptions(e,{uri:i.map.resolvedUri,responseType:"arraybuffer",headers:ow(i.map)}),et=kkt({segment:i,finishProcessingFn:o}),ot=f(ft,et);r.push(ot)}return u=n.mergeOptions(e,{uri:i.resolvedUri,responseType:"arraybuffer",headers:ow(i)}),w&&(u.responseType="text",u.beforeSend=function(n){n.overrideMimeType("text/plain; charset=x-user-defined")}),b=dkt({segment:i,finishProcessingFn:o,responseType:u.responseType}),s=f(u,b),s.addEventListener("progress",rdt({segment:i,progressFn:nt,trackInfoFn:h,timingInfoFn:c,videoSegmentTimingInfoFn:l,audioSegmentTimingInfoFn:a,id3Fn:v,captionsFn:y,dataFn:p,handlePartialData:w})),r.push(s),k={},r.forEach(function(n){n.addEventListener("loadend",idt({loadendState:k,abortFn:g}))}),function(){return gft(r)}},su=typeof window!="undefined"?window:{},vw=typeof Symbol=="undefined"?"__target":Symbol(),fdt="application/javascript",edt=su.BlobBuilder||su.WebKitBlobBuilder||su.MozBlobBuilder||su.MSBlobBuilder,ne=su.URL||su.webkitURL||ne&&ne.msURL,te=su.Worker;if(te){yw=tet("self.onmessage = function () {}");pw=new Uint8Array(1);try{fl=new te(yw);fl.postMessage(pw,[pw.buffer])}catch(pfi){te=null}finally{ne.revokeObjectURL(yw);fl&&fl.terminate()}}var sdt=new net("./transmuxer-worker.worker.js",function(){var n=this,t=function(){var b=function(){this.init=function(){var n={};this.on=function(t,i){n[t]||(n[t]=[]);n[t]=n[t].concat(i)};this.off=function(t,i){var r;return n[t]?(r=n[t].indexOf(i),n[t]=n[t].slice(),n[t].splice(r,1),r>-1):!1};this.trigger=function(t){var r,i,u,f;if(r=n[t],r)if(arguments.length===2)for(u=r.length,i=0;i<u;++i)r[i].call(this,arguments[1]);else{for(f=[],i=arguments.length,i=1;i<arguments.length;++i)f.push(arguments[i]);for(u=r.length,i=0;i<u;++i)r[i].apply(this,f)}};this.dispose=function(){n={}}}},o,ei,r,fr,er,oi,or,sr,hr,cr,si,lr,ar,vr,yr,pr,wr,br,kr,dr,gr,nu,tu,hi,t,ci,iu,ru,uu,fu,eu,ou,su,hu,ot,cu,lu,au,ht,f,gi,kt,rt,rf,uf,gt,ut,ff,ir,fi;b.prototype.pipe=function(n){this.on("data",function(t){n.push(t)});this.on("done",function(t){n.flush(t)});this.on("partialdone",function(t){n.partialFlush(t)});this.on("endedtimeline",function(t){n.endTimeline(t)});this.on("reset",function(t){n.reset(t)});return n};b.prototype.push=function(n){this.trigger("data",n)};b.prototype.flush=function(n){this.trigger("done",n)};b.prototype.partialFlush=function(n){this.trigger("partialdone",n)};b.prototype.endTimeline=function(n){this.trigger("endedtimeline",n)};b.prototype.reset=function(n){this.trigger("reset",n)};o=b;ei=Math.pow(2,32)-1,function(){var n;if(t={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],pasp:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]},typeof Uint8Array!="undefined"){for(n in t)t.hasOwnProperty(n)&&(t[n]=[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3)]);ci=new Uint8Array(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]);ru=new Uint8Array(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]);iu=new Uint8Array([0,0,0,1]);uu=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]);fu=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);eu={video:uu,audio:fu};hu=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]);su=new Uint8Array([0,0,0,0,0,0,0,0]);ot=new Uint8Array([0,0,0,0,0,0,0,0]);cu=ot;lu=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]);au=ot;ou=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}}();r=function(n){for(var r=[],u=0,i,f,t=1;t<arguments.length;t++)r.push(arguments[t]);for(t=r.length;t--;)u+=r[t].byteLength;for(i=new Uint8Array(u+8),f=new DataView(i.buffer,i.byteOffset,i.byteLength),f.setUint32(0,i.byteLength),i.set(n,4),t=0,u=8;t<r.length;t++)i.set(r[t],u),u+=r[t].byteLength;return i};fr=function(){return r(t.dinf,r(t.dref,hu))};er=function(n){return r(t.esds,new Uint8Array([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,n.audioobjecttype<<3|n.samplingfrequencyindex>>>1,n.samplingfrequencyindex<<7|n.channelcount<<3,6,1,2]))};oi=function(){return r(t.ftyp,ci,iu,ci,ru)};br=function(n){return r(t.hdlr,eu[n])};or=function(n){return r(t.mdat,n)};wr=function(n){var i=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,n.duration>>>24&255,n.duration>>>16&255,n.duration>>>8&255,n.duration&255,85,196,0,0]);return n.samplerate&&(i[12]=n.samplerate>>>24&255,i[13]=n.samplerate>>>16&255,i[14]=n.samplerate>>>8&255,i[15]=n.samplerate&255),r(t.mdhd,i)};pr=function(n){return r(t.mdia,wr(n),br(n.type),hr(n))};sr=function(n){return r(t.mfhd,new Uint8Array([0,0,0,0,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255]))};hr=function(n){return r(t.minf,n.type==="video"?r(t.vmhd,ou):r(t.smhd,su),fr(),dr(n))};cr=function(n,i){for(var f=[],u=i.length;u--;)f[u]=nu(i[u]);return r.apply(null,[t.moof,sr(n)].concat(f))};si=function(n){for(var i=n.length,u=[];i--;)u[i]=vr(n[i]);return r.apply(null,[t.moov,ar(4294967295)].concat(u).concat(lr(n)))};lr=function(n){for(var i=n.length,u=[];i--;)u[i]=tu(n[i]);return r.apply(null,[t.mvex].concat(u))};ar=function(n){var i=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(n&4278190080)>>24,(n&16711680)>>16,(n&65280)>>8,n&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return r(t.mvhd,i)};kr=function(n){for(var f=n.samples||[],e=new Uint8Array(4+f.length),u,i=0;i<f.length;i++)u=f[i].flags,e[i+4]=u.dependsOn<<4|u.isDependedOn<<2|u.hasRedundancy;return r(t.sdtp,e)};dr=function(n){return r(t.stbl,gr(n),r(t.stts,au),r(t.stsc,cu),r(t.stsz,lu),r(t.stco,ot))},function(){var n,i;gr=function(u){return r(t.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),u.type==="video"?n(u):i(u))};n=function(n){for(var u=n.sps||[],f=n.pps||[],e=[],o=[],c,s,h,i=0;i<u.length;i++)e.push((u[i].byteLength&65280)>>>8),e.push(u[i].byteLength&255),e=e.concat(Array.prototype.slice.call(u[i]));for(i=0;i<f.length;i++)o.push((f[i].byteLength&65280)>>>8),o.push(f[i].byteLength&255),o=o.concat(Array.prototype.slice.call(f[i]));return c=[t.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(n.width&65280)>>8,n.width&255,(n.height&65280)>>8,n.height&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),r(t.avcC,new Uint8Array([1,n.profileIdc,n.profileCompatibility,n.levelIdc,255].concat([u.length],e,[f.length],o))),r(t.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192]))],n.sarRatio&&(s=n.sarRatio[0],h=n.sarRatio[1],c.push(r(t.pasp,new Uint8Array([(s&4278190080)>>24,(s&16711680)>>16,(s&65280)>>8,s&255,(h&4278190080)>>24,(h&16711680)>>16,(h&65280)>>8,h&255])))),r.apply(null,c)};i=function(n){return r(t.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(n.channelcount&65280)>>8,n.channelcount&255,(n.samplesize&65280)>>8,n.samplesize&255,0,0,0,0,(n.samplerate&65280)>>8,n.samplerate&255,0,0]),er(n))}}();yr=function(n){var i=new Uint8Array([0,0,0,7,0,0,0,0,0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,0,(n.duration&4278190080)>>24,(n.duration&16711680)>>16,(n.duration&65280)>>8,n.duration&255,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(n.width&65280)>>8,n.width&255,0,0,(n.height&65280)>>8,n.height&255,0,0]);return r(t.tkhd,i)};nu=function(n){var e,o,f,s,h,i,u;return(e=r(t.tfhd,new Uint8Array([0,0,0,58,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),i=Math.floor(n.baseMediaDecodeTime/(ei+1)),u=Math.floor(n.baseMediaDecodeTime%(ei+1)),o=r(t.tfdt,new Uint8Array([1,0,0,0,i>>>24&255,i>>>16&255,i>>>8&255,i&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255])),h=92,n.type==="audio")?(f=hi(n,h),r(t.traf,e,o,f)):(s=kr(n),f=hi(n,s.length+h),r(t.traf,e,o,f,s))};vr=function(n){return n.duration=n.duration||4294967295,r(t.trak,yr(n),pr(n))};tu=function(n){var i=new Uint8Array([0,0,0,0,(n.id&4278190080)>>24,(n.id&16711680)>>16,(n.id&65280)>>8,n.id&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return n.type!=="video"&&(i[i.length-1]=0),r(t.trex,i)},function(){var i,u,n;n=function(n,t){var i=0,r=0,u=0,f=0;return n.length&&(n[0].duration!==undefined&&(i=1),n[0].size!==undefined&&(r=2),n[0].flags!==undefined&&(u=4),n[0].compositionTimeOffset!==undefined&&(f=8)),[0,0,i|r|u|f,1,(n.length&4278190080)>>>24,(n.length&16711680)>>>16,(n.length&65280)>>>8,n.length&255,(t&4278190080)>>>24,(t&16711680)>>>16,(t&65280)>>>8,t&255]};u=function(i,u){var o,e,h,s,f,c;for(s=i.samples||[],u+=20+16*s.length,h=n(s,u),e=new Uint8Array(h.length+s.length*16),e.set(h),o=h.length,c=0;c<s.length;c++)f=s[c],e[o++]=(f.duration&4278190080)>>>24,e[o++]=(f.duration&16711680)>>>16,e[o++]=(f.duration&65280)>>>8,e[o++]=f.duration&255,e[o++]=(f.size&4278190080)>>>24,e[o++]=(f.size&16711680)>>>16,e[o++]=(f.size&65280)>>>8,e[o++]=f.size&255,e[o++]=f.flags.isLeading<<2|f.flags.dependsOn,e[o++]=f.flags.isDependedOn<<6|f.flags.hasRedundancy<<4|f.flags.paddingValue<<1|f.flags.isNonSyncSample,e[o++]=f.flags.degradationPriority&61440,e[o++]=f.flags.degradationPriority&15,e[o++]=(f.compositionTimeOffset&4278190080)>>>24,e[o++]=(f.compositionTimeOffset&16711680)>>>16,e[o++]=(f.compositionTimeOffset&65280)>>>8,e[o++]=f.compositionTimeOffset&255;return r(t.trun,e)};i=function(i,u){var f,e,h,s,o,c;for(s=i.samples||[],u+=20+8*s.length,h=n(s,u),f=new Uint8Array(h.length+s.length*8),f.set(h),e=h.length,c=0;c<s.length;c++)o=s[c],f[e++]=(o.duration&4278190080)>>>24,f[e++]=(o.duration&16711680)>>>16,f[e++]=(o.duration&65280)>>>8,f[e++]=o.duration&255,f[e++]=(o.size&4278190080)>>>24,f[e++]=(o.size&16711680)>>>16,f[e++]=(o.size&65280)>>>8,f[e++]=o.size&255;return r(t.trun,f)};hi=function(n,t){return n.type==="audio"?i(n,t):u(n,t)}}();var a={ftyp:oi,mdat:or,moof:cr,moov:si,initSegment:function(n){var i=oi(),r=si(n),t;return t=new Uint8Array(i.byteLength+r.byteLength),t.set(i),t.set(r,i.byteLength),t}},gf=function(n){var u,r,t=[],i=[];for(i.byteLength=0,i.nalCount=0,i.duration=0,t.byteLength=0,u=0;u<n.length;u++)r=n[u],r.nalUnitType==="access_unit_delimiter_rbsp"?(t.length&&(t.duration=r.dts-t.dts,i.byteLength+=t.byteLength,i.nalCount+=t.length,i.duration+=t.duration,i.push(t)),t=[r],t.byteLength=r.data.byteLength,t.pts=r.pts,t.dts=r.dts):(r.nalUnitType==="slice_layer_without_partitioning_rbsp_idr"&&(t.keyFrame=!0),t.duration=r.dts-t.dts,t.byteLength+=r.data.byteLength,t.push(r));return i.length&&(!t.duration||t.duration<=0)&&(t.duration=i[i.length-1].duration),i.byteLength+=t.byteLength,i.nalCount+=t.length,i.duration+=t.duration,i.push(t),i},ne=function(n){var u,r,t=[],i=[];for(t.byteLength=0,t.nalCount=0,t.duration=0,t.pts=n[0].pts,t.dts=n[0].dts,i.byteLength=0,i.nalCount=0,i.duration=0,i.pts=n[0].pts,i.dts=n[0].dts,u=0;u<n.length;u++)r=n[u],r.keyFrame?(t.length&&(i.push(t),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration),t=[r],t.nalCount=r.length,t.byteLength=r.byteLength,t.pts=r.pts,t.dts=r.dts,t.duration=r.duration):(t.duration+=r.duration,t.nalCount+=r.length,t.byteLength+=r.byteLength,t.push(r));return i.length&&t.duration<=0&&(t.duration=i[i.length-1].duration),i.byteLength+=t.byteLength,i.nalCount+=t.nalCount,i.duration+=t.duration,i.push(t),i},te=function(n){var t;return!n[0][0].keyFrame&&n.length>1&&(t=n.shift(),n.byteLength-=t.byteLength,n.nalCount-=t.nalCount,n[0][0].dts=t.dts,n[0][0].pts=t.pts,n[0][0].duration+=t.duration),n},ie=function(){return{size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0,isNonSyncSample:1}}},vu=function(n,t){var i=ie();return i.dataOffset=t,i.compositionTimeOffset=n.pts-n.dts,i.duration=n.duration,i.size=4*n.length,i.size+=n.byteLength,n.keyFrame&&(i.flags.dependsOn=2,i.flags.isNonSyncSample=0),i},re=function(n,t){for(var r,u,f,e,o=t||0,s=[],i=0;i<n.length;i++)for(f=n[i],r=0;r<f.length;r++)e=f[r],u=vu(e,o),o+=u.size,s.push(u);return s},ue=function(n){for(var i,r,e,o,u,f=0,h=n.byteLength,c=n.nalCount,l=h+4*c,s=new Uint8Array(l),a=new DataView(s.buffer),t=0;t<n.length;t++)for(e=n[t],i=0;i<e.length;i++)for(o=e[i],r=0;r<o.length;r++)u=o[r],a.setUint32(f,u.data.byteLength),f+=4,s.set(u.data,f),f+=u.data.byteLength;return s},fe=function(n,t){var i,u=t||0,r=[];return i=vu(n,u),r.push(i),r},ee=function(n){for(var i,r=0,f=n.byteLength,e=n.length,o=f+4*e,u=new Uint8Array(o),s=new DataView(u.buffer),t=0;t<n.length;t++)i=n[t],s.setUint32(r,i.data.byteLength),r+=4,u.set(i.data,r),r+=i.data.byteLength;return u},v={groupNalsIntoFrames:gf,groupFramesIntoGops:ne,extendFirstKeyFrame:te,generateSampleTable:re,concatenateNalData:ue,generateSampleTableForFrame:fe,concatenateNalDataForFrame:ee},p=[33,16,5,32,164,27],li=[33,65,108,84,1,2,4,8,168,2,4,8,17,191,252],u=function(n){for(var t=[];n--;)t.push(0);return t},oe=function(n){return Object.keys(n).reduce(function(t,i){return t[i]=new Uint8Array(n[i].reduce(function(n,t){return n.concat(t)},[])),t},{})},ai,se=function(){if(!ai){var n={96e3:[p,[227,64],u(154),[56]],88200:[p,[231],u(170),[56]],64e3:[p,[248,192],u(240),[56]],48e3:[p,[255,192],u(268),[55,148,128],u(54),[112]],44100:[p,[255,192],u(268),[55,163,128],u(84),[112]],32e3:[p,[255,192],u(268),[55,234],u(226),[112]],24e3:[p,[255,192],u(268),[55,255,128],u(268),[111,112],u(126),[224]],16e3:[p,[255,192],u(268),[55,255,128],u(268),[111,255],u(269),[223,108],u(195),[1,192]],12e3:[li,u(268),[3,127,248],u(268),[6,255,240],u(268),[13,255,224],u(268),[27,253,128],u(259),[56]],11025:[li,u(268),[3,127,248],u(268),[6,255,240],u(268),[13,255,224],u(268),[27,255,192],u(268),[55,175,128],u(108),[112]],8e3:[li,u(268),[3,121,16],u(47),[7]]};ai=oe(n)}return ai},vi=9e4,yi,pi,st,wi,yu,pu,wu;yi=function(n){return n*vi};pi=function(n,t){return n*t};st=function(n){return n/vi};wi=function(n,t){return n/t};yu=function(n,t){return yi(wi(n,t))};pu=function(n,t){return pi(st(n),t)};wu=function(n,t,i){return st(i?n:n-t)};var i={ONE_SECOND_IN_TS:vi,secondsToVideoTs:yi,secondsToAudioTs:pi,videoTsToSeconds:st,audioTsToSeconds:wi,audioTsToVideoTs:yu,videoTsToAudioTs:pu,metadataTsToSeconds:wu},he=function(n){for(var i,r=0,t=0;t<n.length;t++)i=n[t],r+=i.data.byteLength;return r},ce=function(n,t,r,u){var l,f=0,a=0,e=0,o=0,s,h,c;if(t.length&&(l=i.audioTsToVideoTs(n.baseMediaDecodeTime,n.samplerate),f=Math.ceil(i.ONE_SECOND_IN_TS/(n.samplerate/1024)),r&&u&&(a=l-Math.max(r,u),e=Math.floor(a/f),o=e*f),!(e<1)&&!(o>i.ONE_SECOND_IN_TS/2))){for(s=se()[n.samplerate],s||(s=t[0].data),h=0;h<e;h++)c=t[0],t.splice(0,0,{data:s,dts:c.dts-f,pts:c.pts-f});return n.baseMediaDecodeTime-=Math.floor(i.videoTsToAudioTs(o,n.samplerate)),o}},le=function(n,t,i){return t.minSegmentDts>=i?n:(t.minSegmentDts=Infinity,n.filter(function(n){return n.dts>=i?(t.minSegmentDts=Math.min(t.minSegmentDts,n.dts),t.minSegmentPts=t.minSegmentDts,!0):!1}))},ae=function(n){for(var i,r=[],t=0;t<n.length;t++)i=n[t],r.push({size:i.data.byteLength,duration:1024});return r},ve=function(n){for(var i,r=0,u=new Uint8Array(he(n)),t=0;t<n.length;t++)i=n[t],u.set(i.data,r),r+=i.data.byteLength;return u},w={prefixWithSilence:ce,trimAdtsFramesByEarliestDts:le,generateSampleTable:ae,concatenateFrameData:ve},ye=i.ONE_SECOND_IN_TS,pe=function(n,t){typeof t.pts=="number"&&(n.timelineStartInfo.pts===undefined&&(n.timelineStartInfo.pts=t.pts),n.minSegmentPts=n.minSegmentPts===undefined?t.pts:Math.min(n.minSegmentPts,t.pts),n.maxSegmentPts=n.maxSegmentPts===undefined?t.pts:Math.max(n.maxSegmentPts,t.pts));typeof t.dts=="number"&&(n.timelineStartInfo.dts===undefined&&(n.timelineStartInfo.dts=t.dts),n.minSegmentDts=n.minSegmentDts===undefined?t.dts:Math.min(n.minSegmentDts,t.dts),n.maxSegmentDts=n.maxSegmentDts===undefined?t.dts:Math.max(n.maxSegmentDts,t.dts))},we=function(n){delete n.minSegmentDts;delete n.maxSegmentDts;delete n.minSegmentPts;delete n.maxSegmentPts},be=function(n,t){var i,r,u=n.minSegmentDts;return t||(u-=n.timelineStartInfo.dts),i=n.timelineStartInfo.baseMediaDecodeTime,i+=u,i=Math.max(0,i),n.type==="audio"&&(r=n.samplerate/ye,i*=r,i=Math.floor(i)),i},s={clearDtsInfo:we,calculateTrackBaseMediaDecodeTime:be,collectDtsInfo:pe},bu=4,ke=128,de=function(n){for(var t=0,i={payloadType:-1,payloadSize:0},u=0,r=0,f;t<n.byteLength;){if(n[t]===ke)break;while(n[t]===255)u+=255,t++;for(u+=n[t++];n[t]===255;)r+=255,t++;if(r+=n[t++],!i.payload&&u===bu)if(f=String.fromCharCode(n[t+3],n[t+4],n[t+5],n[t+6]),f==="GA94"){i.payloadType=u;i.payloadSize=r;i.payload=n.subarray(t,t+r);break}else i.payload=void 0;t+=r;u=0;r=0}return i},ge=function(n){return n.payload[0]!==181?null:(n.payload[1]<<8|n.payload[2])!=49?null:String.fromCharCode(n.payload[3],n.payload[4],n.payload[5],n.payload[6])!=="GA94"?null:n.payload[7]!==3?null:n.payload.subarray(8,n.payload.length-1)},no=function(n,t){var u=[],r,e,i,f;if(!(t[0]&64))return u;for(e=t[0]&31,r=0;r<e;r++)i=r*3,f={type:t[i+2]&3,pts:n},t[i+2]&4&&(f.ccData=t[i+3]<<8|t[i+4],u.push(f));return u},to=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f},tt={parseSei:de,parseUserData:ge,parseCaptionPackets:no,discardEmulationPreventionBytes:to,USER_DATA_REGISTERED_ITU_T_T35:bu},c=function c(){c.prototype.init.call(this);this.captionPackets_=[];this.ccStreams_=[new e(0,0),new e(0,1),new e(1,0),new e(1,1)];this.cc708Stream_=new f;this.reset();this.ccStreams_.forEach(function(n){n.on("data",this.trigger.bind(this,"data"));n.on("partialdone",this.trigger.bind(this,"partialdone"));n.on("done",this.trigger.bind(this,"done"))},this);this.cc708Stream_.on("data",this.trigger.bind(this,"data"));this.cc708Stream_.on("partialdone",this.trigger.bind(this,"partialdone"));this.cc708Stream_.on("done",this.trigger.bind(this,"done"))};c.prototype=new o;c.prototype.push=function(n){var t,i,r;if(n.nalUnitType==="sei_rbsp"&&(t=tt.parseSei(n.escapedRBSP),t.payload)&&t.payloadType===tt.USER_DATA_REGISTERED_ITU_T_T35&&(i=tt.parseUserData(t),i)){if(n.dts<this.latestDts_){this.ignoreNextEqualDts_=!0;return}if(n.dts===this.latestDts_&&this.ignoreNextEqualDts_){this.numSameDts_--;this.numSameDts_||(this.ignoreNextEqualDts_=!1);return}r=tt.parseCaptionPackets(n.pts,i);this.captionPackets_=this.captionPackets_.concat(r);this.latestDts_!==n.dts&&(this.numSameDts_=0);this.numSameDts_++;this.latestDts_=n.dts}};c.prototype.flushCCStreams=function(n){this.ccStreams_.forEach(function(t){return n==="flush"?t.flush():t.partialFlush()},this)};c.prototype.flushStream=function(n){if(!this.captionPackets_.length){this.flushCCStreams(n);return}this.captionPackets_.forEach(function(n,t){n.presortIndex=t});this.captionPackets_.sort(function(n,t){return n.pts===t.pts?n.presortIndex-t.presortIndex:n.pts-t.pts});this.captionPackets_.forEach(function(n){n.type<2?this.dispatchCea608Packet(n):this.dispatchCea708Packet(n)},this);this.captionPackets_.length=0;this.flushCCStreams(n)};c.prototype.flush=function(){return this.flushStream("flush")};c.prototype.partialFlush=function(){return this.flushStream("partialFlush")};c.prototype.reset=function(){this.latestDts_=null;this.ignoreNextEqualDts_=!1;this.numSameDts_=0;this.activeCea608Channel_=[null,null];this.ccStreams_.forEach(function(n){n.reset()})};c.prototype.dispatchCea608Packet=function(n){(this.setsTextOrXDSActive(n)?this.activeCea608Channel_[n.type]=null:this.setsChannel1Active(n)?this.activeCea608Channel_[n.type]=0:this.setsChannel2Active(n)&&(this.activeCea608Channel_[n.type]=1),this.activeCea608Channel_[n.type]!==null)&&this.ccStreams_[(n.type<<1)+this.activeCea608Channel_[n.type]].push(n)};c.prototype.setsChannel1Active=function(n){return(n.ccData&30720)==4096};c.prototype.setsChannel2Active=function(n){return(n.ccData&30720)==6144};c.prototype.setsTextOrXDSActive=function(n){return(n.ccData&28928)==256||(n.ccData&30974)==4138||(n.ccData&30974)==6186};c.prototype.dispatchCea708Packet=function(n){this.cc708Stream_.push(n)};var io={127:9834,4128:32,4129:160,4133:8230,4138:352,4140:338,4144:9608,4145:8216,4146:8217,4147:8220,4148:8221,4149:8226,4153:8482,4154:353,4156:339,4157:8480,4159:376,4214:8539,4215:8540,4216:8541,4217:8542,4218:9168,4219:9124,4220:9123,4221:9135,4222:9126,4223:9121,4256:12600},ro=function(n){var t=io[n]||n;return n&4096&&n===t?"":String.fromCharCode(t)},ku=function(n){return 32<=n&&n<=127||160<=n&&n<=255},y=function(n){this.windowNum=n;this.reset()};y.prototype.reset=function(){this.clearText();this.pendingNewLine=!1;this.winAttr={};this.penAttr={};this.penLoc={};this.penColor={};this.visible=0;this.rowLock=0;this.columnLock=0;this.priority=0;this.relativePositioning=0;this.anchorVertical=0;this.anchorHorizontal=0;this.anchorPoint=0;this.rowCount=1;this.virtualRowCount=this.rowCount+1;this.columnCount=41;this.windowStyle=0;this.penStyle=0};y.prototype.getText=function(){return this.rows.join("\n")};y.prototype.clearText=function(){this.rows=[""];this.rowIdx=0};y.prototype.newLine=function(n){for(this.rows.length>=this.virtualRowCount&&typeof this.beforeRowOverflow=="function"&&this.beforeRowOverflow(n),this.rows.length>0&&(this.rows.push(""),this.rowIdx++);this.rows.length>this.virtualRowCount;)this.rows.shift(),this.rowIdx--};y.prototype.isEmpty=function(){return this.rows.length===0?!0:this.rows.length===1?this.rows[0]==="":!1};y.prototype.addText=function(n){this.rows[this.rowIdx]+=n};y.prototype.backspace=function(){if(!this.isEmpty()){var n=this.rows[this.rowIdx];this.rows[this.rowIdx]=n.substr(0,n.length-1)}};ht=function(n){this.serviceNum=n;this.text="";this.currentWindow=new y(-1);this.windows=[]};ht.prototype.init=function(n,t){this.startPts=n;for(var i=0;i<8;i++)this.windows[i]=new y(i),typeof t=="function"&&(this.windows[i].beforeRowOverflow=t)};ht.prototype.setCurrentWindow=function(n){this.currentWindow=this.windows[n]};f=function f(){f.prototype.init.call(this);var n=this;this.current708Packet=null;this.services={};this.push=function(t){t.type===3?(n.new708Packet(),n.add708Bytes(t)):(n.current708Packet===null&&n.new708Packet(),n.add708Bytes(t))}};f.prototype=new o;f.prototype.new708Packet=function(){this.current708Packet!==null&&this.push708Packet();this.current708Packet={data:[],ptsVals:[]}};f.prototype.add708Bytes=function(n){var t=n.ccData,i=t>>>8,r=t&255;this.current708Packet.ptsVals.push(n.pts);this.current708Packet.data.push(i);this.current708Packet.data.push(r)};f.prototype.push708Packet=function(){var f=this.current708Packet,r=f.data,u=null,i=null,n=0,t=r[n++];for(f.seq=t>>6,f.sizeCode=t&63;n<r.length;n++)t=r[n++],u=t>>5,i=t&31,u===7&&i>0&&(t=r[n++],u=t),this.pushServiceBlock(u,n,i),i>0&&(n+=i-1)};f.prototype.pushServiceBlock=function(n,t,i){var u,r=t,e=this.current708Packet.data,f=this.services[n];for(f||(f=this.initService(n,r));r<t+i&&r<e.length;r++)u=e[r],ku(u)?r=this.handleText(r,f):u===16?r=this.extendedCommands(r,f):128<=u&&u<=135?r=this.setCurrentWindow(r,f):152<=u&&u<=159?r=this.defineWindow(r,f):u===136?r=this.clearWindows(r,f):u===140?r=this.deleteWindows(r,f):u===137?r=this.displayWindows(r,f):u===138?r=this.hideWindows(r,f):u===139?r=this.toggleWindows(r,f):u===151?r=this.setWindowAttributes(r,f):u===144?r=this.setPenAttributes(r,f):u===145?r=this.setPenColor(r,f):u===146?r=this.setPenLocation(r,f):u===143?f=this.reset(r,f):u===8?f.currentWindow.backspace():u===12?f.currentWindow.clearText():u===13?f.currentWindow.pendingNewLine=!0:u===14?f.currentWindow.clearText():u===141&&r++};f.prototype.extendedCommands=function(n,t){var i=this.current708Packet.data,r=i[++n];return ku(r)&&(n=this.handleText(n,t,!0)),n};f.prototype.getPts=function(n){return this.current708Packet.ptsVals[Math.floor(n/2)]};f.prototype.initService=function(n,t){var i=this;return this.services[n]=new ht(n),this.services[n].init(this.getPts(t),function(t){i.flushDisplayed(t,i.services[n])}),this.services[n]};f.prototype.handleText=function(n,t,i){var u=this.current708Packet.data,f=u[n],e=i?4096:0,o=ro(e|f),r=t.currentWindow;return r.pendingNewLine&&!r.isEmpty()&&r.newLine(this.getPts(n)),r.pendingNewLine=!1,r.addText(o),n};f.prototype.setCurrentWindow=function(n,t){var i=this.current708Packet.data,r=i[n],u=r&7;return t.setCurrentWindow(u),n};f.prototype.defineWindow=function(n,t){var u=this.current708Packet.data,i=u[n],f=i&7,r;return t.setCurrentWindow(f),r=t.currentWindow,i=u[++n],r.visible=(i&32)>>5,r.rowLock=(i&16)>>4,r.columnLock=(i&8)>>3,r.priority=i&7,i=u[++n],r.relativePositioning=(i&128)>>7,r.anchorVertical=i&127,i=u[++n],r.anchorHorizontal=i,i=u[++n],r.anchorPoint=(i&240)>>4,r.rowCount=i&15,i=u[++n],r.columnCount=i&63,i=u[++n],r.windowStyle=(i&56)>>3,r.penStyle=i&7,r.virtualRowCount=r.rowCount+1,n};f.prototype.setWindowAttributes=function(n,t){var u=this.current708Packet.data,i=u[n],r=t.currentWindow.winAttr;return i=u[++n],r.fillOpacity=(i&192)>>6,r.fillRed=(i&48)>>4,r.fillGreen=(i&12)>>2,r.fillBlue=i&3,i=u[++n],r.borderType=(i&192)>>6,r.borderRed=(i&48)>>4,r.borderGreen=(i&12)>>2,r.borderBlue=i&3,i=u[++n],r.borderType+=(i&128)>>5,r.wordWrap=(i&64)>>6,r.printDirection=(i&48)>>4,r.scrollDirection=(i&12)>>2,r.justify=i&3,i=u[++n],r.effectSpeed=(i&240)>>4,r.effectDirection=(i&12)>>2,r.displayEffect=i&3,n};f.prototype.flushDisplayed=function(n,t){for(var r=[],i=0;i<8;i++)t.windows[i].visible&&!t.windows[i].isEmpty()&&r.push(t.windows[i].getText());t.endPts=n;t.text=r.join("\n\n");this.pushCaption(t);t.startPts=n};f.prototype.pushCaption=function(n){n.text!==""&&(this.trigger("data",{startPts:n.startPts,endPts:n.endPts,text:n.text,stream:"cc708_"+n.serviceNum}),n.text="",n.startPts=n.endPts)};f.prototype.displayWindows=function(n,t){var r=this.current708Packet.data,u=r[++n],f=this.getPts(n),i;for(this.flushDisplayed(f,t),i=0;i<8;i++)u&1<<i&&(t.windows[i].visible=1);return n};f.prototype.hideWindows=function(n,t){var r=this.current708Packet.data,u=r[++n],f=this.getPts(n),i;for(this.flushDisplayed(f,t),i=0;i<8;i++)u&1<<i&&(t.windows[i].visible=0);return n};f.prototype.toggleWindows=function(n,t){var r=this.current708Packet.data,u=r[++n],f=this.getPts(n),i;for(this.flushDisplayed(f,t),i=0;i<8;i++)u&1<<i&&(t.windows[i].visible^=1);return n};f.prototype.clearWindows=function(n,t){var r=this.current708Packet.data,u=r[++n],f=this.getPts(n),i;for(this.flushDisplayed(f,t),i=0;i<8;i++)u&1<<i&&t.windows[i].clearText();return n};f.prototype.deleteWindows=function(n,t){var r=this.current708Packet.data,u=r[++n],f=this.getPts(n),i;for(this.flushDisplayed(f,t),i=0;i<8;i++)u&1<<i&&t.windows[i].reset();return n};f.prototype.setPenAttributes=function(n,t){var u=this.current708Packet.data,i=u[n],r=t.currentWindow.penAttr;return i=u[++n],r.textTag=(i&240)>>4,r.offset=(i&12)>>2,r.penSize=i&3,i=u[++n],r.italics=(i&128)>>7,r.underline=(i&64)>>6,r.edgeType=(i&56)>>3,r.fontStyle=i&7,n};f.prototype.setPenColor=function(n,t){var u=this.current708Packet.data,i=u[n],r=t.currentWindow.penColor;return i=u[++n],r.fgOpacity=(i&192)>>6,r.fgRed=(i&48)>>4,r.fgGreen=(i&12)>>2,r.fgBlue=i&3,i=u[++n],r.bgOpacity=(i&192)>>6,r.bgRed=(i&48)>>4,r.bgGreen=(i&12)>>2,r.bgBlue=i&3,i=u[++n],r.edgeRed=(i&48)>>4,r.edgeGreen=(i&12)>>2,r.edgeBlue=i&3,n};f.prototype.setPenLocation=function(n,t){var r=this.current708Packet.data,i=r[n],u=t.currentWindow.penLoc;return t.currentWindow.pendingNewLine=!0,i=r[++n],u.row=i&15,i=r[++n],u.column=i&63,n};f.prototype.reset=function(n,t){var i=this.getPts(n);return this.flushDisplayed(i,t),this.initService(t.serviceNum,n)};var uo={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,304:174,305:176,306:189,307:191,308:8482,309:162,310:163,311:9834,312:224,313:160,314:232,315:226,316:234,317:238,318:244,319:251,544:193,545:201,546:211,547:218,548:220,549:252,550:8216,551:161,552:42,553:39,554:8212,555:169,556:8480,557:8226,558:8220,559:8221,560:192,561:194,562:199,563:200,564:202,565:203,566:235,567:206,568:207,569:239,570:212,571:217,572:249,573:219,574:171,575:187,800:195,801:227,802:205,803:204,804:236,805:210,806:242,807:213,808:245,809:123,810:125,811:92,812:94,813:95,814:124,815:126,816:196,817:228,818:214,819:246,820:223,821:165,822:164,823:9474,824:197,825:229,826:216,827:248,828:9484,829:9488,830:9492,831:9496},ct=function(n){return n===null?"":(n=uo[n]||n,String.fromCharCode(n))},lt=14,fo=[4352,4384,4608,4640,5376,5408,5632,5664,5888,5920,4096,4864,4896,5120,5152],k=function(){for(var n=[],t=lt+1;t--;)n.push("");return n},e=function e(n,t){e.prototype.init.call(this);this.field_=n||0;this.dataChannel_=t||0;this.name_="CC"+((this.field_<<1|this.dataChannel_)+1);this.setConstants();this.reset();this.push=function(n){var t,e,r,i,u,f;if(t=n.ccData&32639,t===this.lastControlCode_){this.lastControlCode_=null;return}((t&61440)==4096?this.lastControlCode_=t:t!==this.PADDING_&&(this.lastControlCode_=null),r=t>>>8,i=t&255,t!==this.PADDING_)&&(t===this.RESUME_CAPTION_LOADING_?this.mode_="popOn":t===this.END_OF_CAPTION_?(this.mode_="popOn",this.clearFormatting(n.pts),this.flushDisplayed(n.pts),e=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=e,this.startPts_=n.pts):t===this.ROLL_UP_2_ROWS_?(this.rollUpRows_=2,this.setRollUp(n.pts)):t===this.ROLL_UP_3_ROWS_?(this.rollUpRows_=3,this.setRollUp(n.pts)):t===this.ROLL_UP_4_ROWS_?(this.rollUpRows_=4,this.setRollUp(n.pts)):t===this.CARRIAGE_RETURN_?(this.clearFormatting(n.pts),this.flushDisplayed(n.pts),this.shiftRowsUp_(),this.startPts_=n.pts):t===this.BACKSPACE_?this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1):t===this.ERASE_DISPLAYED_MEMORY_?(this.flushDisplayed(n.pts),this.displayed_=k()):t===this.ERASE_NON_DISPLAYED_MEMORY_?this.nonDisplayed_=k():t===this.RESUME_DIRECT_CAPTIONING_?(this.mode_!=="paintOn"&&(this.flushDisplayed(n.pts),this.displayed_=k()),this.mode_="paintOn",this.startPts_=n.pts):this.isSpecialCharacter(r,i)?(r=(r&3)<<8,u=ct(r|i),this[this.mode_](n.pts,u),this.column_++):this.isExtCharacter(r,i)?(this.mode_==="popOn"?this.nonDisplayed_[this.row_]=this.nonDisplayed_[this.row_].slice(0,-1):this.displayed_[this.row_]=this.displayed_[this.row_].slice(0,-1),r=(r&3)<<8,u=ct(r|i),this[this.mode_](n.pts,u),this.column_++):this.isMidRowCode(r,i)?(this.clearFormatting(n.pts),this[this.mode_](n.pts," "),this.column_++,(i&14)==14&&this.addFormatting(n.pts,["i"]),(i&1)==1&&this.addFormatting(n.pts,["u"])):this.isOffsetControlCode(r,i)?this.column_+=i&3:this.isPAC(r,i)?(f=fo.indexOf(t&7968),this.mode_==="rollUp"&&(f-this.rollUpRows_+1<0&&(f=this.rollUpRows_-1),this.setRollUp(n.pts,f)),f!==this.row_&&(this.clearFormatting(n.pts),this.row_=f),i&1&&this.formatting_.indexOf("u")===-1&&this.addFormatting(n.pts,["u"]),(t&16)==16&&(this.column_=((t&14)>>1)*4),this.isColorPAC(i)&&(i&14)==14&&this.addFormatting(n.pts,["i"])):this.isNormalChar(r)&&(i===0&&(i=null),u=ct(r),u+=ct(i),this[this.mode_](n.pts,u),this.column_+=u.length))}};e.prototype=new o;e.prototype.flushDisplayed=function(n){var t=this.displayed_.map(function(n){try{return n.trim()}catch(t){return console.error("Skipping malformed caption."),""}}).join("\n").replace(/^\n+|\n+$/g,"");t.length&&this.trigger("data",{startPts:this.startPts_,endPts:n,text:t,stream:this.name_})};e.prototype.reset=function(){this.mode_="popOn";this.topRow_=0;this.startPts_=0;this.displayed_=k();this.nonDisplayed_=k();this.lastControlCode_=null;this.column_=0;this.row_=lt;this.rollUpRows_=2;this.formatting_=[]};e.prototype.setConstants=function(){this.dataChannel_===0?(this.BASE_=16,this.EXT_=17,this.CONTROL_=(20|this.field_)<<8,this.OFFSET_=23):this.dataChannel_===1&&(this.BASE_=24,this.EXT_=25,this.CONTROL_=(28|this.field_)<<8,this.OFFSET_=31);this.PADDING_=0;this.RESUME_CAPTION_LOADING_=this.CONTROL_|32;this.END_OF_CAPTION_=this.CONTROL_|47;this.ROLL_UP_2_ROWS_=this.CONTROL_|37;this.ROLL_UP_3_ROWS_=this.CONTROL_|38;this.ROLL_UP_4_ROWS_=this.CONTROL_|39;this.CARRIAGE_RETURN_=this.CONTROL_|45;this.RESUME_DIRECT_CAPTIONING_=this.CONTROL_|41;this.BACKSPACE_=this.CONTROL_|33;this.ERASE_DISPLAYED_MEMORY_=this.CONTROL_|44;this.ERASE_NON_DISPLAYED_MEMORY_=this.CONTROL_|46};e.prototype.isSpecialCharacter=function(n,t){return n===this.EXT_&&t>=48&&t<=63};e.prototype.isExtCharacter=function(n,t){return(n===this.EXT_+1||n===this.EXT_+2)&&t>=32&&t<=63};e.prototype.isMidRowCode=function(n,t){return n===this.EXT_&&t>=32&&t<=47};e.prototype.isOffsetControlCode=function(n,t){return n===this.OFFSET_&&t>=33&&t<=35};e.prototype.isPAC=function(n,t){return n>=this.BASE_&&n<this.BASE_+8&&t>=64&&t<=127};e.prototype.isColorPAC=function(n){return n>=64&&n<=79||n>=96&&n<=127};e.prototype.isNormalChar=function(n){return n>=32&&n<=127};e.prototype.setRollUp=function(n,t){if(this.mode_!=="rollUp"&&(this.row_=lt,this.mode_="rollUp",this.flushDisplayed(n),this.nonDisplayed_=k(),this.displayed_=k()),t!==undefined&&t!==this.row_)for(var i=0;i<this.rollUpRows_;i++)this.displayed_[t-i]=this.displayed_[this.row_-i],this.displayed_[this.row_-i]="";t===undefined&&(t=this.row_);this.topRow_=t-this.rollUpRows_+1};e.prototype.addFormatting=function(n,t){this.formatting_=this.formatting_.concat(t);var i=t.reduce(function(n,t){return n+"<"+t+">"},"");this[this.mode_](n,i)};e.prototype.clearFormatting=function(n){if(this.formatting_.length){var t=this.formatting_.reverse().reduce(function(n,t){return n+"<\/"+t+">"},"");this.formatting_=[];this[this.mode_](n,t)}};e.prototype.popOn=function(n,t){var i=this.nonDisplayed_[this.row_];i+=t;this.nonDisplayed_[this.row_]=i};e.prototype.rollUp=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};e.prototype.shiftRowsUp_=function(){for(var n=0;n<this.topRow_;n++)this.displayed_[n]="";for(n=this.row_+1;n<lt+1;n++)this.displayed_[n]="";for(n=this.topRow_;n<this.row_;n++)this.displayed_[n]=this.displayed_[n+1];this.displayed_[this.row_]=""};e.prototype.paintOn=function(n,t){var i=this.displayed_[this.row_];i+=t;this.displayed_[this.row_]=i};var at={CaptionStream:c,Cea608Stream:e,Cea708Stream:f},l={H264_STREAM_TYPE:27,ADTS_STREAM_TYPE:15,METADATA_STREAM_TYPE:21},eo=8589934592,oo=4294967296,du="shared",bi=function(n,t){var i=1;for(n>t&&(i=-1);Math.abs(t-n)>oo;)n+=i*eo;return n},ki=function ki(n){var i,t;ki.prototype.init.call(this);this.type_=n||du;this.push=function(n){(this.type_===du||n.type===this.type_)&&(t===undefined&&(t=n.dts),n.dts=bi(n.dts,t),n.pts=bi(n.pts,t),i=n.dts,this.trigger("data",n))};this.flush=function(){t=i;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.discontinuity=function(){t=void 0;i=void 0};this.reset=function(){this.discontinuity();this.trigger("reset")}};ki.prototype=new o;var so={TimestampRolloverStream:ki,handleRollover:bi},gu=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},vt=function(n,t,i){return decodeURIComponent(gu(n,t,i))},ho=function(n,t,i){return unescape(gu(n,t,i))},yt=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},nf={TXXX:function(n){var t;if(n.data[0]===3){for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=vt(n.data,1,t);n.value=vt(n.data,t+1,n.data.length).replace(/\0*$/,"");break}n.data=n.value}},WXXX:function(n){var t;if(n.data[0]===3)for(t=1;t<n.data.length;t++)if(n.data[t]===0){n.description=vt(n.data,1,t);n.url=vt(n.data,t+1,n.data.length);break}},PRIV:function(n){for(var t=0;t<n.data.length;t++)if(n.data[t]===0){n.owner=ho(n.data,0,t);break}n.privateData=n.data.subarray(t+1);n.data=n.privateData}},pt;pt=function(n){var r={debug:!!(n&&n.debug),descriptor:n&&n.descriptor},i=0,t=[],u=0,f;if(pt.prototype.init.call(this),this.dispatchType=l.METADATA_STREAM_TYPE.toString(16),r.descriptor)for(f=0;f<r.descriptor.length;f++)this.dispatchType+=("00"+r.descriptor[f].toString(16)).slice(-2);this.push=function(n){var f,e,c,o,h,a,s,l;if(n.type==="timed-metadata"){if(n.dataAlignmentIndicator&&(u=0,t.length=0),t.length===0&&(n.data.length<10||n.data[0]!=="I".charCodeAt(0)||n.data[1]!=="D".charCodeAt(0)||n.data[2]!=="3".charCodeAt(0))){r.debug&&console.log("Skipping unrecognized metadata packet");return}if(t.push(n),u+=n.data.byteLength,t.length===1&&(i=yt(n.data.subarray(6,10))+10),!(u<i)){for(f={data:new Uint8Array(i),frames:[],pts:t[0].pts,dts:t[0].dts},h=0;h<i;)f.data.set(t[0].data.subarray(0,i-h),h),h+=t[0].data.byteLength,u-=t[0].data.byteLength,t.shift();e=10;f.data[5]&64&&(e+=4,e+=yt(f.data.subarray(10,14)),i-=yt(f.data.subarray(16,20)));do{if(c=yt(f.data.subarray(e+4,e+8)),c<1)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");a=String.fromCharCode(f.data[e],f.data[e+1],f.data[e+2],f.data[e+3]);o={id:a,data:f.data.subarray(e+10,e+c+10)};o.key=o.id;nf[o.id]&&(nf[o.id](o),o.owner==="com.apple.streaming.transportStreamTimestamp"&&(s=o.data,l=(s[3]&1)<<30|s[4]<<22|s[5]<<14|s[6]<<6|s[7]>>>2,l*=4,l+=s[7]&3,o.timeStamp=l,f.pts===undefined&&f.dts===undefined&&(f.pts=o.timeStamp,f.dts=o.timeStamp),this.trigger("timestamp",o)));f.frames.push(o);e+=10;e+=c}while(e<i);this.trigger("data",f)}}}};pt.prototype=new o;var co=pt,lo=so.TimestampRolloverStream,wt,it,bt,g=188,di=71;wt=function(){var t=new Uint8Array(g),n=0;wt.prototype.init.call(this);this.push=function(i){var u=0,f=g,r;for(n?(r=new Uint8Array(i.byteLength+n),r.set(t.subarray(0,n)),r.set(i,n),n=0):r=i;f<r.byteLength;){if(r[u]===di&&r[f]===di){this.trigger("data",r.subarray(u,f));u+=g;f+=g;continue}u++;f++}u<r.byteLength&&(t.set(r.subarray(u),0),n=r.byteLength-u)};this.flush=function(){n===g&&t[0]===di&&(this.trigger("data",t),n=0);this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")};this.reset=function(){n=0;this.trigger("reset")}};wt.prototype=new o;it=function(){var t,i,r,n;it.prototype.init.call(this);n=this;this.packetsWaitingForPmt=[];this.programMapTable=undefined;t=function(n,t){var u=0;t.payloadUnitStartIndicator&&(u+=n[u]+1);t.type==="pat"?i(n.subarray(u),t):r(n.subarray(u),t)};i=function(t,i){i.section_number=t[7];i.last_section_number=t[8];n.pmtPid=(t[10]&31)<<8|t[11];i.pmtPid=n.pmtPid};r=function(t,i){var e,o,s,r,u,f;if(t[5]&1){for(n.programMapTable={video:null,audio:null,"timed-metadata":{}},e=(t[1]&15)<<8|t[2],o=3+e-4,s=(t[10]&15)<<8|t[11],r=12+s;r<o;)u=t[r],f=(t[r+1]&31)<<8|t[r+2],u===l.H264_STREAM_TYPE&&n.programMapTable.video===null?n.programMapTable.video=f:u===l.ADTS_STREAM_TYPE&&n.programMapTable.audio===null?n.programMapTable.audio=f:u===l.METADATA_STREAM_TYPE&&(n.programMapTable["timed-metadata"][f]=u),r+=((t[r+3]&15)<<8|t[r+4])+5;i.programMapTable=n.programMapTable}};this.push=function(n){var i={},r=4;if(i.payloadUnitStartIndicator=!!(n[1]&64),i.pid=n[1]&31,i.pid<<=8,i.pid|=n[2],(n[3]&48)>>>4>1&&(r+=n[r]+1),i.pid===0)i.type="pat",t(n.subarray(r),i),this.trigger("data",i);else if(i.pid===this.pmtPid)for(i.type="pmt",t(n.subarray(r),i),this.trigger("data",i);this.packetsWaitingForPmt.length;)this.processPes_.apply(this,this.packetsWaitingForPmt.shift());else this.programMapTable===undefined?this.packetsWaitingForPmt.push([n,r,i]):this.processPes_(n,r,i)};this.processPes_=function(n,t,i){i.streamType=i.pid===this.programMapTable.video?l.H264_STREAM_TYPE:i.pid===this.programMapTable.audio?l.ADTS_STREAM_TYPE:this.programMapTable["timed-metadata"][i.pid];i.type="pes";i.data=n.subarray(t);this.trigger("data",i)}};it.prototype=new o;it.STREAM_TYPES={h264:27,adts:15};bt=function(){var u=this,t={data:[],size:0},i={data:[],size:0},f={data:[],size:0},n,e=function(n,t){var i;t.packetLength=6+(n[4]<<8|n[5]);t.dataAlignmentIndicator=(n[6]&4)!=0;i=n[7];i&192&&(t.pts=(n[9]&14)<<27|(n[10]&255)<<20|(n[11]&254)<<12|(n[12]&255)<<5|(n[13]&254)>>>3,t.pts*=4,t.pts+=(n[13]&6)>>>1,t.dts=t.pts,i&64&&(t.dts=(n[14]&14)<<27|(n[15]&255)<<20|(n[16]&254)<<12|(n[17]&255)<<5|(n[18]&254)>>>3,t.dts*=4,t.dts+=(n[18]&6)>>>1));t.data=n.subarray(9+n[8])},r=function(n,t,i){var h=new Uint8Array(n.size),r={type:t},f=0,c=0,o=!1,s;if(n.data.length&&!(n.size<9)){for(r.trackId=n.data[0].pid,f=0;f<n.data.length;f++)s=n.data[f],h.set(s.data,c),c+=s.data.byteLength;e(h,r);o=t==="video"||r.packetLength<=n.size;(i||o)&&(n.size=0,n.data.length=0);o&&u.trigger("data",r)}};bt.prototype.init.call(this);this.push=function(e){({pat:function(){},pes:function(){var n,u;switch(e.streamType){case l.H264_STREAM_TYPE:n=t;u="video";break;case l.ADTS_STREAM_TYPE:n=i;u="audio";break;case l.METADATA_STREAM_TYPE:n=f;u="timed-metadata";break;default:return}e.payloadUnitStartIndicator&&r(n,u,!0);n.data.push(e);n.size+=e.data.byteLength},pmt:function(){var t={type:"metadata",tracks:[]};n=e.programMapTable;n.video!==null&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.video,codec:"avc",type:"video"});n.audio!==null&&t.tracks.push({timelineStartInfo:{baseMediaDecodeTime:0},id:+n.audio,codec:"adts",type:"audio"});u.trigger("data",t)}})[e.type]()};this.reset=function(){t.size=0;t.data.length=0;i.size=0;i.data.length=0;this.trigger("reset")};this.flushStreams_=function(){r(t,"video");r(i,"audio");r(f,"timed-metadata")};this.flush=function(){this.flushStreams_();this.trigger("done")}};bt.prototype=new o;gi={PAT_PID:0,MP2T_PACKET_LENGTH:g,TransportPacketStream:wt,TransportParseStream:it,ElementaryStream:bt,TimestampRolloverStream:lo,CaptionStream:at.CaptionStream,Cea608Stream:at.Cea608Stream,Cea708Stream:at.Cea708Stream,MetadataStream:co};for(kt in l)l.hasOwnProperty(kt)&&(gi[kt]=l[kt]);var h=gi,ao=i.ONE_SECOND_IN_TS,dt,tf=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];dt=function(n){var t,i=0;dt.prototype.init.call(this);this.push=function(r){var u=0,h,c,f,e,o,s;if(n||(i=0),r.type==="audio")for(t?(e=t,t=new Uint8Array(e.byteLength+r.data.byteLength),t.set(e),t.set(r.data,e.byteLength)):t=r.data;u+5<t.length;){if(t[u]!==255||(t[u+1]&246)!=240){u++;continue}if(c=(~t[u+1]&1)*2,h=(t[u+3]&3)<<11|t[u+4]<<3|(t[u+5]&224)>>5,o=((t[u+6]&3)+1)*1024,s=o*ao/tf[(t[u+2]&60)>>>2],f=u+h,t.byteLength<f)return;if(this.trigger("data",{pts:r.pts+i*s,dts:r.dts+i*s,sampleCount:o,audioobjecttype:(t[u+2]>>>6&3)+1,channelcount:(t[u+2]&1)<<2|(t[u+3]&192)>>>6,samplerate:tf[(t[u+2]&60)>>>2],samplingfrequencyindex:(t[u+2]&60)>>>2,samplesize:16,data:t.subarray(u+7+c,f)}),i++,t.byteLength===f){t=undefined;return}t=t.subarray(f)}};this.flush=function(){i=0;this.trigger("done")};this.reset=function(){t=void 0;this.trigger("reset")};this.endTimeline=function(){t=void 0;this.trigger("endedtimeline")}};dt.prototype=new o;rt=dt;rf=function(n){var i=n.byteLength,r=0,t=0;this.length=function(){return 8*i};this.bitsAvailable=function(){return 8*i+t};this.loadWord=function(){var f=n.byteLength-i,e=new Uint8Array(4),u=Math.min(4,i);if(u===0)throw new Error("no bytes available");e.set(n.subarray(f,f+u));r=new DataView(e.buffer).getUint32(0);t=u*8;i-=u};this.skipBits=function(n){var u;t>n?(r<<=n,t-=n):(n-=t,u=Math.floor(n/8),n-=u*8,i-=u,this.loadWord(),r<<=n,t-=n)};this.readBits=function(n){var u=Math.min(t,n),f=r>>>32-u;return(t-=u,t>0?r<<=u:i>0&&this.loadWord(),u=n-u,u>0)?f<<u|this.readBits(u):f};this.skipLeadingZeros=function(){for(var n=0;n<t;++n)if((r&2147483648>>>n)!=0)return r<<=n,t-=n,n;return this.loadWord(),n+this.skipLeadingZeros()};this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())};this.readUnsignedExpGolomb=function(){var n=this.skipLeadingZeros();return this.readBits(n+1)-1};this.readExpGolomb=function(){var n=this.readUnsignedExpGolomb();return 1&n?1+n>>>1:-1*(n>>>1)};this.readBoolean=function(){return this.readBits(1)===1};this.readUnsignedByte=function(){return this.readBits(8)};this.loadWord()};uf=rf;ut=function(){var i=0,t,n;ut.prototype.init.call(this);this.push=function(r){var u,f;for(n?(u=new Uint8Array(n.byteLength+r.data.byteLength),u.set(n),u.set(r.data,n.byteLength),n=u):n=r.data,f=n.byteLength;i<f-3;i++)if(n[i+2]===1){t=i+5;break}while(t<f)switch(n[t]){case 0:if(n[t-1]!==0){t+=2;break}else if(n[t-2]!==0){t++;break}i+3!==t-2&&this.trigger("data",n.subarray(i+3,t-2));do t++;while(n[t]!==1&&t<f);i=t-2;t+=3;break;case 1:if(n[t-1]!==0||n[t-2]!==0){t+=3;break}this.trigger("data",n.subarray(i+3,t-2));i=t-2;t+=3;break;default:t+=3}n=n.subarray(i);t-=i;i=0};this.reset=function(){n=null;i=0;this.trigger("reset")};this.flush=function(){n&&n.byteLength>3&&this.trigger("data",n.subarray(i+3));n=null;i=0;this.trigger("done")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline")}};ut.prototype=new o;ff={100:!0,110:!0,122:!0,244:!0,44:!0,83:!0,86:!0,118:!0,128:!0,138:!0,139:!0,134:!0};gt=function(){var n=new ut,t,u,f,e,i,o,r;gt.prototype.init.call(this);t=this;this.push=function(t){t.type==="video"&&(u=t.trackId,f=t.pts,e=t.dts,n.push(t))};n.on("data",function(n){var r={trackId:u,pts:f,dts:e,data:n};switch(n[0]&31){case 5:r.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:r.nalUnitType="sei_rbsp";r.escapedRBSP=i(n.subarray(1));break;case 7:r.nalUnitType="seq_parameter_set_rbsp";r.escapedRBSP=i(n.subarray(1));r.config=o(r.escapedRBSP);break;case 8:r.nalUnitType="pic_parameter_set_rbsp";break;case 9:r.nalUnitType="access_unit_delimiter_rbsp"}t.trigger("data",r)});n.on("done",function(){t.trigger("done")});n.on("partialdone",function(){t.trigger("partialdone")});n.on("reset",function(){t.trigger("reset")});n.on("endedtimeline",function(){t.trigger("endedtimeline")});this.flush=function(){n.flush()};this.partialFlush=function(){n.partialFlush()};this.reset=function(){n.reset()};this.endTimeline=function(){n.endTimeline()};r=function(n,t){for(var r=8,i=8,f,u=0;u<n;u++)i!==0&&(f=t.readExpGolomb(),i=(r+f+256)%256),r=i===0?r:i};i=function(n){for(var e=n.byteLength,i=[],t=1,u,f,r;t<e-2;)n[t]===0&&n[t+1]===0&&n[t+2]===3?(i.push(t+2),t+=2):t++;if(i.length===0)return n;for(u=e-i.length,f=new Uint8Array(u),r=0,t=0;t<u;r++,t++)r===i[0]&&(r++,i.shift()),f[t]=n[r];return f};o=function(n){var h=0,c=0,l=0,a=0,v=1,t,f,y,p,e,o,w,b,k,s,d,i,g,u;if(t=new uf(n),f=t.readUnsignedByte(),p=t.readUnsignedByte(),y=t.readUnsignedByte(),t.skipUnsignedExpGolomb(),ff[f]&&(e=t.readUnsignedExpGolomb(),e===3&&t.skipBits(1),t.skipUnsignedExpGolomb(),t.skipUnsignedExpGolomb(),t.skipBits(1),t.readBoolean()))for(d=e!==3?8:12,u=0;u<d;u++)t.readBoolean()&&(u<6?r(16,t):r(64,t));if(t.skipUnsignedExpGolomb(),o=t.readUnsignedExpGolomb(),o===0)t.readUnsignedExpGolomb();else if(o===1)for(t.skipBits(1),t.skipExpGolomb(),t.skipExpGolomb(),w=t.readUnsignedExpGolomb(),u=0;u<w;u++)t.skipExpGolomb();if(t.skipUnsignedExpGolomb(),t.skipBits(1),b=t.readUnsignedExpGolomb(),k=t.readUnsignedExpGolomb(),s=t.readBits(1),s===0&&t.skipBits(1),t.skipBits(1),t.readBoolean()&&(h=t.readUnsignedExpGolomb(),c=t.readUnsignedExpGolomb(),l=t.readUnsignedExpGolomb(),a=t.readUnsignedExpGolomb()),t.readBoolean()&&t.readBoolean()){g=t.readUnsignedByte();switch(g){case 1:i=[1,1];break;case 2:i=[12,11];break;case 3:i=[10,11];break;case 4:i=[16,11];break;case 5:i=[40,33];break;case 6:i=[24,11];break;case 7:i=[20,11];break;case 8:i=[32,11];break;case 9:i=[80,33];break;case 10:i=[18,11];break;case 11:i=[15,11];break;case 12:i=[64,33];break;case 13:i=[160,99];break;case 14:i=[4,3];break;case 15:i=[3,2];break;case 16:i=[2,1];break;case 255:i=[t.readUnsignedByte()<<8|t.readUnsignedByte(),t.readUnsignedByte()<<8|t.readUnsignedByte()]}i&&(v=i[0]/i[1])}return{profileIdc:f,levelIdc:y,profileCompatibility:p,width:Math.ceil(((b+1)*16-h*2-c*2)*v),height:(2-s)*(k+1)*16-l*2-a*2,sarRatio:i}}};gt.prototype=new o;var ef={H264Stream:gt,NalByteStream:ut},vo=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],of=function(n,t){var i=n[t+6]<<21|n[t+7]<<14|n[t+8]<<7|n[t+9],r=n[t+5],u=(r&16)>>4;return(i=i>=0?i:0,u)?i+20:i+10},sf=function sf(n,t){return n.length-t<10||n[t]!=="I".charCodeAt(0)||n[t+1]!=="D".charCodeAt(0)||n[t+2]!=="3".charCodeAt(0)?t:(t+=of(n,t),sf(n,t))},yo=function(n){var t=sf(n,0);return n.length>=t+2&&(n[t]&255)==255&&(n[t+1]&240)==240&&(n[t+1]&22)==16},hf=function(n){return n[0]<<21|n[1]<<14|n[2]<<7|n[3]},po=function(n,t,i){for(var u="",r=t;r<i;r++)u+="%"+("00"+n[r].toString(16)).slice(-2);return u},wo=function(n,t,i){return unescape(po(n,t,i))},bo=function(n,t){var i=(n[t+5]&224)>>5,r=n[t+4]<<3,u=n[t+3]&6144;return u|r|i},ko=function(n,t){return n[t]==="I".charCodeAt(0)&&n[t+1]==="D".charCodeAt(0)&&n[t+2]==="3".charCodeAt(0)?"timed-metadata":n[t]&!0&&(n[t+1]&240)==240?"audio":null},go=function(n){for(var t=0;t+5<n.length;){if(n[t]!==255||(n[t+1]&246)!=240){t++;continue}return vo[(n[t+2]&60)>>>2]}return null},ns=function(n){var t,f,u,o,r,s,i,e;t=10;n[5]&64&&(t+=4,t+=hf(n.subarray(10,14)));do{if(f=hf(n.subarray(t+4,t+8)),f<1)return null;if(o=String.fromCharCode(n[t],n[t+1],n[t+2],n[t+3]),o==="PRIV")for(u=n.subarray(t+10,t+f+10),r=0;r<u.byteLength;r++)if(u[r]===0){if(s=wo(u,0,r),s==="com.apple.streaming.transportStreamTimestamp")return i=u.subarray(r+1),e=(i[3]&1)<<30|i[4]<<22|i[5]<<14|i[6]<<6|i[7]>>>2,e*=4,e+(i[7]&3);break}t+=10;t+=f}while(t<n.byteLength);return null},ni={isLikelyAacData:yo,parseId3TagSize:of,parseAdtsSize:bo,parseType:ko,parseSampleRate:go,parseAacTimestamp:ns},ti;ti=function(){var n=new Uint8Array,t=0;ti.prototype.init.call(this);this.setTimestamp=function(n){t=n};this.push=function(i){var u=0,r=0,e,o,s,f;for(n.length?(f=n.length,n=new Uint8Array(i.byteLength+f),n.set(n.subarray(0,f)),n.set(i,f)):n=i;n.length-r>=3;){if(n[r]==="I".charCodeAt(0)&&n[r+1]==="D".charCodeAt(0)&&n[r+2]==="3".charCodeAt(0)){if(n.length-r<10)break;if(u=ni.parseId3TagSize(n,r),r+u>n.length)break;o={type:"timed-metadata",data:n.subarray(r,r+u)};this.trigger("data",o);r+=u;continue}else if((n[r]&255)==255&&(n[r+1]&240)==240){if(n.length-r<7)break;if(u=ni.parseAdtsSize(n,r),r+u>n.length)break;s={type:"audio",data:n.subarray(r,r+u),pts:t,dts:t};this.trigger("data",s);r+=u;continue}r++}e=n.length-r;n=e>0?n.subarray(r):new Uint8Array};this.reset=function(){n=new Uint8Array;this.trigger("reset")};this.endTimeline=function(){n=new Uint8Array;this.trigger("endedtimeline")}};ti.prototype=new o;var cf=ti,ii=["audioobjecttype","channelcount","samplerate","samplingfrequencyindex","samplesize"],ri=["width","height","profileIdc","levelIdc","profileCompatibility","sarRatio"],ts=ef.H264Stream,is=ni.isLikelyAacData,rs=i.ONE_SECOND_IN_TS,ft,nt,ui,d,lf=function(n,t){var i;if(n.length!==t.length)return!1;for(i=0;i<n.length;i++)if(n[i]!==t[i])return!1;return!0},nr=function(n,t,i,r,u,f){var e=i-t,o=r-t,s=u-i;return{start:{dts:n,pts:n+e},end:{dts:n+o,pts:n+s},prependedContentDuration:f,baseMediaDecodeTime:n}};nt=function(n,t){var r=[],u=0,f=0,e=0,o=Infinity;t=t||{};nt.prototype.init.call(this);this.push=function(t){s.collectDtsInfo(n,t);n&&ii.forEach(function(i){n[i]=t[i]});r.push(t)};this.setEarliestDts=function(n){f=n};this.setVideoBaseMediaDecodeTime=function(n){o=n};this.setAudioAppendStart=function(n){e=n};this.flush=function(){var h,c,y,l,p,v,b;if(r.length===0){this.trigger("done","AudioSegmentStream");return}h=w.trimAdtsFramesByEarliestDts(r,n,f);n.baseMediaDecodeTime=s.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);b=w.prefixWithSilence(n,h,e,o);n.samples=w.generateSampleTable(h);y=a.mdat(w.concatenateFrameData(h));r=[];c=a.moof(u,[n]);l=new Uint8Array(c.byteLength+y.byteLength);u++;l.set(c);l.set(y,c.byteLength);s.clearDtsInfo(n);p=Math.ceil(rs*1024/n.samplerate);h.length&&(v=h.length*p,this.trigger("segmentTimingInfo",nr(i.audioTsToVideoTs(n.baseMediaDecodeTime,n.samplerate),h[0].dts,h[0].pts,h[0].dts+v,h[0].pts+v,b||0)),this.trigger("timingInfo",{start:h[0].pts,end:h[0].pts+v}));this.trigger("data",{track:n,boxes:l});this.trigger("done","AudioSegmentStream")};this.reset=function(){s.clearDtsInfo(n);r=[];this.trigger("reset")}};nt.prototype=new o;ft=function(n,t){var e=0,i=[],r=[],u,f;t=t||{};ft.prototype.init.call(this);delete n.minPTS;this.gopCache_=[];this.push=function(t){s.collectDtsInfo(n,t);t.nalUnitType!=="seq_parameter_set_rbsp"||u||(u=t.config,n.sps=[t.data],ri.forEach(function(t){n[t]=u[t]},this));t.nalUnitType!=="pic_parameter_set_rbsp"||f||(f=t.data,n.pps=[t.data]);i.push(t)};this.flush=function(){for(var w,f,u,h,l,c,b=0,y,o,p;i.length;){if(i[0].nalUnitType==="access_unit_delimiter_rbsp")break;i.shift()}if(i.length===0){this.resetStream_();this.trigger("done","VideoSegmentStream");return}if(w=v.groupNalsIntoFrames(i),u=v.groupFramesIntoGops(w),u[0][0].keyFrame||(f=this.getGopForFusion_(i[0],n),f?(b=f.duration,u.unshift(f),u.byteLength+=f.byteLength,u.nalCount+=f.nalCount,u.pts=f.pts,u.dts=f.dts,u.duration+=f.duration):u=v.extendFirstKeyFrame(u)),r.length){if(p=t.alignGopsAtEnd?this.alignGopsAtEnd_(u):this.alignGopsAtStart_(u),!p){this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.resetStream_();this.trigger("done","VideoSegmentStream");return}s.clearDtsInfo(n);u=p}s.collectDtsInfo(n,u);n.samples=v.generateSampleTable(u);l=a.mdat(v.concatenateNalData(u));n.baseMediaDecodeTime=s.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps);this.trigger("processedGopsInfo",u.map(function(n){return{pts:n.pts,dts:n.dts,byteLength:n.byteLength}}));y=u[0];o=u[u.length-1];this.trigger("segmentTimingInfo",nr(n.baseMediaDecodeTime,y.dts,y.pts,o.dts+o.duration,o.pts+o.duration,b));this.trigger("timingInfo",{start:u[0].pts,end:u[u.length-1].pts+u[u.length-1].duration});this.gopCache_.unshift({gop:u.pop(),pps:n.pps,sps:n.sps});this.gopCache_.length=Math.min(6,this.gopCache_.length);i=[];this.trigger("baseMediaDecodeTime",n.baseMediaDecodeTime);this.trigger("timelineStartInfo",n.timelineStartInfo);h=a.moof(e,[n]);c=new Uint8Array(h.byteLength+l.byteLength);e++;c.set(h);c.set(l,h.byteLength);this.trigger("data",{track:n,boxes:c});this.resetStream_();this.trigger("done","VideoSegmentStream")};this.reset=function(){this.resetStream_();i=[];this.gopCache_.length=0;r.length=0;this.trigger("reset")};this.resetStream_=function(){s.clearDtsInfo(n);u=undefined;f=undefined};this.getGopForFusion_=function(t){for(var o=Infinity,i,u,f,r,e=0;e<this.gopCache_.length;e++)(r=this.gopCache_[e],f=r.gop,n.pps&&lf(n.pps[0],r.pps[0])&&n.sps&&lf(n.sps[0],r.sps[0]))&&(f.dts<n.timelineStartInfo.dts||(i=t.dts-f.dts-f.duration,i>=-1e4&&i<=45e3&&(!u||o>i)&&(u=r,o=i)));return u?u.gop:null};this.alignGopsAtStart_=function(n){var f,i,e,u,o,s,h,t;for(o=n.byteLength,s=n.nalCount,h=n.duration,f=i=0;f<r.length&&i<n.length;){if(e=r[f],u=n[i],e.pts===u.pts)break;if(u.pts>e.pts){f++;continue}i++;o-=u.byteLength;s-=u.nalCount;h-=u.duration}return i===0?n:i===n.length?null:(t=n.slice(i),t.byteLength=o,t.duration=h,t.nalCount=s,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsAtEnd_=function(n){var u,i,s,h,f,e,c,t,o;for(u=r.length-1,i=n.length-1,f=null,e=!1;u>=0&&i>=0;){if(s=r[u],h=n[i],s.pts===h.pts){e=!0;break}if(s.pts>h.pts){u--;continue}u===r.length-1&&(f=i);i--}return!e&&f===null?null:(c=e?i:f,c===0)?n:(t=n.slice(c),o=t.reduce(function(n,t){return n.byteLength+=t.byteLength,n.duration+=t.duration,n.nalCount+=t.nalCount,n},{byteLength:0,duration:0,nalCount:0}),t.byteLength=o.byteLength,t.duration=o.duration,t.nalCount=o.nalCount,t.pts=t[0].pts,t.dts=t[0].dts,t)};this.alignGopsWith=function(n){r=n}};ft.prototype=new o;d=function(n,t){this.numberOfTracks=0;this.metadataStream=t;n=n||{};this.remuxTracks=typeof n.remux!="undefined"?!!n.remux:!0;this.keepOriginalTimestamps=typeof n.keepOriginalTimestamps=="boolean"?n.keepOriginalTimestamps:!1;this.pendingTracks=[];this.videoTrack=null;this.pendingBoxes=[];this.pendingCaptions=[];this.pendingMetadata=[];this.pendingBytes=0;this.emittedTracks=0;d.prototype.init.call(this);this.push=function(n){if(n.text)return this.pendingCaptions.push(n);if(n.frames)return this.pendingMetadata.push(n);this.pendingTracks.push(n.track);this.pendingBytes+=n.boxes.byteLength;n.track.type==="video"&&(this.videoTrack=n.track,this.pendingBoxes.push(n.boxes));n.track.type==="audio"&&(this.audioTrack=n.track,this.pendingBoxes.unshift(n.boxes))}};d.prototype=new o;d.prototype.flush=function(n){var s=0,r={captions:[],captionStreams:{},metadata:[],info:{}},u,f,o,e=0,t;if(this.pendingTracks.length<this.numberOfTracks){if(n!=="VideoSegmentStream"&&n!=="AudioSegmentStream")return;if(this.remuxTracks)return;if(this.pendingTracks.length===0){this.emittedTracks++;this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0);return}}if(this.videoTrack?(e=this.videoTrack.timelineStartInfo.pts,ri.forEach(function(n){r.info[n]=this.videoTrack[n]},this)):this.audioTrack&&(e=this.audioTrack.timelineStartInfo.pts,ii.forEach(function(n){r.info[n]=this.audioTrack[n]},this)),this.videoTrack||this.audioTrack){for(r.type=this.pendingTracks.length===1?this.pendingTracks[0].type:"combined",this.emittedTracks+=this.pendingTracks.length,o=a.initSegment(this.pendingTracks),r.initSegment=new Uint8Array(o.byteLength),r.initSegment.set(o),r.data=new Uint8Array(this.pendingBytes),t=0;t<this.pendingBoxes.length;t++)r.data.set(this.pendingBoxes[t],s),s+=this.pendingBoxes[t].byteLength;for(t=0;t<this.pendingCaptions.length;t++)u=this.pendingCaptions[t],u.startTime=i.metadataTsToSeconds(u.startPts,e,this.keepOriginalTimestamps),u.endTime=i.metadataTsToSeconds(u.endPts,e,this.keepOriginalTimestamps),r.captionStreams[u.stream]=!0,r.captions.push(u);for(t=0;t<this.pendingMetadata.length;t++)f=this.pendingMetadata[t],f.cueTime=i.metadataTsToSeconds(f.pts,e,this.keepOriginalTimestamps),r.metadata.push(f);for(r.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",r),t=0;t<r.captions.length;t++)u=r.captions[t],this.trigger("caption",u);for(t=0;t<r.metadata.length;t++)f=r.metadata[t],this.trigger("id3Frame",f)}this.emittedTracks>=this.numberOfTracks&&(this.trigger("done"),this.emittedTracks=0)};d.prototype.setRemux=function(n){this.remuxTracks=n};ui=function(n){var t=this,u=!0,r,i;ui.prototype.init.call(this);n=n||{};this.baseMediaDecodeTime=n.baseMediaDecodeTime||0;this.transmuxPipeline_={};this.setupAacPipeline=function(){var u={};this.transmuxPipeline_=u;u.type="aac";u.metadataStream=new h.MetadataStream;u.aacStream=new cf;u.audioTimestampRolloverStream=new h.TimestampRolloverStream("audio");u.timedMetadataTimestampRolloverStream=new h.TimestampRolloverStream("timed-metadata");u.adtsStream=new rt;u.coalesceStream=new d(n,u.metadataStream);u.headOfPipeline=u.aacStream;u.aacStream.pipe(u.audioTimestampRolloverStream).pipe(u.adtsStream);u.aacStream.pipe(u.timedMetadataTimestampRolloverStream).pipe(u.metadataStream).pipe(u.coalesceStream);u.metadataStream.on("timestamp",function(n){u.aacStream.setTimestamp(n.timeStamp)});u.aacStream.on("data",function(f){if((f.type==="timed-metadata"||f.type==="audio")&&!u.audioSegmentStream){i=i||{timelineStartInfo:{baseMediaDecodeTime:t.baseMediaDecodeTime},codec:"adts",type:"audio"};u.coalesceStream.numberOfTracks++;u.audioSegmentStream=new nt(i,n);u.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream);t.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!r})}});u.coalesceStream.on("data",this.trigger.bind(this,"data"));u.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setupTsPipeline=function(){var u={};this.transmuxPipeline_=u;u.type="ts";u.metadataStream=new h.MetadataStream;u.packetStream=new h.TransportPacketStream;u.parseStream=new h.TransportParseStream;u.elementaryStream=new h.ElementaryStream;u.timestampRolloverStream=new h.TimestampRolloverStream;u.adtsStream=new rt;u.h264Stream=new ts;u.captionStream=new h.CaptionStream;u.coalesceStream=new d(n,u.metadataStream);u.headOfPipeline=u.packetStream;u.packetStream.pipe(u.parseStream).pipe(u.elementaryStream).pipe(u.timestampRolloverStream);u.timestampRolloverStream.pipe(u.h264Stream);u.timestampRolloverStream.pipe(u.adtsStream);u.timestampRolloverStream.pipe(u.metadataStream).pipe(u.coalesceStream);u.h264Stream.pipe(u.captionStream).pipe(u.coalesceStream);u.elementaryStream.on("data",function(f){var e;if(f.type==="metadata"){for(e=f.tracks.length;e--;)r||f.tracks[e].type!=="video"?i||f.tracks[e].type!=="audio"||(i=f.tracks[e],i.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime):(r=f.tracks[e],r.timelineStartInfo.baseMediaDecodeTime=t.baseMediaDecodeTime);if(r&&!u.videoSegmentStream){u.coalesceStream.numberOfTracks++;u.videoSegmentStream=new ft(r,n);u.videoSegmentStream.on("timelineStartInfo",function(r){i&&!n.keepOriginalTimestamps&&(i.timelineStartInfo=r,u.audioSegmentStream.setEarliestDts(r.dts-t.baseMediaDecodeTime))});u.videoSegmentStream.on("processedGopsInfo",t.trigger.bind(t,"gopInfo"));u.videoSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"videoSegmentTimingInfo"));u.videoSegmentStream.on("baseMediaDecodeTime",function(n){i&&u.audioSegmentStream.setVideoBaseMediaDecodeTime(n)});u.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo"));u.h264Stream.pipe(u.videoSegmentStream).pipe(u.coalesceStream)}if(i&&!u.audioSegmentStream){u.coalesceStream.numberOfTracks++;u.audioSegmentStream=new nt(i,n);u.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));u.audioSegmentStream.on("segmentTimingInfo",t.trigger.bind(t,"audioSegmentTimingInfo"));u.adtsStream.pipe(u.audioSegmentStream).pipe(u.coalesceStream)}t.trigger("trackinfo",{hasAudio:!!i,hasVideo:!!r})}});u.coalesceStream.on("data",this.trigger.bind(this,"data"));u.coalesceStream.on("id3Frame",function(n){n.dispatchType=u.metadataStream.dispatchType;t.trigger("id3Frame",n)});u.coalesceStream.on("caption",this.trigger.bind(this,"caption"));u.coalesceStream.on("done",this.trigger.bind(this,"done"))};this.setBaseMediaDecodeTime=function(t){var u=this.transmuxPipeline_;n.keepOriginalTimestamps||(this.baseMediaDecodeTime=t);i&&(i.timelineStartInfo.dts=undefined,i.timelineStartInfo.pts=undefined,s.clearDtsInfo(i),u.audioTimestampRolloverStream&&u.audioTimestampRolloverStream.discontinuity());r&&(u.videoSegmentStream&&(u.videoSegmentStream.gopCache_=[]),r.timelineStartInfo.dts=undefined,r.timelineStartInfo.pts=undefined,s.clearDtsInfo(r),u.captionStream.reset());u.timestampRolloverStream&&u.timestampRolloverStream.discontinuity()};this.setAudioAppendStart=function(n){i&&this.transmuxPipeline_.audioSegmentStream.setAudioAppendStart(n)};this.setRemux=function(t){var i=this.transmuxPipeline_;n.remux=t;i&&i.coalesceStream&&i.coalesceStream.setRemux(t)};this.alignGopsWith=function(n){r&&this.transmuxPipeline_.videoSegmentStream&&this.transmuxPipeline_.videoSegmentStream.alignGopsWith(n)};this.push=function(n){if(u){var t=is(n);t&&this.transmuxPipeline_.type!=="aac"?this.setupAacPipeline():t||this.transmuxPipeline_.type==="ts"||this.setupTsPipeline();u=!1}this.transmuxPipeline_.headOfPipeline.push(n)};this.flush=function(){u=!0;this.transmuxPipeline_.headOfPipeline.flush()};this.endTimeline=function(){this.transmuxPipeline_.headOfPipeline.endTimeline()};this.reset=function(){this.transmuxPipeline_.headOfPipeline&&this.transmuxPipeline_.headOfPipeline.reset()};this.resetCaptions=function(){this.transmuxPipeline_.captionStream&&this.transmuxPipeline_.captionStream.reset()}};ui.prototype=new o;var us={Transmuxer:ui,VideoSegmentStream:ft,AudioSegmentStream:nt,AUDIO_PROPERTIES:ii,VIDEO_PROPERTIES:ri,generateSegmentTimingInfo:nr},af={Adts:rt,h264:ef},fs=i.ONE_SECOND_IN_TS,tr=function tr(n,t){var i=[],f=0,e=0,o=0,h=Infinity,r=null,u=null;t=t||{};tr.prototype.init.call(this);this.push=function(t){s.collectDtsInfo(n,t);n&&ii.forEach(function(i){n[i]=t[i]});i.push(t)};this.setEarliestDts=function(n){e=n};this.setVideoBaseMediaDecodeTime=function(n){h=n};this.setAudioAppendStart=function(n){o=n};this.processFrames_=function(){var c,l,y,v,p;i.length!==0&&(c=w.trimAdtsFramesByEarliestDts(i,n,e),c.length!==0)&&(n.baseMediaDecodeTime=s.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps),w.prefixWithSilence(n,c,o,h),n.samples=w.generateSampleTable(c),y=a.mdat(w.concatenateFrameData(c)),i=[],l=a.moof(f,[n]),f++,n.initSegment=a.initSegment([n]),v=new Uint8Array(l.byteLength+y.byteLength),v.set(l),v.set(y,l.byteLength),s.clearDtsInfo(n),r===null&&(u=r=c[0].pts),u+=c.length*(fs*1024/n.samplerate),p={start:r},this.trigger("timingInfo",p),this.trigger("data",{track:n,boxes:v}))};this.flush=function(){this.processFrames_();this.trigger("timingInfo",{start:r,end:u});this.resetTiming_();this.trigger("done","AudioSegmentStream")};this.partialFlush=function(){this.processFrames_();this.trigger("partialdone","AudioSegmentStream")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline","AudioSegmentStream")};this.resetTiming_=function(){s.clearDtsInfo(n);r=null;u=null};this.reset=function(){this.resetTiming_();i=[];this.trigger("reset")}};tr.prototype=new o;ir=tr;fi=function fi(n,t){var h=0,i=[],r=[],e,c,f=null,o=null,u,l=!0;t=t||{};fi.prototype.init.call(this);this.push=function(t){s.collectDtsInfo(n,t);typeof n.timelineStartInfo.dts=="undefined"&&(n.timelineStartInfo.dts=t.dts);t.nalUnitType!=="seq_parameter_set_rbsp"||e||(e=t.config,n.sps=[t.data],ri.forEach(function(t){n[t]=e[t]},this));t.nalUnitType!=="pic_parameter_set_rbsp"||c||(c=t.data,n.pps=[t.data]);i.push(t)};this.processNals_=function(e){var p,c,y,k,w,b;for(i=r.concat(i);i.length;){if(i[0].nalUnitType==="access_unit_delimiter_rbsp")break;i.shift()}if(i.length!==0&&(c=v.groupNalsIntoFrames(i),c.length)){if(r=c[c.length-1],e&&(c.pop(),c.duration-=r.duration,c.nalCount-=r.length,c.byteLength-=r.byteLength),!c.length){i=[];return}if(this.trigger("timelineStartInfo",n.timelineStartInfo),l){if(u=v.groupFramesIntoGops(c),!u[0][0].keyFrame){if(u=v.extendFirstKeyFrame(u),!u[0][0].keyFrame){i=[].concat.apply([],c).concat(r);r=[];return}c=[].concat.apply([],u);c.duration=u.duration}l=!1}for(f===null&&(f=c[0].pts,o=f),o+=c.duration,this.trigger("timingInfo",{start:f,end:o}),p=0;p<c.length;p++)y=c[p],n.samples=v.generateSampleTableForFrame(y),k=a.mdat(v.concatenateNalDataForFrame(y)),s.clearDtsInfo(n),s.collectDtsInfo(n,y),n.baseMediaDecodeTime=s.calculateTrackBaseMediaDecodeTime(n,t.keepOriginalTimestamps),w=a.moof(h,[n]),h++,n.initSegment=a.initSegment([n]),b=new Uint8Array(w.byteLength+k.byteLength),b.set(w),b.set(k,w.byteLength),this.trigger("data",{track:n,boxes:b,sequence:h,videoFrameDts:y.dts,videoFramePts:y.pts});i=[]}};this.resetTimingAndConfig_=function(){e=undefined;c=undefined;f=null;o=null};this.partialFlush=function(){this.processNals_(!0);this.trigger("partialdone","VideoSegmentStream")};this.flush=function(){this.processNals_(!1);this.resetTimingAndConfig_();this.trigger("done","VideoSegmentStream")};this.endTimeline=function(){this.flush();this.trigger("endedtimeline","VideoSegmentStream")};this.reset=function(){this.resetTimingAndConfig_();r=[];i=[];l=!0;this.trigger("reset")}};fi.prototype=new o;var es=fi,os=ni.isLikelyAacData,vf=function(n){return n.prototype=new o,n.prototype.init.call(n),n},ss=function(n){var t={type:"ts",tracks:{audio:null,video:null},packet:new h.TransportPacketStream,parse:new h.TransportParseStream,elementary:new h.ElementaryStream,timestampRollover:new h.TimestampRolloverStream,adts:new af.Adts,h264:new af.h264.H264Stream,captionStream:new h.CaptionStream,metadataStream:new h.MetadataStream};t.headOfPipeline=t.packet;t.packet.pipe(t.parse).pipe(t.elementary).pipe(t.timestampRollover);t.timestampRollover.pipe(t.h264);t.h264.pipe(t.captionStream);t.timestampRollover.pipe(t.metadataStream);t.timestampRollover.pipe(t.adts);t.elementary.on("data",function(i){if(i.type==="metadata"){for(var r=0;r<i.tracks.length;r++)t.tracks[i.tracks[r].type]||(t.tracks[i.tracks[r].type]=i.tracks[r],t.tracks[i.tracks[r].type].timelineStartInfo.baseMediaDecodeTime=n.baseMediaDecodeTime);if(t.tracks.video&&!t.videoSegmentStream){t.videoSegmentStream=new es(t.tracks.video,n);t.videoSegmentStream.on("timelineStartInfo",function(i){t.tracks.audio&&!n.keepOriginalTimestamps&&t.audioSegmentStream.setEarliestDts(i.dts-n.baseMediaDecodeTime)});t.videoSegmentStream.on("timingInfo",t.trigger.bind(t,"videoTimingInfo"));t.videoSegmentStream.on("data",function(n){t.trigger("data",{type:"video",data:n})});t.videoSegmentStream.on("done",t.trigger.bind(t,"done"));t.videoSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone"));t.videoSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline"));t.h264.pipe(t.videoSegmentStream)}if(t.tracks.audio&&!t.audioSegmentStream){t.audioSegmentStream=new ir(t.tracks.audio,n);t.audioSegmentStream.on("data",function(n){t.trigger("data",{type:"audio",data:n})});t.audioSegmentStream.on("done",t.trigger.bind(t,"done"));t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone"));t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline"));t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));t.adts.pipe(t.audioSegmentStream)}t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video})}});t.captionStream.on("data",function(r){var u;u=t.tracks.video?t.tracks.video.timelineStartInfo.pts||0:0;r.startTime=i.metadataTsToSeconds(r.startPts,u,n.keepOriginalTimestamps);r.endTime=i.metadataTsToSeconds(r.endPts,u,n.keepOriginalTimestamps);t.trigger("caption",r)});t=vf(t);t.metadataStream.on("data",t.trigger.bind(t,"id3Frame"));return t},hs=function(n){var t={type:"aac",tracks:{audio:null},metadataStream:new h.MetadataStream,aacStream:new cf,audioRollover:new h.TimestampRolloverStream("audio"),timedMetadataRollover:new h.TimestampRolloverStream("timed-metadata"),adtsStream:new rt(!0)};t.headOfPipeline=t.aacStream;t.aacStream.pipe(t.audioRollover).pipe(t.adtsStream);t.aacStream.pipe(t.timedMetadataRollover).pipe(t.metadataStream);t.metadataStream.on("timestamp",function(n){t.aacStream.setTimestamp(n.timeStamp)});t.aacStream.on("data",function(i){if((i.type==="timed-metadata"||i.type==="audio")&&!t.audioSegmentStream){t.tracks.audio=t.tracks.audio||{timelineStartInfo:{baseMediaDecodeTime:n.baseMediaDecodeTime},codec:"adts",type:"audio"};t.audioSegmentStream=new ir(t.tracks.audio,n);t.audioSegmentStream.on("data",function(n){t.trigger("data",{type:"audio",data:n})});t.audioSegmentStream.on("partialdone",t.trigger.bind(t,"partialdone"));t.audioSegmentStream.on("done",t.trigger.bind(t,"done"));t.audioSegmentStream.on("endedtimeline",t.trigger.bind(t,"endedtimeline"));t.audioSegmentStream.on("timingInfo",t.trigger.bind(t,"audioTimingInfo"));t.adtsStream.pipe(t.audioSegmentStream);t.trigger("trackinfo",{hasAudio:!!t.tracks.audio,hasVideo:!!t.tracks.video})}});t=vf(t);t.metadataStream.on("data",t.trigger.bind(t,"id3Frame"));return t},yf=function(n,t){n.on("data",t.trigger.bind(t,"data"));n.on("done",t.trigger.bind(t,"done"));n.on("partialdone",t.trigger.bind(t,"partialdone"));n.on("endedtimeline",t.trigger.bind(t,"endedtimeline"));n.on("audioTimingInfo",t.trigger.bind(t,"audioTimingInfo"));n.on("videoTimingInfo",t.trigger.bind(t,"videoTimingInfo"));n.on("trackinfo",t.trigger.bind(t,"trackinfo"));n.on("id3Frame",function(r){r.dispatchType=n.metadataStream.dispatchType;r.cueTime=i.videoTsToSeconds(r.pts);t.trigger("id3Frame",r)});n.on("caption",function(n){t.trigger("caption",n)})},rr=function rr(n){var t=null,i=!0;n=n||{};rr.prototype.init.call(this);n.baseMediaDecodeTime=n.baseMediaDecodeTime||0;this.push=function(r){if(i){var u=os(r);u&&(!t||t.type!=="aac")?(t=hs(n),yf(t,this)):u||t&&t.type==="ts"||(t=ss(n),yf(t,this));i=!1}t.headOfPipeline.push(r)};this.flush=function(){t&&(i=!0,t.headOfPipeline.flush())};this.partialFlush=function(){t&&t.headOfPipeline.partialFlush()};this.endTimeline=function(){t&&t.headOfPipeline.endTimeline()};this.reset=function(){t&&t.headOfPipeline.reset()};this.setBaseMediaDecodeTime=function(i){(n.keepOriginalTimestamps||(n.baseMediaDecodeTime=i),t)&&(t.tracks.audio&&(t.tracks.audio.timelineStartInfo.dts=undefined,t.tracks.audio.timelineStartInfo.pts=undefined,s.clearDtsInfo(t.tracks.audio),t.audioRollover&&t.audioRollover.discontinuity()),t.tracks.video&&(t.videoSegmentStream&&(t.videoSegmentStream.gopCache_=[]),t.tracks.video.timelineStartInfo.dts=undefined,t.tracks.video.timelineStartInfo.pts=undefined,s.clearDtsInfo(t.tracks.video)),t.timestampRollover&&t.timestampRollover.discontinuity())};this.setRemux=function(i){n.remux=i;t&&t.coalesceStream&&t.coalesceStream.setRemux(i)};this.setAudioAppendStart=function(n){t&&t.tracks.audio&&t.audioSegmentStream&&t.audioSegmentStream.setAudioAppendStart(n)};this.alignGopsWith=function(){return}};rr.prototype=new o;var cs=rr,ls=function(n){return n>>>0},as=function(n){return("00"+n.toString(16)).slice(-2)},pf={toUnsigned:ls,toHexString:as},vs=function(n){var t="";return t+=String.fromCharCode(n[0]),t+=String.fromCharCode(n[1]),t+=String.fromCharCode(n[2]),t+String.fromCharCode(n[3])},ys=vs,ps=pf.toUnsigned,wf=function wf(n,t){var r=[],i,f,o,u,e;if(!t.length)return null;for(i=0;i<n.byteLength;)f=ps(n[i]<<24|n[i+1]<<16|n[i+2]<<8|n[i+3]),o=ys(n.subarray(i+4,i+8)),u=f>1?i+f:n.byteLength,o===t[0]&&(t.length===1?r.push(n.subarray(i+8,u)):(e=wf(n.subarray(i+8,u),t.slice(1)),e.length&&(r=r.concat(e)))),i=u;return r},et=wf,bf=pf.toUnsigned,ws=function(n){var t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),baseMediaDecodeTime:bf(n[4]<<24|n[5]<<16|n[6]<<8|n[7])};return t.version===1&&(t.baseMediaDecodeTime*=Math.pow(2,32),t.baseMediaDecodeTime+=bf(n[8]<<24|n[9]<<16|n[10]<<8|n[11])),t},bs=ws,ks=function(n){return{isLeading:(n[0]&12)>>>2,dependsOn:n[0]&3,isDependedOn:(n[1]&192)>>>6,hasRedundancy:(n[1]&48)>>>4,paddingValue:(n[1]&14)>>>1,isNonSyncSample:n[1]&1,degradationPriority:n[2]<<8|n[3]}},kf=ks,ds=function(n){var i={version:n[0],flags:new Uint8Array(n.subarray(1,4)),samples:[]},u=new DataView(n.buffer,n.byteOffset,n.byteLength),h=i.flags[2]&1,c=i.flags[2]&4,e=i.flags[1]&1,o=i.flags[1]&2,l=i.flags[1]&4,s=i.flags[1]&8,f=u.getUint32(4),t=8,r;for(h&&(i.dataOffset=u.getInt32(t),t+=4),c&&f&&(r={flags:kf(n.subarray(t,t+4))},t+=4,e&&(r.duration=u.getUint32(t),t+=4),o&&(r.size=u.getUint32(t),t+=4),s&&(r.compositionTimeOffset=i.version===1?u.getInt32(t):u.getUint32(t),t+=4),i.samples.push(r),f--);f--;)r={},e&&(r.duration=u.getUint32(t),t+=4),o&&(r.size=u.getUint32(t),t+=4),l&&(r.flags=kf(n.subarray(t,t+4)),t+=4),s&&(r.compositionTimeOffset=i.version===1?u.getInt32(t):u.getUint32(t),t+=4),i.samples.push(r);return i},gs=ds,nh=function(n){var r=new DataView(n.buffer,n.byteOffset,n.byteLength),t={version:n[0],flags:new Uint8Array(n.subarray(1,4)),trackId:r.getUint32(4)},u=t.flags[2]&1,f=t.flags[2]&2,e=t.flags[2]&8,o=t.flags[2]&16,s=t.flags[2]&32,h=t.flags[0]&65536,c=t.flags[0]&131072,i;return i=8,u&&(i+=4,t.baseDataOffset=r.getUint32(12),i+=4),f&&(t.sampleDescriptionIndex=r.getUint32(i),i+=4),e&&(t.defaultSampleDuration=r.getUint32(i),i+=4),o&&(t.defaultSampleSize=r.getUint32(i),i+=4),s&&(t.defaultSampleFlags=r.getUint32(i)),h&&(t.durationIsEmpty=!0),!u&&c&&(t.baseDataOffsetIsMoof=!0),t},th=nh,ih=tt.discardEmulationPreventionBytes,rh=at.CaptionStream,uh=function(n,t){for(var i,u=n,r=0;r<t.length;r++){if(i=t[r],u<i.size)return i;u-=i.size}return null},fh=function(n,t,i){for(var c=new DataView(n.buffer,n.byteOffset,n.byteLength),h=[],u,f,o,s,e,r=0;r+4<n.length;r+=f)if(f=c.getUint32(r),r+=4,!(f<=0))switch(n[r]&31){case 6:if(s=n.subarray(r+1,r+1+f),e=uh(r,t),u={nalUnitType:"sei_rbsp",size:f,data:s,escapedRBSP:ih(s),trackId:i},e)u.pts=e.pts,u.dts=e.dts,o=e;else if(o)u.pts=o.pts,u.dts=o.dts;else{console.log("We've encountered a nal unit without data. See mux.js#233.");break}h.push(u)}return h},eh=function(n,t,i){var r=t,f=i.defaultSampleDuration||0,e=i.defaultSampleSize||0,o=i.trackId,u=[];return n.forEach(function(n){var i=gs(n),t=i.samples;t.forEach(function(n){n.duration===undefined&&(n.duration=f);n.size===undefined&&(n.size=e);n.trackId=o;n.dts=r;n.compositionTimeOffset===undefined&&(n.compositionTimeOffset=0);n.pts=r+n.compositionTimeOffset;r+=n.duration});u=u.concat(t)}),u},oh=function(n,t){var u=et(n,["moof","traf"]),f=et(n,["mdat"]),i={},r=[];return f.forEach(function(n,t){var i=u[t];r.push({mdat:n,traf:i})}),r.forEach(function(n){var c=n.mdat,u=n.traf,l=et(u,["tfhd"]),f=th(l[0]),r=f.trackId,e=et(u,["tfdt"]),a=e.length>0?bs(e[0]).baseMediaDecodeTime:0,o=et(u,["trun"]),s,h;t===r&&o.length>0&&(s=eh(o,a,f),h=fh(c,s,r),i[r]||(i[r]=[]),i[r]=i[r].concat(h))}),i},sh=function(n,t,i){var r;return t===null?null:(r=oh(n,t),{seiNals:r[t],timescale:i})},hh=function(){var f=!1,r,u,n,t,i,e;this.isInitialized=function(){return f};this.init=function(n){r=new rh;f=!0;e=n?n.isPartial:!1;r.on("data",function(n){n.startTime=n.startPts/t;n.endTime=n.endPts/t;i.captions.push(n);i.captionStreams[n.stream]=!0})};this.isNewInit=function(i,r){return i&&i.length===0||r&&typeof r=="object"&&Object.keys(r).length===0?!1:n!==i[0]||t!==r[n]};this.parse=function(r,f,e){var o,s;if(this.isInitialized())if(f&&e){if(this.isNewInit(f,e))n=f[0],t=e[n];else if(n===null||!t)return u.push(r),null}else return null;else return null;while(u.length>0)s=u.shift(),this.parse(s,f,e);return(o=sh(r,n,t),o===null||!o.seiNals)?null:(this.pushNals(o.seiNals),this.flushStream(),i)};this.pushNals=function(n){if(!this.isInitialized()||!n||n.length===0)return null;n.forEach(function(n){r.push(n)})};this.flushStream=function(){if(!this.isInitialized())return null;e?r.partialFlush():r.flush()};this.clearParsedCaptions=function(){i.captions=[];i.captionStreams={}};this.resetCaptionStream=function(){if(!this.isInitialized())return null;r.reset()};this.clearAllCaptions=function(){this.clearParsedCaptions();this.resetCaptionStream()};this.reset=function(){u=[];n=null;t=null;i?this.clearParsedCaptions():i={captions:[],captionStreams:{}};this.resetCaptionStream()};this.reset()},ch=hh,ur=function(n){return n==="AudioSegmentStream"?"audio":n==="VideoSegmentStream"?"video":""},lh=function(n,t){t.on("data",function(t){var r=t.initSegment,i;t.initSegment={data:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength};i=t.data;t.data=i.buffer;n.postMessage({action:"data",segment:t,byteOffset:i.byteOffset,byteLength:i.byteLength},[t.data])});t.on("done",function(){n.postMessage({action:"done"})});t.on("gopInfo",function(t){n.postMessage({action:"gopInfo",gopInfo:t})});t.on("videoSegmentTimingInfo",function(t){var r={start:{decode:i.videoTsToSeconds(t.start.dts),presentation:i.videoTsToSeconds(t.start.pts)},end:{decode:i.videoTsToSeconds(t.end.dts),presentation:i.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:i.videoTsToSeconds(t.baseMediaDecodeTime)};t.prependedContentDuration&&(r.prependedContentDuration=i.videoTsToSeconds(t.prependedContentDuration));n.postMessage({action:"videoSegmentTimingInfo",videoSegmentTimingInfo:r})});t.on("audioSegmentTimingInfo",function(t){var r={start:{decode:i.videoTsToSeconds(t.start.dts),presentation:i.videoTsToSeconds(t.start.pts)},end:{decode:i.videoTsToSeconds(t.end.dts),presentation:i.videoTsToSeconds(t.end.pts)},baseMediaDecodeTime:i.videoTsToSeconds(t.baseMediaDecodeTime)};t.prependedContentDuration&&(r.prependedContentDuration=i.videoTsToSeconds(t.prependedContentDuration));n.postMessage({action:"audioSegmentTimingInfo",audioSegmentTimingInfo:r})});t.on("id3Frame",function(t){n.postMessage({action:"id3Frame",id3Frame:t})});t.on("caption",function(t){n.postMessage({action:"caption",caption:t})});t.on("trackinfo",function(t){n.postMessage({action:"trackinfo",trackInfo:t})});t.on("audioTimingInfo",function(t){n.postMessage({action:"audioTimingInfo",audioTimingInfo:{start:i.videoTsToSeconds(t.start),end:i.videoTsToSeconds(t.end)}})});t.on("videoTimingInfo",function(t){n.postMessage({action:"videoTimingInfo",videoTimingInfo:{start:i.videoTsToSeconds(t.start),end:i.videoTsToSeconds(t.end)}})})},ah=function(n,t){t.on("data",function(t){var u={data:t.data.track.initSegment.buffer,byteOffset:t.data.track.initSegment.byteOffset,byteLength:t.data.track.initSegment.byteLength},f={data:t.data.boxes.buffer,byteOffset:t.data.boxes.byteOffset,byteLength:t.data.boxes.byteLength},r={boxes:f,initSegment:u,type:t.type,sequence:t.data.sequence};typeof t.data.videoFrameDts!="undefined"&&(r.videoFrameDtsTime=i.videoTsToSeconds(t.data.videoFrameDts));typeof t.data.videoFramePts!="undefined"&&(r.videoFramePtsTime=i.videoTsToSeconds(t.data.videoFramePts));n.postMessage({action:"data",segment:r},[r.boxes.data,r.initSegment.data])});t.on("id3Frame",function(t){n.postMessage({action:"id3Frame",id3Frame:t})});t.on("caption",function(t){n.postMessage({action:"caption",caption:t})});t.on("done",function(t){n.postMessage({action:"done",type:ur(t)})});t.on("partialdone",function(t){n.postMessage({action:"partialdone",type:ur(t)})});t.on("endedsegment",function(t){n.postMessage({action:"endedSegment",type:ur(t)})});t.on("trackinfo",function(t){n.postMessage({action:"trackinfo",trackInfo:t})});t.on("audioTimingInfo",function(t){if(t.start===null){n.postMessage({action:"audioTimingInfo",audioTimingInfo:t});return}var r={start:i.videoTsToSeconds(t.start)};t.end&&(r.end=i.videoTsToSeconds(t.end));n.postMessage({action:"audioTimingInfo",audioTimingInfo:r})});t.on("videoTimingInfo",function(t){var r={start:i.videoTsToSeconds(t.start)};t.end&&(r.end=i.videoTsToSeconds(t.end));n.postMessage({action:"videoTimingInfo",videoTimingInfo:r})})},df=function(){function r(n,t){this.options=t||{};this.self=n;this.init()}var t=r.prototype;return t.init=function(){this.transmuxer&&this.transmuxer.dispose();this.transmuxer=this.options.handlePartialData?new cs(this.options):new us.Transmuxer(this.options);this.options.handlePartialData?ah(this.self,this.transmuxer):lh(this.self,this.transmuxer)},t.pushMp4Captions=function(n){this.captionParser||(this.captionParser=new ch,this.captionParser.init());var t=new Uint8Array(n.data,n.byteOffset,n.byteLength),i=this.captionParser.parse(t,n.trackIds,n.timescales);this.self.postMessage({action:"mp4Captions",captions:i&&i.captions||[],data:t.buffer},[t.buffer])},t.clearAllMp4Captions=function(){this.captionParser&&this.captionParser.clearAllCaptions()},t.clearParsedMp4Captions=function(){this.captionParser&&this.captionParser.clearParsedCaptions()},t.push=function(n){var t=new Uint8Array(n.data,n.byteOffset,n.byteLength);this.transmuxer.push(t)},t.reset=function(){this.transmuxer.reset()},t.setTimestampOffset=function(n){var t=n.timestampOffset||0;this.transmuxer.setBaseMediaDecodeTime(Math.round(i.secondsToVideoTs(t)))},t.setAudioAppendStart=function(n){this.transmuxer.setAudioAppendStart(Math.ceil(i.secondsToVideoTs(n.appendStart)))},t.setRemux=function(n){this.transmuxer.setRemux(n.remux)},t.flush=function(){this.transmuxer.flush();n.postMessage({action:"done",type:"transmuxed"})},t.partialFlush=function(){this.transmuxer.partialFlush();n.postMessage({action:"partialdone",type:"transmuxed"})},t.endTimeline=function(){this.transmuxer.endTimeline();n.postMessage({action:"endedtimeline",type:"transmuxed"})},t.alignGopsWith=function(n){this.transmuxer.alignGopsWith(n.gopsToAlignWith.slice())},r}(),vh=function(n){n.onmessage=function(t){if(t.data.action==="init"&&t.data.options){this.messageHandlers=new df(n,t.data.options);return}this.messageHandlers||(this.messageHandlers=new df(n));t.data&&t.data.action&&t.data.action!=="init"&&this.messageHandlers[t.data.action]&&this.messageHandlers[t.data.action](t.data)}};return new vh(n)}()}),hdt=function(n){var t=n.attributes||{};if(t.CODECS)return bo(t.CODECS)},iet=function(n,t){var i=t.attributes||{};return n&&n.mediaGroups&&n.mediaGroups.AUDIO&&i.AUDIO&&n.mediaGroups.AUDIO[i.AUDIO]},cdt=function(n,t){var u,i,r;if(!iet(n,t))return!0;u=t.attributes||{};i=n.mediaGroups.AUDIO[u.AUDIO];for(r in i)if(!i[r].uri&&!i[r].playlists)return!0;return!1},ts=function(n,t){var f=t.attributes||{},i=hdt(t)||{},u,r;return iet(n,t)&&!i.audio&&(cdt(n,t)||(u=owt(n,f.AUDIO),u&&(i.audio=u.audio))),r={},i.video&&(r.video=aut(""+i.video.type+i.video.details)),i.audio&&(r.audio=aut(""+i.audio.type+i.audio.details)),i.text&&(r.text=i.text.type),i.unknown&&(r.unknown=i.unknown),r},hu=function(t){return n.log.debug?n.log.debug.bind(n,"VHS:",t+" >"):function(){}},el=hu("PlaylistSelector"),ret=function(n){if(n&&n.playlist){var t=n.playlist;return JSON.stringify({id:t.id,bandwidth:n.bandwidth,width:n.width,height:n.height,codecs:t.attributes&&t.attributes.CODECS||""})}},ol=function(n,t){if(!n)return"";var i=u.getComputedStyle(n);return i?i[t]:""},is=function(n,t){var i=n.slice();n.sort(function(n,r){var u=t(n,r);return u===0?i.indexOf(n)-i.indexOf(r):u})},ww=function(n,t){var i,r;return n.attributes.BANDWIDTH&&(i=n.attributes.BANDWIDTH),i=i||u.Number.MAX_VALUE,t.attributes.BANDWIDTH&&(r=t.attributes.BANDWIDTH),r=r||u.Number.MAX_VALUE,i-r},ldt=function(n,t){var i,r;return(n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width&&(i=n.attributes.RESOLUTION.width),i=i||u.Number.MAX_VALUE,t.attributes.RESOLUTION&&t.attributes.RESOLUTION.width&&(r=t.attributes.RESOLUTION.width),r=r||u.Number.MAX_VALUE,i===r&&n.attributes.BANDWIDTH&&t.attributes.BANDWIDTH)?n.attributes.BANDWIDTH-t.attributes.BANDWIDTH:i-r},uet=function(n,t,i,r,f){var h,e,o,l,p,w,b,k,d,g,nt,a,s;if(n){h={bandwidth:t,width:i,height:r,limitRenditionByPlayerDimensions:f};e=n.playlists.map(function(n){var t,i=n.attributes.RESOLUTION&&n.attributes.RESOLUTION.width,r=n.attributes.RESOLUTION&&n.attributes.RESOLUTION.height;return t=n.attributes.BANDWIDTH,t=t||u.Number.MAX_VALUE,{bandwidth:t,width:i,height:r,playlist:n}});is(e,function(n,t){return n.bandwidth-t.bandwidth});e=e.filter(function(n){return!kt.isIncompatible(n.playlist)});o=e.filter(function(n){return kt.isEnabled(n.playlist)});o.length||(o=e.filter(function(n){return!kt.isDisabled(n.playlist)}));var v=o.filter(function(n){return n.bandwidth*it.BANDWIDTH_VARIANCE<t}),c=v[v.length-1],y=v.filter(function(n){return n.bandwidth===c.bandwidth})[0];return f===!1?(l=y||o[0]||e[0],l&&l.playlist)?(p="sortedPlaylistReps",y&&(p="bandwidthBestRep"),o[0]&&(p="enabledPlaylistReps"),el("choosing "+ret(l)+" using "+p+" with options",h),l.playlist):(el("could not choose a playlist with options",h),null):(w=v.filter(function(n){return n.width&&n.height}),is(w,function(n,t){return n.width-t.width}),b=w.filter(function(n){return n.width===i&&n.height===r}),c=b[b.length-1],k=b.filter(function(n){return n.bandwidth===c.bandwidth})[0],k||(d=w.filter(function(n){return n.width>i||n.height>r}),g=d.filter(function(n){return n.width===d[0].width&&n.height===d[0].height}),c=g[g.length-1],nt=g.filter(function(n){return n.bandwidth===c.bandwidth})[0]),a=nt||k||y||o[0]||e[0],a&&a.playlist)?(s="sortedPlaylistReps",nt?s="resolutionPlusOneRep":k?s="resolutionBestRep":y?s="bandwidthBestRep":o[0]&&(s="enabledPlaylistReps"),el("choosing "+ret(a)+" using "+s+" with options",h),a.playlist):(el("could not choose a playlist with options",h),null)}},fet=function(){var n=this.useDevicePixelRatio?u.devicePixelRatio||1:1;return uet(this.playlists.master,this.systemBandwidth,parseInt(ol(this.tech_.el(),"width"),10)*n,parseInt(ol(this.tech_.el(),"height"),10)*n,this.limitRenditionByPlayerDimensions)},adt=function(n){var t=-1;if(n<0||n>1)throw new Error("Moving average bandwidth decay must be between 0 and 1.");return function(){var i=this.useDevicePixelRatio?u.devicePixelRatio||1:1;return t<0&&(t=this.systemBandwidth),t=n*this.systemBandwidth+(1-n)*t,uet(this.playlists.master,t,parseInt(ol(this.tech_.el(),"width"),10)*i,parseInt(ol(this.tech_.el(),"height"),10)*i,this.limitRenditionByPlayerDimensions)}},vdt=function(n){var f=n.master,e=n.currentTime,o=n.bandwidth,s=n.duration,h=n.segmentDuration,c=n.timeUntilRebuffer,l=n.currentTimeline,a=n.syncController,u=f.playlists.filter(function(n){return!kt.isIncompatible(n)}),t=u.filter(kt.isEnabled);t.length||(t=u.filter(function(n){return!kt.isDisabled(n)}));var v=t.filter(kt.hasAttribute.bind(null,"BANDWIDTH")),i=v.map(function(n){var t=a.getSyncPoint(n,s,l,e),i=t?1:2,r=kt.estimateSegmentRequestTime(h,o,n),u=r*i-c;return{playlist:n,rebufferingImpact:u}}),r=i.filter(function(n){return n.rebufferingImpact<=0});return(is(r,function(n,t){return ww(t.playlist,n.playlist)}),r.length)?r[0]:(is(i,function(n,t){return n.rebufferingImpact-t.rebufferingImpact}),i[0]||null)},ydt=function(){var i=this,n=this.playlists.master.playlists.filter(kt.isEnabled),t;return is(n,function(n,t){return ww(n,t)}),t=n.filter(function(n){return!!ts(i.playlists.master,n).video}),t[0]||null},pdt=function(n,t,i){if(!n[i]){t.trigger({type:"usage",name:"vhs-608"});t.trigger({type:"usage",name:"hls-608"});var r=t.textTracks().getTrackById(i);n[i]=r?r:t.addRemoteTextTrack({kind:"captions",id:i,label:i},!1).track}},wdt=function(n){var f=n.inbandTextTracks,t=n.captionArray,i=n.timestampOffset,r;t&&(r=u.WebKitDataCue||u.VTTCue,t.forEach(function(n){var t=n.stream;f[t].addCue(new r(n.startTime+i,n.endTime+i,n.text))}))},bdt=function(t){Object.defineProperties(t.frame,{id:{get:function(){return n.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),t.value.key}},value:{get:function(){return n.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),t.value.data}},privateData:{get:function(){return n.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),t.value.data}}})},kdt=function(n){var c=n.inbandTextTracks,s=n.metadataArray,l=n.timestampOffset,a=n.videoDuration,h,t,r,f,i,e,o;if(s&&(h=u.WebKitDataCue||u.VTTCue,t=c.metadataTrack_,t)&&(s.forEach(function(n){var i=n.cueTime+l;typeof i!="number"||u.isNaN(i)||i<0||!(i<Infinity)||n.frames.forEach(function(n){var r=new h(i,i,n.value||n.url||n.data||"");r.frame=n;r.value=n;bdt(r);t.addCue(r)})}),t.cues&&t.cues.length)){for(r=t.cues,f=[],i=0;i<r.length;i++)r[i]&&f.push(r[i]);e=f.reduce(function(n,t){var i=n[t.startTime]||[];return i.push(t),n[t.startTime]=i,n},{});o=Object.keys(e).sort(function(n,t){return Number(n)-Number(t)});o.forEach(function(n,t){var i=e[n],r=Number(o[t+1])||a;i.forEach(function(n){n.endTime=r})})}},ddt=function(n,t,i){n.metadataTrack_||(n.metadataTrack_=i.addRemoteTextTrack({kind:"metadata",label:"Timed Metadata"},!1).track,n.metadataTrack_.inBandMetadataTrackDispatchType=t)},rs=function(n,t,i){var u,r;if(i&&i.cues)for(u=i.cues.length;u--;)r=i.cues[u],r.startTime>=n&&r.endTime<=t&&i.removeCue(r)},gdt=function(n){var t=n.cues,r,u,f,i;if(t)for(r=0;r<t.length;r++){for(u=[],f=0,i=0;i<t.length;i++)t[r].startTime===t[i].startTime&&t[r].endTime===t[i].endTime&&t[r].text===t[i].text&&(f++,f>1&&u.push(t[i]));u.length&&u.forEach(function(t){return n.removeCue(t)})}},ngt=function(n,t,i){if(typeof t=="undefined"||t===null||!n.length)return[];for(var u=Math.ceil((t-i+3)*po),r=0;r<n.length;r++)if(n[r].pts>u)break;return n.slice(r)},tgt=function(n,t,i){if(!t.length)return n;if(i)return t.slice();var u=t[0].pts,r=0;for(r;r<n.length;r++)if(n[r].pts>=u)break;return n.slice(0,r).concat(t)},igt=function(n,t,i,r){for(var o=Math.ceil((t-r)*po),s=Math.ceil((i-r)*po),e=n.slice(),f=n.length,u;f--;)if(n[f].pts<=s)break;if(f===-1)return e;for(u=f+1;u--;)if(n[u].pts<=o)break;return u=Math.max(u,0),e.splice(u,f-u+1),e},rgt=function(n,t){var r,f,i,u;if(!n&&!t||!n&&t||n&&!t)return!1;if(n===t)return!0;if(r=Object.keys(n).sort(),f=Object.keys(t).sort(),r.length!==f.length)return!1;for(i=0;i<r.length;i++)if((u=r[i],u!==f[i])||n[u]!==t[u])return!1;return!0},ugt=500,eet=function(n){return typeof n=="number"&&isFinite(n)},sl=1/60,fgt=function(n,t,i){return n!=="main"||!t||!i?null:!i.hasAudio&&!i.hasVideo?"Neither audio nor video found in segment.":t.hasVideo&&!i.hasVideo?"Only audio found in segment when we expected video. We can't switch to audio only from a stream that had video. To get rid of this message, please add codec information to the manifest.":!t.hasVideo&&i.hasVideo?"Video found in segment when we expected only audio. We can't switch to a stream with video from an audio only stream. To get rid of this message, please add codec information to the manifest.":null},egt=function(n,t,i){var r=t-it.BACK_BUFFER_LENGTH,u;return n.length&&(r=Math.max(r,n.start(0))),u=t-i,Math.min(u,r)},ogt=function(n){var i=n.segment,f=i.start,e=i.end,t=n.playlist,r=t.mediaSequence,o=t.id,u=t.segments,s=u===void 0?[]:u,h=n.mediaIndex,c=n.timeline;return["appending ["+h+"] of ["+r+", "+(r+s.length)+"] from playlist ["+o+"]","["+f+" => "+e+"] in timeline ["+c+"]"].join(" ")},oet=function(n){return n+"TimingInfo"},set=function(n){var i=n.segmentTimeline,r=n.currentTimeline,u=n.startOfSegment,t=n.buffered,f=n.overrideCheck;return!f&&i===r?null:i<r?u:t.length?t.end(t.length-1):u},het=function(n){var u=n.timelineChangeController,e=n.currentTimeline,t=n.segmentTimeline,f=n.loaderType,o=n.audioDisabled,i,r;return e===t?!1:f==="audio"?(i=u.lastTimelineChange({type:"main"}),!i||i.to!==t):f==="main"&&o?(r=u.pendingTimelineChange({type:"audio"}),r&&r.to===t)?!1:!0:!1},sgt=function(n,t){var i=n&&typeof n.start=="number"&&typeof n.end=="number"?n.end-n.start:0,r=t&&typeof t.start=="number"&&typeof t.end=="number"?t.end-t.start:0;return Math.max(i,r)},cet=function(n){var t=n.segmentDuration,i=n.maxDuration;return t?Math.round(t)>i+ou:!1},hgt=function(n,t){var i;if(t!=="hls"||(i=sgt(n.audioTimingInfo,n.videoTimingInfo),!i))return null;var r=n.playlist.targetDuration,u=cet({segmentDuration:i,maxDuration:r*2}),f=cet({segmentDuration:i,maxDuration:r}),e="Segment with index "+n.mediaIndex+" "+("from playlist "+n.playlist.id+" ")+("has a duration of "+i+" ")+("when the reported duration is "+n.duration+" ")+("and the target duration is "+r+". ")+"For HLS content, a duration in excess of the target duration may result in playback issues. See the HLS specification section on EXT-X-TARGETDURATION for more details: https://tools.ietf.org/html/draft-pantos-http-live-streaming-23#section-4.3.3.1";return u||f?{severity:u?"warn":"info",message:e}:null},bw=function(t){function r(i){var r;if(r=t.call(this)||this,!i)throw new TypeError("Initialization settings are required");if(typeof i.currentTime!="function")throw new TypeError("No currentTime getter specified");if(!i.mediaSource)throw new TypeError("No MediaSource specified");r.bandwidth=i.bandwidth;r.throughput={rate:0,count:0};r.roundTrip=NaN;r.resetStats_();r.mediaIndex=null;r.hasPlayed_=i.hasPlayed;r.currentTime_=i.currentTime;r.seekable_=i.seekable;r.seeking_=i.seeking;r.duration_=i.duration;r.mediaSource_=i.mediaSource;r.vhs_=i.vhs;r.loaderType_=i.loaderType;r.currentMediaInfo_=void 0;r.startingMediaInfo_=void 0;r.segmentMetadataTrack_=i.segmentMetadataTrack;r.goalBufferLength_=i.goalBufferLength;r.sourceType_=i.sourceType;r.sourceUpdater_=i.sourceUpdater;r.inbandTextTracks_=i.inbandTextTracks;r.state_="INIT";r.handlePartialData_=i.handlePartialData;r.timelineChangeController_=i.timelineChangeController;r.shouldSaveSegmentTimingInfo_=!0;r.checkBufferTimeout_=null;r.error_=void 0;r.currentTimeline_=-1;r.pendingSegment_=null;r.xhrOptions_=null;r.pendingSegments_=[];r.audioDisabled_=!1;r.isPendingTimestampOffset_=!1;r.gopBuffer_=[];r.timeMapping_=0;r.safeAppend_=n.browser.IE_VERSION>=11;r.appendInitSegment_={audio:!0,video:!0};r.playlistOfLastInitSegment_={audio:null,video:null};r.callQueue_=[];r.loadQueue_=[];r.metadataQueue_={id3:[],caption:[]};r.activeInitSegmentId_=null;r.initSegments_={};r.cacheEncryptionKeys_=i.cacheEncryptionKeys;r.keyCache_={};r.decrypter_=i.decrypter;r.syncController_=i.syncController;r.syncPoint_={segmentIndex:0,time:0};r.transmuxer_=r.createTransmuxer_();r.triggerSyncInfoUpdate_=function(){return r.trigger("syncinfoupdate")};r.syncController_.on("syncinfoupdate",r.triggerSyncInfoUpdate_);r.mediaSource_.addEventListener("sourceopen",function(){r.isEndOfStream_()||(r.ended_=!1)});r.fetchAtBuffer_=!1;r.logger_=hu("SegmentLoader["+r.loaderType_+"]");Object.defineProperty(ri(r),"state",{get:function(){return this.state_},set:function(n){n!==this.state_&&(this.logger_(this.state_+" -> "+n),this.state_=n,this.trigger("statechange"))}});r.sourceUpdater_.on("ready",function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()});if(r.loaderType_==="main")r.timelineChangeController_.on("pendingtimelinechange",function(){r.hasEnoughInfoToAppend_()&&r.processCallQueue_()});if(r.loaderType_==="audio")r.timelineChangeController_.on("timelinechange",function(){r.hasEnoughInfoToLoad_()&&r.processLoadQueue_();r.hasEnoughInfoToAppend_()&&r.processCallQueue_()});return r}vi(r,t);var i=r.prototype;return i.createTransmuxer_=function(){var n=new sdt;return n.postMessage({action:"init",options:{remux:!1,alignGopsAtEnd:this.safeAppend_,keepOriginalTimestamps:!0,handlePartialData:this.handlePartialData_}}),n},i.resetStats_=function(){this.mediaBytesTransferred=0;this.mediaRequests=0;this.mediaRequestsAborted=0;this.mediaRequestsTimedout=0;this.mediaRequestsErrored=0;this.mediaTransferDuration=0;this.mediaSecondsLoaded=0},i.dispose=function(){this.trigger("dispose");this.state="DISPOSED";this.pause();this.abort_();this.transmuxer_&&(this.transmuxer_.terminate(),ul.dispose());this.resetStats_();this.checkBufferTimeout_&&u.clearTimeout(this.checkBufferTimeout_);this.syncController_&&this.triggerSyncInfoUpdate_&&this.syncController_.off("syncinfoupdate",this.triggerSyncInfoUpdate_);this.off()},i.setAudio=function(n){this.audioDisabled_=!n;n?this.appendInitSegment_.audio=!0:this.sourceUpdater_.removeAudio(0,this.duration_())},i.abort=function(){if(this.state!=="WAITING"){this.pendingSegment_&&(this.pendingSegment_=null);return}this.abort_();this.state="READY";this.paused()||this.monitorBuffer_()},i.abort_=function(){this.pendingSegment_&&this.pendingSegment_.abortRequests&&this.pendingSegment_.abortRequests();this.pendingSegment_=null;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.timelineChangeController_.clearPendingTimelineChange(this.loaderType_)},i.checkForAbort_=function(n){return this.state==="APPENDING"&&!this.pendingSegment_?(this.state="READY",!0):!this.pendingSegment_||this.pendingSegment_.requestId!==n?!0:!1},i.error=function(n){return typeof n!="undefined"&&(this.logger_("error occurred:",n),this.error_=n),this.pendingSegment_=null,this.error_},i.endOfStream=function(){this.ended_=!0;this.transmuxer_&&ul.reset(this.transmuxer_);this.gopBuffer_.length=0;this.pause();this.trigger("ended")},i.buffered_=function(){if(!this.sourceUpdater_||!this.startingMediaInfo_)return n.createTimeRanges();if(this.loaderType_==="main"){var t=this.startingMediaInfo_,r=t.hasAudio,i=t.hasVideo,u=t.isMuxed;if(i&&r&&!this.audioDisabled_&&!u)return this.sourceUpdater_.buffered();if(i)return this.sourceUpdater_.videoBuffered()}return this.sourceUpdater_.audioBuffered()},i.initSegmentForMap=function(n,t){if(t===void 0&&(t=!1),!n)return null;var r=rl(n),i=this.initSegments_[r];return t&&!i&&n.bytes&&(this.initSegments_[r]=i={resolvedUri:n.resolvedUri,byterange:n.byterange,bytes:n.bytes,tracks:n.tracks,timescales:n.timescales}),i||n},i.segmentKey=function(n,t){var r,i,u;return(t===void 0&&(t=!1),!n)?null:(r=sft(n),i=this.keyCache_[r],this.cacheEncryptionKeys_&&t&&!i&&n.bytes&&(this.keyCache_[r]=i={resolvedUri:n.resolvedUri,bytes:n.bytes}),u={resolvedUri:(i||n).resolvedUri},i&&(u.bytes=i.bytes),u)},i.couldBeginLoading_=function(){return this.playlist_&&!this.paused()},i.load=function(){if(this.monitorBuffer_(),this.playlist_){if(this.syncController_.setDateTimeMapping(this.playlist_),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();this.couldBeginLoading_()&&(this.state==="READY"||this.state==="INIT")&&(this.state="READY")}},i.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},i.playlist=function(n,t){var i,r,u,f;if(t===void 0&&(t={}),n){if(i=this.playlist_,r=this.pendingSegment_,this.playlist_=n,this.xhrOptions_=t,this.state==="INIT"&&(n.syncInfo={mediaSequence:n.mediaSequence,time:0}),u=null,i&&(i.id?u=i.id:i.uri&&(u=i.uri)),this.logger_("playlist update ["+u+" => "+(n.id||n.uri)+"]"),this.trigger("syncinfoupdate"),this.state==="INIT"&&this.couldBeginLoading_())return this.init_();if(!i||i.uri!==n.uri){(this.mediaIndex!==null||this.handlePartialData_)&&this.resyncLoader();this.currentMediaInfo_=void 0;this.trigger("playlistupdate");return}f=n.mediaSequence-i.mediaSequence;this.logger_("live window shift ["+f+"]");this.mediaIndex!==null&&(this.mediaIndex-=f);r&&(r.mediaIndex-=f,r.mediaIndex>=0&&(r.segment=n.segments[r.mediaIndex]));this.syncController_.saveExpiredSegmentInfo(i,n)}},i.pause=function(){this.checkBufferTimeout_&&(u.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null)},i.paused=function(){return this.checkBufferTimeout_===null},i.resetEverything=function(n){this.ended_=!1;this.appendInitSegment_={audio:!0,video:!0};this.resetLoader();this.remove(0,Infinity,n);this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"})},i.resetLoader=function(){this.fetchAtBuffer_=!1;this.resyncLoader()},i.resyncLoader=function(){this.transmuxer_&&ul.reset(this.transmuxer_);this.mediaIndex=null;this.syncPoint_=null;this.isPendingTimestampOffset_=!1;this.callQueue_=[];this.loadQueue_=[];this.metadataQueue_.id3=[];this.metadataQueue_.caption=[];this.abort();this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})},i.remove=function(n,t,i){var r,u,f;if(i===void 0&&(i=function(){}),t===Infinity&&(t=this.duration_()),this.sourceUpdater_&&this.currentMediaInfo_){r=1;u=function(){r--;r===0&&i()};this.audioDisabled_||(r++,this.sourceUpdater_.removeAudio(n,t,u));this.loaderType_==="main"&&this.currentMediaInfo_&&this.currentMediaInfo_.hasVideo&&(this.gopBuffer_=igt(this.gopBuffer_,n,t,this.timeMapping_),r++,this.sourceUpdater_.removeVideo(n,t,u));for(f in this.inbandTextTracks_)rs(n,t,this.inbandTextTracks_[f]);rs(n,t,this.segmentMetadataTrack_);u()}},i.monitorBuffer_=function(){this.checkBufferTimeout_&&u.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=u.setTimeout(this.monitorBufferTick_.bind(this),1)},i.monitorBufferTick_=function(){this.state==="READY"&&this.fillBuffer_();this.checkBufferTimeout_&&u.clearTimeout(this.checkBufferTimeout_);this.checkBufferTimeout_=u.setTimeout(this.monitorBufferTick_.bind(this),ugt)},i.fillBuffer_=function(){if(!this.sourceUpdater_.updating()){this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_()));var t=this.buffered_(),n=this.checkBuffer_(t,this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_);n&&(n.timestampOffset=set({segmentTimeline:n.timeline,currentTimeline:this.currentTimeline_,startOfSegment:n.startOfSegment,buffered:t,overrideCheck:this.isPendingTimestampOffset_}),this.isPendingTimestampOffset_=!1,typeof n.timestampOffset=="number"&&this.timelineChangeController_.pendingTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:n.timeline}),this.loadSegment_(n))}},i.isEndOfStream_=function(n,t){if(n===void 0&&(n=this.mediaIndex),t===void 0&&(t=this.playlist_),!t||!this.mediaSource_)return!1;var i=n+1===t.segments.length;return t.endList&&this.mediaSource_.readyState==="open"&&i},i.checkBuffer_=function(n,t,i,r,u,f){var h=0,a,e,s,c,l,v,y,o;return(n.length&&(h=n.end(n.length-1)),a=Math.max(0,h-u),!t.segments.length)?null:a>=this.goalBufferLength_()?null:!r&&a>=1?null:(e=null,c=!1,f===null?(e=this.getSyncSegmentCandidate_(t),c=!0):i!==null?(l=t.segments[i],s=l&&l.end?l.end:h,e=i+1):this.fetchAtBuffer_?(v=kt.getMediaInfoForTime(t,h,f.segmentIndex,f.time),e=v.mediaIndex,s=v.startTime):(y=kt.getMediaInfoForTime(t,u,f.segmentIndex,f.time),e=y.mediaIndex,s=y.startTime),o=this.generateSegmentInfo_(t,e,s,c),!o)?void 0:this.mediaSource_&&this.playlist_&&o.mediaIndex===this.playlist_.segments.length-1&&this.mediaSource_.readyState==="ended"&&!this.seeking_()?void 0:(this.logger_("checkBuffer_ returning "+o.uri,{segmentInfo:o,playlist:t,currentMediaIndex:i,nextMediaIndex:e,startOfSegment:s,isSyncRequest:c}),o)},i.getSyncSegmentCandidate_=function(n){var i=this,t;return this.currentTimeline_===-1?0:(t=n.segments.map(function(n,t){return{timeline:n.timeline,segmentIndex:t}}).filter(function(n){return n.timeline===i.currentTimeline_}),t.length)?t[Math.min(t.length-1,1)].segmentIndex:Math.max(n.segments.length-1,0)},i.generateSegmentInfo_=function(n,t,i,r){if(t<0||t>=n.segments.length)return null;var u=n.segments[t],f=this.sourceUpdater_.audioBuffered(),s=this.sourceUpdater_.videoBuffered(),e,o;return f.length&&(e=f.end(f.length-1)-this.sourceUpdater_.audioTimestampOffset()),s.length&&(o=ngt(this.gopBuffer_,this.currentTime_()-this.sourceUpdater_.videoTimestampOffset(),this.timeMapping_)),{requestId:"segment-loader-"+Math.random(),uri:u.resolvedUri,mediaIndex:t,isSyncRequest:r,startOfSegment:i,playlist:n,bytes:null,encryptedBytes:null,timestampOffset:null,timeline:u.timeline,duration:u.duration,segment:u,byteLength:0,transmuxer:this.transmuxer_,audioAppendStart:e,gopsToAlignWith:o}},i.earlyAbortWhenNeeded_=function(n){var t;if(!this.vhs_.tech_.paused()&&this.xhrOptions_.timeout&&this.playlist_.attributes.BANDWIDTH&&!(Date.now()-(n.firstBytesReceivedAt||Date.now())<1e3)){var r=this.currentTime_(),u=n.bandwidth,f=this.pendingSegment_.duration,e=kt.estimateSegmentRequestTime(f,u,this.playlist_,n.bytesReceived),i=kwt(this.buffered_(),r,this.vhs_.tech_.playbackRate())-1;if(!(e<=i)&&(t=vdt({master:this.vhs_.playlists.master,currentTime:r,bandwidth:u,duration:this.duration_(),segmentDuration:f,timeUntilRebuffer:i,currentTimeline:this.currentTimeline_,syncController:this.syncController_}),t)){var s=e-i,h=s-t.rebufferingImpact,o=.5;(i<=ou&&(o=1),!t.playlist||t.playlist.uri===this.playlist_.uri||h<o)||(this.bandwidth=t.playlist.attributes.BANDWIDTH*it.BANDWIDTH_VARIANCE+1,this.trigger("earlyabort"))}}},i.handleAbort_=function(){this.mediaRequestsAborted+=1},i.handleProgress_=function(n,t){(this.earlyAbortWhenNeeded_(t.stats),this.checkForAbort_(t.requestId))||this.trigger("progress")},i.handleTrackInfo_=function(n,t){(this.earlyAbortWhenNeeded_(n.stats),this.checkForAbort_(n.requestId))||this.checkForIllegalMediaSwitch(t)||(t=t||{},rgt(this.currentMediaInfo_,t)||(this.appendInitSegment_={audio:!0,video:!0},this.startingMediaInfo_=t,this.currentMediaInfo_=t,this.logger_("trackinfo update",t),this.trigger("trackinfo")),this.checkForAbort_(n.requestId))||(this.pendingSegment_.trackInfo=t,this.hasEnoughInfoToAppend_()&&this.processCallQueue_())},i.handleTimingInfo_=function(n,t,i,r){if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){var u=this.pendingSegment_,f=oet(t);u[f]=u[f]||{};u[f][i]=r;this.logger_("timinginfo: "+t+" - "+i+" - "+r);this.hasEnoughInfoToAppend_()&&this.processCallQueue_()}},i.handleCaptions_=function(n,t){var u=this,f,r,i;if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){if(t.length===0){this.logger_("SegmentLoader received no captions from a caption event");return}if(f=this.pendingSegment_,!f.hasAppendedData_){this.metadataQueue_.caption.push(this.handleCaptions_.bind(this,n,t));return}r=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();i={};t.forEach(function(n){i[n.stream]=i[n.stream]||{startTime:Infinity,captions:[],endTime:0};var t=i[n.stream];t.startTime=Math.min(t.startTime,n.startTime+r);t.endTime=Math.max(t.endTime,n.endTime+r);t.captions.push(n)});Object.keys(i).forEach(function(n){var t=i[n],e=t.startTime,o=t.endTime,s=t.captions,f=u.inbandTextTracks_;u.logger_("adding cues from "+e+" -> "+o+" for "+n);pdt(f,u.vhs_.tech_,n);rs(e,o,f[n]);wdt({captionArray:s,inbandTextTracks:f,timestampOffset:r})});this.transmuxer_&&this.transmuxer_.postMessage({action:"clearParsedMp4Captions"})}},i.handleId3_=function(n,t,i){var r,u;if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){if(r=this.pendingSegment_,!r.hasAppendedData_){this.metadataQueue_.id3.push(this.handleId3_.bind(this,n,t,i));return}u=this.sourceUpdater_.videoTimestampOffset()===null?this.sourceUpdater_.audioTimestampOffset():this.sourceUpdater_.videoTimestampOffset();ddt(this.inbandTextTracks_,i,this.vhs_.tech_);kdt({inbandTextTracks:this.inbandTextTracks_,metadataArray:t,timestampOffset:u,videoDuration:this.duration_()})}},i.processMetadataQueue_=function(){this.metadataQueue_.id3.forEach(function(n){return n()});this.metadataQueue_.caption.forEach(function(n){return n()});this.metadataQueue_.id3=[];this.metadataQueue_.caption=[]},i.processCallQueue_=function(){var n=this.callQueue_;this.callQueue_=[];n.forEach(function(n){return n()})},i.processLoadQueue_=function(){var n=this.loadQueue_;this.loadQueue_=[];n.forEach(function(n){return n()})},i.hasEnoughInfoToLoad_=function(){if(this.loaderType_!=="audio")return!0;var n=this.pendingSegment_;return n?this.currentMediaInfo_?het({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:n.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?!1:!0:!0:!1},i.hasEnoughInfoToAppend_=function(){var n;if(!this.sourceUpdater_.ready()||(n=this.pendingSegment_,!n||!n.trackInfo))return!1;if(!this.handlePartialData_){var t=this.currentMediaInfo_,i=t.hasAudio,r=t.hasVideo,u=t.isMuxed;if(r&&!n.videoTimingInfo||i&&!this.audioDisabled_&&!u&&!n.audioTimingInfo)return!1}return het({timelineChangeController:this.timelineChangeController_,currentTimeline:this.currentTimeline_,segmentTimeline:n.timeline,loaderType:this.loaderType_,audioDisabled:this.audioDisabled_})?!1:!0},i.handleData_=function(n,t){var i,r,u;if(this.earlyAbortWhenNeeded_(n.stats),!this.checkForAbort_(n.requestId)){if(this.callQueue_.length||!this.hasEnoughInfoToAppend_()){this.callQueue_.push(this.handleData_.bind(this,n,t));return}(i=this.pendingSegment_,this.setTimeMapping_(i.timeline),this.updateMediaSecondsLoaded_(i.segment),this.mediaSource_.readyState!=="closed")&&(n.map&&(n.map=this.initSegmentForMap(n.map,!0),i.segment.map=n.map),n.key&&this.segmentKey(n.key,!0),i.isFmp4=n.isFmp4,i.timingInfo=i.timingInfo||{},i.isFmp4?(this.trigger("fmp4"),i.timingInfo.start=i[oet(t.type)].start):(r=this.loaderType_==="main"&&this.currentMediaInfo_.hasVideo,r&&(u=this.handlePartialData_?t.videoFramePtsTime:i.videoTimingInfo.start),i.timingInfo.start=this.trueSegmentStart_({currentStart:i.timingInfo.start,playlist:i.playlist,mediaIndex:i.mediaIndex,currentVideoTimestampOffset:this.sourceUpdater_.videoTimestampOffset(),useVideoTimingInfo:r,firstVideoFrameTimeForData:u,videoTimingInfo:i.videoTimingInfo,audioTimingInfo:i.audioTimingInfo})),this.updateAppendInitSegmentStatus(i,t.type),this.updateSourceBufferTimestampOffset_(i),i.hasAppendedData_=!0,this.processMetadataQueue_(),this.appendData_(i,t))}},i.updateAppendInitSegmentStatus=function(n,t){this.loaderType_!=="main"||typeof n.timestampOffset!="number"||n.changedTimestampOffset||(this.appendInitSegment_={audio:!0,video:!0});this.playlistOfLastInitSegment_[t]!==n.playlist&&(this.appendInitSegment_[t]=!0)},i.getInitSegmentAndUpdateState_=function(n){var i=n.type,r=n.initSegment,t=n.map,f=n.playlist,u;if(t){if(u=rl(t),this.activeInitSegmentId_===u)return null;r=this.initSegmentForMap(t,!0).bytes;this.activeInitSegmentId_=u}return r&&this.appendInitSegment_[i]?(this.playlistOfLastInitSegment_[i]=f,this.appendInitSegment_[i]=t?!0:!1,this.activeInitSegmentId_=null,r):null},i.appendToSourceBuffer_=function(n){var u=this,t=n.segmentInfo,f=n.type,i=n.initSegment,e=n.data,o=[e],s=e.byteLength,r;i&&(o.unshift(i),s+=i.byteLength);r=ykt({bytes:s,segments:o});this.sourceUpdater_.appendBuffer({segmentInfo:t,type:f,bytes:r},function(n){n&&(u.error(f+" append of "+r.length+"b failed for segment #"+t.mediaIndex+" in playlist "+t.playlist.id),u.trigger("appenderror"))})},i.handleSegmentTimingInfo_=function(n,t,i){if(this.pendingSegment_&&t===this.pendingSegment_.requestId){var r=this.pendingSegment_.segment,u=n+"TimingInfo";r[u]||(r[u]={});r[u].transmuxerPrependedSeconds=i.prependedContentDuration||0;r[u].transmuxedPresentationStart=i.start.presentation;r[u].transmuxedDecodeStart=i.start.decode;r[u].transmuxedPresentationEnd=i.end.presentation;r[u].transmuxedDecodeEnd=i.end.decode;r[u].baseMediaDecodeTime=i.baseMediaDecodeTime}},i.appendData_=function(n,t){var i=t.type,r=t.data,u;r&&r.byteLength&&(i==="audio"&&this.audioDisabled_||(u=this.getInitSegmentAndUpdateState_({type:i,initSegment:t.initSegment,playlist:n.playlist,map:n.isFmp4?n.segment.map:null}),this.appendToSourceBuffer_({segmentInfo:n,type:i,initSegment:u,data:r})))},i.loadSegment_=function(n){var t=this;if(this.state="WAITING",this.pendingSegment_=n,this.trimBackBuffer_(n),typeof n.timestampOffset=="number"&&this.transmuxer_&&this.transmuxer_.postMessage({action:"clearAllMp4Captions"}),!this.hasEnoughInfoToLoad_()){this.loadQueue_.push(function(){var r=t.buffered_(),i;typeof n.timestampOffset=="number"&&(n.timestampOffset=set({segmentTimeline:n.timeline,currentTimeline:t.currentTimeline_,startOfSegment:n.startOfSegment,buffered:r,overrideCheck:!0}));delete n.audioAppendStart;i=t.sourceUpdater_.audioBuffered();i.length&&(n.audioAppendStart=i.end(i.length-1)-t.sourceUpdater_.audioTimestampOffset());t.updateTransmuxerAndRequestSegment_(n)});return}this.updateTransmuxerAndRequestSegment_(n)},i.updateTransmuxerAndRequestSegment_=function(n){this.shouldUpdateTransmuxerTimestampOffset_(n.timestampOffset)&&(this.gopBuffer_.length=0,n.gopsToAlignWith=[],this.timeMapping_=0,this.transmuxer_.postMessage({action:"reset"}),this.transmuxer_.postMessage({action:"setTimestampOffset",timestampOffset:n.timestampOffset}));var t=this.createSimplifiedSegmentObj_(n);n.abortRequests=udt({xhr:this.vhs_.xhr,xhrOptions:this.xhrOptions_,decryptionWorker:this.decrypter_,segment:t,handlePartialData:this.handlePartialData_,abortFn:this.handleAbort_.bind(this),progressFn:this.handleProgress_.bind(this),trackInfoFn:this.handleTrackInfo_.bind(this),timingInfoFn:this.handleTimingInfo_.bind(this),videoSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"video",n.requestId),audioSegmentTimingInfoFn:this.handleSegmentTimingInfo_.bind(this,"audio",n.requestId),captionsFn:this.handleCaptions_.bind(this),id3Fn:this.handleId3_.bind(this),dataFn:this.handleData_.bind(this),doneFn:this.segmentRequestFinished_.bind(this)})},i.trimBackBuffer_=function(){var n=egt(this.seekable_(),this.currentTime_(),this.playlist_.targetDuration||10);n>0&&this.remove(0,n)},i.createSimplifiedSegmentObj_=function(n){var t=n.segment,i={resolvedUri:t.resolvedUri,byterange:t.byterange,requestId:n.requestId,transmuxer:n.transmuxer,audioAppendStart:n.audioAppendStart,gopsToAlignWith:n.gopsToAlignWith},r=n.playlist.segments[n.mediaIndex-1],u;return r&&r.timeline===t.timeline&&(r.videoTimingInfo?i.baseStartTime=r.videoTimingInfo.transmuxedDecodeEnd:r.audioTimingInfo&&(i.baseStartTime=r.audioTimingInfo.transmuxedDecodeEnd)),t.key&&(u=t.key.iv||new Uint32Array([0,0,0,n.mediaIndex+n.playlist.mediaSequence]),i.key=this.segmentKey(t.key),i.key.iv=u),t.map&&(i.map=this.initSegmentForMap(t.map)),i},i.saveTransferStats_=function(n){this.mediaRequests+=1;n&&(this.mediaBytesTransferred+=n.bytesReceived,this.mediaTransferDuration+=n.roundTripTime)},i.saveBandwidthRelatedStats_=function(n,t){if(this.pendingSegment_.byteLength=t.bytesReceived,n<sl){this.logger_("Ignoring segment's bandwidth because its duration of "+n+(" is less than the min to record "+sl));return}this.bandwidth=t.bandwidth;this.roundTrip=t.roundTripTime},i.handleTimeout_=function(){this.mediaRequestsTimedout+=1;this.bandwidth=1;this.roundTrip=NaN;this.trigger("bandwidthupdate")},i.segmentRequestFinished_=function(n,t,i){var r;if(this.callQueue_.length){this.callQueue_.push(this.segmentRequestFinished_.bind(this,n,t,i));return}if((this.saveTransferStats_(t.stats),this.pendingSegment_)&&t.requestId===this.pendingSegment_.requestId){if(n){if(this.pendingSegment_=null,this.state="READY",n.code===ci.ABORTED)return;if(this.pause(),n.code===ci.TIMEOUT){this.handleTimeout_();return}this.mediaRequestsErrored+=1;this.error(n);this.trigger("error");return}r=this.pendingSegment_;this.saveBandwidthRelatedStats_(r.duration,t.stats);r.endOfAllRequests=t.endOfAllRequests;i.gopInfo&&(this.gopBuffer_=tgt(this.gopBuffer_,i.gopInfo,this.safeAppend_));this.state="APPENDING";var u=this.isEndOfStream_(r.mediaIndex,r.playlist),f=this.mediaIndex!==null,e=r.timeline!==this.currentTimeline_&&r.timeline>0;!r.isFmp4&&(u||f&&e)&&ul.endTimeline(this.transmuxer_);this.trigger("appending");this.waitForAppendsToComplete_(r)}},i.setTimeMapping_=function(n){var t=this.syncController_.mappingForTimeline(n);t!==null&&(this.timeMapping_=t)},i.updateMediaSecondsLoaded_=function(n){this.mediaSecondsLoaded+=typeof n.start=="number"&&typeof n.end=="number"?n.end-n.start:n.duration},i.shouldUpdateTransmuxerTimestampOffset_=function(n){return n===null?!1:this.loaderType_==="main"&&n!==this.sourceUpdater_.videoTimestampOffset()?!0:!this.audioDisabled_&&n!==this.sourceUpdater_.audioTimestampOffset()?!0:!1},i.trueSegmentStart_=function(n){var i=n.currentStart,f=n.playlist,r=n.mediaIndex,u=n.firstVideoFrameTimeForData,e=n.currentVideoTimestampOffset,o=n.useVideoTimingInfo,s=n.videoTimingInfo,h=n.audioTimingInfo,t;return typeof i!="undefined"?i:o?(t=f.segments[r-1],r===0||!t||typeof t.start=="undefined"||t.end!==u+e)?u:s.start:h.start},i.waitForAppendsToComplete_=function(n){if(!this.currentMediaInfo_){this.error({message:"No starting media returned, likely due to an unsupported media format.",blacklistDuration:Infinity});this.trigger("error");return}var t=this.currentMediaInfo_,u=t.hasAudio,f=t.hasVideo,e=t.isMuxed,i=this.loaderType_==="main"&&f,r=!this.audioDisabled_&&u&&!e;if(n.waitingOnAppends=0,!n.hasAppendedData_){n.timingInfo||typeof n.timestampOffset!="number"||(this.isPendingTimestampOffset_=!0);n.timingInfo={start:0};n.waitingOnAppends++;this.isPendingTimestampOffset_||(this.updateSourceBufferTimestampOffset_(n),this.processMetadataQueue_());this.checkAppendsDone_(n);return}i&&n.waitingOnAppends++;r&&n.waitingOnAppends++;i&&this.sourceUpdater_.videoQueueCallback(this.checkAppendsDone_.bind(this,n));r&&this.sourceUpdater_.audioQueueCallback(this.checkAppendsDone_.bind(this,n))},i.checkAppendsDone_=function(n){this.checkForAbort_(n.requestId)||(n.waitingOnAppends--,n.waitingOnAppends===0&&this.handleAppendsDone_())},i.checkForIllegalMediaSwitch=function(n){var t=fgt(this.loaderType_,this.currentMediaInfo_,n);return t?(this.error({message:t,blacklistDuration:Infinity}),this.trigger("error"),!0):!1},i.updateSourceBufferTimestampOffset_=function(n){if(n.timestampOffset!==null&&typeof n.timingInfo.start=="number"&&!n.changedTimestampOffset&&this.loaderType_==="main"){var t=!1;n.timestampOffset-=n.timingInfo.start;n.changedTimestampOffset=!0;n.timestampOffset!==this.sourceUpdater_.videoTimestampOffset()&&(this.sourceUpdater_.videoTimestampOffset(n.timestampOffset),t=!0);n.timestampOffset!==this.sourceUpdater_.audioTimestampOffset()&&(this.sourceUpdater_.audioTimestampOffset(n.timestampOffset),t=!0);t&&this.trigger("timestampoffset")}},i.updateTimingInfoEnd_=function(n){n.timingInfo=n.timingInfo||{};var i=this.loaderType_==="main"&&this.currentMediaInfo_.hasVideo,t=i&&n.videoTimingInfo?n.videoTimingInfo:n.audioTimingInfo;t&&(n.timingInfo.end=typeof t.end=="number"?t.end:t.start+n.duration)},i.handleAppendsDone_=function(){var t,i,r,u;if(this.pendingSegment_&&this.trigger("appendsdone"),!this.pendingSegment_){this.state="READY";this.paused()||this.monitorBuffer_();return}if(t=this.pendingSegment_,this.updateTimingInfoEnd_(t),this.shouldSaveSegmentTimingInfo_&&this.syncController_.saveSegmentTimingInfo({segmentInfo:t,shouldSaveTimelineMapping:this.loaderType_==="main"}),this.logger_(ogt(t)),i=hgt(t,this.sourceType_),i&&(i.severity==="warn"?n.log.warn(i.message):this.logger_(i.message)),this.recordThroughput_(t),this.pendingSegment_=null,this.state="READY",t.isSyncRequest){this.trigger("syncinfoupdate");return}if(this.addSegmentMetadataCue_(t),this.fetchAtBuffer_=!0,this.currentTimeline_!==t.timeline&&(this.timelineChangeController_.lastTimelineChange({type:this.loaderType_,from:this.currentTimeline_,to:t.timeline}),this.loaderType_!=="main"||this.audioDisabled_||this.timelineChangeController_.lastTimelineChange({type:"audio",from:this.currentTimeline_,to:t.timeline})),this.currentTimeline_=t.timeline,this.trigger("syncinfoupdate"),r=t.segment,r.end&&this.currentTime_()-r.end>t.playlist.targetDuration*3){this.resetEverything();return}u=this.mediaIndex!==null;u&&this.trigger("bandwidthupdate");this.trigger("progress");this.mediaIndex=t.mediaIndex;this.isEndOfStream_(t.mediaIndex,t.playlist)&&this.endOfStream();this.trigger("appended");this.paused()||this.monitorBuffer_()},i.recordThroughput_=function(n){if(n.duration<sl){this.logger_("Ignoring segment's throughput because its duration of "+n.duration+(" is less than the min to record "+sl));return}var t=this.throughput.rate,i=Date.now()-n.endOfAllRequests+1,r=Math.floor(n.byteLength/i*8e3);this.throughput.rate+=(r-t)/++this.throughput.count},i.addSegmentMetadataCue_=function(n){if(this.segmentMetadataTrack_){var t=n.segment,i=t.start,r=t.end;if(eet(i)&&eet(r)){rs(i,r,this.segmentMetadataTrack_);var o=u.WebKitDataCue||u.VTTCue,f={custom:t.custom,dateTimeObject:t.dateTimeObject,dateTimeString:t.dateTimeString,bandwidth:n.playlist.attributes.BANDWIDTH,resolution:n.playlist.attributes.RESOLUTION,codecs:n.playlist.attributes.CODECS,byteLength:n.byteLength,uri:n.uri,timeline:n.timeline,playlist:n.playlist.id,start:i,end:r},s=JSON.stringify(f),e=new o(i,r,s);e.value=f;this.segmentMetadataTrack_.addCue(e)}}},r}(n.EventTarget);var aet=function(n){return typeof n!="string"?n:n.replace(/./,function(n){return n.toUpperCase()})},cgt=["video","audio"],kw=function(n,t){var i=t[n+"Buffer"];return i&&i.updating||t.queuePending[n]},lgt=function(n,t){for(var r,i=0;i<t.length;i++){if(r=t[i],r.type==="mediaSource")return null;if(r.type===n)return i}return null},ie=function ie(n,t){if(t.queue.length!==0){var r=0,i=t.queue[r];if(i.type==="mediaSource"){t.updating()||t.mediaSource.readyState==="closed"||(t.queue.shift(),i.action(t),i.doneFn&&i.doneFn(),ie("audio",t),ie("video",t));return}if(n!=="mediaSource"&&t.ready()&&t.mediaSource.readyState!=="closed"&&!kw(n,t)){if(i.type!==n){if(r=lgt(n,t.queue),r===null)return;i=t.queue[r]}if(t.queue.splice(r,1),i.action(n,t),!i.doneFn){ie(n,t);return}t.queuePending[n]=i}}},vet=function(n,t){var i=t[n+"Buffer"],r=aet(n);i&&(i.removeEventListener("updateend",t["on"+r+"UpdateEnd_"]),i.removeEventListener("error",t["on"+r+"Error_"]),t.codecs[n]=null,t[n+"Buffer"]=null)},bi=function(n,t){return n&&t&&Array.prototype.indexOf.call(n.sourceBuffers,t)!==-1},ui={appendBuffer:function(n,t){return function(i,r){var u=r[i+"Buffer"];bi(r.mediaSource,u)&&(r.logger_("Appending segment "+t.mediaIndex+"'s "+n.length+" bytes to "+i+"Buffer"),u.appendBuffer(n))}},remove:function(n,t){return function(i,r){var u=r[i+"Buffer"];bi(r.mediaSource,u)&&(r.logger_("Removing "+n+" to "+t+" from "+i+"Buffer"),u.remove(n,t))}},timestampOffset:function(n){return function(t,i){var r=i[t+"Buffer"];bi(i.mediaSource,r)&&(i.logger_("Setting "+t+"timestampOffset to "+n),r.timestampOffset=n)}},callback:function(n){return function(){n()}},endOfStream:function(t){return function(i){if(i.mediaSource.readyState==="open"){i.logger_("Calling mediaSource endOfStream("+(t||"")+")");try{i.mediaSource.endOfStream(t)}catch(r){n.log.warn("Failed to call media source endOfStream",r)}}}},duration:function(t){return function(i){i.logger_("Setting mediaSource duration to "+t);try{i.mediaSource.duration=t}catch(r){n.log.warn("Failed to set media source duration",r)}}},abort:function(){return function(t,i){if(i.mediaSource.readyState==="open"){var r=i[t+"Buffer"];if(bi(i.mediaSource,r)){i.logger_("calling abort on "+t+"Buffer");try{r.abort()}catch(u){n.log.warn("Failed to abort on "+t+"Buffer",u)}}}}},addSourceBuffer:function(n,t){return function(i){var u=aet(n),f=lut(t),r;i.logger_("Adding "+n+"Buffer with codec "+t+" to mediaSource");r=i.mediaSource.addSourceBuffer(f);r.addEventListener("updateend",i["on"+u+"UpdateEnd_"]);r.addEventListener("error",i["on"+u+"Error_"]);i.codecs[n]=t;i[n+"Buffer"]=r}},removeSourceBuffer:function(t){return function(i){var r=i[t+"Buffer"];if(vet(t,i),bi(i.mediaSource,r)){i.logger_("Removing "+t+"Buffer with codec "+i.codecs[t]+" from mediaSource");try{i.mediaSource.removeSourceBuffer(r)}catch(u){n.log.warn("Failed to removeSourceBuffer "+t+"Buffer",u)}}}},changeType:function(n){return function(t,i){var r=i[t+"Buffer"],u=lut(n);bi(i.mediaSource,r)&&i.codecs[t]!==n&&(i.logger_("changing "+t+"Buffer codec from "+i.codecs[t]+" to "+n),r.changeType(u),i.codecs[t]=n)}}},fi=function(n){var t=n.type,i=n.sourceUpdater,r=n.action,u=n.doneFn,f=n.name;i.queue.push({type:t,action:r,doneFn:u,name:f});ie(t,i)},yet=function(n,t){return function(){if(t.queuePending[n]){var i=t.queuePending[n].doneFn;t.queuePending[n]=null;i&&i(t[n+"Error_"])}ie(n,t)}},pet=function(t){function r(n){var i;return i=t.call(this)||this,i.mediaSource=n,i.sourceopenListener_=function(){return ie("mediaSource",ri(i))},i.mediaSource.addEventListener("sourceopen",i.sourceopenListener_),i.logger_=hu("SourceUpdater"),i.audioTimestampOffset_=0,i.videoTimestampOffset_=0,i.queue=[],i.queuePending={audio:null,video:null},i.delayedAudioAppendQueue_=[],i.videoAppendQueued_=!1,i.codecs={},i.onVideoUpdateEnd_=yet("video",ri(i)),i.onAudioUpdateEnd_=yet("audio",ri(i)),i.onVideoError_=function(n){i.videoError_=n},i.onAudioError_=function(n){i.audioError_=n},i.createdSourceBuffers_=!1,i.initializedEme_=!1,i.triggeredReady_=!1,i}vi(r,t);var i=r.prototype;return i.initializedEme=function(){this.initializedEme_=!0;this.triggerReady()},i.hasCreatedSourceBuffers=function(){return this.createdSourceBuffers_},i.hasInitializedAnyEme=function(){return this.initializedEme_},i.ready=function(){return this.hasCreatedSourceBuffers()&&this.hasInitializedAnyEme()},i.createSourceBuffers=function(n){this.hasCreatedSourceBuffers()||(this.addOrChangeSourceBuffers(n),this.createdSourceBuffers_=!0,this.trigger("createdsourcebuffers"),this.triggerReady())},i.triggerReady=function(){this.ready()&&!this.triggeredReady_&&(this.triggeredReady_=!0,this.trigger("ready"))},i.addSourceBuffer=function(n,t){fi({type:"mediaSource",sourceUpdater:this,action:ui.addSourceBuffer(n,t),name:"addSourceBuffer"})},i.abort=function(n){fi({type:n,sourceUpdater:this,action:ui.abort(n),name:"abort"})},i.removeSourceBuffer=function(t){if(!this.canRemoveSourceBuffer()){n.log.error("removeSourceBuffer is not supported!");return}fi({type:"mediaSource",sourceUpdater:this,action:ui.removeSourceBuffer(t),name:"removeSourceBuffer"})},i.canRemoveSourceBuffer=function(){return!n.browser.IE_VERSION&&!n.browser.IS_FIREFOX&&u.MediaSource&&u.MediaSource.prototype&&typeof u.MediaSource.prototype.removeSourceBuffer=="function"},r.canChangeType=function(){return u.SourceBuffer&&u.SourceBuffer.prototype&&typeof u.SourceBuffer.prototype.changeType=="function"},i.canChangeType=function(){return this.constructor.canChangeType()},i.changeType=function(t,i){if(!this.canChangeType()){n.log.error("changeType is not supported!");return}fi({type:t,sourceUpdater:this,action:ui.changeType(i),name:"changeType"})},i.addOrChangeSourceBuffers=function(n){var t=this;if(!n||typeof n!="object"||Object.keys(n).length===0)throw new Error("Cannot addOrChangeSourceBuffers to undefined codecs");Object.keys(n).forEach(function(i){var r=n[i];if(!t.hasCreatedSourceBuffers())return t.addSourceBuffer(i,r);t.canChangeType()&&t.changeType(i,r)})},i.appendBuffer=function(n,t){var u=this,e=n.segmentInfo,i=n.type,f=n.bytes,r;if(this.processedAppend_=!0,i==="audio"&&this.videoBuffer&&!this.videoAppendQueued_){this.delayedAudioAppendQueue_.push([n,t]);this.logger_("delayed audio append of "+f.length+" until video append");return}if(fi({type:i,sourceUpdater:this,action:ui.appendBuffer(f,e||{mediaIndex:-1}),doneFn:t,name:"appendBuffer"}),i==="video"){if(this.videoAppendQueued_=!0,!this.delayedAudioAppendQueue_.length)return;r=this.delayedAudioAppendQueue_.slice();this.logger_("queuing delayed audio "+r.length+" appendBuffers");this.delayedAudioAppendQueue_.length=0;r.forEach(function(n){u.appendBuffer.apply(u,n)})}},i.audioBuffered=function(){return bi(this.mediaSource,this.audioBuffer)?this.audioBuffer.buffered?this.audioBuffer.buffered:n.createTimeRange():n.createTimeRange()},i.videoBuffered=function(){return bi(this.mediaSource,this.videoBuffer)?this.videoBuffer.buffered?this.videoBuffer.buffered:n.createTimeRange():n.createTimeRange()},i.buffered=function(){var n=bi(this.mediaSource,this.videoBuffer)?this.videoBuffer:null,t=bi(this.mediaSource,this.audioBuffer)?this.audioBuffer:null;return t&&!n?this.audioBuffered():n&&!t?this.videoBuffered():bwt(this.audioBuffered(),this.videoBuffered())},i.setDuration=function(n,t){t===void 0&&(t=cr);fi({type:"mediaSource",sourceUpdater:this,action:ui.duration(n),name:"duration",doneFn:t})},i.endOfStream=function(n,t){n===void 0&&(n=null);t===void 0&&(t=cr);typeof n!="string"&&(n=undefined);fi({type:"mediaSource",sourceUpdater:this,action:ui.endOfStream(n),name:"endOfStream",doneFn:t})},i.removeAudio=function(n,t,i){if(i===void 0&&(i=cr),!this.audioBuffered().length||this.audioBuffered().end(0)===0){i();return}fi({type:"audio",sourceUpdater:this,action:ui.remove(n,t),doneFn:i,name:"remove"})},i.removeVideo=function(n,t,i){if(i===void 0&&(i=cr),!this.videoBuffered().length||this.videoBuffered().end(0)===0){i();return}fi({type:"video",sourceUpdater:this,action:ui.remove(n,t),doneFn:i,name:"remove"})},i.updating=function(){return kw("audio",this)||kw("video",this)?!0:!1},i.audioTimestampOffset=function(n){return typeof n!="undefined"&&this.audioBuffer&&this.audioTimestampOffset_!==n&&(fi({type:"audio",sourceUpdater:this,action:ui.timestampOffset(n),name:"timestampOffset"}),this.audioTimestampOffset_=n),this.audioTimestampOffset_},i.videoTimestampOffset=function(n){return typeof n!="undefined"&&this.videoBuffer&&this.videoTimestampOffset!==n&&(fi({type:"video",sourceUpdater:this,action:ui.timestampOffset(n),name:"timestampOffset"}),this.videoTimestampOffset_=n),this.videoTimestampOffset_},i.audioQueueCallback=function(n){this.audioBuffer&&fi({type:"audio",sourceUpdater:this,action:ui.callback(n),name:"callback"})},i.videoQueueCallback=function(n){this.videoBuffer&&fi({type:"video",sourceUpdater:this,action:ui.callback(n),name:"callback"})},i.dispose=function(){var n=this;this.trigger("dispose");cgt.forEach(function(t){n.abort(t);n.canRemoveSourceBuffer()?n.removeSourceBuffer(t):n[t+"QueueCallback"](function(){return vet(t,n)})});this.videoAppendQueued_=!1;this.delayedAudioAppendQueue_.length=0;this.sourceopenListener_&&this.mediaSource.removeEventListener("sourceopen",this.sourceopenListener_);this.off()},r}(n.EventTarget),wet=function(n){return decodeURIComponent(escape(String.fromCharCode.apply(null,n)))},bet=new Uint8Array("\n\n".split("").map(function(n){return n.charCodeAt(0)})),agt=function(t){function r(n,i){var r;return i===void 0&&(i={}),r=t.call(this,n,i)||this,r.handlePartialData_=!1,r.mediaSource_=null,r.subtitlesTrack_=null,r.loaderType_="subtitle",r.featuresNativeTextTracks_=n.featuresNativeTextTracks,r.shouldSaveSegmentTimingInfo_=!1,r}vi(r,t);var i=r.prototype;return i.createTransmuxer_=function(){return null},i.buffered_=function(){if(!this.subtitlesTrack_||!this.subtitlesTrack_.cues.length)return n.createTimeRanges();var t=this.subtitlesTrack_.cues,i=t[0].startTime,r=t[t.length-1].startTime;return n.createTimeRanges([[i,r]])},i.initSegmentForMap=function(n,t){var u,i,f,r;return(t===void 0&&(t=!1),!n)?null:(u=rl(n),i=this.initSegments_[u],t&&!i&&n.bytes&&(f=bet.byteLength+n.bytes.byteLength,r=new Uint8Array(f),r.set(n.bytes),r.set(bet,n.bytes.byteLength),this.initSegments_[u]=i={resolvedUri:n.resolvedUri,byterange:n.byterange,bytes:r}),i||n)},i.couldBeginLoading_=function(){return this.playlist_&&this.subtitlesTrack_&&!this.paused()},i.init_=function(){return this.state="READY",this.resetEverything(),this.monitorBuffer_()},i.track=function(n){return typeof n=="undefined"?this.subtitlesTrack_:(this.subtitlesTrack_=n,this.state==="INIT"&&this.couldBeginLoading_()&&this.init_(),this.subtitlesTrack_)},i.remove=function(n,t){rs(n,t,this.subtitlesTrack_)},i.fillBuffer_=function(){var t=this,n,i;if(this.syncPoint_||(this.syncPoint_=this.syncController_.getSyncPoint(this.playlist_,this.duration_(),this.currentTimeline_,this.currentTime_())),n=this.checkBuffer_(this.buffered_(),this.playlist_,this.mediaIndex,this.hasPlayed_(),this.currentTime_(),this.syncPoint_),n=this.skipEmptySegments_(n),n){if(this.syncController_.timestampOffsetForTimeline(n.timeline)===null){i=function(){t.state="READY";t.paused()||t.monitorBuffer_()};this.syncController_.one("timestampoffset",i);this.state="WAITING_ON_TIMELINE";return}this.loadSegment_(n)}},i.skipEmptySegments_=function(n){while(n&&n.segment.empty)n=this.generateSegmentInfo_(n.playlist,n.mediaIndex+1,n.startOfSegment+n.duration,n.isSyncRequest);return n},i.stopForError=function(n){this.error(n);this.state="READY";this.pause();this.trigger("error")},i.segmentRequestFinished_=function(n,t,i){var f=this,r,e,o,s;if(!this.subtitlesTrack_){this.state="READY";return}if(this.saveTransferStats_(t.stats),!this.pendingSegment_){this.state="READY";this.mediaRequestsAborted+=1;return}if(n){n.code===ci.TIMEOUT&&this.handleTimeout_();n.code===ci.ABORTED?this.mediaRequestsAborted+=1:this.mediaRequestsErrored+=1;this.stopForError(n);return}if(r=this.pendingSegment_,this.saveBandwidthRelatedStats_(r.duration,t.stats),this.state="APPENDING",this.trigger("appending"),e=r.segment,e.map&&(e.map.bytes=t.map.bytes),r.bytes=t.bytes,typeof u.WebVTT!="function"&&this.subtitlesTrack_&&this.subtitlesTrack_.tech_){s=function(){f.subtitlesTrack_.tech_.off("vttjsloaded",o);f.stopForError({message:"Error loading vtt.js"});return};o=function(){f.subtitlesTrack_.tech_.off("vttjserror",s);f.segmentRequestFinished_(n,t,i)};this.state="WAITING_ON_VTTJS";this.subtitlesTrack_.tech_.one("vttjsloaded",o);this.subtitlesTrack_.tech_.one("vttjserror",s);return}e.requested=!0;try{this.parseVTTCues_(r)}catch(h){this.stopForError({message:h.message});return}if(this.updateTimeMapping_(r,this.syncController_.timelines[r.timeline],this.playlist_),r.timingInfo=r.cues.length?{start:r.cues[0].startTime,end:r.cues[r.cues.length-1].endTime}:{start:r.startOfSegment,end:r.startOfSegment+r.duration},r.isSyncRequest){this.trigger("syncinfoupdate");this.pendingSegment_=null;this.state="READY";return}r.byteLength=r.bytes.byteLength;this.mediaSecondsLoaded+=e.duration;r.cues.forEach(function(n){f.subtitlesTrack_.addCue(f.featuresNativeTextTracks_?new u.VTTCue(n.startTime,n.endTime,n.text):n)});gdt(this.subtitlesTrack_);this.handleAppendsDone_()},i.handleData_=function(){},i.updateTimingInfoEnd_=function(){},i.parseVTTCues_=function(t){var e,o=!1,i,r,f;typeof u.TextDecoder=="function"?e=new u.TextDecoder("utf8"):(e=u.WebVTT.StringDecoder(),o=!0);i=new u.WebVTT.Parser(u,u.vttjs,e);t.cues=[];t.timestampmap={MPEGTS:0,LOCAL:0};i.oncue=t.cues.push.bind(t.cues);i.ontimestampmap=function(n){t.timestampmap=n};i.onparsingerror=function(t){n.log.warn("Error encountered when parsing cues: "+t.message)};t.segment.map&&(r=t.segment.map.bytes,o&&(r=wet(r)),i.parse(r));f=t.bytes;o&&(f=wet(f));i.parse(f);i.flush()},i.updateTimeMapping_=function(n,t,i){var f=n.segment,r,u,e,o;if(t){if(!n.cues.length){f.empty=!0;return}r=n.timestampmap;u=r.MPEGTS/po-r.LOCAL+t.mapping;n.cues.forEach(function(n){n.startTime+=u;n.endTime+=u});i.syncInfo||(e=n.cues[0].startTime,o=n.cues[n.cues.length-1].startTime,i.syncInfo={mediaSequence:i.mediaSequence+n.mediaIndex,time:Math.min(e,o-f.duration)})}},r}(bw),vgt=function(n,t){for(var i,u=n.cues,r=0;r<u.length;r++)if(i=u[r],t>=i.adStartTime&&t<=i.adEndTime)return i;return null},ygt=function(n,t,i){var f,r,o,e;if(i===void 0&&(i=0),n.segments)for(f=i,o=0;o<n.segments.length;o++){if(e=n.segments[o],r||(r=vgt(t,f+e.duration/2)),r){if("cueIn"in e){r.endTime=f;r.adEndTime=f;f+=e.duration;r=null;continue}if(f<r.endTime){f+=e.duration;continue}r.endTime+=e.duration}else if("cueOut"in e&&(r=new u.VTTCue(f,f+e.duration,e.cueOut),r.adStartTime=f,r.adEndTime=f+parseFloat(e.cueOut),t.addCue(r)),"cueOutCont"in e){var s=e.cueOutCont.split("/").map(parseFloat),h=s[0],c=s[1];r=new u.VTTCue(f,f+e.duration,"");r.adStartTime=f-h;r.adEndTime=r.adStartTime+c;t.addCue(r)}f+=e.duration}},ket=[{name:"VOD",run:function(n,t,i){return i!==Infinity?{time:0,segmentIndex:0}:null}},{name:"ProgramDateTime",run:function(n,t,i,r,u){var f,o;if(!n.datetimeToDisplayTime)return null;var h=t.segments||[],c=null,e=null;for(u=u||0,f=0;f<h.length;f++)if(o=h[f],o.dateTimeObject){var a=o.dateTimeObject.getTime()/1e3,l=a+n.datetimeToDisplayTime,s=Math.abs(u-l);if(e!==null&&(s===0||e<s))break;e=s;c={time:l,segmentIndex:f}}return c}},{name:"Segment",run:function(n,t,i,r,u){var c=t.segments||[],h=null,f=null,e,o,s;for(u=u||0,e=0;e<c.length;e++)if(o=c[e],o.timeline===r&&typeof o.start!="undefined"){if(s=Math.abs(u-o.start),f!==null&&f<s)break;(!h||f===null||f>=s)&&(f=s,h={time:o.start,segmentIndex:e})}return h}},{name:"Discontinuity",run:function(n,t,i,r,u){var s=null,f,e,o;if(u=u||0,t.discontinuityStarts&&t.discontinuityStarts.length)for(f=null,e=0;e<t.discontinuityStarts.length;e++){var c=t.discontinuityStarts[e],l=t.discontinuitySequence+e+1,h=n.discontinuities[l];if(h){if(o=Math.abs(u-h.time),f!==null&&f<o)break;(!s||f===null||f>=o)&&(f=o,s={time:h.time,segmentIndex:c})}}return s}},{name:"Playlist",run:function(n,t){return t.syncInfo?{time:t.syncInfo.time,segmentIndex:t.syncInfo.mediaSequence-t.mediaSequence}:null}}],pgt=function(n){function i(){var t;return t=n.call(this)||this,t.timelines=[],t.discontinuities=[],t.datetimeToDisplayTime=null,t.logger_=hu("SyncController"),t}vi(i,n);var t=i.prototype;return t.getSyncPoint=function(n,t,i,r){var u=this.runStrategies_(n,t,i,r);return u.length?this.selectSyncPoint_(u,{key:"time",value:r}):null},t.getExpiredTime=function(n,t){var r,i;return!n||!n.segments?null:(r=this.runStrategies_(n,t,n.discontinuitySequence,0),!r.length)?null:(i=this.selectSyncPoint_(r,{key:"segmentIndex",value:0}),i.segmentIndex>0&&(i.time*=-1),Math.abs(i.time+go(n,i.segmentIndex,0)))},t.runStrategies_=function(n,t,i,r){for(var u,f,o=[],e=0;e<ket.length;e++)u=ket[e],f=u.run(this,n,t,i,r),f&&(f.strategy=u.name,o.push({strategy:u.name,syncPoint:f}));return o},t.selectSyncPoint_=function(n,t){for(var u,r=n[0].syncPoint,f=Math.abs(n[0].syncPoint[t.key]-t.value),e=n[0].strategy,i=1;i<n.length;i++)u=Math.abs(n[i].syncPoint[t.key]-t.value),u<f&&(f=u,r=n[i].syncPoint,e=n[i].strategy);return this.logger_("syncPoint for ["+t.key+": "+t.value+"] chosen with strategy"+(" ["+e+"]: [time:"+r.time+",")+(" segmentIndex:"+r.segmentIndex+"]")),r},t.saveExpiredSegmentInfo=function(n,t){for(var r,u=t.mediaSequence-n.mediaSequence,i=u-1;i>=0;i--)if(r=n.segments[i],r&&typeof r.start!="undefined"){t.syncInfo={mediaSequence:n.mediaSequence+i,time:r.start};this.logger_("playlist refresh sync: [time:"+t.syncInfo.time+","+(" mediaSequence: "+t.syncInfo.mediaSequence+"]"));this.trigger("syncinfoupdate");break}},t.setDateTimeMapping=function(n){if(!this.datetimeToDisplayTime&&n.segments&&n.segments.length&&n.segments[0].dateTimeObject){var t=n.segments[0].dateTimeObject.getTime()/1e3;this.datetimeToDisplayTime=-t}},t.saveSegmentTimingInfo=function(n){var t=n.segmentInfo,i=n.shouldSaveTimelineMapping,r=this.calculateSegmentTimeMapping_(t,t.timingInfo,i);r&&(this.saveDiscontinuitySyncInfo_(t),t.playlist.syncInfo||(t.playlist.syncInfo={mediaSequence:t.playlist.mediaSequence+t.mediaIndex,time:t.segment.start}))},t.timestampOffsetForTimeline=function(n){return typeof this.timelines[n]=="undefined"?null:this.timelines[n].time},t.mappingForTimeline=function(n){return typeof this.timelines[n]=="undefined"?null:this.timelines[n].mapping},t.calculateSegmentTimeMapping_=function(n,t,i){var u=n.segment,r=this.timelines[n.timeline];if(n.timestampOffset!==null)r={time:n.startOfSegment,mapping:n.startOfSegment-t.start},i&&(this.timelines[n.timeline]=r,this.trigger("timestampoffset"),this.logger_("time mapping for timeline "+n.timeline+": "+("[time: "+r.time+"] [mapping: "+r.mapping+"]"))),u.start=n.startOfSegment,u.end=t.end+r.mapping;else if(r)u.start=t.start+r.mapping,u.end=t.end+r.mapping;else return!1;return!0},t.saveDiscontinuitySyncInfo_=function(n){var t=n.playlist,i=n.segment,r,e;if(i.discontinuity)this.discontinuities[i.timeline]={time:i.start,accuracy:0};else if(t.discontinuityStarts&&t.discontinuityStarts.length)for(r=0;r<t.discontinuityStarts.length;r++){var u=t.discontinuityStarts[r],f=t.discontinuitySequence+r+1,o=u-n.mediaIndex,s=Math.abs(o);(!this.discontinuities[f]||this.discontinuities[f].accuracy>s)&&(e=void 0,e=o<0?i.start-go(t,n.mediaIndex,u):i.end+go(t,n.mediaIndex+1,u),this.discontinuities[f]={time:e,accuracy:s})}},t.dispose=function(){this.trigger("dispose");this.off()},i}(n.EventTarget),wgt=function(n){function i(){var t;return t=n.call(this)||this,t.pendingTimelineChanges_={},t.lastTimelineChanges_={},t}vi(i,n);var t=i.prototype;return t.clearPendingTimelineChange=function(n){this.pendingTimelineChanges_[n]=null;this.trigger("pendingtimelinechange")},t.pendingTimelineChange=function(n){var t=n.type,i=n.from,r=n.to;return typeof i=="number"&&typeof r=="number"&&(this.pendingTimelineChanges_[t]={type:t,from:i,to:r},this.trigger("pendingtimelinechange")),this.pendingTimelineChanges_[t]},t.lastTimelineChange=function(n){var t=n.type,i=n.from,r=n.to;return typeof i=="number"&&typeof r=="number"&&(this.lastTimelineChanges_[t]={type:t,from:i,to:r},delete this.pendingTimelineChanges_[t],this.trigger("timelinechange")),this.lastTimelineChanges_[t]},t.dispose=function(){this.trigger("dispose");this.pendingTimelineChanges_={};this.lastTimelineChanges_={};this.off()},i}(n.EventTarget),bgt=new net("./decrypter-worker.worker.js",function(){var n=this,t=function(){function r(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function f(n,t,i){return t&&r(n.prototype,t),i&&r(n,i),n}function o(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function c(n){return n.subarray(0,n.byteLength-n[n.byteLength-1])}var e=f,s=o,h=function(){function t(){this.listeners={}}var n=t.prototype;return n.on=function(n,t){this.listeners[n]||(this.listeners[n]=[]);this.listeners[n].push(t)},n.off=function(n,t){if(!this.listeners[n])return!1;var i=this.listeners[n].indexOf(t);return this.listeners[n]=this.listeners[n].slice(0),this.listeners[n].splice(i,1),i>-1},n.trigger=function(n){var t=this.listeners[n],u,i,f,e,r;if(t)if(arguments.length===2)for(u=t.length,i=0;i<u;++i)t[i].call(this,arguments[1]);else for(f=Array.prototype.slice.call(arguments,1),e=t.length,r=0;r<e;++r)t[r].apply(this,f)},n.dispose=function(){this.listeners={}},n.pipe=function(n){this.on("data",function(t){n.push(t)})},t}(),u=h,l=function(){for(var h=[[[],[],[],[],[]],[[],[],[],[],[]]],f=h[0],e=h[1],l=f[4],p=e[4],i,r,u=[],a=[],c,v,y,t,o,s,n=0;n<256;n++)a[(u[n]=n<<1^(n>>7)*283)^n]=n;for(i=r=0;!l[i];i^=c||1,r=a[r]||1)for(t=r^r<<1^r<<2^r<<3^r<<4,t=t>>8^t&255^99,l[i]=t,p[t]=i,y=u[v=u[c=u[i]]],s=y*16843009^v*65537^c*257^i*16843008,o=u[t]*257^t*16843008,n=0;n<4;n++)f[n][i]=o=o<<24^o>>>8,e[n][t]=s=s<<24^s>>>8;for(n=0;n<5;n++)f[n]=f[n].slice(0),e[n]=e[n].slice(0);return h},t=null,a=function(){function n(n){var e,c;t||(t=l());this._tables=[[t[0][0].slice(),t[0][1].slice(),t[0][2].slice(),t[0][3].slice(),t[0][4].slice()],[t[1][0].slice(),t[1][1].slice(),t[1][2].slice(),t[1][3].slice(),t[1][4].slice()]];var r,o,i,f=this._tables[0][4],s=this._tables[1],u=n.length,h=1;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size");for(e=n.slice(0),c=[],this._key=[e,c],r=u;r<4*u+28;r++)i=e[r-1],(r%u==0||u===8&&r%u==4)&&(i=f[i>>>24]<<24^f[i>>16&255]<<16^f[i>>8&255]<<8^f[i&255],r%u==0&&(i=i<<8^i>>>24^h<<24,h=h<<1^(h>>7)*283)),e[r]=e[r-u]^i;for(o=0;r;o++,r--)i=e[o&3?r:r-4],c[o]=r<=4||o<4?i:s[0][f[i>>>24]]^s[1][f[i>>16&255]]^s[2][f[i>>8&255]]^s[3][f[i&255]]}var i=n.prototype;return i.decrypt=function(n,t,i,r,u,f){for(var e=this._key[1],o=n^e[0],s=r^e[1],h=i^e[2],c=t^e[3],y,g,nt,tt=e.length/4-2,a=4,v=this._tables[1],p=v[0],w=v[1],b=v[2],k=v[3],d=v[4],l=0;l<tt;l++)y=p[o>>>24]^w[s>>16&255]^b[h>>8&255]^k[c&255]^e[a],g=p[s>>>24]^w[h>>16&255]^b[c>>8&255]^k[o&255]^e[a+1],nt=p[h>>>24]^w[c>>16&255]^b[o>>8&255]^k[s&255]^e[a+2],c=p[c>>>24]^w[o>>16&255]^b[s>>8&255]^k[h&255]^e[a+3],a+=4,o=y,s=g,h=nt;for(l=0;l<4;l++)u[(3&-l)+f]=d[o>>>24]<<24^d[s>>16&255]<<16^d[h>>8&255]<<8^d[c&255]^e[a++],y=o,o=s,s=h,h=c,c=y},n}(),v=function(n){function t(){var t;return t=n.call(this,u)||this,t.jobs=[],t.delay=1,t.timeout_=null,t}s(t,n);var i=t.prototype;return i.processJob_=function(){this.jobs.shift()();this.timeout_=this.jobs.length?setTimeout(this.processJob_.bind(this),this.delay):null},i.push=function(n){this.jobs.push(n);this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},t}(u),i=function(n){return n<<24|(n&65280)<<8|(n&16711680)>>8|n>>>24},y=function(n,t,r){var e=new Int32Array(n.buffer,n.byteOffset,n.byteLength>>2),b=new a(Array.prototype.slice.call(t)),w=new Uint8Array(n.byteLength),f=new Int32Array(w.buffer),o,s,h,c,l,v,y,p,u;for(o=r[0],s=r[1],h=r[2],c=r[3],u=0;u<e.length;u+=4)l=i(e[u]),v=i(e[u+1]),y=i(e[u+2]),p=i(e[u+3]),b.decrypt(l,v,y,p,f,u),f[u]=i(f[u]^o),f[u+1]=i(f[u+1]^s),f[u+2]=i(f[u+2]^h),f[u+3]=i(f[u+3]^c),o=l,s=v,h=y,c=p;return w},p=function(){function n(t,r,u,f){var s=n.STEP,o=new Int32Array(t.buffer),h=new Uint8Array(t.byteLength),e=0;for(this.asyncStream_=new v,this.asyncStream_.push(this.decryptChunk_(o.subarray(e,e+s),r,u,h)),e=s;e<o.length;e+=s)u=new Uint32Array([i(o[e-4]),i(o[e-3]),i(o[e-2]),i(o[e-1])]),this.asyncStream_.push(this.decryptChunk_(o.subarray(e,e+s),r,u,h));this.asyncStream_.push(function(){f(null,c(h))})}var t=n.prototype;return t.decryptChunk_=function(n,t,i,r){return function(){var u=y(n,t,i);r.set(u,n.byteOffset)}},e(n,null,[{key:"STEP",get:function(){return 32e3}}]),n}(),w=function(n){var t={};return Object.keys(n).forEach(function(i){var r=n[i];t[i]=ArrayBuffer.isView(r)?{bytes:r.buffer,byteOffset:r.byteOffset,byteLength:r.byteLength}:r}),t},b=function(n){n.onmessage=function(t){var i=t.data,r=new Uint8Array(i.encrypted.bytes,i.encrypted.byteOffset,i.encrypted.byteLength),u=new Uint32Array(i.key.bytes,i.key.byteOffset,i.key.byteLength/4),f=new Uint32Array(i.iv.bytes,i.iv.byteOffset,i.iv.byteLength/4);new p(r,u,f,function(t,r){n.postMessage(w({source:i.source,decrypted:r}),[r.buffer])})}};return new b(n)}()}),kgt=function(n){var t=n["default"]?"main":"alternative";return n.characteristics&&n.characteristics.indexOf("public.accessibility.describes-video")>=0&&(t="main-desc"),t},hl=function(n,t){n.abort();n.pause();t&&t.activePlaylistLoader&&(t.activePlaylistLoader.pause(),t.activePlaylistLoader=null)},dw=function(n,t){t.activePlaylistLoader=n;n.load()},dgt=function(n,t){return function(){var u=t.segmentLoaders,f=u[n],e=u.main,i=t.mediaTypes[n],o=i.activeTrack(),r=i.activeGroup(o),s=i.activePlaylistLoader;if(hl(f,i),r){if(!r.playlistLoader){s&&e.resetEverything();return}f.resyncLoader();dw(r.playlistLoader,i)}}},ggt=function(n,t){return function(){var i=t.segmentLoaders[n];i.abort();i.pause()}},nnt=function(n,t){return function(){var e=t.segmentLoaders,r=e[n],f=e.main,i=t.mediaTypes[n],o=i.activeTrack(),u=i.activeGroup(o),s=i.activePlaylistLoader;if(hl(r,i),u){if(n==="AUDIO"){if(!u.playlistLoader){f.setAudio(!0);f.resetEverything();return}r.setAudio(!0);f.setAudio(!1)}if(s===u.playlistLoader){dw(u.playlistLoader,i);return}r.track&&r.track(o);r.resetEverything();dw(u.playlistLoader,i)}}},cl={AUDIO:function(t,i){return function(){var o=i.segmentLoaders[t],r=i.mediaTypes[t],s=i.blacklistCurrentPlaylist,u;hl(o,r);var h=r.activeTrack(),f=r.activeGroup(),c=(f.filter(function(n){return n["default"]})[0]||f[0]).id,e=r.tracks[c];if(h===e){s({message:"Problem encountered loading the default audio track."});return}n.log.warn("Problem encountered loading the alternate audio track.Switching back to default.");for(u in r.tracks)r.tracks[u].enabled=r.tracks[u]===e;r.onTrackChanged()}},SUBTITLES:function(t,i){return function(){var f=i.segmentLoaders[t],r=i.mediaTypes[t],u;n.log.warn("Problem encountered loading the subtitle track.Disabling subtitle track.");hl(f,r);u=r.activeTrack();u&&(u.mode="disabled");r.onTrackChanged()}}},det={AUDIO:function(n,t,i){if(t){var u=i.tech,f=i.requestOptions,r=i.segmentLoaders[n];t.on("loadedmetadata",function(){var n=t.media();r.playlist(n,f);(!u.paused()||n.endList&&u.preload()!=="none")&&r.load()});t.on("loadedplaylist",function(){r.playlist(t.media(),f);u.paused()||r.load()});t.on("error",cl[n](n,i))}},SUBTITLES:function(n,t,i){var u=i.tech,f=i.requestOptions,r=i.segmentLoaders[n],e=i.mediaTypes[n];t.on("loadedmetadata",function(){var n=t.media();r.playlist(n,f);r.track(e.activeTrack());(!u.paused()||n.endList&&u.preload()!=="none")&&r.load()});t.on("loadedplaylist",function(){r.playlist(t.media(),f);u.paused()||r.load()});t.on("error",cl[n](n,i))}},tnt={AUDIO:function(t,i){var u=i.vhs,o=i.sourceType,v=i.segmentLoaders[t],f=i.requestOptions,s=i.master,r=s.mediaGroups,y=s.playlists,h=i.mediaTypes[t],e=h.groups,c=h.tracks,p=i.masterPlaylistLoader,l,a;r[t]&&Object.keys(r[t]).length!==0||(r[t]={main:{"default":{"default":!0}}});l=function(s){var h,l,a;e[s]||(e[s]=[]);h=y.filter(function(n){return n.attributes[t]===s});l=function(l){var a=r[t][s][l],w=h.filter(function(n){return n.resolvedUri!==a.resolvedUri}),v,y;!w.length&&h.length&&delete a.resolvedUri;v=void 0;v=o==="vhs-json"&&a.playlists?new gf(a.playlists[0],u,f):a.resolvedUri?new gf(a.resolvedUri,u,f):a.playlists&&o==="dash"?new cw(a.playlists[0],u,f,p):null;a=n.mergeOptions({id:l,playlistLoader:v},a);det[t](t,a.playlistLoader,i);e[s].push(a);typeof c[l]=="undefined"&&(y=new n.AudioTrack({id:l,kind:kgt(a),enabled:!1,language:a.language,"default":a["default"],label:l}),c[l]=y)};for(a in r[t][s])l(a)};for(a in r[t])l(a);v.on("error",cl[t](t,i))},SUBTITLES:function(t,i){var w=i.tech,s=i.vhs,h=i.sourceType,b=i.segmentLoaders[t],c=i.requestOptions,o=i.master.mediaGroups,a=i.mediaTypes[t],l=a.groups,v=a.tracks,k=i.masterPlaylistLoader,f,u,r,e,y,p;for(f in o[t]){l[f]||(l[f]=[]);for(u in o[t][f])if(!o[t][f][u].forced){if(r=o[t][f][u],e=void 0,h==="hls")e=new gf(r.resolvedUri,s,c);else if(h==="dash"){if(y=r.playlists.filter(function(n){return n.excludeUntil!==Infinity}),!y.length)return;e=new cw(r.playlists[0],s,c,k)}else h==="vhs-json"&&(e=new gf(r.playlists?r.playlists[0]:r.resolvedUri,s,c));r=n.mergeOptions({id:u,playlistLoader:e},r);det[t](t,r.playlistLoader,i);l[f].push(r);typeof v[u]=="undefined"&&(p=w.addRemoteTextTrack({id:u,kind:"subtitles","default":r["default"]&&r.autoselect,language:r.language,label:u},!1).track,v[u]=p)}}b.on("error",cl[t](t,i))},"CLOSED-CAPTIONS":function(t,i){var l=i.tech,e=i.master.mediaGroups,s=i.mediaTypes[t],o=s.groups,h=s.tracks,u,f,r,c;for(u in e[t]){o[u]||(o[u]=[]);for(f in e[t][u])(r=e[t][u][f],r.instreamId.match(/CC\d/))&&(o[u].push(n.mergeOptions({id:f},r)),typeof h[f]=="undefined"&&(c=l.addRemoteTextTrack({id:r.instreamId,kind:"captions","default":r["default"]&&r.autoselect,language:r.language,label:f},!1).track,h[f]=c))}}},int=function(n,t){return function(i){var e=t.masterPlaylistLoader,f=t.mediaTypes[n].groups,u=e.media(),r;return u?(r=null,u.attributes[n]&&(r=f[u.attributes[n]]),r=r||f.main,typeof i=="undefined")?r:i===null?null:r.filter(function(n){return n.id===i.id})[0]||null:null}},rnt={AUDIO:function(n,t){return function(){var i=t.mediaTypes[n].tracks;for(var r in i)if(i[r].enabled)return i[r];return null}},SUBTITLES:function(n,t){return function(){var i=t.mediaTypes[n].tracks;for(var r in i)if(i[r].mode==="showing"||i[r].mode==="hidden")return i[r];return null}}},unt=function(n){var r,e,u,o;["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){tnt[t](t,n)});var t=n.mediaTypes,f=n.masterPlaylistLoader,i=n.tech,s=n.vhs;["AUDIO","SUBTITLES"].forEach(function(i){t[i].activeGroup=int(i,n);t[i].activeTrack=rnt[i](i,n);t[i].onGroupChanged=dgt(i,n);t[i].onGroupChanging=ggt(i,n);t[i].onTrackChanged=nnt(i,n)});r=t.AUDIO.activeGroup();r&&(e=(r.filter(function(n){return n["default"]})[0]||r[0]).id,t.AUDIO.tracks[e].enabled=!0,t.AUDIO.onTrackChanged());f.on("mediachange",function(){["AUDIO","SUBTITLES"].forEach(function(n){return t[n].onGroupChanged()})});f.on("mediachanging",function(){["AUDIO","SUBTITLES"].forEach(function(n){return t[n].onGroupChanging()})});u=function(){t.AUDIO.onTrackChanged();i.trigger({type:"usage",name:"vhs-audio-change"});i.trigger({type:"usage",name:"hls-audio-change"})};i.audioTracks().addEventListener("change",u);i.remoteTextTracks().addEventListener("change",t.SUBTITLES.onTrackChanged);s.on("dispose",function(){i.audioTracks().removeEventListener("change",u);i.remoteTextTracks().removeEventListener("change",t.SUBTITLES.onTrackChanged)});i.clearTracks("audio");for(o in t.AUDIO.tracks)i.audioTracks().addTrack(t.AUDIO.tracks[o])},fnt=function(){var n={};return["AUDIO","SUBTITLES","CLOSED-CAPTIONS"].forEach(function(t){n[t]={groups:{},tracks:{},activePlaylistLoader:null,activeGroup:cr,activeTrack:cr,onGroupChanged:cr,onTrackChanged:cr}}),n},ent=120,cu,ont=["mediaRequests","mediaRequestsAborted","mediaRequestsTimedout","mediaRequestsErrored","mediaTransferDuration","mediaBytesTransferred"],snt=function(n){return this.audioSegmentLoader_[n]+this.mainSegmentLoader_[n]},hnt=function(t){var i=t.currentPlaylist,s=t.nextPlaylist,h=t.forwardBuffer,v=t.bufferLowWaterLine,y=t.bufferHighWaterLine,p=t.duration,u=t.experimentalBufferBasedABR,f=t.log,r,c,e,o,l,a;return s?(r="allowing switch "+(i&&i.id||"null")+" -> "+s.id,!i||!i.endList)?(f(r+" as current playlist "+(i?"is live":"is not set")),!0):s.id===i.id?!1:(c=u?it.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE:it.MAX_BUFFER_LOW_WATER_LINE,p<c)?(f(r+" as duration < max low water line ("+p+" < "+c+")"),!0):(e=s.attributes.BANDWIDTH,o=i.attributes.BANDWIDTH,e<o&&(!u||h<y))?(l=r+" as next bandwidth < current bandwidth ("+e+" < "+o+")",u&&(l+=" and forwardBuffer < bufferHighWaterLine ("+h+" < "+y+")"),f(l),!0):(!u||e>o)&&h>=v?(a=r+" as forwardBuffer >= bufferLowWaterLine ("+h+" >= "+v+")",u&&(a+=" and next bandwidth > current bandwidth ("+e+" > "+o+")"),f(a),!0):(f("not "+r+" as no switching criteria met"),!1):(n.log.warn("We received no playlist to switch to. Please check your stream."),!1)},cnt=function(t){function r(i){var r,f;r=t.call(this)||this;var e=i.src,h=i.handleManifestRedirects,s=i.withCredentials,o=i.tech,c=i.bandwidth,l=i.externVhs,a=i.useCueTags,v=i.blacklistDuration,y=i.enableLowInitialPlaylist,p=i.sourceType,w=i.cacheEncryptionKeys,b=i.handlePartialData,k=i.experimentalBufferBasedABR;if(!e)throw new Error("A non-empty playlist URL or JSON manifest string is required");cu=l;r.experimentalBufferBasedABR=Boolean(k);r.withCredentials=s;r.tech_=o;r.vhs_=o.vhs;r.sourceType_=p;r.useCueTags_=a;r.blacklistDuration=v;r.enableLowInitialPlaylist=y;r.useCueTags_&&(r.cueTagsTrack_=r.tech_.addTextTrack("metadata","ad-cues"),r.cueTagsTrack_.inBandMetadataTrackDispatchType="");r.requestOptions_={withCredentials:s,handleManifestRedirects:h,timeout:null};r.on("error",r.pauseLoading);if(r.mediaTypes_=fnt(),r.mediaSource=new u.MediaSource,r.handleDurationChange_=r.handleDurationChange_.bind(ri(r)),r.handleSourceOpen_=r.handleSourceOpen_.bind(ri(r)),r.handleSourceEnded_=r.handleSourceEnded_.bind(ri(r)),r.mediaSource.addEventListener("durationchange",r.handleDurationChange_),r.mediaSource.addEventListener("sourceopen",r.handleSourceOpen_),r.mediaSource.addEventListener("sourceended",r.handleSourceEnded_),r.seekable_=n.createTimeRanges(),r.hasPlayed_=!1,r.syncController_=new pgt(i),r.segmentMetadataTrack_=o.addRemoteTextTrack({kind:"metadata",label:"segment-metadata"},!1).track,r.decrypter_=new bgt,r.sourceUpdater_=new pet(r.mediaSource),r.inbandTextTracks_={},r.timelineChangeController_=new wgt,f={vhs:r.vhs_,mediaSource:r.mediaSource,currentTime:r.tech_.currentTime.bind(r.tech_),seekable:function(){return r.seekable()},seeking:function(){return r.tech_.seeking()},duration:function(){return r.duration()},hasPlayed:function(){return r.hasPlayed_},goalBufferLength:function(){return r.goalBufferLength()},bandwidth:c,syncController:r.syncController_,decrypter:r.decrypter_,sourceType:r.sourceType_,inbandTextTracks:r.inbandTextTracks_,cacheEncryptionKeys:w,handlePartialData:b,sourceUpdater:r.sourceUpdater_,timelineChangeController:r.timelineChangeController_},r.masterPlaylistLoader_=r.sourceType_==="dash"?new cw(e,r.vhs_,r.requestOptions_):new gf(e,r.vhs_,r.requestOptions_),r.setupMasterPlaylistLoaderListeners_(),r.mainSegmentLoader_=new bw(n.mergeOptions(f,{segmentMetadataTrack:r.segmentMetadataTrack_,loaderType:"main"}),i),r.audioSegmentLoader_=new bw(n.mergeOptions(f,{loaderType:"audio"}),i),r.subtitleSegmentLoader_=new agt(n.mergeOptions(f,{loaderType:"vtt",featuresNativeTextTracks:r.tech_.featuresNativeTextTracks}),i),r.setupSegmentLoaderListeners_(),r.experimentalBufferBasedABR){r.masterPlaylistLoader_.one("loadedplaylist",function(){return r.startABRTimer_()});r.tech_.on("pause",function(){return r.stopABRTimer_()});r.tech_.on("play",function(){return r.startABRTimer_()})}return ont.forEach(function(n){r[n+"_"]=snt.bind(ri(r),n)}),r.logger_=hu("MPC"),r.triggeredFmp4Usage=!1,r.masterPlaylistLoader_.load(),r}vi(r,t);var i=r.prototype;return i.checkABR_=function(){var n=this.selectPlaylist();this.shouldSwitchToMedia_(n)&&this.masterPlaylistLoader_.media(n)},i.startABRTimer_=function(){var n=this;this.stopABRTimer_();this.abrTimer_=u.setInterval(function(){return n.checkABR_()},250)},i.stopABRTimer_=function(){this.tech_.scrubbing&&this.tech_.scrubbing()||(u.clearInterval(this.abrTimer_),this.abrTimer_=null)},i.setupMasterPlaylistLoaderListeners_=function(){var n=this;this.masterPlaylistLoader_.on("loadedmetadata",function(){var t=n.masterPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;if(n.requestOptions_.timeout=fw(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())?0:i,t.endList&&n.tech_.preload()!=="none"&&(n.mainSegmentLoader_.playlist(t,n.requestOptions_),n.mainSegmentLoader_.load()),unt({sourceType:n.sourceType_,segmentLoaders:{AUDIO:n.audioSegmentLoader_,SUBTITLES:n.subtitleSegmentLoader_,main:n.mainSegmentLoader_},tech:n.tech_,requestOptions:n.requestOptions_,masterPlaylistLoader:n.masterPlaylistLoader_,vhs:n.vhs_,master:n.master(),mediaTypes:n.mediaTypes_,blacklistCurrentPlaylist:n.blacklistCurrentPlaylist.bind(n)}),n.triggerPresenceUsage_(n.master(),t),n.setupFirstPlay(),!n.mediaTypes_.AUDIO.activePlaylistLoader||n.mediaTypes_.AUDIO.activePlaylistLoader.media())n.trigger("selectedinitialmedia");else n.mediaTypes_.AUDIO.activePlaylistLoader.one("loadedmetadata",function(){n.trigger("selectedinitialmedia")})});this.masterPlaylistLoader_.on("loadedplaylist",function(){var i=n.masterPlaylistLoader_.media(),t,r;if(!i){if(n.excludeUnsupportedVariants_(),n.enableLowInitialPlaylist&&(t=n.selectInitialPlaylist()),t||(t=n.selectPlaylist()),!t||!n.shouldSwitchToMedia_(t))return;if(n.initialMedia_=t,n.masterPlaylistLoader_.media(n.initialMedia_),r=n.sourceType_==="vhs-json"&&n.initialMedia_.segments,!r)return;i=n.initialMedia_}n.handleUpdatedMediaPlaylist(i)});this.masterPlaylistLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.masterPlaylistLoader_.error)});this.masterPlaylistLoader_.on("mediachanging",function(){n.mainSegmentLoader_.abort();n.mainSegmentLoader_.pause()});this.masterPlaylistLoader_.on("mediachange",function(){var t=n.masterPlaylistLoader_.media(),i=t.targetDuration*1.5*1e3;n.requestOptions_.timeout=fw(n.masterPlaylistLoader_.master,n.masterPlaylistLoader_.media())?0:i;n.mainSegmentLoader_.playlist(t,n.requestOptions_);n.mainSegmentLoader_.load();n.tech_.trigger({type:"mediachange",bubbles:!0})});this.masterPlaylistLoader_.on("playlistunchanged",function(){var t=n.masterPlaylistLoader_.media(),i=n.stuckAtPlaylistEnd_(t);i&&(n.blacklistCurrentPlaylist({message:"Playlist no longer updating."}),n.tech_.trigger("playliststuck"))});this.masterPlaylistLoader_.on("renditiondisabled",function(){n.tech_.trigger({type:"usage",name:"vhs-rendition-disabled"});n.tech_.trigger({type:"usage",name:"hls-rendition-disabled"})});this.masterPlaylistLoader_.on("renditionenabled",function(){n.tech_.trigger({type:"usage",name:"vhs-rendition-enabled"});n.tech_.trigger({type:"usage",name:"hls-rendition-enabled"})})},i.handleUpdatedMediaPlaylist=function(n){this.useCueTags_&&this.updateAdCues_(n);this.mainSegmentLoader_.playlist(n,this.requestOptions_);this.updateDuration(!n.endList);this.tech_.paused()||(this.mainSegmentLoader_.load(),this.audioSegmentLoader_&&this.audioSegmentLoader_.load())},i.triggerPresenceUsage_=function(n,t){var i=n.mediaGroups||{},u=!0,f=Object.keys(i.AUDIO),r,e,o;for(r in i.AUDIO)for(e in i.AUDIO[r])o=i.AUDIO[r][e],o.uri||(u=!1);u&&(this.tech_.trigger({type:"usage",name:"vhs-demuxed"}),this.tech_.trigger({type:"usage",name:"hls-demuxed"}));Object.keys(i.SUBTITLES).length&&(this.tech_.trigger({type:"usage",name:"vhs-webvtt"}),this.tech_.trigger({type:"usage",name:"hls-webvtt"}));cu.Playlist.isAes(t)&&(this.tech_.trigger({type:"usage",name:"vhs-aes"}),this.tech_.trigger({type:"usage",name:"hls-aes"}));f.length&&Object.keys(i.AUDIO[f[0]]).length>1&&(this.tech_.trigger({type:"usage",name:"vhs-alternate-audio"}),this.tech_.trigger({type:"usage",name:"hls-alternate-audio"}));this.useCueTags_&&(this.tech_.trigger({type:"usage",name:"vhs-playlist-cue-tags"}),this.tech_.trigger({type:"usage",name:"hls-playlist-cue-tags"}))},i.shouldSwitchToMedia_=function(n){var i=this.masterPlaylistLoader_.media(),t=this.tech_.buffered(),r=t.length?t.end(t.length-1)-this.tech_.currentTime():0,u=this.bufferLowWaterLine(),f=this.bufferHighWaterLine();return hnt({currentPlaylist:i,nextPlaylist:n,forwardBuffer:r,bufferLowWaterLine:u,bufferHighWaterLine:f,duration:this.duration(),experimentalBufferBasedABR:this.experimentalBufferBasedABR,log:this.logger_})},i.setupSegmentLoaderListeners_=function(){var n=this,t;if(!this.experimentalBufferBasedABR){this.mainSegmentLoader_.on("bandwidthupdate",function(){var t=n.selectPlaylist();n.shouldSwitchToMedia_(t)&&n.masterPlaylistLoader_.media(t);n.tech_.trigger("bandwidthupdate")});this.mainSegmentLoader_.on("progress",function(){n.trigger("progress")})}this.mainSegmentLoader_.on("error",function(){n.blacklistCurrentPlaylist(n.mainSegmentLoader_.error())});this.mainSegmentLoader_.on("appenderror",function(){n.error=n.mainSegmentLoader_.error_;n.trigger("error")});this.mainSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()});this.mainSegmentLoader_.on("timestampoffset",function(){n.tech_.trigger({type:"usage",name:"vhs-timestamp-offset"});n.tech_.trigger({type:"usage",name:"hls-timestamp-offset"})});this.audioSegmentLoader_.on("syncinfoupdate",function(){n.onSyncInfoUpdate_()});this.audioSegmentLoader_.on("appenderror",function(){n.error=n.audioSegmentLoader_.error_;n.trigger("error")});this.mainSegmentLoader_.on("ended",function(){n.logger_("main segment loader ended");n.onEndOfStream()});this.mainSegmentLoader_.on("earlyabort",function(){n.experimentalBufferBasedABR||(n.delegateLoaders_("all",["abort"]),n.blacklistCurrentPlaylist({message:"Aborted early because there isn't enough bandwidth to complete the request without rebuffering."},ent))});t=function(){if(!n.sourceUpdater_.hasCreatedSourceBuffers())return n.tryToCreateSourceBuffers_();var t=n.getCodecsOrExclude_();t&&n.sourceUpdater_.addOrChangeSourceBuffers(t)};this.mainSegmentLoader_.on("trackinfo",t);this.audioSegmentLoader_.on("trackinfo",t);this.mainSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)});this.audioSegmentLoader_.on("fmp4",function(){n.triggeredFmp4Usage||(n.tech_.trigger({type:"usage",name:"vhs-fmp4"}),n.tech_.trigger({type:"usage",name:"hls-fmp4"}),n.triggeredFmp4Usage=!0)});this.audioSegmentLoader_.on("ended",function(){n.logger_("audioSegmentLoader ended");n.onEndOfStream()})},i.mediaSecondsLoaded_=function(){return Math.max(this.audioSegmentLoader_.mediaSecondsLoaded+this.mainSegmentLoader_.mediaSecondsLoaded)},i.load=function(){this.mainSegmentLoader_.load();this.mediaTypes_.AUDIO.activePlaylistLoader&&this.audioSegmentLoader_.load();this.mediaTypes_.SUBTITLES.activePlaylistLoader&&this.subtitleSegmentLoader_.load()},i.smoothQualityChange_=function(n){(n===void 0&&(n=this.selectPlaylist()),n!==this.masterPlaylistLoader_.media())&&(this.masterPlaylistLoader_.media(n),this.mainSegmentLoader_.resetLoader())},i.fastQualityChange_=function(t){var i=this;(t===void 0&&(t=this.selectPlaylist()),t!==this.masterPlaylistLoader_.media())&&(this.masterPlaylistLoader_.media(t),this.mainSegmentLoader_.resetEverything(function(){n.browser.IE_VERSION||n.browser.IS_EDGE?i.tech_.setCurrentTime(i.tech_.currentTime()+.04):i.tech_.setCurrentTime(i.tech_.currentTime())}))},i.play=function(){if(!this.setupFirstPlay()){this.tech_.ended()&&this.tech_.setCurrentTime(0);this.hasPlayed_&&this.load();var n=this.tech_.seekable();if(this.tech_.duration()===Infinity&&this.tech_.currentTime()<n.start(0))return this.tech_.setCurrentTime(n.end(n.length-1))}},i.setupFirstPlay=function(){var i=this,r=this.masterPlaylistLoader_.media(),t;if(!r||this.tech_.paused()||this.hasPlayed_)return!1;if(!r.endList){if(t=this.seekable(),!t.length)return!1;if(n.browser.IE_VERSION&&this.tech_.readyState()===0){this.tech_.one("loadedmetadata",function(){i.trigger("firstplay");i.tech_.setCurrentTime(t.end(0));i.hasPlayed_=!0});return!1}this.trigger("firstplay");this.tech_.setCurrentTime(t.end(0))}return this.hasPlayed_=!0,this.load(),!0},i.handleSourceOpen_=function(){if(this.tryToCreateSourceBuffers_(),this.tech_.autoplay()){var n=this.tech_.play();typeof n!="undefined"&&typeof n.then=="function"&&n.then(null,function(){})}this.trigger("sourceopen")},i.handleSourceEnded_=function(){var n,t;this.inbandTextTracks_.metadataTrack_&&(n=this.inbandTextTracks_.metadataTrack_.cues,n&&n.length)&&(t=this.duration(),n[n.length-1].endTime=isNaN(t)||Math.abs(t)===Infinity?Number.MAX_VALUE:t)},i.handleDurationChange_=function(){this.tech_.trigger("durationchange")},i.onEndOfStream=function(){var n=this.mainSegmentLoader_.ended_;(this.mediaTypes_.AUDIO.activePlaylistLoader&&(n=!this.mainSegmentLoader_.currentMediaInfo_||this.mainSegmentLoader_.currentMediaInfo_.hasVideo?n&&this.audioSegmentLoader_.ended_:this.audioSegmentLoader_.ended_),n)&&(this.stopABRTimer_(),this.sourceUpdater_.endOfStream())},i.stuckAtPlaylistEnd_=function(n){var e=this.seekable(),t,r;if(!e.length||(t=this.syncController_.getExpiredTime(n,this.duration()),t===null))return!1;var u=cu.Playlist.playlistEnd(n,t),f=this.tech_.currentTime(),i=this.tech_.buffered();return i.length?(r=i.end(i.length-1),r-f<=wi&&u-r<=wi):u-f<=wi},i.blacklistCurrentPlaylist=function(t,i){var r,o,u,h,c,l,a;if(t===void 0&&(t={}),r=t.playlist||this.masterPlaylistLoader_.media(),i=i||t.blacklistDuration||this.blacklistDuration,!r){this.error=t;this.mediaSource.readyState!=="open"?this.trigger("error"):this.sourceUpdater_.endOfStream("network");return}var f=this.masterPlaylistLoader_.master.playlists,s=f.filter(il),e=s.length===1&&s[0]===r;if(f.length===1&&i!==Infinity)return n.log.warn("Problem encountered with playlist "+r.id+". Trying again since it is the only playlist."),this.tech_.trigger("retryplaylist"),this.masterPlaylistLoader_.load(e);if(e&&(o=!1,f.forEach(function(n){if(n!==r){var t=n.excludeUntil;typeof t!="undefined"&&t!==Infinity&&(o=!0,delete n.excludeUntil)}}),o&&(n.log.warn("Removing other playlists from the exclusion list because the last rendition is about to be excluded."),this.tech_.trigger("retryplaylist"))),r.excludeUntil=Date.now()+i*1e3,this.tech_.trigger("blacklistplaylist"),this.tech_.trigger({type:"usage",name:"vhs-rendition-blacklisted"}),this.tech_.trigger({type:"usage",name:"hls-rendition-blacklisted"}),u=this.selectPlaylist(),!u){this.error="Playback cannot continue. No available working or supported playlists.";this.trigger("error");return}return h=t.internal?this.logger_:n.log.warn,c=t.message?" "+t.message:"",h((t.internal?"Internal problem":"Problem")+" encountered with playlist "+r.id+"."+(c+" Switching to playlist "+u.id+".")),u.attributes.AUDIO!==r.attributes.AUDIO&&this.delegateLoaders_("audio",["abort","pause"]),u.attributes.SUBTITLES!==r.attributes.SUBTITLES&&this.delegateLoaders_("subtitle",["abort","pause"]),this.delegateLoaders_("main",["abort","pause"]),l=u.targetDuration*500||5e3,a=typeof u.lastRequest=="number"&&Date.now()-u.lastRequest<=l,this.masterPlaylistLoader_.media(u,e||a)},i.pauseLoading=function(){this.delegateLoaders_("all",["abort","pause"]);this.stopABRTimer_()},i.delegateLoaders_=function(n,t){var u=this,r=[],f=n==="all",i;(f||n==="main")&&r.push(this.masterPlaylistLoader_);i=[];(f||n==="audio")&&i.push("AUDIO");(f||n==="subtitle")&&(i.push("CLOSED-CAPTIONS"),i.push("SUBTITLES"));i.forEach(function(n){var t=u.mediaTypes_[n]&&u.mediaTypes_[n].activePlaylistLoader;t&&r.push(t)});["main","audio","subtitle"].forEach(function(t){var i=u[t+"SegmentLoader_"];i&&(n===t||n==="all")&&r.push(i)});r.forEach(function(n){return t.forEach(function(t){typeof n[t]=="function"&&n[t]()})})},i.setCurrentTime=function(n){var t=ko(this.tech_.buffered(),n);if(!(this.masterPlaylistLoader_&&this.masterPlaylistLoader_.media())||!this.masterPlaylistLoader_.media().segments)return 0;if(t&&t.length)return n;this.mainSegmentLoader_.resetEverything();this.mainSegmentLoader_.abort();this.mediaTypes_.AUDIO.activePlaylistLoader&&(this.audioSegmentLoader_.resetEverything(),this.audioSegmentLoader_.abort());this.mediaTypes_.SUBTITLES.activePlaylistLoader&&(this.subtitleSegmentLoader_.resetEverything(),this.subtitleSegmentLoader_.abort());this.load()},i.duration=function(){if(!this.masterPlaylistLoader_)return 0;var n=this.masterPlaylistLoader_.media();return n?n.endList?this.mediaSource?this.mediaSource.duration:cu.Playlist.duration(n):Infinity:0},i.seekable=function(){return this.seekable_},i.onSyncInfoUpdate_=function(){var i,r,u,f,t,e,o;if(this.masterPlaylistLoader_&&(r=this.masterPlaylistLoader_.media(),r)&&(u=this.syncController_.getExpiredTime(r,this.duration()),u!==null)&&(f=this.masterPlaylistLoader_.master.suggestedPresentationDelay,t=cu.Playlist.seekable(r,u,f),t.length!==0)){if(this.mediaTypes_.AUDIO.activePlaylistLoader){if(r=this.mediaTypes_.AUDIO.activePlaylistLoader.media(),u=this.syncController_.getExpiredTime(r,this.duration()),u===null)return;if(i=cu.Playlist.seekable(r,u,f),i.length===0)return}(this.seekable_&&this.seekable_.length&&(e=this.seekable_.end(0),o=this.seekable_.start(0)),this.seekable_=i?i.start(0)>t.end(0)||t.start(0)>i.end(0)?t:n.createTimeRanges([[i.start(0)>t.start(0)?i.start(0):t.start(0),i.end(0)<t.end(0)?i.end(0):t.end(0)]]):t,this.seekable_&&this.seekable_.length&&this.seekable_.end(0)===e&&this.seekable_.start(0)===o)||(this.logger_("seekable updated ["+dut(this.seekable_)+"]"),this.tech_.trigger("seekablechanged"))}},i.updateDuration=function(n){var t,r,i;if(this.updateDuration_&&(this.mediaSource.removeEventListener("sourceopen",this.updateDuration_),this.updateDuration_=null),this.mediaSource.readyState!=="open"){this.updateDuration_=this.updateDuration.bind(this,n);this.mediaSource.addEventListener("sourceopen",this.updateDuration_);return}if(n){if(t=this.seekable(),!t.length)return;(isNaN(this.mediaSource.duration)||this.mediaSource.duration<t.end(t.length-1))&&this.sourceUpdater_.setDuration(t.end(t.length-1));return}r=this.tech_.buffered();i=cu.Playlist.duration(this.masterPlaylistLoader_.media());r.length>0&&(i=Math.max(i,r.end(r.length-1)));this.mediaSource.duration!==i&&this.sourceUpdater_.setDuration(i)},i.dispose=function(){var n=this;this.trigger("dispose");this.decrypter_.terminate();this.masterPlaylistLoader_.dispose();this.mainSegmentLoader_.dispose();["AUDIO","SUBTITLES"].forEach(function(t){var i=n.mediaTypes_[t].groups;for(var r in i)i[r].forEach(function(n){n.playlistLoader&&n.playlistLoader.dispose()})});this.audioSegmentLoader_.dispose();this.subtitleSegmentLoader_.dispose();this.sourceUpdater_.dispose();this.timelineChangeController_.dispose();this.stopABRTimer_();this.updateDuration_&&this.mediaSource.removeEventListener("sourceopen",this.updateDuration_);this.mediaSource.removeEventListener("durationchange",this.handleDurationChange_);this.mediaSource.removeEventListener("sourceopen",this.handleSourceOpen_);this.mediaSource.removeEventListener("sourceended",this.handleSourceEnded_);this.off()},i.master=function(){return this.masterPlaylistLoader_.master},i.media=function(){return this.masterPlaylistLoader_.media()||this.initialMedia_},i.areMediaTypesKnown_=function(){var n=!!this.mediaTypes_.AUDIO.activePlaylistLoader;return!this.mainSegmentLoader_.currentMediaInfo_||n&&!this.audioSegmentLoader_.currentMediaInfo_?!1:!0},i.getCodecsOrExclude_=function(){var u=this,n={main:this.mainSegmentLoader_.currentMediaInfo_||{},audio:this.audioSegmentLoader_.currentMediaInfo_||{}},h,i,e,o,c,r;n.video=n.main;var f=ts(this.master(),this.media()),t={},s=!!this.mediaTypes_.AUDIO.activePlaylistLoader;if(n.main.hasVideo&&(t.video=f.video||n.main.videoCodec||ewt),n.main.isMuxed&&(t.video+=","+(f.audio||n.main.audioCodec||cut)),(n.main.hasAudio&&!n.main.isMuxed||n.audio.hasAudio||s)&&(t.audio=f.audio||n.main.audioCodec||n.audio.audioCodec||cut,n.audio.isFmp4=n.main.hasAudio&&!n.main.isMuxed?n.main.isFmp4:n.audio.isFmp4),!t.audio&&!t.video){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Could not determine codecs for playlist.",blacklistDuration:Infinity});return}if(h=function(n,t){return n?gc(t):dp(t)},i={},["video","audio"].forEach(function(r){if(t.hasOwnProperty(r)&&!h(n[r].isFmp4,t[r])){var u=n[r].isFmp4?"browser":"muxer";i[u]=i[u]||[];i[u].push(t[r]);r==="audio"&&(e=u)}}),s&&e&&this.media().attributes.AUDIO&&(o=this.media().attributes.AUDIO,this.master().playlists.forEach(function(n){var t=n.attributes&&n.attributes.AUDIO;t===o&&n!==u.media()&&(n.excludeUntil=Infinity)}),this.logger_("excluding audio group "+o+" as "+e+' does not support codec(s): "'+t.audio+'"')),Object.keys(i).length){c=Object.keys(i).reduce(function(n,t){return n&&(n+=", "),n+(t+' does not support codec(s): "'+i[t].join(",")+'"')},"")+".";this.blacklistCurrentPlaylist({playlist:this.media(),internal:!0,message:c,blacklistDuration:Infinity});return}if(this.sourceUpdater_.hasCreatedSourceBuffers()&&!this.sourceUpdater_.canChangeType()&&(r=[],["video","audio"].forEach(function(n){var i=(bo(u.sourceUpdater_.codecs[n]||"")[n]||{}).type,f=(bo(t[n]||"")[n]||{}).type;i&&f&&i.toLowerCase()!==f.toLowerCase()&&r.push('"'+u.sourceUpdater_.codecs[n]+'" -> "'+t[n]+'"')}),r.length)){this.blacklistCurrentPlaylist({playlist:this.media(),message:"Codec switching not supported: "+r.join(", ")+".",blacklistDuration:Infinity,internal:!0});return}return t},i.tryToCreateSourceBuffers_=function(){var n,t;this.mediaSource.readyState!=="open"||this.sourceUpdater_.hasCreatedSourceBuffers()||this.areMediaTypesKnown_()&&(n=this.getCodecsOrExclude_(),n)&&(this.sourceUpdater_.createSourceBuffers(n),t=[n.video,n.audio].filter(Boolean).join(","),this.excludeIncompatibleVariants_(t))},i.excludeUnsupportedVariants_=function(){var n=this,t=this.master().playlists,i=[];Object.keys(t).forEach(function(r){var f=t[r],u,e;i.indexOf(f.id)===-1&&(i.push(f.id),u=ts(n.master,f),e=[],!u.audio||dp(u.audio)||gc(u.audio)||(f.excludeUntil=Infinity,e.push("audio codec "+u.audio)),!u.video||dp(u.video)||gc(u.video)||(f.excludeUntil=Infinity,e.push("video codec "+u.video)),u.text&&u.text==="stpp.ttml.im1t"&&(f.excludeUntil=Infinity,e.push("text codec "+u.text)),e.length&&n.logger_("excluding "+f.id+" as codecs "+e.join(", ")+" are unsupported"))})},i.excludeIncompatibleVariants_=function(n){var i=this,t=bo(n),r=Object.keys(t).length;this.master().playlists.forEach(function(n){var s;if(n.excludeUntil!==Infinity){var u={},o=2,f=[],e=ts(i.masterPlaylistLoader_.master,n);(e.audio||e.video)&&(s=[e.video,e.audio].filter(Boolean).join(","),u=bo(s),o=Object.keys(u).length);o!==r&&(f.push('codec count "'+o+'" !== "'+r+'"'),n.excludeUntil=Infinity);i.sourceUpdater_.canChangeType()||(u.video&&t.video&&u.video.type.toLowerCase()!==t.video.type.toLowerCase()&&(f.push('video codec "'+u.video.type+'" !== "'+t.video.type+'"'),n.excludeUntil=Infinity),u.audio&&t.audio&&u.audio.type.toLowerCase()!==t.audio.type.toLowerCase()&&(n.excludeUntil=Infinity,f.push('audio codec "'+u.audio.type+'" !== "'+t.audio.type+'"')));f.length&&i.logger_("blacklisting "+n.id+": "+f.join(" && "))}})},i.updateAdCues_=function(n){var t=0,i=this.seekable();i.length&&(t=i.start(0));ygt(n,this.cueTagsTrack_,t)},i.goalBufferLength=function(){var t=this.tech_.currentTime(),n=it.GOAL_BUFFER_LENGTH,i=it.GOAL_BUFFER_LENGTH_RATE,r=Math.max(n,it.MAX_GOAL_BUFFER_LENGTH);return Math.min(n+t*i,r)},i.bufferLowWaterLine=function(){var t=this.tech_.currentTime(),n=it.BUFFER_LOW_WATER_LINE,i=it.BUFFER_LOW_WATER_LINE_RATE,r=Math.max(n,it.MAX_BUFFER_LOW_WATER_LINE),u=Math.max(n,it.EXPERIMENTAL_MAX_BUFFER_LOW_WATER_LINE);return Math.min(n+t*i,this.experimentalBufferBasedABR?u:r)},i.bufferHighWaterLine=function(){return it.BUFFER_HIGH_WATER_LINE},r}(n.EventTarget),lnt=function(n,t,i){return function(r){var u=n.master.playlists[t],e=uw(u),f=il(u);return typeof r=="undefined"?f:(r?delete u.disabled:u.disabled=!0,r===f||e||(i(),r?n.trigger("renditionenabled"):n.trigger("renditiondisabled")),r)}},ant=function(n,t,i){var r=n.masterPlaylistController_,f=n.options_.smoothQualityChange,e=f?"smooth":"fast",o=r[e+"QualityChange_"].bind(r),u;t.attributes.RESOLUTION&&(u=t.attributes.RESOLUTION,this.width=u.width,this.height=u.height);this.bandwidth=t.attributes.BANDWIDTH;this.codecs=ts(r.master(),t);this.playlist=t;this.id=i;this.enabled=lnt(n.playlists,t.id,o)},vnt=function(n){var t=n.playlists;n.representations=function(){return!t||!t.master||!t.master.playlists?[]:t.master.playlists.filter(function(n){return!uw(n)}).map(function(t){return new ant(n,t,t.id)})}},get=["seeking","seeked","pause","playing","error"],ynt=function(n){var t=n.buffered,i=n.targetDuration,r=n.currentTime;return t.length?t.end(0)-t.start(0)<i*2?!1:r>t.start(0)?!1:t.start(0)-r<i:!1},pnt=function(){function t(n){var t=this;this.masterPlaylistController_=n.masterPlaylistController;this.tech_=n.tech;this.seekable=n.seekable;this.allowSeeksWithinUnsafeLiveWindow=n.allowSeeksWithinUnsafeLiveWindow;this.liveRangeSafeTimeDelta=n.liveRangeSafeTimeDelta;this.media=n.media;this.consecutiveUpdates=0;this.lastRecordedTime=null;this.timer_=null;this.checkCurrentTimeTimeout_=null;this.logger_=hu("PlaybackWatcher");this.logger_("initialize");var f=function(){return t.monitorCurrentTime_()},e=function(){return t.techWaiting_()},o=function(){return t.cancelTimer_()},s=function(){return t.fixesBadSeeks_()},r=this.masterPlaylistController_,h=["main","subtitle","audio"],i={};h.forEach(function(n){i[n]={reset:function(){return t.resetSegmentDownloads_(n)},updateend:function(){return t.checkSegmentDownloads_(n)}};r[n+"SegmentLoader_"].on("appendsdone",i[n].updateend);r[n+"SegmentLoader_"].on("playlistupdate",i[n].reset);t.tech_.on(["seeked","seeking"],i[n].reset)});this.tech_.on("seekablechanged",s);this.tech_.on("waiting",e);this.tech_.on(get,o);this.tech_.on("canplay",f);this.dispose=function(){t.logger_("dispose");t.tech_.off("seekablechanged",s);t.tech_.off("waiting",e);t.tech_.off(get,o);t.tech_.off("canplay",f);h.forEach(function(n){r[n+"SegmentLoader_"].off("appendsdone",i[n].updateend);r[n+"SegmentLoader_"].off("playlistupdate",i[n].reset);t.tech_.off(["seeked","seeking"],i[n].reset)});t.checkCurrentTimeTimeout_&&u.clearTimeout(t.checkCurrentTimeTimeout_);t.cancelTimer_()}}var n=t.prototype;return n.monitorCurrentTime_=function(){this.checkCurrentTime_();this.checkCurrentTimeTimeout_&&u.clearTimeout(this.checkCurrentTimeTimeout_);this.checkCurrentTimeTimeout_=u.setTimeout(this.monitorCurrentTime_.bind(this),250)},n.resetSegmentDownloads_=function(n){var t=this.masterPlaylistController_[n+"SegmentLoader_"];this[n+"StalledDownloads_"]>0&&this.logger_("resetting possible stalled download count for "+n+" loader");this[n+"StalledDownloads_"]=0;this[n+"Buffered_"]=t.buffered_()},n.checkSegmentDownloads_=function(n){var r=this.masterPlaylistController_,t=r[n+"SegmentLoader_"],i=t.buffered_(),u=dwt(this[n+"Buffered_"],i);if(this[n+"Buffered_"]=i,u){this.resetSegmentDownloads_(n);return}(this[n+"StalledDownloads_"]++,this.logger_("found #"+this[n+"StalledDownloads_"]+" "+n+" appends that did not increase buffer (possible stalled download)",{playlistId:t.playlist_&&t.playlist_.id,buffered:rw(i)}),this[n+"StalledDownloads_"]<10)||(this.logger_(n+" loader stalled download exclusion"),this.resetSegmentDownloads_(n),this.tech_.trigger({type:"usage",name:"vhs-"+n+"-download-exclusion"}),n!=="subtitle")&&r.blacklistCurrentPlaylist({message:"Excessive "+n+" segment downloading detected."},Infinity)},n.checkCurrentTime_=function(){if(this.tech_.seeking()&&this.fixesBadSeeks_()){this.consecutiveUpdates=0;this.lastRecordedTime=this.tech_.currentTime();return}if(!this.tech_.paused()&&!this.tech_.seeking()){var n=this.tech_.currentTime(),t=this.tech_.buffered();if(this.lastRecordedTime===n&&(!t.length||n+wi>=t.end(t.length-1)))return this.techWaiting_();this.consecutiveUpdates>=5&&n===this.lastRecordedTime?(this.consecutiveUpdates++,this.waiting_()):n===this.lastRecordedTime?this.consecutiveUpdates++:(this.consecutiveUpdates=0,this.lastRecordedTime=n)}},n.cancelTimer_=function(){this.consecutiveUpdates=0;this.timer_&&(this.logger_("cancelTimer_"),clearTimeout(this.timer_));this.timer_=null},n.fixesBadSeeks_=function(){var e=this.tech_.seeking(),f,u,r;if(!e)return!1;var t=this.seekable(),i=this.tech_.currentTime(),o=this.afterSeekableWindow_(t,i,this.media(),this.allowSeeksWithinUnsafeLiveWindow),n;return(o&&(f=t.end(t.length-1),n=f),this.beforeSeekableWindow_(t,i)&&(u=t.start(0),n=u+(u===t.end(0)?0:wi)),typeof n!="undefined")?(this.logger_("Trying to seek outside of seekable at time "+i+" with "+("seekable range "+dut(t)+". Seeking to ")+(n+".")),this.tech_.setCurrentTime(n),!0):(r=this.tech_.buffered(),ynt({buffered:r,targetDuration:this.media().targetDuration,currentTime:i}))?(n=r.start(0)+wi,this.logger_("Buffered region starts ("+r.start(0)+") "+(" just beyond seek point ("+i+"). Seeking to "+n+".")),this.tech_.setCurrentTime(n),!0):!1},n.waiting_=function(){if(!this.techWaiting_()){var n=this.tech_.currentTime(),i=this.tech_.buffered(),t=ko(i,n);if(t.length&&n+3<=t.end(0)){this.cancelTimer_();this.tech_.setCurrentTime(n);this.logger_("Stopped at "+n+" while inside a buffered region "+("["+t.start(0)+" -> "+t.end(0)+"]. Attempting to resume ")+"playback by seeking to the current time.");this.tech_.trigger({type:"usage",name:"vhs-unknown-waiting"});this.tech_.trigger({type:"usage",name:"hls-unknown-waiting"});return}}},n.techWaiting_=function(){var i=this.seekable(),n=this.tech_.currentTime(),r,t,u;if(this.tech_.seeking()&&this.fixesBadSeeks_()||this.tech_.seeking()||this.timer_!==null)return!0;if(this.beforeSeekableWindow_(i,n))return r=i.end(i.length-1),this.logger_("Fell out of live window at time "+n+". Seeking to "+("live point (seekable end) "+r)),this.cancelTimer_(),this.tech_.setCurrentTime(r),this.tech_.trigger({type:"usage",name:"vhs-live-resync"}),this.tech_.trigger({type:"usage",name:"hls-live-resync"}),!0;var f=this.tech_.vhs.masterPlaylistController_.sourceUpdater_,e=this.tech_.buffered(),o=this.videoUnderflow_({audioBuffered:f.audioBuffered(),videoBuffered:f.videoBuffered(),currentTime:n});return o?(this.cancelTimer_(),this.tech_.setCurrentTime(n),this.tech_.trigger({type:"usage",name:"vhs-video-underflow"}),this.tech_.trigger({type:"usage",name:"hls-video-underflow"}),!0):(t=iw(e,n),t.length>0)?(u=t.start(0)-n,this.logger_("Stopped at "+n+", setting timer for "+u+", seeking "+("to "+t.start(0))),this.cancelTimer_(),this.timer_=setTimeout(this.skipTheGap_.bind(this),u*1e3,n),!0):!1},n.afterSeekableWindow_=function(n,t,i,r){if(r===void 0&&(r=!1),!n.length)return!1;var u=n.end(n.length-1)+wi,f=!i.endList;return(f&&r&&(u=n.end(n.length-1)+i.targetDuration*3),t>u)?!0:!1},n.beforeSeekableWindow_=function(n,t){return n.length&&n.start(0)>0&&t<n.start(0)-this.liveRangeSafeTimeDelta?!0:!1},n.videoUnderflow_=function(n){var t=n.videoBuffered,u=n.audioBuffered,i=n.currentTime,r,o;if(t){if(t.length&&u.length){var f=ko(t,i-3),s=ko(t,i),e=ko(u,i);e.length&&!s.length&&f.length&&(r={start:f.end(0),end:e.end(0)})}else o=iw(t,i),o.length||(r=this.gapFromVideoUnderflow_(t,i));return r?(this.logger_("Encountered a gap in video from "+r.start+" to "+r.end+". "+("Seeking to current time "+i)),!0):!1}},n.skipTheGap_=function(n){var r=this.tech_.buffered(),t=this.tech_.currentTime(),i=iw(r,t);(this.cancelTimer_(),i.length!==0&&t===n)&&(this.logger_("skipTheGap_:","currentTime:",t,"scheduled currentTime:",n,"nextRange start:",i.start(0)),this.tech_.setCurrentTime(i.start(0)+ou),this.tech_.trigger({type:"usage",name:"vhs-gap-skip"}),this.tech_.trigger({type:"usage",name:"hls-gap-skip"}))},n.gapFromVideoUnderflow_=function(n,t){for(var r,f,u=wwt(n),i=0;i<u.length;i++)if(r=u.start(i),f=u.end(i),t-r<4&&t-r>2)return{start:r,end:f};return null},t}(),wnt={errorInterval:30,getSource:function(n){var t=this.tech({IWillNotUseThisInPlugins:!0}),i=t.currentSource_||this.currentSource();return n(i)}},not=function not(t,i){var e=0,u=0,r=n.mergeOptions(wnt,i);t.ready(function(){t.trigger({type:"usage",name:"vhs-error-reload-initialized"});t.trigger({type:"usage",name:"hls-error-reload-initialized"})});var o=function(){u&&t.currentTime(u)},h=function(n){if(n!==null&&n!==undefined){u=t.duration()!==Infinity&&t.currentTime()||0;t.one("loadedmetadata",o);t.src(n);t.trigger({type:"usage",name:"vhs-error-reload"});t.trigger({type:"usage",name:"hls-error-reload"});t.play()}},s=function(){if(Date.now()-e<r.errorInterval*1e3){t.trigger({type:"usage",name:"vhs-error-reload-canceled"});t.trigger({type:"usage",name:"hls-error-reload-canceled"});return}if(!r.getSource||typeof r.getSource!="function"){n.log.error("ERROR: reloadSourceOnError - The option getSource must be a function!");return}return e=Date.now(),r.getSource.call(t,h)},f=function f(){t.off("loadedmetadata",o);t.off("error",s);t.off("dispose",f)},c=function(n){f();not(t,n)};t.on("error",s);t.on("dispose",f);t.reloadSourceOnError=c},tot=function(n){not(this,n)},iot="2.4.2",bnt="5.8.0",knt="0.15.0",dnt="4.5.0",gnt="3.1.0",rt={PlaylistLoader:gf,Playlist:kt,utils:ybt,STANDARD_PLAYLIST_SELECTOR:fet,INITIAL_PLAYLIST_SELECTOR:ydt,lastBandwidthSelector:fet,movingAverageBandwidthSelector:adt,comparePlaylistBandwidth:ww,comparePlaylistResolution:ldt,xhr:eft()};Object.keys(it).forEach(function(t){Object.defineProperty(rt,t,{get:function(){return n.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),it[t]},set:function(i){if(n.log.warn("using Vhs."+t+" is UNSAFE be sure you know what you are doing"),typeof i!="number"||i<0){n.log.warn("value of Vhs."+t+" must be greater than or equal to 0");return}it[t]=i}})});var rot="videojs-vhs",uot=function(n,t){for(var u=t.media(),r=-1,i=0;i<n.length;i++)if(n[i].id===u.id){r=i;break}n.selectedIndex_=r;n.trigger({selectedIndex:r,type:"change"})},nti=function(n,t){t.representations().forEach(function(t){n.addQualityLevel(t)});uot(n,t.playlists)};rt.canPlaySource=function(){return n.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var tti=function(t,i,r){var u,f;if(!t)return t;u={video:i&&i.attributes&&i.attributes.CODECS,audio:r&&r.attributes&&r.attributes.CODECS};!u.audio&&u.video&&u.video.split(",").length>1&&u.video.split(",").forEach(function(n){n=n.trim();swt(n)?u.audio=n:hwt(n)&&(u.video=n)});var o=u.video?'video/mp4;codecs="'+u.video+'"':null,s=u.audio?'audio/mp4;codecs="'+u.audio+'"':null,e={};for(f in t)e[f]={audioContentType:s,videoContentType:o},i.contentProtection&&i.contentProtection[f]&&i.contentProtection[f].pssh&&(e[f].pssh=i.contentProtection[f].pssh),typeof t[f]=="string"&&(e[f].url=t[f]);return n.mergeOptions(t,e)},iti=function(n,t){return n.reduce(function(n,i){if(!i.contentProtection)return n;var r=t.reduce(function(n,t){var r=i.contentProtection[t];return r&&r.pssh&&(n[t]={pssh:r.pssh}),n},{});return Object.keys(r).length&&n.push(r),n},[])},rti=function(n){var t=n.player,e=n.sourceKeySystems,i=n.audioMedia,r=n.mainPlaylists;if(!t.eme.initializeMediaKeys)return Promise.resolve();var o=i?r.concat([i]):r,s=iti(o,Object.keys(e)),u=[],f=[];return s.forEach(function(n){f.push(new Promise(function(n){t.tech_.one("keysessioncreated",n)}));u.push(new Promise(function(i,r){t.eme.initializeMediaKeys({keySystems:n},function(n){if(n){r(n);return}i()})}))}),Promise.race([Promise.all(u),Promise.race(f)])},uti=function(t){var r=t.player,u=t.sourceKeySystems,f=t.media,e=t.audioMedia,i=tti(u,f,e);return i?(r.currentSource().keySystems=i,i&&!r.eme)?(n.log.warn("DRM encrypted source cannot be decrypted without a DRM plugin"),!1):!0:!1},fot=function(){if(!u.localStorage)return null;var n=u.localStorage.getItem(rot);if(!n)return null;try{return JSON.parse(n)}catch(t){return null}},fti=function(t){if(!u.localStorage)return!1;var i=fot();i=i?n.mergeOptions(i,t):t;try{u.localStorage.setItem(rot,JSON.stringify(i))}catch(r){return!1}return i},eti=function(n){return n.toLowerCase().indexOf("data:application/vnd.videojs.vhs+json,")===0?JSON.parse(n.substring(n.indexOf(",")+1)):n};rt.supportsNativeHls=function(){var t,i;return!si||!si.createElement?!1:(t=si.createElement("video"),!n.getTech("Html5").isSupported())?!1:(i=["application/vnd.apple.mpegurl","audio/mpegurl","audio/x-mpegurl","application/x-mpegurl","video/x-mpegurl","video/mpegurl","application/mpegurl"],i.some(function(n){return/maybe|probably/i.test(t.canPlayType(n))}))}();rt.supportsNativeDash=function(){return!si||!si.createElement||!n.getTech("Html5").isSupported()?!1:/maybe|probably/i.test(si.createElement("video").canPlayType("application/dash+xml"))}();rt.supportsTypeNatively=function(n){return n==="hls"?rt.supportsNativeHls:n==="dash"?rt.supportsNativeDash:!1};rt.isSupported=function(){return n.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")};var oti=n.getComponent("Component"),gw=function(t){function r(i,r,u){var f,e;if(f=t.call(this,r,n.mergeOptions(u.hls,u.vhs))||this,u.hls&&Object.keys(u.hls).length&&n.log.warn("Using hls options is deprecated. Use vhs instead."),f.logger_=hu("VhsHandler"),r.options_&&r.options_.playerId&&(e=n(r.options_.playerId),e.hasOwnProperty("hls")||Object.defineProperty(e,"hls",{get:function(){return n.log.warn("player.hls is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"hls-player-access"}),ri(f)},configurable:!0}),e.hasOwnProperty("vhs")||Object.defineProperty(e,"vhs",{get:function(){return n.log.warn("player.vhs is deprecated. Use player.tech().vhs instead."),r.trigger({type:"usage",name:"vhs-player-access"}),ri(f)},configurable:!0}),e.hasOwnProperty("dash")||Object.defineProperty(e,"dash",{get:function(){return n.log.warn("player.dash is deprecated. Use player.tech().vhs instead."),ri(f)},configurable:!0}),f.player_=e),f.tech_=r,f.source_=i,f.stats={},f.ignoreNextSeekingEvent_=!1,f.setOptions_(),f.options_.overrideNative&&r.overrideNativeAudioTracks&&r.overrideNativeVideoTracks)r.overrideNativeAudioTracks(!0),r.overrideNativeVideoTracks(!0);else if(f.options_.overrideNative&&(r.featuresNativeVideoTracks||r.featuresNativeAudioTracks))throw new Error("Overriding native HLS requires emulated tracks. See https://git.io/vMpjB");f.on(si,["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],function(){var n=si.fullscreenElement||si.webkitFullscreenElement||si.mozFullScreenElement||si.msFullscreenElement;n&&n.contains(f.tech_.el())&&f.masterPlaylistController_.smoothQualityChange_()});f.on(f.tech_,"seeking",function(){if(this.ignoreNextSeekingEvent_){this.ignoreNextSeekingEvent_=!1;return}this.setCurrentTime(this.tech_.currentTime())});f.on(f.tech_,"error",function(){this.tech_.error()&&this.masterPlaylistController_&&this.masterPlaylistController_.pauseLoading()});f.on(f.tech_,"play",f.play);return f}vi(r,t);var i=r.prototype;return i.setOptions_=function(){var t=this,n;this.options_.withCredentials=this.options_.withCredentials||!1;this.options_.handleManifestRedirects=this.options_.handleManifestRedirects===!1?!1:!0;this.options_.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions===!1?!1:!0;this.options_.useDevicePixelRatio=this.options_.useDevicePixelRatio||!1;this.options_.smoothQualityChange=this.options_.smoothQualityChange||!1;this.options_.useBandwidthFromLocalStorage=typeof this.source_.useBandwidthFromLocalStorage!="undefined"?this.source_.useBandwidthFromLocalStorage:this.options_.useBandwidthFromLocalStorage||!1;this.options_.customTagParsers=this.options_.customTagParsers||[];this.options_.customTagMappers=this.options_.customTagMappers||[];this.options_.cacheEncryptionKeys=this.options_.cacheEncryptionKeys||!1;this.options_.handlePartialData=this.options_.handlePartialData||!1;typeof this.options_.blacklistDuration!="number"&&(this.options_.blacklistDuration=300);typeof this.options_.bandwidth!="number"&&this.options_.useBandwidthFromLocalStorage&&(n=fot(),n&&n.bandwidth&&(this.options_.bandwidth=n.bandwidth,this.tech_.trigger({type:"usage",name:"vhs-bandwidth-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-bandwidth-from-local-storage"})),n&&n.throughput&&(this.options_.throughput=n.throughput,this.tech_.trigger({type:"usage",name:"vhs-throughput-from-local-storage"}),this.tech_.trigger({type:"usage",name:"hls-throughput-from-local-storage"})));typeof this.options_.bandwidth!="number"&&(this.options_.bandwidth=it.INITIAL_BANDWIDTH);this.options_.enableLowInitialPlaylist=this.options_.enableLowInitialPlaylist&&this.options_.bandwidth===it.INITIAL_BANDWIDTH;["withCredentials","useDevicePixelRatio","limitRenditionByPlayerDimensions","bandwidth","smoothQualityChange","customTagParsers","customTagMappers","handleManifestRedirects","cacheEncryptionKeys","handlePartialData","playlistSelector","initialPlaylistSelector","experimentalBufferBasedABR","liveRangeSafeTimeDelta"].forEach(function(n){typeof t.source_[n]!="undefined"&&(t.options_[n]=t.source_[n])});this.limitRenditionByPlayerDimensions=this.options_.limitRenditionByPlayerDimensions;this.useDevicePixelRatio=this.options_.useDevicePixelRatio},i.src=function(t,i){var r=this,f,e;if(t){this.setOptions_();this.options_.src=eti(this.source_.src);this.options_.tech=this.tech_;this.options_.externVhs=rt;this.options_.sourceType=ctt(i);this.options_.seekTo=function(n){r.tech_.setCurrentTime(n)};this.masterPlaylistController_=new cnt(this.options_);f=n.mergeOptions({liveRangeSafeTimeDelta:wi},this.options_,{seekable:function(){return r.seekable()},media:function(){return r.masterPlaylistController_.media()},masterPlaylistController:this.masterPlaylistController_});this.playbackWatcher_=new pnt(f);this.masterPlaylistController_.on("error",function(){var i=n.players[r.tech_.options_.playerId],t=r.masterPlaylistController_.error;typeof t!="object"||t.code?typeof t=="string"&&(t={message:t,code:3}):t.code=3;i.error(t)});e=this.options_.experimentalBufferBasedABR?rt.movingAverageBandwidthSelector(.55):rt.STANDARD_PLAYLIST_SELECTOR;this.masterPlaylistController_.selectPlaylist=this.selectPlaylist?this.selectPlaylist.bind(this):e.bind(this);this.masterPlaylistController_.selectInitialPlaylist=rt.INITIAL_PLAYLIST_SELECTOR.bind(this);this.playlists=this.masterPlaylistController_.masterPlaylistLoader_;this.mediaSource=this.masterPlaylistController_.mediaSource;Object.defineProperties(this,{selectPlaylist:{get:function(){return this.masterPlaylistController_.selectPlaylist},set:function(n){this.masterPlaylistController_.selectPlaylist=n.bind(this)}},throughput:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.throughput.rate},set:function(n){this.masterPlaylistController_.mainSegmentLoader_.throughput.rate=n;this.masterPlaylistController_.mainSegmentLoader_.throughput.count=1}},bandwidth:{get:function(){return this.masterPlaylistController_.mainSegmentLoader_.bandwidth},set:function(n){this.masterPlaylistController_.mainSegmentLoader_.bandwidth=n;this.masterPlaylistController_.mainSegmentLoader_.throughput={rate:0,count:0}}},systemBandwidth:{get:function(){var t=1/(this.bandwidth||1),n;return n=this.throughput>0?1/this.throughput:0,Math.floor(1/(t+n))},set:function(){n.log.error('The "systemBandwidth" property is read-only')}}});this.options_.bandwidth&&(this.bandwidth=this.options_.bandwidth);this.options_.throughput&&(this.throughput=this.options_.throughput);Object.defineProperties(this.stats,{bandwidth:{get:function(){return r.bandwidth||0},enumerable:!0},mediaRequests:{get:function(){return r.masterPlaylistController_.mediaRequests_()||0},enumerable:!0},mediaRequestsAborted:{get:function(){return r.masterPlaylistController_.mediaRequestsAborted_()||0},enumerable:!0},mediaRequestsTimedout:{get:function(){return r.masterPlaylistController_.mediaRequestsTimedout_()||0},enumerable:!0},mediaRequestsErrored:{get:function(){return r.masterPlaylistController_.mediaRequestsErrored_()||0},enumerable:!0},mediaTransferDuration:{get:function(){return r.masterPlaylistController_.mediaTransferDuration_()||0},enumerable:!0},mediaBytesTransferred:{get:function(){return r.masterPlaylistController_.mediaBytesTransferred_()||0},enumerable:!0},mediaSecondsLoaded:{get:function(){return r.masterPlaylistController_.mediaSecondsLoaded_()||0},enumerable:!0},buffered:{get:function(){return rw(r.tech_.buffered())},enumerable:!0},currentTime:{get:function(){return r.tech_.currentTime()},enumerable:!0},currentSource:{get:function(){return r.tech_.currentSource_},enumerable:!0},currentTech:{get:function(){return r.tech_.name_},enumerable:!0},duration:{get:function(){return r.tech_.duration()},enumerable:!0},master:{get:function(){return r.playlists.master},enumerable:!0},playerDimensions:{get:function(){return r.tech_.currentDimensions()},enumerable:!0},seekable:{get:function(){return rw(r.tech_.seekable())},enumerable:!0},timestamp:{get:function(){return Date.now()},enumerable:!0},videoPlaybackQuality:{get:function(){return r.tech_.getVideoPlaybackQuality()},enumerable:!0}});this.tech_.one("canplay",this.masterPlaylistController_.setupFirstPlay.bind(this.masterPlaylistController_));this.tech_.on("bandwidthupdate",function(){r.options_.useBandwidthFromLocalStorage&&fti({bandwidth:r.bandwidth,throughput:Math.round(r.throughput)})});this.masterPlaylistController_.on("selectedinitialmedia",function(){vnt(r)});this.masterPlaylistController_.sourceUpdater_.on("createdsourcebuffers",function(){r.setupEme_()});this.on(this.masterPlaylistController_,"progress",function(){this.tech_.trigger("progress")});this.on(this.masterPlaylistController_,"firstplay",function(){this.ignoreNextSeekingEvent_=!0});(this.setupQualityLevels_(),this.tech_.el())&&(this.mediaSourceUrl_=u.URL.createObjectURL(this.masterPlaylistController_.mediaSource),this.tech_.src(this.mediaSourceUrl_))}},i.setupEme_=function(){var t=this,i=this.masterPlaylistController_.mediaTypes_.AUDIO.activePlaylistLoader,r=uti({player:this.player_,sourceKeySystems:this.source_.keySystems,media:this.playlists.media(),audioMedia:i&&i.media()});if(n.browser.IE_VERSION===11||!r){this.masterPlaylistController_.sourceUpdater_.initializedEme();return}this.logger_("waiting for EME key session creation");rti({player:this.player_,sourceKeySystems:this.source_.keySystems,audioMedia:i&&i.media(),mainPlaylists:this.playlists.master.playlists}).then(function(){t.logger_("created EME key session");t.masterPlaylistController_.sourceUpdater_.initializedEme()})["catch"](function(n){t.logger_("error while creating EME key session",n);t.player_.error({message:"Failed to initialize media keys for EME",code:3})})},i.setupQualityLevels_=function(){var t=this,i=n.players[this.tech_.options_.playerId];if(i&&i.qualityLevels&&!this.qualityLevels_){this.qualityLevels_=i.qualityLevels();this.masterPlaylistController_.on("selectedinitialmedia",function(){nti(t.qualityLevels_,t)});this.playlists.on("mediachange",function(){uot(t.qualityLevels_,t.playlists)})}},r.version=function(){return{"@videojs/http-streaming":iot,"mux.js":bnt,"mpd-parser":knt,"m3u8-parser":dnt,"aes-decrypter":gnt}},i.version=function(){return this.constructor.version()},i.canChangeType=function(){return pet.canChangeType()},i.play=function(){this.masterPlaylistController_.play()},i.setCurrentTime=function(n){this.masterPlaylistController_.setCurrentTime(n)},i.duration=function(){return this.masterPlaylistController_.duration()},i.seekable=function(){return this.masterPlaylistController_.seekable()},i.dispose=function(){this.playbackWatcher_&&this.playbackWatcher_.dispose();this.masterPlaylistController_&&this.masterPlaylistController_.dispose();this.qualityLevels_&&this.qualityLevels_.dispose();this.player_&&(delete this.player_.vhs,delete this.player_.dash,delete this.player_.hls);this.tech_&&this.tech_.vhs&&delete this.tech_.vhs;this.tech_&&delete this.tech_.hls;this.mediaSourceUrl_&&u.URL.revokeObjectURL&&(u.URL.revokeObjectURL(this.mediaSourceUrl_),this.mediaSourceUrl_=null);t.prototype.dispose.call(this)},i.convertToProgramTime=function(n,t){return nkt({playlist:this.masterPlaylistController_.media(),time:n,callback:t})},i.seekToProgramTime=function(n,t,i,r){return i===void 0&&(i=!0),r===void 0&&(r=2),lft({programTime:n,playlist:this.masterPlaylistController_.media(),retryCount:r,pauseAfterSeek:i,seekTo:this.options_.seekTo,tech:this.options_.tech,callback:t})},r}(oti),ll={name:"videojs-http-streaming",VERSION:iot,canHandleSource:function(t,i){i===void 0&&(i={});var r=n.mergeOptions(n.options,i);return ll.canPlayType(t.type,r)},handleSource:function(t,i,r){r===void 0&&(r={});var u=n.mergeOptions(n.options,r);return i.vhs=new gw(t,i,u),n.hasOwnProperty("hls")||Object.defineProperty(i,"hls",{get:function(){return n.log.warn("player.tech().hls is deprecated. Use player.tech().vhs instead."),i.vhs},configurable:!0}),i.vhs.xhr=eft(),i.vhs.src(t.src,t.type),i.vhs},canPlayType:function(t,i){i===void 0&&(i={});var f=n.mergeOptions(n.options,i),r=f.vhs.overrideNative,e=r===void 0?!n.browser.IS_ANY_SAFARI:r,u=ctt(t),o=u&&(!rt.supportsTypeNatively(u)||e);return o?"maybe":""}},sti=function(){return gc("avc1.4d400d,mp4a.40.2")};return sti()&&n.getTech("Html5").registerSourceHandler(ll,0),n.VhsHandler=gw,Object.defineProperty(n,"HlsHandler",{get:function(){return n.log.warn("videojs.HlsHandler is deprecated. Use videojs.VhsHandler instead."),gw},configurable:!0}),n.VhsSourceHandler=ll,Object.defineProperty(n,"HlsSourceHandler",{get:function(){return n.log.warn("videojs.HlsSourceHandler is deprecated. Use videojs.VhsSourceHandler instead."),ll},configurable:!0}),n.Vhs=rt,Object.defineProperty(n,"Hls",{get:function(){return n.log.warn("videojs.Hls is deprecated. Use videojs.Vhs instead."),rt},configurable:!0}),n.use||(n.registerComponent("Hls",rt),n.registerComponent("Vhs",rt)),n.options.vhs=n.options.vhs||{},n.options.hls=n.options.hls||{},n.registerPlugin?n.registerPlugin("reloadSourceOnError",tot):n.plugin("reloadSourceOnError",tot),n});!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=0)}([function(n,t,i){"use strict";var i=i(1),i=(window.videojs&&(i.registerConfigPlugin(window.videojs),i.registerSourceHandler(window.videojs)),{register:i.registerSourceHandler}),r="hlsSourceHandler";window[r]||(window[r]=i)},function(n,t,i){"use strict";function f(n){var t=this;n&&(t.srOptions_||(t.srOptions_={}),t.srOptions_.hlsjsConfig||(t.srOptions_.hlsjsConfig=n.hlsjsConfig),t.srOptions_.captionConfig||(t.srOptions_.captionConfig=n.captionConfig))}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(n){return typeof n}:function(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},r=i(2);n.exports={registerSourceHandler:function(n){function f(i,f){function tt(n){1===a[r.ErrorTypes.MEDIA_ERROR]?e.recoverMediaError():2===a[r.ErrorTypes.MEDIA_ERROR]?(e.swapAudioCodec(),e.recoverMediaError()):2<a[r.ErrorTypes.MEDIA_ERROR]&&(f.error=function(){return n},f.trigger("error"))}function ft(n){e.nextLevel=n}function et(n,t){var u,r,i;if(h){if("boolean"==typeof t){for(h[n]._enabled=t,u=!0,r=0;r<h.length;r++)if(!h[r]._enabled){u=!1;break}if(u)e.currentLevel=-1;else{for(i=h.length-1;0<=i&&!h[i]._enabled;i--);e.currentLevel=i}}return h[n]._enabled}return!1}function ot(n,t){h&&(h.selectedIndex_=t.level,h.trigger({selectedIndex:t.level,type:"change"}))}function w(){var n,t;l&&(n=[],1<l.levels.length&&(t={id:-1,label:"auto",selected:-1===e.manualLevel},n.push(t)),l.levels.forEach(function(t,i){var r={};r.id=i;r.selected=i===e.manualLevel;r.label=(i=t).height?i.height+"p":i.width?Math.round(9*i.width/16)+"p":i.bitrate?i.bitrate/1e3+"kbps":0;n.push(r)}),f.trigger("loadedqualitydata",{qualityData:{video:n},qualitySwitchCallback:ft}),o.removeEventListener("playing",w))}function it(){for(var t=f.audioTracks(),n=0;n<t.length;n++)if(t[n].enabled){e.audioTrack=n;break}}function st(){var i=e.audioTracks,r=f.audioTracks(),t;if(1<i.length&&0===r.length){for(t=0;t<i.length;t++)r.addTrack(new n.AudioTrack({id:t,kind:"alternative",label:i[t].name||i[t].lang,language:i[t].lang,enabled:t===e.audioTrack}));r.addEventListener("change",it)}}function b(n){return n.label||n.language}function rt(n,t){return b(n)===b(t)&&n.kind===t.kind}function k(){for(var t,n,r=s.textTracks(),u=null,i=0;i<r.length;i++)if("showing"===r[i].mode){u=r[i];break}for(t=o.textTracks,n=0;n<t.length;n++)"subtitles"!==t[n].kind&&"captions"!==t[n].kind||(t[n].mode=u&&rt(t[n],u)?"showing":"disabled")}function d(){e.startLoad(-1);o.removeEventListener("play",d)}function ut(){for(var n,f,i,r=function(n){for(var i=[],t=0;t<n.length;t++)"subtitles"!==n[t].kind&&"captions"!==n[t].kind||i.push(n[t]);return i}(o.textTracks),u=s.textTracks(),t=0;t<r.length;t++){for(f=!1,i=0;i<u.length;i++)if(rt(r[t],u[i])){f=!0;break}f||(n=r[t],s.addRemoteTextTrack({kind:n.kind,label:b(n),language:n.language,srclang:n.language},!1))}k();p||(u.addEventListener("change",k),p=!0)}function ht(n,t){l=t,function(){var n;if(l&&(h=s.qualityLevels&&s.qualityLevels()))for(f.hls={},n=0;n<l.levels.length;n++){var t=l.levels[n],i="hlsjs-"+n,i={id:i,label:i,width:t.width,height:t.height,bandwidth:t.bitrate,bitrate:t.bitrate,_enabled:!1};i.enabled=et.bind(this,n);h.addQualityLevel(i)}}()}function ct(){var n,h=s.srOptions_&&s.srOptions_.hlsjsConfig||f.options_.hlsjsConfig,h=(c=h?function(n){for(var r={},i=Object.keys(n),t=0;t<i.length;t++)r[i[t]]=n[i[t]];return r}(h):{},-1!==["","auto"].indexOf(o.preload)||o.autoplay||void 0!==c.autoStartLoad||(c.autoStartLoad=!1),s.srOptions_&&s.srOptions_.captionConfig||f.options_.captionConfig),p=(h&&(c.cueHandler=(n=h,{newCue:function(t,i,r,f){for(var c,l,a,s,h,e,v=window.VTTCue||window.TextTrackCue,o=0;o<f.rows.length;o++)if(a="",!(c=f.rows[o]).isEmpty()){for(s=0;s<c.chars.length;s++)a+=c.chars[s].uchar;if(l=new v(i,r,a.trim()),null!=n&&"object"===(void 0===n?"undefined":u(n)))for(h=Object.keys(n),e=0;e<h.length;e++)l[h[e]]=n[h[e]];t.addCue(l);r===i&&t.addCue(new v(r+5,""))}}})),!1===c.autoStartLoad&&o.addEventListener("play",d),o.addEventListener("playing",w),e=new r(c),"beforeinitialize"),l;if(void 0!==t[p])for(l=0;l<t[p].length;l++)t[p][l](s,e);e.on(r.Events.ERROR,function(n,t){var i={message:"HLS.js error: "+t.type+" - fatal: "+t.fatal+" - "+t.details};if(a[t.type]?a[t.type]+=1:a[t.type]=1,t.fatal)switch(t.type){case r.ErrorTypes.NETWORK_ERROR:i.code=2;f.error=function(){return i};f.trigger("error");break;case r.ErrorTypes.MEDIA_ERROR:i.code=3;tt(i);break;default:e.destroy();f.error=function(){return i};f.trigger("error")}});e.on(r.Events.AUDIO_TRACKS_UPDATED,st);e.on(r.Events.MANIFEST_PARSED,ht);e.on(r.Events.LEVEL_LOADED,function(n,t){c.liveSyncDuration?y=c.liveSyncDuration:c.liveSyncDurationCount&&(y=c.liveSyncDurationCount*t.details.targetduration);v=t.details.live;nt=t.details.totalduration;g=v?1/0:t.details.totalduration});e.once(r.Events.FRAG_LOADED,function(){f.trigger("loadedmetadata")});e.on(r.Events.LEVEL_SWITCHED,ot);e.attachMedia(o);o.textTracks.addEventListener("addtrack",ut);e.loadSource(i.src)}f.name_="StreamrootHlsjs";var e,o=f.el(),a={},g=null,l=null,v=null,nt=null,y=null,c=null,s=n(f.options_.playerId),h=s.qualityLevels&&s.qualityLevels(),p=(h&&s.hlsQualitySelector&&(f.hls={}),!1);this.duration=function(){return g||o.duration||0};this.seekable=function(){if(e.media){if(!v)return n.createTimeRanges(0,e.media.duration);var t=Math.round(e.media.duration-nt),i=Math.round(e.media.duration-y);return n.createTimeRanges(t,i)}return n.createTimeRanges()};this.dispose=function(){o.removeEventListener("play",d);o.textTracks.removeEventListener("addtrack",ut);o.removeEventListener("playing",w);s.textTracks().removeEventListener("change",k);p=!1;s.audioTracks().removeEventListener("change",it);e.destroy()};o.addEventListener("error",function(n){var t=n.currentTarget.error;switch(t.code){case t.MEDIA_ERR_ABORTED:0;break;case t.MEDIA_ERR_DECODE:tt(t);break;case t.MEDIA_ERR_NETWORK:0;break;case t.MEDIA_ERR_SRC_NOT_SUPPORTED:0;break;default:t.message}});ct()}var i,t={};if(f.addHook=function(n,i){t[n]=t[n]||[];t[n].push(i)},f.removeHook=function(n,i){return void 0===t[n]?!1:(i=t[n].indexOf(i),-1!==i&&(t[n].splice(i,1),!0))},r.isSupported()){if("function"==typeof n.getTech)i=n.getTech("Html5");else{if("function"!=typeof n.getComponent)return;i=n.getComponent("Html5")}i&&(i.registerSourceHandler({canHandleSource:function(n){return/^application\/x-mpegURL|application\/vnd\.apple\.mpegurl$/i.test(n.type)?"probably":/\.m3u8/i.test(n.src)?"maybe":""},handleSource:function(n,t){return t.hlsProvider&&t.hlsProvider.dispose(),t.hlsProvider=new f(n,t),t.hlsProvider}},0),n.Html5Hlsjs=f)}},registerConfigPlugin:function(n){(n.registerPlugin||n.plugin)("streamrootHls",f)}}},function(n){var t;"undefined"!=typeof window&&(t=function(){function n(r){if(t[r])return t[r].exports;var u=t[r]={i:r,l:!1,exports:{}};return i[r].call(u.exports,u,u.exports,n),u.l=!0,u.exports}return t={},n.m=i={"./node_modules/eventemitter3/index.js":function(n){"use strict";function r(){}function o(n,t,i){this.fn=n;this.context=t;this.once=i||!1}function f(n,i,r,u,f){if("function"!=typeof r)throw new TypeError("The listener must be a function");return r=new o(r,u||n,f),u=t?t+i:i,n._events[u]?n._events[u].fn?n._events[u]=[n._events[u],r]:n._events[u].push(r):(n._events[u]=r,n._eventsCount++),n}function u(n,t){0==--n._eventsCount?n._events=new r:delete n._events[t]}function i(){this._events=new r;this._eventsCount=0}var e=Object.prototype.hasOwnProperty,t="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(t=!1));i.prototype.eventNames=function(){var r,n,i=[];if(0===this._eventsCount)return i;for(n in r=this._events)e.call(r,n)&&i.push(t?n.slice(1):n);return Object.getOwnPropertySymbols?i.concat(Object.getOwnPropertySymbols(r)):i};i.prototype.listeners=function(n){var n=t?t+n:n,i=this._events[n];if(!i)return[];if(i.fn)return[i.fn];for(var r=0,u=i.length,f=new Array(u);r<u;r++)f[r]=i[r].fn;return f};i.prototype.listenerCount=function(n){return n=t?t+n:n,n=this._events[n],n?n.fn?1:n.length:0};i.prototype.emit=function(n,i,r,u,f,e){var a=t?t+n:n,h,o,c,l,v,s;if(!this._events[a])return!1;if(o=this._events[a],c=arguments.length,o.fn){switch(o.once&&this.removeListener(n,o.fn,void 0,!0),c){case 1:return o.fn.call(o.context),!0;case 2:return o.fn.call(o.context,i),!0;case 3:return o.fn.call(o.context,i,r),!0;case 4:return o.fn.call(o.context,i,r,u),!0;case 5:return o.fn.call(o.context,i,r,u,f),!0;case 6:return o.fn.call(o.context,i,r,u,f,e),!0}for(s=1,h=new Array(c-1);s<c;s++)h[s-1]=arguments[s];o.fn.apply(o.context,h)}else for(v=o.length,s=0;s<v;s++)switch(o[s].once&&this.removeListener(n,o[s].fn,void 0,!0),c){case 1:o[s].fn.call(o[s].context);break;case 2:o[s].fn.call(o[s].context,i);break;case 3:o[s].fn.call(o[s].context,i,r);break;case 4:o[s].fn.call(o[s].context,i,r,u);break;default:if(!h)for(l=1,h=new Array(c-1);l<c;l++)h[l-1]=arguments[l];o[s].fn.apply(o[s].context,h)}return!0};i.prototype.on=function(n,t,i){return f(this,n,t,i,!1)};i.prototype.once=function(n,t,i){return f(this,n,t,i,!0)};i.prototype.removeListener=function(n,i,r,f){var e;if(n=t?t+n:n,!this._events[n])return this;if(!i)return u(this,n),this;if(e=this._events[n],e.fn)e.fn!==i||f&&!e.once||r&&e.context!==r||u(this,n);else{for(var o=0,s=[],h=e.length;o<h;o++)(e[o].fn!==i||f&&!e[o].once||r&&e[o].context!==r)&&s.push(e[o]);s.length?this._events[n]=1===s.length?s[0]:s:u(this,n)}return this};i.prototype.removeAllListeners=function(n){return n?(n=t?t+n:n,this._events[n]&&u(this,n)):(this._events=new r,this._eventsCount=0),this};i.prototype.off=i.prototype.removeListener;i.prototype.addListener=i.prototype.on;i.prefixed=t;n.exports=i.EventEmitter=i},"./node_modules/url-toolkit/src/url-toolkit.js":function(n){var i,r,u,f,t;i=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/\?#]*\/)*.*?)??(;.*?)?(\?.*?)?(#.*?)?$/;r=/^([^\/?#]*)(.*)$/;u=/(?:\/|^)\.(?=\/)/g;f=/(?:\/|^)\.\.\/(?!\.\.\/).*?(?=\/)/g;t={buildAbsoluteURL:function(n,i,u){var f,e,n;if(u=u||{},n=n.trim(),!(i=i.trim())){if(!u.alwaysNormalize)return n;if(f=t.parseURL(n),!f)throw new Error("Error trying to parse base URL.");return f.path=t.normalizePath(f.path),t.buildURLFromParts(f)}if(f=t.parseURL(i),!f)throw new Error("Error trying to parse relative URL.");if(f.scheme)return u.alwaysNormalize?(f.path=t.normalizePath(f.path),t.buildURLFromParts(f)):i;if(i=t.parseURL(n),!i)throw new Error("Error trying to parse base URL.");return!i.netLoc&&i.path&&"/"!==i.path[0]&&(n=r.exec(i.path),i.netLoc=n[1],i.path=n[2]),i.netLoc&&!i.path&&(i.path="/"),n={scheme:i.scheme,netLoc:f.netLoc,path:null,params:f.params,query:f.query,fragment:f.fragment},f.netLoc||(n.netLoc=i.netLoc,"/"!==f.path[0]&&(f.path?(e=(e=i.path).substring(0,e.lastIndexOf("/")+1)+f.path,n.path=t.normalizePath(e)):(n.path=i.path,f.params||(n.params=i.params,f.query||(n.query=i.query))))),null===n.path&&(n.path=u.alwaysNormalize?t.normalizePath(f.path):f.path),t.buildURLFromParts(n)},parseURL:function(n){return n=i.exec(n),n?{scheme:n[1]||"",netLoc:n[2]||"",path:n[3]||"",params:n[4]||"",query:n[5]||"",fragment:n[6]||""}:null},normalizePath:function(n){for(n=n.split("").reverse().join("").replace(u,"");n.length!==(n=n.replace(f,"")).length;);return n.split("").reverse().join("")},buildURLFromParts:function(n){return n.scheme+n.netLoc+n.path+n.params+n.query+n.fragment}};n.exports=t},"./node_modules/webworkify-webpack/index.js":function(n,t,i){function r(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={},r;return t.m=n,t.c=i,t.i=function(n){return n},t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{configurable:!1,enumerable:!0,get:r})},t.r=function(n){Object.defineProperty(n,"__esModule",{value:!0})},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/",t.oe=function(n){throw n;},r=t(t.s=ENTRY_MODULE),r.default||r}function e(n){return(n+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function o(n,t,r){var o={},v=(o[r]=[],t.toString()),t=v.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/),s,a,y,c,h,l;if(!t)return o;for(t=t[1],a=new RegExp("(\\\\n|\\W)"+e(t)+f,"g");s=a.exec(v);)"dll-reference"!==s[3]&&o[r].push(s[3]);for(a=new RegExp("\\("+e(t)+'\\("(dll-reference\\s('+u+'))"\\)\\)'+f,"g");s=a.exec(v);)n[s[2]]||(o[r].push(s[1]),n[s[2]]=i(s[1]).m),o[s[2]]=o[s[2]]||[],o[s[2]].push(s[4]);for(c=Object.keys(o),h=0;h<c.length;h++)for(l=0;l<o[c[h]].length;l++)y=o[c[h]][l],isNaN(+y)||(o[c[h]][l]=+o[c[h]][l]);return o}function s(n,t){for(var l,c,i,f,r={main:[t]},s={main:[]},h={main:{}};function(n){return Object.keys(n).reduce(function(t,i){return t||0<n[i].length},!1)}(r);)for(l=Object.keys(r),c=0;c<l.length;c++)if(i=l[c],f=r[i].pop(),h[i]=h[i]||{},!h[i][f]&&n[i][f]){h[i][f]=!0;s[i]=s[i]||[];s[i].push(f);for(var a=o(n,n[i][f],i),e=Object.keys(a),u=0;u<e.length;u++)r[e[u]]=r[e[u]]||[],r[e[u]]=r[e[u]].concat(a[e[u]])}return s}var u="[\\.|\\-|\\+|\\w|/|@]+",f="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+u+").*?\\)";n.exports=function(n,t){var u={main:i.m},f=(t=t||{}).all?{main:Object.keys(u.main)}:s(u,n),e="",n=(Object.keys(f).filter(function(n){return"main"!==n}).forEach(function(n){for(var t=0;f[n][t];)t++;f[n].push(t);u[n][t]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })";e=e+"var "+n+" = ("+r.toString().replace("ENTRY_MODULE",JSON.stringify(t))+")({"+f[n].map(function(t){return JSON.stringify(t)+": "+u[n][t].toString()}).join(",")+"});\n"}),e=e+"new (("+r.toString().replace("ENTRY_MODULE",JSON.stringify(n))+")({"+f.main.map(function(n){return JSON.stringify(n)+": "+u.main[n].toString()}).join(",")+"}))(self);",new window.Blob([e],{type:"text/javascript"}));return t.bare?n:(t=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(n),n=new window.Worker(t),n.objectURL=t,n)}},"./src/crypt/decrypter.js":function(n,t,i){"use strict";i.r(t);var f=function(){function n(n,t){this.subtle=n;this.aesIV=t}return n.prototype.decrypt=function(n,t){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},t,n)},n}(),e=function(){function n(n,t){this.subtle=n;this.key=t}return n.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},n}(),o=function(){function t(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54];this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)];this.sBox=new Uint32Array(256);this.invSBox=new Uint32Array(256);this.key=new Uint32Array(0);this.initTable()}var n=t.prototype;return n.uint8ArrayToUint32Array_=function(n){for(var r=new DataView(n),i=new Uint32Array(4),t=0;t<4;t++)i[t]=r.getUint32(4*t);return i},n.initTable=function(){for(var c=this.sBox,l=this.invSBox,f=this.subMix,a=f[0],v=f[1],y=f[2],p=f[3],f=this.invSubMix,w=f[0],b=f[1],k=f[2],d=f[3],t=new Uint32Array(256),i=0,e=0,u=0,u=0;u<256;u++)t[u]=u<128?u<<1:u<<1^283;for(u=0;u<256;u++){var r=e^e<<1^e<<2^e<<3^e<<4,o=(c[i]=r=r>>>8^255&r^99,t[l[r]=i]),s=t[o],h=t[s],n=257*t[r]^16843008*r;a[i]=n<<24|n>>>8;v[i]=n<<16|n>>>16;y[i]=n<<8|n>>>24;p[i]=n;w[r]=(n=16843009*h^65537*s^257*o^16843008*i)<<24|n>>>8;b[r]=n<<16|n>>>16;k[r]=n<<8|n>>>24;d[r]=n;i?(i=o^t[t[t[h^o]]],e^=t[t[e]]):i=e=1}},n.expandKey=function(n){for(var r,e=this.uint8ArrayToUint32Array_(n),c=!0,h=0;h<e.length&&c;)c=e[h]===this.key[h],h++;if(!c){if(this.key=e,r=this.keySize=e.length,4!==r&&6!==r&&8!==r)throw new Error("Invalid aes key size="+r);for(var f,l,t,o=this.ksRows=4*(r+6+1),s=this.keySchedule=new Uint32Array(o),a=this.invKeySchedule=new Uint32Array(o),u=this.sBox,v=this.rcon,n=this.invSubMix,y=n[0],p=n[1],w=n[2],b=n[3],i=0;i<o;i++)i<r?l=s[i]=e[i]:(t=l,i%r==0?(t=u[(t=t<<8|t>>>24)>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t],t^=v[i/r|0]<<24):6<r&&i%r==4&&(t=u[t>>>24]<<24|u[t>>>16&255]<<16|u[t>>>8&255]<<8|u[255&t]),s[i]=l=(s[i-r]^t)>>>0);for(f=0;f<o;f++)i=o-f,t=3&f?s[i]:s[i-4],a[f]=f<4||i<=4?t:y[u[t>>>24]]^p[u[t>>>16&255]]^w[u[t>>>8&255]]^b[u[255&t]],a[f]=a[f]>>>0}},n.networkToHostOrderSwap=function(n){return n<<24|(65280&n)<<8|(16711680&n)>>8|n>>>24},n.decrypt=function(n,t,i,r){for(var p,w,b,k,s,h,c,l,it,rt,ut,ft,o,et,lt=this.keySize+6,f=this.invKeySchedule,u=this.invSBox,e=this.invSubMix,d=e[0],g=e[1],nt=e[2],tt=e[3],e=this.uint8ArrayToUint32Array_(i),ot=e[0],st=e[1],ht=e[2],ct=e[3],v=new Int32Array(n),y=new Int32Array(v.length),a=this.networkToHostOrderSwap;t<v.length;){for(it=a(v[t]),rt=a(v[t+1]),ut=a(v[t+2]),ft=a(v[t+3]),s=it^f[0],h=ft^f[1],c=ut^f[2],l=rt^f[3],o=4,et=1;et<lt;et++)p=d[s>>>24]^g[h>>16&255]^nt[c>>8&255]^tt[255&l]^f[o],w=d[h>>>24]^g[c>>16&255]^nt[l>>8&255]^tt[255&s]^f[o+1],b=d[c>>>24]^g[l>>16&255]^nt[s>>8&255]^tt[255&h]^f[o+2],k=d[l>>>24]^g[s>>16&255]^nt[h>>8&255]^tt[255&c]^f[o+3],s=p,h=w,c=b,l=k,o+=4;p=u[s>>>24]<<24^u[h>>16&255]<<16^u[c>>8&255]<<8^u[255&l]^f[o];w=u[h>>>24]<<24^u[c>>16&255]<<16^u[l>>8&255]<<8^u[255&s]^f[o+1];b=u[c>>>24]<<24^u[l>>16&255]<<16^u[s>>8&255]<<8^u[255&h]^f[o+2];k=u[l>>>24]<<24^u[s>>16&255]<<16^u[h>>8&255]<<8^u[255&c]^f[o+3];o+=3;y[t]=a(p^ot);y[t+1]=a(k^st);y[t+2]=a(b^ht);y[t+3]=a(w^ct);ot=it;st=rt;ht=ut;ct=ft;t+=4}return r?(i=y.buffer,e=i.byteLength,(n=e&&new DataView(i).getUint8(e-1))?i.slice(0,e-n):i):y.buffer},n.destroy=function(){this.key=void 0;this.keySize=void 0;this.ksRows=void 0;this.sBox=void 0;this.invSBox=void 0;this.subMix=void 0;this.invSubMix=void 0;this.keySchedule=void 0;this.invKeySchedule=void 0;this.rcon=void 0},t}(),u=i("./src/errors.ts"),r=i("./src/utils/logger.js"),s=i("./src/events.js"),i=i("./src/utils/get-self-scope.js"),h=Object(i.getSelfScope)();t.default=function(){function t(n,t,i){if(i=(void 0===i?{}:i).removePKCS7Padding,i=void 0===i||i,this.logEnabled=!0,this.observer=n,this.config=t,this.removePKCS7Padding=i)try{var r=h.crypto;r&&(this.subtle=r.subtle||r.webkitSubtle)}catch(n){}this.disableWebCrypto=!this.subtle}var n=t.prototype;return n.isSync=function(){return this.disableWebCrypto&&this.config.enableSoftwareAES},n.decrypt=function(n,t,i,u){var s,h,c=this;this.disableWebCrypto&&this.config.enableSoftwareAES?(this.logEnabled&&(r.logger.log("JS AES decrypt"),this.logEnabled=!1),(s=this.decryptor)||(this.decryptor=s=new o),s.expandKey(t),u(s.decrypt(n,0,i,this.removePKCS7Padding))):(this.logEnabled&&(r.logger.log("WebCrypto AES decrypt"),this.logEnabled=!1),h=this.subtle,this.key!==t&&(this.key=t,this.fastAesKey=new e(h,t)),this.fastAesKey.expandKey().then(function(r){new f(h,i).decrypt(n,r).catch(function(r){c.onWebCryptoError(r,n,t,i,u)}).then(function(n){u(n)})}).catch(function(r){c.onWebCryptoError(r,n,t,i,u)}))},n.onWebCryptoError=function(n,t,i,f,e){this.config.enableSoftwareAES?(r.logger.log("WebCrypto Error, disable WebCrypto API"),this.disableWebCrypto=!0,this.logEnabled=!0,this.decrypt(t,i,f,e)):(r.logger.error("decrypting error : "+n.message),this.observer.trigger(s.default.ERROR,{type:u.ErrorTypes.MEDIA_ERROR,details:u.ErrorDetails.FRAG_DECRYPT_ERROR,fatal:!0,reason:n.message}))},n.destroy=function(){var n=this.decryptor;n&&(n.destroy(),this.decryptor=void 0)},t}()},"./src/demux/demuxer-inline.js":function(n,t,i){"use strict";function k(n,t){return 255===n[t]&&240==(246&n[t+1])}function d(n,t){return 1&n[t+1]?7:9}function g(n,t){return(3&n[t+3])<<11|n[t+4]<<3|(224&n[t+5])>>>5}function a(n,t){return!!(t+1<n.length&&k(n,t))}function nt(n,t,i,f,o){n.samplerate||(t=function(n,t,i,f){var c,s,l=navigator.userAgent.toLowerCase(),v=f,a=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],h=1+((192&t[i+2])>>>6),o=(60&t[i+2])>>>2;if(!(a.length-1<o))return c=(1&t[i+2])<<2,c|=(192&t[i+3])>>>6,r.logger.log("manifest codec:"+f+",ADTS data:type:"+h+",sampleingIndex:"+o+"["+a[o]+"Hz],channelConfig:"+c),t=/firefox/i.test(l)?6<=o?(h=5,s=new Array(4),o-3):(h=2,s=new Array(2),o):-1!==l.indexOf("android")?(h=2,s=new Array(2),o):(h=5,s=new Array(4),f&&(-1!==f.indexOf("mp4a.40.29")||-1!==f.indexOf("mp4a.40.5"))||!f&&6<=o?o-3:((f&&-1!==f.indexOf("mp4a.40.2")&&(6<=o&&1==c||/vivaldi/i.test(l))||!f&&1==c)&&(h=2,s=new Array(2)),o)),s[0]=h<<3,s[0]|=(14&o)>>1,s[1]|=(1&o)<<7,s[1]|=c<<3,5===h&&(s[1]|=(14&t)>>1,s[2]=(1&t)<<7,s[2]|=8,s[3]=0),{config:s,samplerate:a[o],channelCount:c,codec:"mp4a.40."+h,manifestCodec:v};n.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+o})}(t,i,f,o),n.config=t.config,n.samplerate=t.samplerate,n.channelCount=t.channelCount,n.codec=t.codec,n.manifestCodec=t.manifestCodec,r.logger.log("parsed codec:"+n.codec+",rate:"+t.samplerate+",nb channel:"+t.channelCount))}function tt(n){return 9216e4/n}function it(n,t,i,r,u){var f,r=function(n,t,i,r,u){var e=n.length,f=d(n,t),n=g(n,t);if(0<(n-=f)&&t+f+n<=e)return{headerLength:f,frameLength:n,stamp:i+r*u}}(t,i,r,u,tt(n.samplerate));if(r)return u=r.stamp,f=r.headerLength,r=r.frameLength,t={unit:t.subarray(i+f,i+f+r),pts:u,dts:u},n.samples.push(t),{sample:t,length:r+f}}function rt(n,t,i,r){return n=n*t*(i=void 0===i?1:i),(r=void 0===r?!1:r)?Math.round(n):n}function f(n,t){return rt(n,1e3,1/9e4,t=void 0===t?!1:t)}function ut(n,t){return rt(n,9e4,1/(t=void 0===t?1:t))}i.r(t);var u=i("./src/events.js"),e=i("./src/errors.ts"),b=i("./src/crypt/decrypter.js"),et=i("./src/polyfills/number-isFinite.js"),r=i("./src/utils/logger.js"),ot=i("./src/utils/get-self-scope.js");var o=i("./src/demux/id3.js"),st=function(){function t(n,t,i){this.observer=n;this.config=i;this.remuxer=t}var n=t.prototype;return n.resetInitSegment=function(n,t,i,r){this._audioTrack={container:"audio/adts",type:"audio",id:0,sequenceNumber:0,isAAC:!0,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},n.resetTimeStamp=function(){},t.probe=function(n){if(!n)return!1;for(var t=(o.default.getID3Data(n,0)||[]).length,i=n.length;t<i;t++)if(function(n,t){if(a(n,t)){var i=d(n,t),t=t+(i=t+5<n.length?g(n,t):i);if(t===n.length||t+1<n.length&&k(n,t))return 1}}(n,t))return r.logger.log("ADTS sync word found !"),!0;return!1},n.append=function(n,t,i,u){for(var c,h=this._audioTrack,e=o.default.getID3Data(n,0)||[],l=o.default.getTimeStamp(e),v=Object(et.isFiniteNumber)(l)?90*l:9e4*t,y=0,s=v,p=n.length,f=e.length,w=[{pts:s,dts:s,data:e}];f<p-1;)if(a(n,f)&&f+5<p){if(nt(h,this.observer,n,f,h.manifestCodec),c=it(h,n,f,v,y),!c){r.logger.log("Unable to parse AAC frame");break}f+=c.length;s=c.sample.pts;y++}else o.default.isHeader(n,f)?(e=o.default.getID3Data(n,f),w.push({pts:s,dts:s,data:e}),f+=e.length):f++;this.remuxer.remux(h,{samples:[]},{samples:w,inputTimeScale:9e4},{samples:[]},t,i,u)},n.destroy=function(){},t}(),ht=i("./src/demux/mp4demuxer.js"),c={BitratesMap:[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],SamplingRateMap:[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],SamplesCoefficients:[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],BytesInSlot:[0,1,1,4],appendFrame:function(n,t,i,r,u){var f;if(!(i+24>t.length))return f=this.parseHeader(t,i),f&&i+f.frameLength<=t.length?(r=r+u*(9e4*f.samplesPerFrame/f.sampleRate),u={unit:t.subarray(i,i+f.frameLength),pts:r,dts:r},n.config=[],n.channelCount=f.channelCount,n.samplerate=f.sampleRate,n.samples.push(u),{sample:u,length:f.frameLength}):void 0},parseHeader:function(n,t){var i=n[t+1]>>3&3,r=n[t+1]>>1&3,u=n[t+2]>>4&15,f=n[t+2]>>2&3,e=n[t+2]>>1&1;if(1!=i&&0!=u&&15!=u&&3!=f)return u=1e3*c.BitratesMap[14*(3==i?3-r:3==r?3:4)+u-1],f=c.SamplingRateMap[3*(3==i?0:2==i?1:2)+f],n=n[t+3]>>6==3?1:2,r=8*(t=c.SamplesCoefficients[i][r])*(i=c.BytesInSlot[r]),{sampleRate:f,channelCount:n,frameLength:parseInt(t*u/f+e,10)*i,samplesPerFrame:r}},isHeaderPattern:function(n,t){return 255===n[t]&&224==(224&n[t+1])&&0!=(6&n[t+1])},isHeader:function(n,t){return!!(t+1<n.length&&this.isHeaderPattern(n,t))},probe:function(n,t){if(t+1<n.length&&this.isHeaderPattern(n,t)){var i=this.parseHeader(n,t),r=4,t=t+(r=i&&i.frameLength?i.frameLength:r);if(t===n.length||t+1<n.length&&this.isHeaderPattern(n,t))return!0}return!1}},l=c,p=function(){function t(n){this.data=n;this.bytesAvailable=n.byteLength;this.word=0;this.bitsAvailable=0}var n=t.prototype;return n.loadWord=function(){var t=this.data,n=this.bytesAvailable,i=t.byteLength-n,r=new Uint8Array(4),n=Math.min(4,n);if(0===n)throw new Error("no bytes available");r.set(t.subarray(i,i+n));this.word=new DataView(r.buffer).getUint32(0);this.bitsAvailable=8*n;this.bytesAvailable-=n},n.skipBits=function(n){var t;this.bitsAvailable>n||(n=(n-=this.bitsAvailable)-((t=n>>3)>>3),this.bytesAvailable-=t,this.loadWord());this.word<<=n;this.bitsAvailable-=n},n.readBits=function(n){var t=Math.min(this.bitsAvailable,n),i=this.word>>>32-t;return 32<n&&r.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=t,0<this.bitsAvailable?this.word<<=t:0<this.bytesAvailable&&this.loadWord(),0<(t=n-t)&&this.bitsAvailable?i<<t|this.readBits(t):i},n.skipLZ=function(){for(var n=0;n<this.bitsAvailable;++n)if(0!=(this.word&2147483648>>>n))return this.word<<=n,this.bitsAvailable-=n,n;return this.loadWord(),n+this.skipLZ()},n.skipUEG=function(){this.skipBits(1+this.skipLZ())},n.skipEG=function(){this.skipBits(1+this.skipLZ())},n.readUEG=function(){var n=this.skipLZ();return this.readBits(n+1)-1},n.readEG=function(){var n=this.readUEG();return 1&n?1+n>>>1:-1*(n>>>1)},n.readBoolean=function(){return 1===this.readBits(1)},n.readUByte=function(){return this.readBits(8)},n.readUShort=function(){return this.readBits(16)},n.readUInt=function(){return this.readBits(32)},n.skipScalingList=function(n){for(var i=8,t=8,r=0;r<n;r++)i=0===(t=0!==t?(i+this.readEG()+256)%256:t)?i:t},n.readSPS=function(){var c,l,u,a=0,v=0,y=0,p=0,r=this.readUByte.bind(this),o=this.readBits.bind(this),i=this.readUEG.bind(this),s=this.readBoolean.bind(this),f=this.skipBits.bind(this),h=this.skipEG.bind(this),e=this.skipUEG.bind(this),w=this.skipScalingList.bind(this),t,n;if((r(),t=r(),o(5),f(3),r(),e(),100===t||110===t||122===t||244===t||44===t||83===t||86===t||118===t||128===t)&&(t=i(),3===t&&f(1),e(),e(),f(1),s()))for(l=3!==t?8:12,u=0;u<l;u++)s()&&w(u<6?16:64);if(e(),t=i(),0===t)i();else if(1===t)for(f(1),h(),h(),c=i(),u=0;u<c;u++)h();if(e(),f(1),t=i(),e=i(),0===(o=o(1))&&f(1),f(1),s()&&(a=i(),v=i(),y=i(),p=i()),n=[1,1],s()&&s())switch(r()){case 1:n=[1,1];break;case 2:n=[12,11];break;case 3:n=[10,11];break;case 4:n=[16,11];break;case 5:n=[40,33];break;case 6:n=[24,11];break;case 7:n=[20,11];break;case 8:n=[32,11];break;case 9:n=[80,33];break;case 10:n=[18,11];break;case 11:n=[15,11];break;case 12:n=[64,33];break;case 13:n=[160,99];break;case 14:n=[4,3];break;case 15:n=[3,2];break;case 16:n=[2,1];break;case 255:n=[r()<<8|r(),r()<<8|r()]}return{width:Math.ceil(16*(t+1)-2*a-2*v),height:(2-o)*(e+1)*16-(o?2:4)*(y+p),pixelRatio:n}},n.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},t}(),ct=function(){function t(n,t,i,r){this.decryptdata=i;this.discardEPB=r;this.decrypter=new b.default(n,t,{removePKCS7Padding:!1})}var n=t.prototype;return n.decryptBuffer=function(n,t){this.decrypter.decrypt(n,this.decryptdata.key.buffer,this.decryptdata.iv.buffer,t)},n.decryptAacSample=function(n,t,i,r){var f=n[t].unit,u=f.subarray(16,f.length-f.length%16),u=u.buffer.slice(u.byteOffset,u.byteOffset+u.length),e=this;this.decryptBuffer(u,function(u){u=new Uint8Array(u);f.set(u,16);r||e.decryptAacSamples(n,t+1,i)})},n.decryptAacSamples=function(n,t,i){for(;;t++){if(t>=n.length)return void i();if(!(n[t].unit.length<32)){var r=this.decrypter.isSync();if(this.decryptAacSample(n,t,i,r),!r)return}}},n.getAvcEncryptedData=function(n){for(var u=16*Math.floor((n.length-48)/160)+16,i=new Int8Array(u),r=0,t=32;t<=n.length-16;t+=160,r+=16)i.set(n.subarray(t,t+16),r);return i},n.getAvcDecryptedUnit=function(n,t){t=new Uint8Array(t);for(var i=0,r=32;r<=n.length-16;r+=160,i+=16)n.set(t.subarray(i,i+16),r);return n},n.decryptAvcSample=function(n,t,i,r,u,f){var e=this.discardEPB(u.data),s=this.getAvcEncryptedData(e),o=this;this.decryptBuffer(s.buffer,function(s){u.data=o.getAvcDecryptedUnit(e,s);f||o.decryptAvcSamples(n,t,i+1,r)})},n.decryptAvcSamples=function(n,t,i,r){for(var f,u,e;;t++,i=0){if(t>=n.length)return void r();for(f=n[t].units;!(i>=f.length);i++)if(u=f[i],!(u.length<=48||1!==u.type&&5!==u.type)&&(e=this.decrypter.isSync(),this.decryptAvcSample(n,t,i,r,u,e),!e))return}},t}(),lt={video:1,audio:2,id3:3,text:4},at=function(){function t(n,t,i,r){this.observer=n;this.config=i;this.typeSupported=r;this.remuxer=t;this.sampleAes=null}var n=t.prototype;return n.setDecryptData=function(n){this.sampleAes=null!=n&&null!=n.key&&"SAMPLE-AES"===n.method?new ct(this.observer,this.config,n,this.discardEPB):null},t.probe=function(n){return n=t._syncOffset(n),!(n<0)&&(n&&r.logger.warn("MPEG2-TS detected but first sync word found @ offset "+n+", junk ahead ?"),!0)},t._syncOffset=function(n){for(var i=Math.min(1e3,n.length-564),t=0;t<i;){if(71===n[t]&&71===n[t+188]&&71===n[t+376])return t;t++}return-1},t.createTrack=function(n,t){return{container:"video"===n||"audio"===n?"video/mp2t":void 0,type:n,id:lt[n],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:"video"===n?0:void 0,isAAC:"audio"===n||void 0,duration:"audio"===n?t:void 0}},n.resetInitSegment=function(n,i,r,u){this.pmtParsed=!1;this._pmtId=-1;this._avcTrack=t.createTrack("video",u);this._audioTrack=t.createTrack("audio",u);this._id3Track=t.createTrack("id3",u);this._txtTrack=t.createTrack("text",u);this.aacOverFlow=null;this.aacLastPTS=null;this.avcSample=null;this.audioCodec=i;this.videoCodec=r;this._duration=u},n.resetTimeStamp=function(){},n.append=function(n,i,f,o){var s,b,ft,h,c,g=n.length,nt=!1,et=(this.contiguous=f,this.pmtParsed),p=this._avcTrack,a=this._audioTrack,w=this._id3Track,tt=p.pid,it=a.pid,rt=w.pid,ot=this._pmtId,v=p.pesData,l=a.pesData,y=w.pesData,at=this._parsePAT,vt=this._parsePMT,k=this._parsePES,st=this._parseAVCPES.bind(this),ht=this._parseAACPES.bind(this),ct=this._parseMPEGPES.bind(this),lt=this._parseID3PES.bind(this),ut=t._syncOffset(n),d;for(g-=(g+ut)%188,s=ut;s<g;s+=188)if(71===n[s]){if(b=!!(64&n[s+1]),ft=((31&n[s+1])<<8)+n[s+2],1<(48&n[s+3])>>4){if((h=s+5+n[s+4])===s+188)continue}else h=s+4;switch(ft){case tt:b&&(v&&(c=k(v))&&st(c,!1),v={data:[],size:0});v&&(v.data.push(n.subarray(h,s+188)),v.size+=s+188-h);break;case it:b&&(l&&(c=k(l))&&(a.isAAC?ht:ct)(c),l={data:[],size:0});l&&(l.data.push(n.subarray(h,s+188)),l.size+=s+188-h);break;case rt:b&&(y&&(c=k(y))&&lt(c),y={data:[],size:0});y&&(y.data.push(n.subarray(h,s+188)),y.size+=s+188-h);break;case 0:b&&(h+=n[h]+1);ot=this._pmtId=at(n,h);break;case ot:b&&(h+=n[h]+1);d=vt(n,h,!0===this.typeSupported.mpeg||!0===this.typeSupported.mp3,null!=this.sampleAes);0<(tt=d.avc)&&(p.pid=tt);0<(it=d.audio)&&(a.pid=it,a.isAAC=d.isAAC);0<(rt=d.id3)&&(w.pid=rt);nt&&!et&&(r.logger.log("reparse from beginning"),nt=!1,s=ut-188);et=this.pmtParsed=!0;break;case 17:case 8191:break;default:nt=!0}}else this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});v&&(c=k(v))?(st(c,!0),p.pesData=null):p.pesData=v;l&&(c=k(l))?((a.isAAC?ht:ct)(c),a.pesData=null):(l&&l.size&&r.logger.log("last AAC PES packet truncated,might overlap between fragments"),a.pesData=l);y&&(c=k(y))?(lt(c),w.pesData=null):w.pesData=y;null==this.sampleAes?this.remuxer.remux(a,p,w,this._txtTrack,i,f,o):this.decryptAndRemux(a,p,w,this._txtTrack,i,f,o)},n.decryptAndRemux=function(n,t,i,r,u,f,e){var o;n.samples&&n.isAAC?(o=this).sampleAes.decryptAacSamples(n.samples,0,function(){o.decryptAndRemuxAvc(n,t,i,r,u,f,e)}):this.decryptAndRemuxAvc(n,t,i,r,u,f,e)},n.decryptAndRemuxAvc=function(n,t,i,r,u,f,e){var o;t.samples?(o=this).sampleAes.decryptAvcSamples(t.samples,0,0,function(){o.remuxer.remux(n,t,i,r,u,f,e)}):this.remuxer.remux(n,t,i,r,u,f,e)},n.destroy=function(){this._initPTS=this._initDTS=void 0;this._duration=0},n._parsePAT=function(n,t){return(31&n[t+10])<<8|n[t+11]},n._parsePMT=function(n,t,i,u){var e,f={audio:-1,avc:-1,id3:-1,isAAC:!0},o=t+3+((15&n[t+1])<<8|n[t+2])-4;for(t+=12+((15&n[t+10])<<8|n[t+11]);t<o;){switch(e=(31&n[t+1])<<8|n[t+2],n[t]){case 207:if(!u){r.logger.log("unknown stream type:"+n[t]);break}case 15:-1===f.audio&&(f.audio=e);break;case 21:-1===f.id3&&(f.id3=e);break;case 219:if(!u){r.logger.log("unknown stream type:"+n[t]);break}case 27:-1===f.avc&&(f.avc=e);break;case 3:case 4:i?-1===f.audio&&(f.audio=e,f.isAAC=!1):r.logger.log("MPEG audio found, not supported in this browser for now");break;case 36:r.logger.warn("HEVC stream type found, not supported for now");break;default:r.logger.log("unknown stream type:"+n[t])}t+=5+((15&n[t+3])<<8|n[t+4])}return f},n._parsePES=function(n){var o,s,f,e,u,a=0,i=n.data,c,t,h;if(!n||0===n.size)return null;for(;i[0].length<19&&1<i.length;)c=new Uint8Array(i[0].length+i[1].length),c.set(i[0]),c.set(i[1],i[0].length),i[0]=c,i.splice(1,1);if(1!==((t=i[0])[0]<<16)+(t[1]<<8)+t[2]||(o=(t[4]<<8)+t[5])&&o>n.size-6||(192&(s=t[7])&&(4294967295<(f=536870912*(14&t[9])+4194304*(255&t[10])+16384*(254&t[11])+128*(255&t[12])+(254&t[13])/2)&&(f-=8589934592),64&s?(4294967295<(e=536870912*(14&t[14])+4194304*(255&t[15])+16384*(254&t[16])+128*(255&t[17])+(254&t[18])/2)&&(e-=8589934592),54e5<f-e&&(r.logger.warn(Math.round((f-e)/9e4)+"s delta between PTS and DTS, align them"),f=e)):e=f),s=t[8],n.size<=(u=s+9)))return null;n.size-=u;for(var v=new Uint8Array(n.size),l=0,y=i.length;l<y;l++){if(h=(t=i[l]).byteLength,u){if(h<u){u-=h;continue}t=t.subarray(u);h-=u;u=0}v.set(t,a);a+=h}return o&&(o-=s+3),{data:v,pts:f,dts:e,len:o}},n.pushAccesUnit=function(n,t){var u,i,f;if(n.units.length&&n.frame){if(u=t.samples,i=u.length,isNaN(n.pts)){if(!i)return void t.dropped++;f=u[i-1];n.pts=f.pts;n.dts=f.dts}!this.config.forceKeyFrameOnDiscontinuity||!0===n.key||t.sps&&(i||this.contiguous)?(n.id=i,u.push(n)):t.dropped++}n.debug.length&&r.logger.log(n.pts+"/"+n.dts+":"+n.debug)},n._parseAVCPES=function(n,t){function h(n,t,i,r){return{key:n,pts:t,dts:i,units:[],debug:r}}var r,e,i,s=this,f=this._avcTrack,l=this._parseAVCNALu(n.data),u=this.avcSample,a=!1,c=this.pushAccesUnit.bind(this);n.data=null;u&&l.length&&!f.audFound&&(c(u,f),u=this.avcSample=h(!1,n.pts,n.dts,""));l.forEach(function(t){var l,tt,y,g,it,nt,b;switch(t.type){case 1:e=!0;(u=u||(s.avcSample=h(!0,n.pts,n.dts,""))).frame=!0;l=t.data;a&&4<l.length&&(2!==(l=new p(l).readSliceType())&&4!==l&&7!==l&&9!==l||(u.key=!0));break;case 5:e=!0;(u=u||(s.avcSample=h(!0,n.pts,n.dts,""))).key=!0;u.frame=!0;break;case 6:e=!0;(r=new p(s.discardEPB(t.data))).readUByte();for(var w=0,v=0,tt=!1,k=0;!tt&&1<r.bytesAvailable;){for(w=0;w+=k=r.readUByte(),255===k;);for(v=0;v+=k=r.readUByte(),255===k;);if(4===w&&0!==r.bytesAvailable){if(tt=!0,y=r.readUByte(),181===y&&49===r.readUShort()&&(y=r.readUInt(),1195456820===y&&3===r.readUByte())){var y=r.readUByte(),ut=31&y,d=[y,r.readUByte()];for(i=0;i<ut;i++)d.push(r.readUByte()),d.push(r.readUByte()),d.push(r.readUByte());s._insertSampleInOrder(s._txtTrack.samples,{type:3,pts:n.pts,bytes:d})}}else if(5===w&&0!==r.bytesAvailable){if(tt=!0,16<v){for(g=[],i=0;i<16;i++)g.push(r.readUByte().toString(16)),3!==i&&5!==i&&7!==i&&9!==i||g.push("-");for(it=v-16,nt=new Uint8Array(it),i=0;i<it;i++)nt[i]=r.readUByte();s._insertSampleInOrder(s._txtTrack.samples,{pts:n.pts,payloadType:w,uuid:g.join(""),userDataBytes:nt,userData:Object(o.utf8ArrayToStr)(nt.buffer)})}}else if(v<r.bytesAvailable)for(i=0;i<v;i++)r.readUByte()}break;case 7:if(a=e=!0,!f.sps){var l=(r=new p(t.data)).readSPS(),ft=(f.width=l.width,f.height=l.height,f.pixelRatio=l.pixelRatio,f.sps=[t.data],f.duration=s._duration,t.data.subarray(1,4)),rt="avc1.";for(i=0;i<3;i++)b=ft[i].toString(16),rt+=b=b.length<2?"0"+b:b;f.codec=rt}break;case 8:e=!0;f.pps||(f.pps=[t.data]);break;case 9:e=!1;f.audFound=!0;u&&c(u,f);u=s.avcSample=h(!1,n.pts,n.dts,"");break;case 12:e=!1;break;default:e=!1;u&&(u.debug+="unknown NAL "+t.type+" ")}u&&e&&u.units.push(t)});t&&u&&(c(u,f),this.avcSample=null)},n._insertSampleInOrder=function(n,t){var r=n.length,i;if(0<r){if(t.pts>=n[r-1].pts)n.push(t);else for(i=r-1;0<=i;i--)if(t.pts<n[i].pts){n.splice(i,0,t);break}}else n.push(t)},n._getLastNalUnit=function(){var t,i,n=this.avcSample;return(n=!n||0===n.units.length?(t=this._avcTrack.samples)[t.length-1]:n)?(t=n.units)[t.length-1]:i},n._parseAVCNALu=function(n){var c,o,s,f,l,r=0,a=n.byteLength,p=this._avcTrack,v=t=p.naluState||0,h=[],u=-1,i,y,t,e;for(-1===t&&(s=31&n[u=0],t=0,r=1);r<a;)e=n[r++],t=t?1!==t?e?1===e?(0<=u?(o={data:n.subarray(u,r-t-1),type:s},h.push(o)):(i=this._getLastNalUnit())&&(v&&r<=4-v&&i.state&&(i.data=i.data.subarray(0,i.data.byteLength-v)),0<(c=r-t-1)&&((y=new Uint8Array(i.data.byteLength+c)).set(i.data,0),y.set(n.subarray(0,c),i.data.byteLength),i.data=y)),r<a?(s=31&n[u=r],0):-1):0:3:e?0:2:e?0:1;return 0<=u&&0<=t&&(o={data:n.subarray(u,a),type:s,state:t},h.push(o)),0!==h.length||(f=this._getLastNalUnit())&&((l=new Uint8Array(f.data.byteLength+n.byteLength)).set(f.data,0),l.set(n,f.data.byteLength),f.data=l),p.naluState=t,h},n.discardEPB=function(n){for(var u=n.byteLength,i=[],t=1;t<u-2;)0===n[t]&&0===n[t+1]&&3===n[t+2]?(i.push(t+2),t+=2):t++;if(0===i.length)return n;for(var f=u-i.length,e=new Uint8Array(f),r=0,t=0;t<f;r++,t++)r===i[0]&&(r++,i.shift()),e[t]=n[r];return e},n._parseAACPES=function(n){var l,t,y,o,v=this._audioTrack,f=n.data,h=n.pts,n=this.aacOverFlow,p=this.aacLastPTS,s,i,c;for(n&&((i=new Uint8Array(n.byteLength+f.byteLength)).set(n,0),i.set(f,n.byteLength),f=i),t=0,o=f.length;t<o-1&&!a(f,t);t++);if(!t||(i=t<o-1?(s="AAC PES did not start with ADTS header,offset:"+t,!1):(s="no ADTS header found in AAC PES",!0),r.logger.warn("parsing error:"+s),this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:i,reason:s}),!i)){for(nt(v,this.observer,f,t,this.audioCodec),l=0,s=tt(v.samplerate),n&&p&&(i=p+s,1<Math.abs(i-h)&&(r.logger.log("AAC: align PTS for overlapping frames by "+Math.round((i-h)/90)),h=i));t<o;){if(a(f,t)){if(t+5<o&&(c=it(v,f,t,h,l),c)){t+=c.length;y=c.sample.pts;l++;continue}break}t++}n=t<o?f.subarray(t,o):null;this.aacOverFlow=n;this.aacLastPTS=y}},n._parseMPEGPES=function(n){for(var r,i=n.data,f=i.length,u=0,t=0,e=n.pts;t<f;)if(l.isHeader(i,t)){if(r=l.appendFrame(this._audioTrack,i,t,e,u),!r)break;t+=r.length;u++}else t++},n._parseID3PES=function(n){this._id3Track.samples.push(n)},t}(),vt=function(){function t(n,t,i){this.observer=n;this.config=i;this.remuxer=t}var n=t.prototype;return n.resetInitSegment=function(n,t,i,r){this._audioTrack={container:"audio/mpeg",type:"audio",id:-1,sequenceNumber:0,isAAC:!1,samples:[],len:0,manifestCodec:t,duration:r,inputTimeScale:9e4}},n.resetTimeStamp=function(){},t.probe=function(n){var t,u,i=o.default.getID3Data(n,0);if(i&&void 0!==o.default.getTimeStamp(i))for(t=i.length,u=Math.min(n.length-1,t+100);t<u;t++)if(l.probe(n,t))return r.logger.log("MPEG Audio sync word found !"),!0;return!1},n.append=function(n,t,i,r){for(var e,f=o.default.getID3Data(n,0),c=o.default.getTimeStamp(f),s=c?90*c:9e4*t,u=f.length,p=n.length,a=0,h=0,v=this._audioTrack,y=[{pts:s,dts:s,data:f}];u<p;)if(l.isHeader(n,u)){if(e=l.appendFrame(v,n,u,s,a),!e)break;u+=e.length;h=e.sample.pts;a++}else o.default.isHeader(n,u)?(f=o.default.getID3Data(n,u),y.push({pts:h,dts:h,data:f}),u+=f.length):u++;this.remuxer.remux(v,{samples:[]},{samples:y,inputTimeScale:9e4},{samples:[]},t,i,r)},n.destroy=function(){},t}(),v=function(){function n(){}return n.getSilentFrame=function(n,t){if("mp4a.40.2"===n){if(1===t)return new Uint8Array([0,200,0,128,35,128]);if(2===t)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(3===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(4===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(5===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(6===t)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(1===t)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(2===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(3===t)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}return null},n}(),s=Math.pow(2,32)-1,h=function(){function n(){}return n.init=function(){for(var t in n.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]})n.types.hasOwnProperty(t)&&(n.types[t]=[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3)]);var r=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),i=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),r=(n.HDLR_TYPES={video:r,audio:i},new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1])),i=new Uint8Array([0,0,0,0,0,0,0,0]),i=(n.STTS=n.STSC=n.STCO=i,n.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),n.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),n.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),n.STSD=new Uint8Array([0,0,0,0,0,0,0,1]),new Uint8Array([105,115,111,109])),u=new Uint8Array([97,118,99,49]),f=new Uint8Array([0,0,0,1]);n.FTYP=n.box(n.types.ftyp,i,f,i,u);n.DINF=n.box(n.types.dinf,n.box(n.types.dref,r))},n.box=function(n){for(var r,u=Array.prototype.slice.call(arguments,1),t=8,i=u.length,f=i;i--;)t+=u[i].byteLength;for((r=new Uint8Array(t))[0]=t>>24&255,r[1]=t>>16&255,r[2]=t>>8&255,r[3]=255&t,r.set(n,4),i=0,t=8;i<f;i++)r.set(u[i],t),t+=u[i].byteLength;return r},n.hdlr=function(t){return n.box(n.types.hdlr,n.HDLR_TYPES[t])},n.mdat=function(t){return n.box(n.types.mdat,t)},n.mdhd=function(t,i){i*=t;var r=Math.floor(i/(1+s)),i=Math.floor(i%(1+s));return n.box(n.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,85,196,0,0]))},n.mdia=function(t){return n.box(n.types.mdia,n.mdhd(t.timescale,t.duration),n.hdlr(t.type),n.minf(t))},n.mfhd=function(t){return n.box(n.types.mfhd,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t]))},n.minf=function(t){return"audio"===t.type?n.box(n.types.minf,n.box(n.types.smhd,n.SMHD),n.DINF,n.stbl(t)):n.box(n.types.minf,n.box(n.types.vmhd,n.VMHD),n.DINF,n.stbl(t))},n.moof=function(t,i,r){return n.box(n.types.moof,n.mfhd(t),n.traf(r,i))},n.moov=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trak(t[i]);return n.box.apply(null,[n.types.moov,n.mvhd(t[0].timescale,t[0].duration)].concat(r).concat(n.mvex(t)))},n.mvex=function(t){for(var i=t.length,r=[];i--;)r[i]=n.trex(t[i]);return n.box.apply(null,[n.types.mvex].concat(r))},n.mvhd=function(t,i){i*=t;var r=Math.floor(i/(1+s)),i=Math.floor(i%(1+s)),t=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,t>>24&255,t>>16&255,t>>8&255,255&t,r>>24,r>>16&255,r>>8&255,255&r,i>>24,i>>16&255,i>>8&255,255&i,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return n.box(n.types.mvhd,t)},n.sdtp=function(t){for(var i,u=t.samples||[],f=new Uint8Array(4+u.length),r=0;r<u.length;r++)i=u[r].flags,f[r+4]=i.dependsOn<<4|i.isDependedOn<<2|i.hasRedundancy;return n.box(n.types.sdtp,f)},n.stbl=function(t){return n.box(n.types.stbl,n.stsd(t),n.box(n.types.stts,n.STTS),n.box(n.types.stsc,n.STSC),n.box(n.types.stsz,n.STSZ),n.box(n.types.stco,n.STCO))},n.avc1=function(t){for(var e,u,i=[],f=[],r=0;r<t.sps.length;r++)u=(e=t.sps[r]).byteLength,i.push(u>>>8&255),i.push(255&u),i=i.concat(Array.prototype.slice.call(e));for(r=0;r<t.pps.length;r++)u=(e=t.pps[r]).byteLength,f.push(u>>>8&255),f.push(255&u),f=f.concat(Array.prototype.slice.call(e));var l=n.box(n.types.avcC,new Uint8Array([1,i[3],i[4],i[5],255,224|t.sps.length].concat(i).concat([t.pps.length]).concat(f))),h=t.width,c=t.height,o=t.pixelRatio[0],s=t.pixelRatio[1];return n.box(n.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,h>>8&255,255&h,c>>8&255,255&c,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),l,n.box(n.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),n.box(n.types.pasp,new Uint8Array([o>>24,o>>16&255,o>>8&255,255&o,s>>24,s>>16&255,s>>8&255,255&s])))},n.esds=function(n){var t=n.config.length;return new Uint8Array([0,0,0,0,3,23+t,0,1,0,4,15+t,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([t]).concat(n.config).concat([6,1,2]))},n.mp4a=function(t){var i=t.samplerate;return n.box(n.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]),n.box(n.types.esds,n.esds(t)))},n.mp3=function(t){var i=t.samplerate;return n.box(n.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,t.channelCount,0,16,0,0,0,0,i>>8&255,255&i,0,0]))},n.stsd=function(t){return"audio"===t.type?t.isAAC||"mp3"!==t.codec?n.box(n.types.stsd,n.STSD,n.mp4a(t)):n.box(n.types.stsd,n.STSD,n.mp3(t)):n.box(n.types.stsd,n.STSD,n.avc1(t))},n.tkhd=function(t){var r=t.id,i=t.duration*t.timescale,f=t.width,t=t.height,u=Math.floor(i/(1+s)),i=Math.floor(i%(1+s));return n.box(n.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,r>>24&255,r>>16&255,r>>8&255,255&r,0,0,0,0,u>>24,u>>16&255,u>>8&255,255&u,i>>24,i>>16&255,i>>8&255,255&i,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,f>>8&255,255&f,0,0,t>>8&255,255&t,0,0]))},n.traf=function(t,i){var f=n.sdtp(t),r=t.id,u=Math.floor(i/(1+s)),i=Math.floor(i%(1+s));return n.box(n.types.traf,n.box(n.types.tfhd,new Uint8Array([0,0,0,0,r>>24,r>>16&255,r>>8&255,255&r])),n.box(n.types.tfdt,new Uint8Array([1,0,0,0,u>>24,u>>16&255,u>>8&255,255&u,i>>24,i>>16&255,i>>8&255,255&i])),n.trun(t,f.length+16+20+8+16+8+8),f)},n.trak=function(t){return t.duration=t.duration||4294967295,n.box(n.types.trak,n.tkhd(t),n.mdia(t))},n.trex=function(t){return t=t.id,n.box(n.types.trex,new Uint8Array([0,0,0,0,t>>24,t>>16&255,t>>8&255,255&t,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},n.trun=function(t,i){var e,o,s,r,u,c=t.samples||[],f=c.length,t=12+16*f,h=new Uint8Array(t);for(h.set([0,0,15,1,f>>>24&255,f>>>16&255,f>>>8&255,255&f,(i+=8+t)>>>24&255,i>>>16&255,i>>>8&255,255&i],0),e=0;e<f;e++)o=(u=c[e]).duration,s=u.size,r=u.flags,u=u.cts,h.set([o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s,r.isLeading<<2|r.dependsOn,r.isDependedOn<<6|r.hasRedundancy<<4|r.paddingValue<<1|r.isNonSync,61440&r.degradPrio,15&r.degradPrio,u>>>24&255,u>>>16&255,u>>>8&255,255&u],12+16*e);return n.box(n.types.trun,h)},n.initSegment=function(t){n.types||n.init();var t=n.moov(t),i=new Uint8Array(n.FTYP.byteLength+t.byteLength);return i.set(n.FTYP),i.set(t,n.FTYP.byteLength),i},n}();var y,ft=ut(10),yt=ut(.2),w=function(){function t(n,t,i,r){this.observer=n;this.config=t;this.typeSupported=i;n=navigator.userAgent;this.isSafari=r&&-1<r.indexOf("Apple")&&n&&!n.match("CriOS");this.ISGenerated=!1}var n=t.prototype;return n.destroy=function(){},n.resetTimeStamp=function(n){this._initPTS=this._initDTS=n},n.resetInitSegment=function(){this.ISGenerated=!1},n.remux=function(n,t,i,f,e,o,s){var l,a,v,h,y,c;this.ISGenerated||this.generateIS(n,t,e);this.ISGenerated&&(c=n.samples.length,l=t.samples.length,v=a=e,c&&l&&(h=(n.samples[0].pts-t.samples[0].pts)/t.inputTimeScale,a+=Math.max(0,h),v+=Math.max(0,-h)),c?(n.timescale||(r.logger.warn("regenerate InitSegment as audio detected"),this.generateIS(n,t,e)),h=this.remuxAudio(n,a,o,s),l&&(h&&(y=h.endPTS-h.startPTS),t.timescale||(r.logger.warn("regenerate InitSegment as video detected"),this.generateIS(n,t,e)),this.remuxVideo(t,v,o,y,s))):!l||(c=this.remuxVideo(t,v,o,0,s))&&n.codec&&this.remuxEmptyAudio(n,a,o,c));i.samples.length&&this.remuxID3(i,e);f.samples.length&&this.remuxText(f,e);this.observer.trigger(u.default.FRAG_PARSED)},n.generateIS=function(n,t,i){var f,s,y=this.observer,p=n.samples,a=t.samples,v=this.typeSupported,o="audio/mp4",c={},w={tracks:c},l=void 0===this._initPTS;l&&(f=s=1/0);n.config&&p.length&&(n.timescale=n.samplerate,r.logger.log("audio sampling rate : "+n.samplerate),n.isAAC||(v.mpeg?(o="audio/mpeg",n.codec=""):v.mp3&&(n.codec="mp3")),c.audio={container:o,codec:n.codec,initSegment:!n.isAAC&&v.mpeg?new Uint8Array:h.initSegment([n]),metadata:{channelCount:n.channelCount}},l&&(f=s=p[0].pts-n.inputTimeScale*i));t.sps&&t.pps&&a.length&&(o=t.inputTimeScale,t.timescale=o,c.video={container:"video/mp4",codec:t.codec,initSegment:h.initSegment([t]),metadata:{width:t.width,height:t.height}},l&&(f=Math.min(f,a[0].pts-o*i),s=Math.min(s,a[0].dts-o*i),this.observer.trigger(u.default.INIT_PTS_FOUND,{initPTS:f})));Object.keys(c).length?(y.trigger(u.default.FRAG_PARSING_INIT_SEGMENT,w),this.ISGenerated=!0,l&&(this._initPTS=f,this._initDTS=s)):y.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"no audio/video samples found"})},n.remuxVideo=function(n,t,i,o,s){var l,g,rt=8,v=n.timescale,c=n.samples,nt=[],ut=c.length,pt=this._PTSNormalize,ht=this._initPTS,y=this.nextAvcDts,ft=this.isSafari,et,ot,at,w;if(0!==ut){if(ft&&(i|=c.length&&y&&(s&&Math.abs(t-y/v)<.1||Math.abs(c[0].pts-y-ht)<v/5)),i||(y=t*v),c.forEach(function(n){n.pts=pt(n.pts-ht,y);n.dts=pt(n.dts-ht,y)}),c.sort(function(n,t){var i=n.dts-t.dts,r=n.pts-t.pts;return i||r||n.id-t.id}),et=c.reduce(function(n,t){return Math.max(Math.min(n,t.pts-t.dts),-1*yt)},0),et<0)for(r.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+f(et,!0)+" ms to overcome this issue"),ot=0;ot<c.length;ot++)c[ot].dts+=et;for(var s=c[0],p=Math.max(s.dts,0),d=Math.max(s.pts,0),t=p-y,wt=(i&&t&&(1<t?r.logger.log("AVC: "+f(t,!0)+" ms hole between fragments detected,filling it"):t<-1&&r.logger.log("AVC: "+f(-t,!0)+" ms overlapping between fragments detected"),p=y,c[0].dts=p,d=Math.max(d-t,y),c[0].pts=d,r.logger.log("Video: PTS/DTS adjusted: "+f(d,!0)+"/"+f(p,!0)+", delta: "+f(t,!0)+" ms")),s=c[c.length-1],i=Math.max(s.dts,0),t=Math.max(s.pts,0,i),ft&&(l=Math.round((i-p)/(c.length-1))),0),bt=0,st=0;st<ut;st++){for(var k=c[st],kt=k.units,dt=kt.length,ct=0,lt=0;lt<dt;lt++)ct+=kt[lt].data.length;bt+=ct;wt+=dt;k.length=ct;k.dts=ft?p+st*l:Math.max(k.dts,p);k.pts=Math.max(k.pts,k.dts)}s=bt+4*wt+8;try{g=new Uint8Array(s)}catch(n){return void this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MUX_ERROR,details:e.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:s,reason:"fail allocating video mdat "+s})}for(at=new DataView(g.buffer),at.setUint32(0,s),g.set(h.types.mdat,4),w=0;w<ut;w++){for(var tt,b,a=c[w],gt=a.units,ni=0,ti=void 0,vt=0,ii=gt.length;vt<ii;vt++){var it=gt[vt],ri=it.data,it=it.data.byteLength;at.setUint32(rt,it);rt+=4;g.set(ri,rt);rt+=it;ni+=4+it}ti=ft?Math.max(0,l*Math.round((a.pts-a.dts)/l)):(w<ut-1?l=c[w+1].dts-a.dts:(b=this.config,tt=a.dts-c[0<w?w-1:w].dts,b.stretchShortVideoTrack?(b=b.maxBufferHole,Math.floor(b*v)<(b=(o?d+o*v:this.nextAudioPts)-a.pts)?((l=b-tt)<0&&(l=tt),r.logger.log("It is approximately "+f(b,!1)+" ms to the next segment; using duration "+f(l,!1)+" ms for the last video frame.")):l=tt):l=tt),Math.round(a.pts-a.dts));nt.push({size:ni,duration:l,cts:ti,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:a.key?2:1,isNonSync:a.key?0:1}})}return this.nextAvcDts=i+l,s=n.dropped,n=(n.nbNalu=0,n.dropped=0,nt.length&&-1<navigator.userAgent.toLowerCase().indexOf("chrome")&&((i=nt[0].flags).dependsOn=2,i.isNonSync=0),n.samples=nt,i=h.moof(n.sequenceNumber++,p,n),n.samples=[],{data1:i,data2:g,startPTS:d/v,endPTS:(t+l)/v,startDTS:p/v,endDTS:this.nextAvcDts/v,type:"video",hasAudio:!1,hasVideo:!0,nb:nt.length,dropped:s}),this.observer.trigger(u.default.FRAG_PARSING_DATA,n),n}},n.remuxAudio=function(n,t,i,o){var ut,it,vt,ct,rt=n.inputTimeScale,w=n.timescale,lt=rt/w,k=(n.isAAC?1024:1152)*lt,ti=this._PTSNormalize,dt=this._initPTS,yt=!n.isAAC&&this.typeSupported.mpeg,et=yt?0:8,s=n.samples,ot=[],c=this.nextAudioPts,g,nt,pt,wt,a,bt,tt,y,at,ni,p,ht,kt;if(i|=s.length&&c&&(o&&Math.abs(t-c/rt)<.1||Math.abs(s[0].pts-c-dt)<20*k),s.forEach(function(n){n.pts=n.dts=ti(n.pts-dt,t*rt)}),0!==(s=s.filter(function(n){return 0<=n.pts})).length){if(i||(c=o?t*rt:s[0].pts),n.isAAC)for(var gt=this.config.maxAudioFramesDrift,d=0,l=c;d<s.length;)if(g=s[d],nt=g.pts-l,nt<=-gt*k)r.logger.warn("Dropping 1 audio frame @ "+f(l,!0)+" ms due to "+f(nt,!0)+" ms overlap."),s.splice(d,1);else if(gt*k<=nt&&nt<ft&&l){for(pt=Math.round(nt/k),r.logger.warn("Injecting "+pt+" audio frames @ "+f(l,!0)+" ms due to "+f(l,!0)+" ms gap."),wt=0;wt<pt;wt++)bt=Math.max(l,0),(a=v.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||(r.logger.log("Unable to get silent frame for given audio codec; duplicating last frame instead."),a=g.unit.subarray()),s.splice(d,0,{unit:a,pts:bt,dts:bt}),l+=k,d++;g.pts=g.dts=l;l+=k;d++}else Math.abs(nt),g.pts=g.dts=l,l+=k,d++;for(tt=s.length,y=0;tt--;)y+=s[tt].unit.byteLength;for(at=0,ni=s.length;at<ni;at++){var b=s[at],st=b.unit,b=b.pts;if(void 0!==ct)ut.duration=Math.round((b-ct)/lt);else{if(p=b-c,ht=0,i&&n.isAAC&&p){if(0<p&&p<ft)ht=Math.round((b-c)/k),r.logger.log(f(p,!0)+" ms hole between AAC samples detected,filling it"),0<ht&&(y+=ht*(a=(a=v.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||st.subarray()).length);else if(p<-12){r.logger.log("drop overlapping AAC sample, expected/parsed/delta: "+f(c,!0)+" ms / "+f(b,!0)+" ms / "+f(-p,!0)+" ms");y-=st.byteLength;continue}b=c}if(vt=b,!(0<y))return;y+=et;try{it=new Uint8Array(y)}catch(n){return void this.observer.trigger(u.default.ERROR,{type:e.ErrorTypes.MUX_ERROR,details:e.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:y,reason:"fail allocating audio mdat "+y})}for(yt||(new DataView(it.buffer).setUint32(0,y),it.set(h.types.mdat,4)),kt=0;kt<ht;kt++)(a=v.getSilentFrame(n.manifestCodec||n.codec,n.channelCount))||(r.logger.log("Unable to get silent frame for given audio codec; duplicating this frame instead."),a=st.subarray()),it.set(a,et),et+=a.byteLength,ut={size:a.byteLength,cts:0,duration:1024,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}},ot.push(ut)}it.set(st,et);p=st.byteLength;et+=p;ot.push(ut={size:p,cts:0,duration:0,flags:{isLeading:0,isDependedOn:0,hasRedundancy:0,degradPrio:0,dependsOn:1}});ct=b}return w=0,2<=(tt=ot.length)&&(w=ot[tt-2].duration,ut.duration=w),tt?(this.nextAudioPts=c=ct+lt*w,n.samples=ot,o=yt?new Uint8Array:h.moof(n.sequenceNumber++,vt/lt,n),n.samples=[],this.observer.trigger(u.default.FRAG_PARSING_DATA,w={data1:o,data2:it,startPTS:w=vt/rt,endPTS:o=c/rt,startDTS:w,endDTS:o,type:"audio",hasAudio:!0,hasVideo:!1,nb:tt}),w):null}},n.remuxEmptyAudio=function(n,t,i,u){var f=n.inputTimeScale,y=n.samplerate||f,o=this.nextAudioPts,c=(void 0!==o?o:u.startDTS*f)+this._initDTS,o=u.endDTS*f+this._initDTS,l=1024*(f/y),p=Math.ceil((o-c)/l),a=v.getSilentFrame(n.manifestCodec||n.codec,n.channelCount),s,e,h;if(r.logger.warn("remux empty Audio"),a){for(s=[],e=0;e<p;e++)h=c+e*l,s.push({unit:a,pts:h,dts:h});n.samples=s;this.remuxAudio(n,t,i)}else r.logger.trace("Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec!")},n.remuxID3=function(n){var t,r=n.samples.length,f=n.inputTimeScale,e=this._initPTS,o=this._initDTS,i;if(r){for(i=0;i<r;i++)(t=n.samples[i]).pts=(t.pts-e)/f,t.dts=(t.dts-o)/f;this.observer.trigger(u.default.FRAG_PARSING_METADATA,{samples:n.samples})}n.samples=[]},n.remuxText=function(n){var t;n.samples.sort(function(n,t){return n.pts-t.pts});var i,r=n.samples.length,f=n.inputTimeScale,e=this._initPTS;if(r){for(t=0;t<r;t++)(i=n.samples[t]).pts=(i.pts-e)/f;this.observer.trigger(u.default.FRAG_PARSING_USERDATA,{samples:n.samples})}n.samples=[]},n._PTSNormalize=function(n,t){var i;if(void 0===t)return n;for(i=t<n?-8589934592:8589934592;4294967296<Math.abs(n-t);)n+=i;return n},t}(),pt=function(){function t(n){this.observer=n}var n=t.prototype;return n.destroy=function(){},n.resetTimeStamp=function(){},n.resetInitSegment=function(){},n.remux=function(n,t,i,r,f,e,o,s){var c=this.observer,h="";n&&(h+="audio");t&&(h+="video");c.trigger(u.default.FRAG_PARSING_DATA,{data1:s,startPTS:f,startDTS:f,type:h,hasAudio:!!n,hasVideo:!!t,nb:1,dropped:0});c.trigger(u.default.FRAG_PARSED)},t}(),i=Object(ot.getSelfScope)();try{y=i.performance.now.bind(i.performance)}catch(n){r.logger.debug("Unable to use Performance API on this environment");y=i.Date.now}t.default=function(){function t(n,t,i,r){this.observer=n;this.typeSupported=t;this.config=i;this.vendor=r}var n=t.prototype;return n.destroy=function(){var n=this.demuxer;n&&n.destroy()},n.push=function(n,t,i,r,f,e,o,s,h,c,l,a){var v,p,w=this;0<n.byteLength&&null!=t&&null!=t.key&&"AES-128"===t.method?(null==(v=this.decrypter)&&(v=this.decrypter=new b.default(this.observer,this.config)),p=y(),v.decrypt(n,t.key.buffer,t.iv.buffer,function(n){var v=y();w.observer.trigger(u.default.FRAG_DECRYPTED,{stats:{tstart:p,tdecrypt:v}});w.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),r,f,e,o,s,h,c,l,a)})):this.pushDecrypted(new Uint8Array(n),t,new Uint8Array(i),r,f,e,o,s,h,c,l,a)},n.pushDecrypted=function(n,t,i,r,f,o,s,h,c,l,a,v){var p,d,rt,y,g;if(!(y=this.demuxer)||(s||h)&&!this.probe(n)){for(var b=this.observer,nt=this.typeSupported,tt=this.config,it=[{demux:at,remux:w},{demux:ht.default,remux:pt},{demux:st,remux:w},{demux:vt,remux:w}],k=0,ut=it.length;k<ut;k++)if(p=it[k],d=p.demux.probe,d(n)){rt=this.remuxer=new p.remux(b,tt,nt,this.vendor);y=new p.demux(b,rt,tt,nt);this.probe=d;break}if(!y)return void b.trigger(u.default.ERROR,{type:e.ErrorTypes.MEDIA_ERROR,details:e.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"});this.demuxer=y}g=this.remuxer;(s||h)&&(y.resetInitSegment(i,r,f,l),g.resetInitSegment());s&&(y.resetTimeStamp(v),g.resetTimeStamp(v));"function"==typeof y.setDecryptData&&y.setDecryptData(t);y.append(n,o,c,a)},t}()},"./src/demux/demuxer-worker.js":function(n,t,i){"use strict";i.r(t);var u=i("./src/demux/demuxer-inline.js"),r=i("./src/events.js"),f=i("./src/utils/logger.js"),e=i("./node_modules/eventemitter3/index.js");t.default=function(n){function i(t,i){n.postMessage({event:t,data:i})}var t=new e.EventEmitter;t.trigger=function(n){for(var r=arguments.length,u=new Array(1<r?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];t.emit.apply(t,[n,n].concat(u))};t.off=function(n){for(var r=arguments.length,u=new Array(1<r?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];t.removeListener.apply(t,[n].concat(u))};n.addEventListener("message",function(r){var e=r.data,o;switch(e.cmd){case"init":o=JSON.parse(e.config);n.demuxer=new u.default(t,e.typeSupported,o,e.vendor);Object(f.enableLogs)(o.debug);i("init",null);break;case"demux":n.demuxer.push(e.data,e.decryptdata,e.initSegment,e.audioCodec,e.videoCodec,e.timeOffset,e.discontinuity,e.trackSwitch,e.contiguous,e.duration,e.accurateTimeOffset,e.defaultInitPTS)}});t.on(r.default.FRAG_DECRYPTED,i);t.on(r.default.FRAG_PARSING_INIT_SEGMENT,i);t.on(r.default.FRAG_PARSED,i);t.on(r.default.ERROR,i);t.on(r.default.FRAG_PARSING_METADATA,i);t.on(r.default.FRAG_PARSING_USERDATA,i);t.on(r.default.INIT_PTS_FOUND,i);t.on(r.default.FRAG_PARSING_DATA,function(t,i){var r=[],t={event:t,data:i};i.data1&&(t.data1=i.data1.buffer,r.push(i.data1.buffer),delete i.data1);i.data2&&(t.data2=i.data2.buffer,r.push(i.data2.buffer),delete i.data2);n.postMessage(t,r)})}},"./src/demux/id3.js":function(n,t,i){"use strict";i.r(t);i.d(t,"utf8ArrayToStr",function(){return f});var r,u=i("./src/utils/get-self-scope.js"),i=function(){function n(){}return n.isHeader=function(n,t){return t+10<=n.length&&73===n[t]&&68===n[t+1]&&51===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},n.isFooter=function(n,t){return t+10<=n.length&&51===n[t]&&68===n[t+1]&&73===n[t+2]&&n[t+3]<255&&n[t+4]<255&&n[t+6]<128&&n[t+7]<128&&n[t+8]<128&&n[t+9]<128},n.getID3Data=function(t,i){for(var u=i,r=0;n.isHeader(t,i);)r=(r+=10)+n._readSize(t,i+6),n.isFooter(t,i+10)&&(r+=10),i+=r;if(0<r)return t.subarray(u,u+r)},n._readSize=function(n,t){var i=(127&n[t])<<21;return(i|=(127&n[t+1])<<14)|(127&n[t+2])<<7|127&n[t+3]},n.getTimeStamp=function(t){for(var u,r=n.getID3Frames(t),i=0;i<r.length;i++)if(u=r[i],n.isTimeStampFrame(u))return n._readTimeStamp(u)},n.isTimeStampFrame=function(n){return n&&"PRIV"===n.key&&"com.apple.streaming.transportStreamTimestamp"===n.info},n._getFrameData=function(t){var r=String.fromCharCode(t[0],t[1],t[2],t[3]),i=n._readSize(t,4);return{type:r,size:i,data:t.subarray(10,10+i)}},n.getID3Frames=function(t){for(var e,o,u,f,i=0,r=[];n.isHeader(t,i);){for(e=n._readSize(t,i+6),o=(i+=10)+e;i+8<o;)u=n._getFrameData(t.subarray(i)),f=n._decodeFrame(u),f&&r.push(f),i+=u.size+10;n.isFooter(t,i)&&(i+=10)}return r},n._decodeFrame=function(t){return"PRIV"===t.type?n._decodePrivFrame(t):"T"===t.type[0]?n._decodeTextFrame(t):"W"===t.type[0]?n._decodeURLFrame(t):void 0},n._readTimeStamp=function(n){var t;if(8===n.data.byteLength)return t=1&(n=new Uint8Array(n.data))[3],n=(n[4]<<23)+(n[5]<<15)+(n[6]<<7)+n[7],n/=45,t&&(n+=47721858.84),Math.round(n)},n._decodePrivFrame=function(t){var i,r;if(!(t.size<2))return i=n._utf8ArrayToStr(t.data,!0),r=new Uint8Array(t.data.subarray(i.length+1)),{key:t.type,info:i,data:r.buffer}},n._decodeTextFrame=function(t){var i,r;if(!(t.size<2))return"TXXX"===t.type?(i=1,i+=(r=n._utf8ArrayToStr(t.data.subarray(1),!0)).length+1,i=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:i}):(r=n._utf8ArrayToStr(t.data.subarray(1)),{key:t.type,data:r})},n._decodeURLFrame=function(t){var r,i;return"WXXX"!==t.type?(i=n._utf8ArrayToStr(t.data),{key:t.type,data:i}):t.size<2?void 0:(i=1,i+=(r=n._utf8ArrayToStr(t.data.subarray(1))).length+1,i=n._utf8ArrayToStr(t.data.subarray(i)),{key:t.type,info:r,data:i})},n._utf8ArrayToStr=function(n,t){var h,i;if(void 0===t&&(t=!1),i=function(){var n=Object(u.getSelfScope)();return r||void 0===n.TextDecoder||(r=new n.TextDecoder("utf-8")),r}(),i)return i=i.decode(n),t?-1!==(h=i.indexOf("\0"))?i.substring(0,h):i:i.replace(/\0/g,"");for(var f,s,c,l=n.length,e="",o=0;o<l;){if(0===(f=n[o++])&&t)return e;if(0!==f&&3!==f)switch(f>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e+=String.fromCharCode(f);break;case 12:case 13:s=n[o++];e+=String.fromCharCode((31&f)<<6|63&s);break;case 14:s=n[o++];c=n[o++];e+=String.fromCharCode((15&f)<<12|(63&s)<<6|(63&c)<<0)}}return e},n}(),f=i._utf8ArrayToStr;t.default=i},"./src/demux/mp4demuxer.js":function(n,t,i){"use strict";i.r(t);var f=i("./src/utils/logger.js"),r=i("./src/events.js"),u=Math.pow(2,32)-1;t.default=function(){function n(n,t){this.observer=n;this.remuxer=t}var t=n.prototype;return t.resetTimeStamp=function(n){this.initPTS=n},t.resetInitSegment=function(t,i,u,f){var o,e;t&&t.byteLength?(null==i&&(i="mp4a.40.5"),null==u&&(u="avc1.42e01e"),e={},(o=this.initData=n.parseInitSegment(t)).audio&&o.video?e.audiovideo={container:"video/mp4",codec:i+","+u,initSegment:f?t:null}:(o.audio&&(e.audio={container:"audio/mp4",codec:i,initSegment:f?t:null}),o.video&&(e.video={container:"video/mp4",codec:u,initSegment:f?t:null})),this.observer.trigger(r.default.FRAG_PARSING_INIT_SEGMENT,{tracks:e})):(i&&(this.audioCodec=i),u&&(this.videoCodec=u))},n.probe=function(t){return 0<n.findBox({data:t,start:0,end:Math.min(t.length,16384)},["moof"]).length},n.bin2str=function(n){return String.fromCharCode.apply(null,n)},n.readUint16=function(n,t){return n.data&&(t+=n.start,n=n.data),n=n[t]<<8|n[t+1],n<0?65536+n:n},n.readUint32=function(n,t){return n.data&&(t+=n.start,n=n.data),n=n[t]<<24|n[t+1]<<16|n[t+2]<<8|n[t+3],n<0?4294967296+n:n},n.writeUint32=function(n,t,i){n.data&&(t+=n.start,n=n.data);n[t]=i>>24;n[t+1]=i>>16&255;n[t+2]=i>>8&255;n[t+3]=255&i},n.findBox=function(t,i){var r,f,s,o,u,e=[];if(t.data?(o=t.start,f=t.end,t=t.data):(o=0,f=t.byteLength),!i.length)return null;for(r=o;r<f;)u=1<(u=n.readUint32(t,r))?r+u:f,n.bin2str(t.subarray(r+4,r+8))===i[0]&&(1===i.length?e.push({data:t,start:r+8,end:u}):(s=n.findBox({data:t,start:r+8,end:u},i.slice(1))).length&&(e=e.concat(s))),r=u;return e},n.parseSegmentIndex=function(t){var e=n.findBox(t,["moov"])[0],e=e?e.end:null,r=0,i=n.findBox(t,["sidx"]),s;if(!i||!i[0])return null;var c=[],t=(i=i[0]).data[0],r=0===t?8:16,l=n.readUint32(i,r),o=i.end+0,a=n.readUint16(i,r=(r+=4)+(0===t?8:16)+2);for(r+=2,s=0;s<a;s++){var f=r,u=n.readUint32(i,f),h=2147483647&u;if(1==(2147483648&u)>>>31)return;u=n.readUint32(i,f+=4);f+=4;c.push({referenceSize:h,subsegmentDuration:u,info:{duration:u/l,start:o,end:o+h-1}});o+=h;r=f+=4}return{earliestPresentationTime:0,timescale:l,version:t,referencesCount:a,references:c,moovEndOffset:e}},n.parseInitSegment=function(t){var i=[];return n.findBox(t,["moov","trak"]).forEach(function(t){var u,r,e=n.findBox(t,["tkhd"])[0];e&&(r=e.data[e.start],e=n.readUint32(e,0===r?12:20),(u=n.findBox(t,["mdia","mdhd"])[0])&&(r=u.data[u.start],u=n.readUint32(u,0===r?12:20),!(r=n.findBox(t,["mdia","hdlr"])[0])||(r={soun:"audio",vide:"video"}[n.bin2str(r.data.subarray(r.start+8,r.start+12))])&&((t=n.findBox(t,["mdia","minf","stbl","stsd"])).length&&(t=t[0],t=n.bin2str(t.data.subarray(t.start+12,t.start+16)),f.logger.log("MP4Demuxer:"+r+":"+t+" found")),i[e]={timescale:u,type:r},i[r]={timescale:u,id:e})))}),i},n.getStartDTS=function(t,i){return i=n.findBox(i,["moof","traf"]),i=[].concat.apply([],i.map(function(i){return n.findBox(i,["tfhd"]).map(function(r){return r=n.readUint32(r,4),r=t[r].timescale||9e4,n.findBox(i,["tfdt"]).map(function(t){var r=t.data[t.start],i=n.readUint32(t,4);return 1===r?(i*=Math.pow(2,32))+n.readUint32(t,8):i})[0]/r})})),i=Math.min.apply(null,i),isFinite(i)?i:0},n.offsetStartDTS=function(t,i,r){n.findBox(i,["moof","traf"]).map(function(i){return n.findBox(i,["tfhd"]).map(function(f){var f=n.readUint32(f,4),e=t[f].timescale||9e4;n.findBox(i,["tfdt"]).map(function(t){var f=t.data[t.start],i=n.readUint32(t,4);0===f?n.writeUint32(t,4,i-r*e):(i=(i=(i*=Math.pow(2,32))+n.readUint32(t,8))-r*e,i=Math.max(i,0),f=Math.floor(i/(1+u)),i=Math.floor(i%(1+u)),n.writeUint32(t,4,f),n.writeUint32(t,8,i))})})})},t.append=function(t,i,u,f){var e=this.initData,s,o;e||(this.resetInitSegment(t,this.audioCodec,this.videoCodec,!1),e=this.initData);o=this.initPTS;void 0===o&&(s=n.getStartDTS(e,t),this.initPTS=o=s-i,this.observer.trigger(r.default.INIT_PTS_FOUND,{initPTS:o}));n.offsetStartDTS(e,t,o);s=n.getStartDTS(e,t);this.remuxer.remux(e.audio,e.video,null,null,s,u,f,t)},t.destroy=function(){},n}()},"./src/errors.ts":function(n,t,i){"use strict";var r,u;i.r(t);i.d(t,"ErrorTypes",function(){return r});i.d(t,"ErrorDetails",function(){return u});(i=r=r||{}).NETWORK_ERROR="networkError";i.MEDIA_ERROR="mediaError";i.KEY_SYSTEM_ERROR="keySystemError";i.MUX_ERROR="muxError";i.OTHER_ERROR="otherError";(t=u=u||{}).KEY_SYSTEM_NO_KEYS="keySystemNoKeys";t.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess";t.KEY_SYSTEM_NO_SESSION="keySystemNoSession";t.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed";t.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData";t.MANIFEST_LOAD_ERROR="manifestLoadError";t.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut";t.MANIFEST_PARSING_ERROR="manifestParsingError";t.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError";t.LEVEL_LOAD_ERROR="levelLoadError";t.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut";t.LEVEL_SWITCH_ERROR="levelSwitchError";t.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError";t.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut";t.FRAG_LOAD_ERROR="fragLoadError";t.FRAG_LOAD_TIMEOUT="fragLoadTimeOut";t.FRAG_DECRYPT_ERROR="fragDecryptError";t.FRAG_PARSING_ERROR="fragParsingError";t.REMUX_ALLOC_ERROR="remuxAllocError";t.KEY_LOAD_ERROR="keyLoadError";t.KEY_LOAD_TIMEOUT="keyLoadTimeOut";t.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError";t.BUFFER_APPEND_ERROR="bufferAppendError";t.BUFFER_APPENDING_ERROR="bufferAppendingError";t.BUFFER_STALLED_ERROR="bufferStalledError";t.BUFFER_FULL_ERROR="bufferFullError";t.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole";t.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall";t.INTERNAL_EXCEPTION="internalException"},"./src/events.js":function(n,t,i){"use strict";i.r(t);t.default={MEDIA_ATTACHING:"hlsMediaAttaching",MEDIA_ATTACHED:"hlsMediaAttached",MEDIA_DETACHING:"hlsMediaDetaching",MEDIA_DETACHED:"hlsMediaDetached",BUFFER_RESET:"hlsBufferReset",BUFFER_CODECS:"hlsBufferCodecs",BUFFER_CREATED:"hlsBufferCreated",BUFFER_APPENDING:"hlsBufferAppending",BUFFER_APPENDED:"hlsBufferAppended",BUFFER_EOS:"hlsBufferEos",BUFFER_FLUSHING:"hlsBufferFlushing",BUFFER_FLUSHED:"hlsBufferFlushed",MANIFEST_LOADING:"hlsManifestLoading",MANIFEST_LOADED:"hlsManifestLoaded",MANIFEST_PARSED:"hlsManifestParsed",LEVEL_SWITCHING:"hlsLevelSwitching",LEVEL_SWITCHED:"hlsLevelSwitched",LEVEL_LOADING:"hlsLevelLoading",LEVEL_LOADED:"hlsLevelLoaded",LEVEL_UPDATED:"hlsLevelUpdated",LEVEL_PTS_UPDATED:"hlsLevelPtsUpdated",AUDIO_TRACKS_UPDATED:"hlsAudioTracksUpdated",AUDIO_TRACK_SWITCHING:"hlsAudioTrackSwitching",AUDIO_TRACK_SWITCHED:"hlsAudioTrackSwitched",AUDIO_TRACK_LOADING:"hlsAudioTrackLoading",AUDIO_TRACK_LOADED:"hlsAudioTrackLoaded",SUBTITLE_TRACKS_UPDATED:"hlsSubtitleTracksUpdated",SUBTITLE_TRACK_SWITCH:"hlsSubtitleTrackSwitch",SUBTITLE_TRACK_LOADING:"hlsSubtitleTrackLoading",SUBTITLE_TRACK_LOADED:"hlsSubtitleTrackLoaded",SUBTITLE_FRAG_PROCESSED:"hlsSubtitleFragProcessed",INIT_PTS_FOUND:"hlsInitPtsFound",FRAG_LOADING:"hlsFragLoading",FRAG_LOAD_PROGRESS:"hlsFragLoadProgress",FRAG_LOAD_EMERGENCY_ABORTED:"hlsFragLoadEmergencyAborted",FRAG_LOADED:"hlsFragLoaded",FRAG_DECRYPTED:"hlsFragDecrypted",FRAG_PARSING_INIT_SEGMENT:"hlsFragParsingInitSegment",FRAG_PARSING_USERDATA:"hlsFragParsingUserdata",FRAG_PARSING_METADATA:"hlsFragParsingMetadata",FRAG_PARSING_DATA:"hlsFragParsingData",FRAG_PARSED:"hlsFragParsed",FRAG_BUFFERED:"hlsFragBuffered",FRAG_CHANGED:"hlsFragChanged",FPS_DROP:"hlsFpsDrop",FPS_DROP_LEVEL_CAPPING:"hlsFpsDropLevelCapping",ERROR:"hlsError",DESTROYING:"hlsDestroying",KEY_LOADING:"hlsKeyLoading",KEY_LOADED:"hlsKeyLoaded",STREAM_STATE_TRANSITION:"hlsStreamStateTransition",LIVE_BACK_BUFFER_REACHED:"hlsLiveBackBufferReached"}},"./src/hls.ts":function(n,t,i){"use strict";function di(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function gi(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function nr(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ii(n,t){return MediaSource.isTypeSupported((t||"video")+'/mp4;codecs="'+n+'"')}function ui(){return window.MediaSource||window.WebKitMediaSource}function lr(n,t,i){switch(t){case"audio":n.audioGroupIds||(n.audioGroupIds=[]);n.audioGroupIds.push(i);break;case"text":n.textGroupIds||(n.textGroupIds=[]);n.textGroupIds.push(i)}}function ar(n,t,i){var u=n[t],n=n[i],f=n.startPTS;Object(e.isFiniteNumber)(f)?t<i?(u.duration=f-u.start,u.duration<0&&r.logger.warn("negative duration computed for frag "+u.sn+",level "+u.level+", there should be some duration drift between playlist and fragment!")):(n.duration=u.start-f,n.duration<0&&r.logger.warn("negative duration computed for frag "+n.sn+",level "+n.level+", there should be some duration drift between playlist and fragment!")):n.start=t<i?u.start+u.duration:Math.max(u.start-n.duration,0)}function oi(n,t,i,r,u,f){var h,o,s=i,c=(Object(e.isFiniteNumber)(t.startPTS)&&(c=Math.abs(t.startPTS-i),t.deltaPTS=Object(e.isFiniteNumber)(t.deltaPTS)?Math.max(c,t.deltaPTS):c,s=Math.max(i,t.startPTS),i=Math.min(i,t.startPTS),r=Math.max(r,t.endPTS),u=Math.min(u,t.startDTS),f=Math.max(f,t.endDTS)),i-t.start),s=(t.start=t.startPTS=i,t.maxStartPTS=s,t.endPTS=r,t.startDTS=u,t.endDTS=f,t.duration=r-i,t.sn);if(!n||s<n.startSN||s>n.endSN)return 0;for(u=s-n.startSN,(h=n.fragments)[u]=t,o=u;0<o;o--)ar(h,o,o-1);for(o=u;o<h.length-1;o++)ar(h,o,o+1);return n.PTSKnown=!0,c}function vr(n,t){var i,u,s,f,o;if(t.initSegment&&n.initSegment&&(t.initSegment=n.initSegment),u=0,yr(n,t,function(n,r){u=n.cc-r.cc;Object(e.isFiniteNumber)(n.startPTS)&&(r.start=r.startPTS=n.startPTS,r.endPTS=n.endPTS,r.duration=n.duration,r.backtracked=n.backtracked,r.dropped=n.dropped,i=r);t.PTSKnown=!0}),t.PTSKnown){if(u)for(r.logger.log("discontinuity sliding from playlist, take drift into account"),s=t.fragments,f=0;f<s.length;f++)s[f].cc+=u;if(i)oi(t,i,i.startPTS,i.endPTS,i.startDTS,i.endDTS);else{var c=n,l=t,h=l.startSN-c.startSN,a=c.fragments,v=l.fragments;if(!(h<0||h>a.length))for(o=0;o<v.length;o++)v[o].start+=a[h].start}t.PTSKnown=n.PTSKnown}}function yr(n,t,i){var u,f;if(n&&t)for(var e=Math.max(n.startSN,t.startSN)-t.startSN,o=Math.min(n.endSN,t.endSN)-t.startSN,s=t.startSN-n.startSN,r=e;r<=o;r++){if(u=n.fragments[s+r],f=t.fragments[r],!u||!f)break;i(u,f,r)}}function pr(n,t,i){var r=1e3*(t.averagetargetduration||t.targetduration),u=r/2;return n&&t.endSN===n.endSN&&(r=u),i&&(r=Math.max(u,r-(window.performance.now()-i))),Math.round(r)}function ue(n,t){if(n=n.fragments,t=t.fragments,t.length&&n.length){if(n=function(n,t){for(var r,u=null,i=0;i<n.length;i+=1)if(r=n[i],r&&r.cc===t){u=r;break}return u}(n,t[0].cc),n&&n.startPTS)return n;r.logger.log("No frag in previous level to align on")}else r.logger.log("No fragments to align")}function wr(n,t){t.fragments.forEach(function(t){var i;t&&(i=t.start+n,t.start=t.startPTS=i,t.endPTS=i+t.duration)});t.PTSKnown=!0}function br(n,t,i){var f,u;(function(n,t,i){return t&&t.details&&i&&(i.endCC>i.startCC||n&&n.cc<i.startCC)?!0:!1})(n=n,f=t,u=i)&&(n=ue(f.details,u))&&(r.logger.log("Adjusting PTS using last level due to CC increase within current level"),wr(n.start,u));!i.PTSKnown&&t&&(f=i,(n=t.details)&&n.fragments.length&&f.hasProgramDateTime&&n.hasProgramDateTime&&(u=n.fragments[0].programDateTime,u=(f.fragments[0].programDateTime-u)/1e3+n.fragments[0].start,Object(e.isFiniteNumber)(u)&&(r.logger.log("adjusting PTS using programDateTime delta, sliding:"+u.toFixed(3)),wr(u,f))))}function kr(n,t,i){var r,u;if(null===t||!Array.isArray(n)||!n.length||!Object(e.isFiniteNumber)(t)||t<(n[0].programDateTime||0)||(n[n.length-1].endProgramDateTime||0)<=t)return null;for(i=i||0,r=0;r<n.length;++r)if(u=n[r],function(n,t,i){return t=1e3*Math.min(t,i.duration+(i.deltaPTS||0)),(i.endProgramDateTime||0)-t>n}(t,i,u))return u;return null}function dr(n,t,i,r){return void 0===i&&(i=0),void 0===r&&(r=0),n=n?t[n.sn-t[0].sn+1]:null,n&&!gr(i,r,n)?n:pt.search(t,gr.bind(null,i,r))}function gr(n,t,i){return void 0===n&&(n=0),void 0===t&&(t=0),t=Math.min(t,i.duration+(i.deltaPTS||0)),i.start+i.duration-t<=n?1:i.start-t>n&&i.start?-1:0}function ru(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function fu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function su(n,t){var i;try{i=new Event("addtrack")}catch(n){(i=document.createEvent("Event")).initEvent("addtrack",!1,!1)}i.track=n;t.dispatchEvent(i)}function ht(n){if(n&&n.cues)for(;0<n.cues.length;)n.removeCue(n.cues[0])}function cu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function au(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function vu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function yu(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function ye(){return{decode:function(n){if(!n)return"";if("string"!=typeof n)throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}}function wu(){this.window=window;this.state="INITIAL";this.buffer="";this.decoder=new ye;this.regionList=[]}function bu(){this.values=Object.create(null)}function ku(n,t,i,r){var u,f,e=r?n.split(r):[n];for(u in e)"string"==typeof e[u]&&2===(f=e[u].split(i)).length&&t(f[0],f[1])}function we(n,t,i){function o(){function i(n,t,i,r){return 3600*(0|n)+60*(0|t)+(0|i)+(0|r)/1e3}var t=(t=(t=n).match(/^(\d+):(\d{2})(:\d{2})?\.(\d{3})/))?t[3]?i(t[1],t[2],t[3].replace(":",""),t[4]):59<t[1]?i(t[1],t[2],0,t[4]):i(0,t[1],t[2],t[4]):null;if(null===t)throw new Error("Malformed timestamp: "+e);return n=n.replace(/^[^\sa-zA-Z-]+/,""),t}function f(){n=n.replace(/^\s+/,"")}var u,r,e=n;if(f(),t.startTime=o(),f(),"-->"!==n.substr(0,3))throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+e);n=n.substr(3);f();t.endTime=o();f();u=n;t=t;r=new bu;ku(u,function(n,t){var f,u,e;switch(n){case"region":for(f=i.length-1;0<=f;f--)if(i[f].id===t){r.set(n,i[f].region);break}break;case"vertical":r.alt(n,t,["rl","lr"]);break;case"line":u=t.split(",");e=u[0];r.integer(n,e);r.percent(n,e)&&r.set("snapToLines",!1);r.alt(n,e,["auto"]);2===u.length&&r.alt("lineAlign",u[1],["start",lt,"end"]);break;case"position":u=t.split(",");r.percent(n,u[0]);2===u.length&&r.alt("positionAlign",u[1],["start",lt,"end","line-left","line-right","auto"]);break;case"size":r.percent(n,t);break;case"align":r.alt(n,t,["start",lt,"end","left","right"])}},/:/,/\s/);t.region=r.get("region",null);t.vertical=r.get("vertical","");"auto"===(u=r.get("line","auto"))&&-1===gt.line&&(u=-1);t.line=u;t.lineAlign=r.get("lineAlign","start");t.snapToLines=r.get("snapToLines",!0);t.size=r.get("size",100);t.align=r.get("align",lt);"auto"===(u=r.get("position","auto"))&&50===gt.position&&(u="start"===t.align||"left"===t.align?0:"end"===t.align||"right"===t.align?100:50);t.position=u}function du(n){return n.replace(/<br(?: \/)?>/gi,"\n")}function be(n,t,i,r){for(var e,o,h,f,c,s,l=window.VTTCue||TextTrackCue,u=0;u<r.rows.length;u++)if(h=!0,f=0,c="",!(e=r.rows[u]).isEmpty()){for(s=0;s<e.chars.length;s++)e.chars[s].uchar.match(/\s/)&&h?f++:(c+=e.chars[s].uchar,h=!1);(e.cueStartTime=t)===i&&(i+=.0001);o=new l(t,i,du(c.trim()));16<=f?f--:f++;o.line=navigator.userAgent.match(/Firefox\//)?u+1:7<u?u-2:u+1;o.align="left";o.position=Math.max(0,Math.min(100,f/32*100));n.addCue(o)}}function nf(n){var t=n;return tf.hasOwnProperty(n)&&(t=tf[n]),String.fromCharCode(t)}function nt(n){for(var i=[],t=0;t<n.length;t++)i.push(n[t].toString(16));return i}function vi(n,t,i){return n.substr(i||0,t.length)===t}function yi(n){for(var t=5381,i=n.length;i;)t=33*t^n.charCodeAt(--i);return(t>>>0).toString()}function ef(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function of(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function wi(n){for(var r,i=[],t=0;t<n.length;t++)r=n[t],"subtitles"===r.kind&&r.label&&i.push(n[t]);return i}function hf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function so(n){for(var i,r,t=1;t<arguments.length;t++)i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i),(r="function"==typeof Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(i).filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})):r).forEach(function(t){var r,u;r=n;u=i[t=t];t in r?Object.defineProperty(r,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[t]=u});return n}function l(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function lf(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function af(n,t,i){return t&&lf(n.prototype,t),i&&lf(n,i),n}var b,ti,ft,si,nu,uu,eu,ou,dt,gt,lt,gu,tt,cf,ki;i.r(t);var c,it,ni={},at=(i.r(ni),i.d(ni,"newCue",function(){return be}),i("./node_modules/url-toolkit/src/url-toolkit.js")),f=i("./src/errors.ts"),e=i("./src/polyfills/number-isFinite.js"),u=i("./src/events.js"),r=i("./src/utils/logger.js"),vf={hlsEventGeneric:!0,hlsHandlerDestroying:!0,hlsHandlerDestroyed:!0},h=function(){function t(n){this.hls=void 0;this.handledEvents=void 0;this.useGenericHandler=void 0;this.hls=n;this.onEvent=this.onEvent.bind(this);for(var i=arguments.length,r=new Array(1<i?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];this.handledEvents=r;this.useGenericHandler=!0;this.registerListeners()}var n=t.prototype;return n.destroy=function(){this.onHandlerDestroying();this.unregisterListeners();this.onHandlerDestroyed()},n.onHandlerDestroying=function(){},n.onHandlerDestroyed=function(){},n.isEventHandler=function(){return"object"==typeof this.handledEvents&&this.handledEvents.length&&"function"==typeof this.onEvent},n.registerListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(n){if(vf[n])throw new Error("Forbidden event-name: "+n);this.hls.on(n,this.onEvent)},this)},n.unregisterListeners=function(){this.isEventHandler()&&this.handledEvents.forEach(function(n){this.hls.off(n,this.onEvent)},this)},n.onEvent=function(n,t){this.onEventGeneric(n,t)},n.onEventGeneric=function(n,t){try{!function(n,t){var i="on"+n.replace("hls","");if("function"!=typeof this[i])throw new Error("Event "+n+" has no generic handler in this "+this.constructor.name+" class (tried "+i+")");return this[i].bind(this,t)}.call(this,n,t).call()}catch(t){r.logger.error("An internal error happened while handling event "+n+'. Error message: "'+t.message+'". Here is a stacktrace:',t);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:n,err:t})}},t}(),yf=((v=c=c||{}).MANIFEST="manifest",v.LEVEL="level",v.AUDIO_TRACK="audioTrack",v.SUBTITLE_TRACK="subtitleTrack",(v=it=it||{}).MAIN="main",v.AUDIO="audio",v.SUBTITLE="subtitle",i("./src/demux/mp4demuxer.js"));ti=function(){function t(n,t){this._uri=null;this.baseuri=void 0;this.reluri=void 0;this.method=null;this.key=null;this.iv=null;this.baseuri=n;this.reluri=t}var n,i,r;return n=t,(i=[{key:"uri",get:function(){return!this._uri&&this.reluri&&(this._uri=Object(at.buildAbsoluteURL)(this.baseuri,this.reluri,{alwaysNormalize:!0})),this._uri}}])&&di(n.prototype,i),r&&di(n,r),t}();(v=b=b||{}).AUDIO="audio";v.VIDEO="video";ft=function(){function t(){var n;this._url=null;this._byteRange=null;this._decryptdata=null;this._elementaryStreams=((n={})[b.AUDIO]=!1,n[b.VIDEO]=!1,n);this.deltaPTS=0;this.rawProgramDateTime=null;this.programDateTime=null;this.title=null;this.tagList=[];this.cc=void 0;this.type=void 0;this.relurl=void 0;this.baseurl=void 0;this.duration=void 0;this.start=void 0;this.sn=0;this.urlId=0;this.level=0;this.levelkey=void 0;this.loader=void 0}var i,u,n=t.prototype;return n.setByteRange=function(n,t){var n=n.split("@",2),i=[];i[0]=1===n.length?t?t.byteRangeEndOffset:0:parseInt(n[1]);i[1]=parseInt(n[0])+i[0];this._byteRange=i},n.addElementaryStream=function(n){this._elementaryStreams[n]=!0},n.hasElementaryStream=function(n){return!0===this._elementaryStreams[n]},n.createInitializationVector=function(n){for(var i=new Uint8Array(16),t=12;t<16;t++)i[t]=n>>8*(15-t)&255;return i},n.setDecryptDataFromLevelKey=function(n,t){var i=n;return n&&n.method&&n.uri&&!n.iv&&((i=new ti(n.baseuri,n.reluri)).method=n.method,i.iv=this.createInitializationVector(t)),i},n=t,(i=[{key:"url",get:function(){return!this._url&&this.relurl&&(this._url=Object(at.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url},set:function(n){this._url=n}},{key:"byteRange",get:function(){return this._byteRange||[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"decryptdata",get:function(){return this.levelkey||this._decryptdata?(!this._decryptdata&&this.levelkey&&("number"!=typeof(n=this.sn)&&(this.levelkey&&"AES-128"===this.levelkey.method&&!this.levelkey.iv&&r.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),n=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,n)),this._decryptdata):null;var n}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime||!Object(e.isFiniteNumber)(this.programDateTime))return null;var n=Object(e.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*n}},{key:"encrypted",get:function(){return!(!this.decryptdata||null===this.decryptdata.uri||null!==this.decryptdata.key)}}])&&gi(n.prototype,i),u&&gi(n,u),t}();var pf=function(){function t(n){this.endCC=0;this.endSN=0;this.fragments=[];this.initSegment=null;this.live=!0;this.needSidxRanges=!1;this.startCC=0;this.startSN=0;this.startTimeOffset=null;this.targetduration=0;this.totalduration=0;this.type=null;this.url=n;this.version=null}var n,i,r;return n=t,(i=[{key:"hasProgramDateTime",get:function(){return!(!this.fragments[0]||!Object(e.isFiniteNumber)(this.fragments[0].programDateTime))}}])&&nr(n.prototype,i),r&&nr(n,r),t}(),wf=/^(\d+)x(\d+)$/,tr=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,et=function(){function t(n){for(var i in n="string"==typeof n?t.parseAttrList(n):n)n.hasOwnProperty(i)&&(this[i]=n[i])}var n=t.prototype;return n.decimalInteger=function(n){return n=parseInt(this[n],10),n>Number.MAX_SAFE_INTEGER?1/0:n},n.hexadecimalInteger=function(n){if(this[n]){for(var t=(1&(t=(this[n]||"0x").slice(2)).length?"0":"")+t,r=new Uint8Array(t.length/2),i=0;i<t.length/2;i++)r[i]=parseInt(t.slice(2*i,2*i+2),16);return r}return null},n.hexadecimalIntegerAsNumber=function(n){return n=parseInt(this[n],16),n>Number.MAX_SAFE_INTEGER?1/0:n},n.decimalFloatingPoint=function(n){return parseFloat(this[n])},n.enumeratedString=function(n){return this[n]},n.decimalResolution=function(n){return n=wf.exec(this[n]),null!==n?{width:parseInt(n[1],10),height:parseInt(n[2],10)}:void 0},t.parseAttrList=function(n){var i,r={},t;for(tr.lastIndex=0;null!==(i=tr.exec(n));)t=i[2],0===t.indexOf('"')&&t.lastIndexOf('"')===t.length-1&&(t=t.slice(1,-1)),r[i[1]]=t;return r},t}(),bf={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0}};var ir=/#EXT-X-STREAM-INF:([^\n\r]*)[\r\n]+([^\r\n]+)/g,rr=/#EXT-X-MEDIA:(.*)/g,ur=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/|(?!#)([\S+ ?]+)/.source,/|#EXT-X-BYTERANGE:*(.+)/.source,/|#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/|#.*/.source].join(""),"g"),kf=/(?:(?:#(EXTM3U))|(?:#EXT-X-(PLAYLIST-TYPE):(.+))|(?:#EXT-X-(MEDIA-SEQUENCE): *(\d+))|(?:#EXT-X-(TARGETDURATION): *(\d+))|(?:#EXT-X-(KEY):(.+))|(?:#EXT-X-(START):(.+))|(?:#EXT-X-(ENDLIST))|(?:#EXT-X-(DISCONTINUITY-SEQ)UENCE:(\d+))|(?:#EXT-X-(DIS)CONTINUITY))|(?:#EXT-X-(VERSION):(\d+))|(?:#EXT-X-(MAP):(.+))|(?:(#)([^:]*):(.*))|(?:(#)(.*))(?:.*)\r?\n?/,df=/\.(mp4|m4s|m4v|m4a)$/i,vt=function(){function n(){}return n.findGroup=function(n,t){for(var r,i=0;i<n.length;i++)if(r=n[i],r.id===t)return r},n.convertAVC1ToAVCOTI=function(n){var t=n.split("."),i=2<t.length?(i=t.shift()+".",(i+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).substr(-4)):n;return i},n.resolve=function(n,t){return at.buildAbsoluteURL(t,n,{alwaysNormalize:!0})},n.parseMasterPlaylist=function(t,i){function o(n,t){["video","audio"].forEach(function(i){var u,r=n.filter(function(n){return n=n,!!(t=bf[t=i])&&!0===t[n.slice(0,4)];var t});r.length&&(u=r.filter(function(n){return 0===n.lastIndexOf("avc1",0)||0===n.lastIndexOf("mp4a",0)}),t[i+"Codec"]=(0<u.length?u:r)[0],n=n.filter(function(n){return-1===r.indexOf(n)}))});t.unknownCodecs=n}var e=[];for(ir.lastIndex=0;null!=(u=ir.exec(t));){var r={},f=r.attrs=new et(u[1]),u=(r.url=n.resolve(u[2],i),f.decimalResolution("RESOLUTION"));u&&(r.width=u.width,r.height=u.height);r.bitrate=f.decimalInteger("AVERAGE-BANDWIDTH")||f.decimalInteger("BANDWIDTH");r.name=f.NAME;o([].concat((f.CODECS||"").split(/[ ,]+/)),r);r.videoCodec&&-1!==r.videoCodec.indexOf("avc1")&&(r.videoCodec=n.convertAVC1ToAVCOTI(r.videoCodec));e.push(r)}return e},n.parseMasterPlaylistMedia=function(t,i,r,u){var o,s,e,f;for(void 0===u&&(u=[]),o=[],s=0,rr.lastIndex=0;null!==(f=rr.exec(t));)f=new et(f[1]),f.TYPE===r&&(e={id:s++,groupId:f["GROUP-ID"],name:f.NAME||f.LANGUAGE,type:r,"default":"YES"===f.DEFAULT,autoselect:"YES"===f.AUTOSELECT,forced:"YES"===f.FORCED,lang:f.LANGUAGE},f.URI&&(e.url=n.resolve(f.URI,i)),u.length&&(f=n.findGroup(u,e.groupId),e.audioCodec=(f||u[0]).codec),o.push(e));return o},n.parseLevelPlaylist=function(n,t,i,u,f){var h,v,p,rt=0,b=0,s=new pf(t),g=0,k=null,o=new ft,nt=null,c,w,a,l,ut,it;for(ur.lastIndex=0;null!==(h=ur.exec(n));)if(c=h[1],c)o.duration=parseFloat(c),w=(" "+h[2]).slice(1),o.title=w||null,o.tagList.push(w?["INF",c,w]:["INF",c]);else if(h[3])Object(e.isFiniteNumber)(o.duration)&&(w=rt++,o.type=u,o.start=b,p&&(o.levelkey=p),o.sn=w,o.level=i,o.cc=g,o.urlId=f,o.baseurl=t,o.relurl=(" "+h[3]).slice(1),a=c=void 0,a=k,(c=o).rawProgramDateTime?c.programDateTime=Date.parse(c.rawProgramDateTime):a&&a.programDateTime&&(c.programDateTime=a.endProgramDateTime),Object(e.isFiniteNumber)(c.programDateTime)||(c.programDateTime=null,c.rawProgramDateTime=null),s.fragments.push(o),b+=(k=o).duration,o=new ft);else if(h[4])a=(" "+h[4]).slice(1),k?o.setByteRange(a,k):o.setByteRange(a);else if(h[5])o.rawProgramDateTime=(" "+h[5]).slice(1),o.tagList.push(["PROGRAM-DATE-TIME",o.rawProgramDateTime]),null===nt&&(nt=s.fragments.length);else if(h=h[0].match(kf)){for(v=1;v<h.length&&void 0===h[v];v++);l=(" "+h[v+1]).slice(1);ut=(" "+h[v+2]).slice(1);switch(h[v]){case"#":o.tagList.push(ut?[l,ut]:[l]);break;case"PLAYLIST-TYPE":s.type=l.toUpperCase();break;case"MEDIA-SEQUENCE":rt=s.startSN=parseInt(l);break;case"TARGETDURATION":s.targetduration=parseFloat(l);break;case"VERSION":s.version=parseInt(l);break;case"EXTM3U":break;case"ENDLIST":s.live=!1;break;case"DIS":g++;o.tagList.push(["DIS"]);break;case"DISCONTINUITY-SEQ":g=parseInt(l);break;case"KEY":var tt=new et(l),y=tt.enumeratedString("METHOD"),d=tt.URI,tt=tt.hexadecimalInteger("IV");y&&(p=new ti(t,d),d&&0<=["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(y)&&(p.method=y,p.key=null,p.iv=tt));break;case"START":d=new et(l).decimalFloatingPoint("TIME-OFFSET");Object(e.isFiniteNumber)(d)&&(s.startTimeOffset=d);break;case"MAP":y=new et(l);o.relurl=y.URI;y.BYTERANGE&&o.setByteRange(y.BYTERANGE);o.baseurl=t;o.level=i;o.type=u;o.sn="initSegment";s.initSegment=o;(o=new ft).rawProgramDateTime=s.initSegment.rawProgramDateTime;break;default:r.logger.warn("line parsed but not handled: "+h)}}else r.logger.warn("No matches on slow regex match for level playlist!");if((o=k)&&!o.relurl&&(s.fragments.pop(),b-=o.duration),s.totalduration=b,s.averagetargetduration=b/s.fragments.length,s.endSN=rt-1,s.startCC=s.fragments[0]?s.fragments[0].cc:0,s.endCC=g,!s.initSegment&&s.fragments.length&&s.fragments.every(function(n){return df.test(n.relurl)})&&(r.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),(o=new ft).relurl=s.fragments[0].relurl,o.baseurl=t,o.level=i,o.type=u,o.sn="initSegment",s.initSegment=o,s.needSidxRanges=!0),nt)for(var st=s.fragments,ht=nt,ct=st[ht],ot=ht-1;0<=ot;ot--)it=st[ot],it.programDateTime=ct.programDateTime-1e3*it.duration,ct=it;return s},n}(),fr=window.performance,gf=function(n){function i(t){return t=n.call(this,t,u.default.MANIFEST_LOADING,u.default.LEVEL_LOADING,u.default.AUDIO_TRACK_LOADING,u.default.SUBTITLE_TRACK_LOADING)||this,t.loaders={},t}var o,t;return o=n,(t=i).prototype=Object.create(o.prototype),(t.prototype.constructor=t).__proto__=o,i.canHaveQualityLevels=function(n){return n!==c.AUDIO_TRACK&&n!==c.SUBTITLE_TRACK},i.mapContextToLevelType=function(n){switch(n.type){case c.AUDIO_TRACK:return it.AUDIO;case c.SUBTITLE_TRACK:return it.SUBTITLE;default:return it.MAIN}},i.getResponseUrl=function(n,t){return n=n.url,void 0===n||0===n.indexOf("data:")?t.url:n},t=i.prototype,t.createInternalLoader=function(n){var t=this.hls.config,i=t.pLoader,r=t.loader,i=new(i||r)(t);return n.loader=i,this.loaders[n.type]=i},t.getInternalLoader=function(n){return this.loaders[n.type]},t.resetInternalLoader=function(n){this.loaders[n]&&delete this.loaders[n]},t.destroyInternalLoaders=function(){var n,t;for(n in this.loaders)t=this.loaders[n],t&&t.destroy(),this.resetInternalLoader(n)},t.destroy=function(){this.destroyInternalLoaders();n.prototype.destroy.call(this)},t.onManifestLoading=function(n){this.load({url:n.url,type:c.MANIFEST,level:0,id:null,responseType:"text"})},t.onLevelLoading=function(n){this.load({url:n.url,type:c.LEVEL,level:n.level,id:n.id,responseType:"text"})},t.onAudioTrackLoading=function(n){this.load({url:n.url,type:c.AUDIO_TRACK,level:null,id:n.id,responseType:"text"})},t.onSubtitleTrackLoading=function(n){this.load({url:n.url,type:c.SUBTITLE_TRACK,level:null,id:n.id,responseType:"text"})},t.load=function(n){var i,u,f,e,t=this.hls.config,o;if(r.logger.debug("Loading playlist of type "+n.type+", level: "+n.level+", id: "+n.id),s=this.getInternalLoader(n)){if(o=s.context,o&&o.url===n.url)return r.logger.trace("playlist request ongoing"),!1;r.logger.warn("aborting previous loader for type: "+n.type);s.abort()}switch(n.type){case c.MANIFEST:i=t.manifestLoadingMaxRetry;u=t.manifestLoadingTimeOut;f=t.manifestLoadingRetryDelay;e=t.manifestLoadingMaxRetryTimeout;break;case c.LEVEL:f=e=i=0;u=t.levelLoadingTimeOut;break;default:i=t.levelLoadingMaxRetry;u=t.levelLoadingTimeOut;f=t.levelLoadingRetryDelay;e=t.levelLoadingMaxRetryTimeout}var s=this.createInternalLoader(n),o={timeout:u,maxRetry:i,retryDelay:f,maxRetryDelay:e},h={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};return r.logger.debug("Calling internal loader delegate for URL: "+n.url),s.load(n,o,h),!0},t.loadsuccess=function(n,t,i,r){if(void 0===r&&(r=null),i.isSidxRequest)return this._handleSidxRequest(n,i),void this._handlePlaylistLoaded(n,t,i,r);if(this.resetInternalLoader(i.type),"string"!=typeof n.data)throw new Error('expected responseType of "text" for PlaylistLoader');var u=n.data;t.tload=fr.now();0===u.indexOf("#EXTM3U")?0<u.indexOf("#EXTINF:")||0<u.indexOf("#EXT-X-TARGETDURATION:")?this._handleTrackOrLevelPlaylist(n,t,i,r):this._handleMasterPlaylist(n,t,i,r):this._handleManifestParsingError(n,i,"no EXTM3U delimiter",r)},t.loaderror=function(n,t,i){this._handleNetworkError(t,i=void 0===i?null:i,!1,n)},t.loadtimeout=function(n,t,i){this._handleNetworkError(t,i=void 0===i?null:i,!0)},t._handleMasterPlaylist=function(n,t,f,e){var o,l,a=this.hls,s=n.data,c=i.getResponseUrl(n,f),h=vt.parseMasterPlaylist(s,c);h.length?(o=h.map(function(n){return{id:n.attrs.AUDIO,codec:n.audioCodec}}),o=vt.parseMasterPlaylistMedia(s,c,"AUDIO",o),s=vt.parseMasterPlaylistMedia(s,c,"SUBTITLES"),o.length&&(l=!1,o.forEach(function(n){n.url||(l=!0)}),!1===l&&h[0].audioCodec&&!h[0].attrs.AUDIO&&(r.logger.log("audio codec signaled in quality level, but no embedded audio track signaled, create one"),o.unshift({type:"main",name:"main","default":!1,autoselect:!1,forced:!1,id:-1}))),a.trigger(u.default.MANIFEST_LOADED,{levels:h,audioTracks:o,subtitles:s,url:c,stats:t,networkDetails:e})):this._handleManifestParsingError(n,f,"no level found in manifest",e)},t._handleTrackOrLevelPlaylist=function(n,t,r,f){var p=this.hls,s=r.id,h=r.level,v=r.type,l=i.getResponseUrl(n,r),y=Object(e.isFiniteNumber)(s)?s:0,o=Object(e.isFiniteNumber)(h)?h:y,a=i.mapContextToLevelType(r),o=vt.parseLevelPlaylist(n.data,l,o,a,y);if(o.tload=t.tload,v===c.MANIFEST&&p.trigger(u.default.MANIFEST_LOADED,{levels:[{url:l,details:o}],audioTracks:[],url:l,stats:t,networkDetails:f}),t.tparsed=fr.now(),o.needSidxRanges)return a=o.initSegment.url,void this.load({url:a,isSidxRequest:!0,type:v,level:h,levelDetails:o,id:s,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer"});r.levelDetails=o;this._handlePlaylistLoaded(n,t,r,f)},t._handleSidxRequest=function(n,t){if("string"==typeof n.data)throw new Error("sidx request must be made with responseType of array buffer");var r,i,n=yf.default.parseSegmentIndex(new Uint8Array(n.data));n&&(r=n.references,i=t.levelDetails,r.forEach(function(n,t){n=n.info;i&&0===(t=i.fragments[t]).byteRange.length&&t.setByteRange(String(1+n.end-n.start)+"@"+String(n.start))}),i&&i.initSegment.setByteRange(String(n.moovEndOffset)+"@0"))},t._handleManifestParsingError=function(n,t,i,r){this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:!0,url:n.url,reason:i,networkDetails:r})},t._handleNetworkError=function(n,t,i,e){void 0===i&&(i=!1);void 0===e&&(e=null);r.logger.info("A network error occured while loading a "+n.type+"-type playlist");var h,s,o=this.getInternalLoader(n);switch(n.type){case c.MANIFEST:h=i?f.ErrorDetails.MANIFEST_LOAD_TIMEOUT:f.ErrorDetails.MANIFEST_LOAD_ERROR;s=!0;break;case c.LEVEL:h=i?f.ErrorDetails.LEVEL_LOAD_TIMEOUT:f.ErrorDetails.LEVEL_LOAD_ERROR;s=!1;break;case c.AUDIO_TRACK:h=i?f.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR;s=!1;break;default:s=!1}o&&(o.abort(),this.resetInternalLoader(n.type));o={type:f.ErrorTypes.NETWORK_ERROR,details:h,fatal:s,url:n.url,loader:o,context:n,networkDetails:t};e&&(o.response=e);this.hls.trigger(u.default.ERROR,o)},t._handlePlaylistLoaded=function(n,t,r,f){var s=r.type,h=r.level,o=r.id,e=r.levelDetails;if(e&&e.targetduration)if(i.canHaveQualityLevels(r.type))this.hls.trigger(u.default.LEVEL_LOADED,{details:e,level:h||0,id:o||0,stats:t,networkDetails:f});else switch(s){case c.AUDIO_TRACK:this.hls.trigger(u.default.AUDIO_TRACK_LOADED,{details:e,id:o,stats:t,networkDetails:f});break;case c.SUBTITLE_TRACK:this.hls.trigger(u.default.SUBTITLE_TRACK_LOADED,{details:e,id:o,stats:t,networkDetails:f})}else this._handleManifestParsingError(n,r,"invalid target duration",f)},i}(h),ne=function(n){function o(t){return t=n.call(this,t,u.default.FRAG_LOADING)||this,t.loaders={},t}var i,t;return i=n,(t=o).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=o.prototype,t.destroy=function(){var i,r=this.loaders,t;for(i in r)t=r[i],t&&t.destroy();this.loaders={};n.prototype.destroy.call(this)},t.onFragLoading=function(n){var n=n.frag,u=n.type,t=this.loaders,i=this.hls.config,o=i.fLoader,s=i.loader,f=(n.loaded=0,t[u]),u=(f&&(r.logger.warn("abort previous fragment loader for type: "+u),f.abort()),f=t[u]=n.loader=new(i.fLoader?o:s)(i),t={url:n.url,frag:n,responseType:"arraybuffer",progressData:!1},n.byteRangeStartOffset),o=n.byteRangeEndOffset;Object(e.isFiniteNumber)(u)&&Object(e.isFiniteNumber)(o)&&(t.rangeStart=u,t.rangeEnd=o);s={timeout:i.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:i.fragLoadingMaxRetryTimeout};n={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this),onProgress:this.loadprogress.bind(this)};f.load(t,s,n)},t.loadsuccess=function(n,t,i,r){void 0===r&&(r=null);n=n.data;i=i.frag;i.loader=void 0;this.loaders[i.type]=void 0;this.hls.trigger(u.default.FRAG_LOADED,{payload:n,frag:i,stats:t,networkDetails:r})},t.loaderror=function(n,t,i){void 0===i&&(i=null);var r=t.frag,e=r.loader;e&&e.abort();this.loaders[r.type]=void 0;this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t.frag,response:n,networkDetails:i})},t.loadtimeout=function(n,t,i){void 0===i&&(i=null);var r=t.frag,e=r.loader;e&&e.abort();this.loaders[r.type]=void 0;this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t.frag,networkDetails:i})},t.loadprogress=function(n,t,i,r){void 0===r&&(r=null);t=t.frag;t.loaded=n.loaded;this.hls.trigger(u.default.FRAG_LOAD_PROGRESS,{frag:t,stats:n,networkDetails:r})},o}(h),te=function(n){function e(t){return t=n.call(this,t,u.default.KEY_LOADING)||this,t.loaders={},t.decryptkey=null,t.decrypturl=null,t}var i,t;return i=n,(t=e).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=e.prototype,t.destroy=function(){for(var t in this.loaders)t=this.loaders[t],t&&t.destroy();this.loaders={};n.prototype.destroy.call(this)},t.onKeyLoading=function(n){var t,i,n=n.frag,f=n.type,e=this.loaders[f];n.decryptdata?(i=n.decryptdata.uri)!==this.decrypturl||null===this.decryptkey?(t=this.hls.config,e&&(r.logger.warn("abort previous key loader for type:"+f),e.abort()),i?(n.loader=this.loaders[f]=new t.loader(t),this.decrypturl=i,this.decryptkey=null,e={url:i,frag:n,responseType:"arraybuffer"},f={timeout:t.fragLoadingTimeOut,maxRetry:0,retryDelay:t.fragLoadingRetryDelay,maxRetryDelay:t.fragLoadingMaxRetryTimeout},i={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)},n.loader.load(e,f,i)):r.logger.warn("key uri is falsy")):this.decryptkey&&(n.decryptdata.key=this.decryptkey,this.hls.trigger(u.default.KEY_LOADED,{frag:n})):r.logger.warn("Missing decryption data on fragment in onKeyLoading")},t.loadsuccess=function(n,t,i){i=i.frag;i.decryptdata?(this.decryptkey=i.decryptdata.key=new Uint8Array(n.data),i.loader=void 0,delete this.loaders[i.type],this.hls.trigger(u.default.KEY_LOADED,{frag:i})):r.logger.error("after key load, decryptdata unset")},t.loaderror=function(n,t){var t=t.frag,i=t.loader;i&&i.abort();delete this.loaders[t.type];this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:t,response:n})},t.loadtimeout=function(n,t){var t=t.frag,i=t.loader;i&&i.abort();delete this.loaders[t.type];this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.NETWORK_ERROR,details:f.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:t})},e}(h),yt="NOT_LOADED",er="APPENDING",ri="PARTIAL",or="OK",ie=function(n){function r(t){var i=n.call(this,t,u.default.BUFFER_APPENDED,u.default.FRAG_BUFFERED,u.default.FRAG_LOADED)||this;return i.bufferPadding=.2,i.fragments=Object.create(null),i.timeRanges=Object.create(null),i.config=t.config,i}var i,t;return i=n,(t=r).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=r.prototype,t.destroy=function(){this.fragments=Object.create(null);this.timeRanges=Object.create(null);this.config=null;h.prototype.destroy.call(this);n.prototype.destroy.call(this)},t.getBufferedFrag=function(n,t){var r=this.fragments,i=Object.keys(r).filter(function(i){return(i=r[i],i.body.type!==t)?!1:i.buffered?(i=i.body,i.startPTS<=n&&n<=i.endPTS):!1});return 0===i.length?null:(i=i.pop(),r[i].body)},t.detectEvictedFragments=function(n,t){var i,r,u=this;Object.keys(this.fragments).forEach(function(f){var o=u.fragments[f],e;if(!0===o.buffered&&(f=o.range[n],f))for(i=f.time,e=0;e<i.length;e++)if(r=i[e],!1===u.isTimeBuffered(r.startPTS,r.endPTS,t)){u.removeFragment(o.body);break}})},t.detectPartialFragments=function(n){var i=this,r=this.getFragmentKey(n),t=this.fragments[r];t&&(t.buffered=!0,Object.keys(this.timeRanges).forEach(function(r){var u;n.hasElementaryStream(r)&&(u=i.timeRanges[r],t.range[r]=i.getBufferedTimes(n.startPTS,n.endPTS,u))}))},t.getBufferedTimes=function(n,t,i){for(var u,f,e=[],o=!1,r=0;r<i.length;r++){if(u=i.start(r)-this.bufferPadding,f=i.end(r)+this.bufferPadding,u<=n&&t<=f){e.push({startPTS:Math.max(n,i.start(r)),endPTS:Math.min(t,i.end(r))});break}if(n<f&&u<t)e.push({startPTS:Math.max(n,i.start(r)),endPTS:Math.min(t,i.end(r))}),o=!0;else if(t<=u)break}return{time:e,partial:o}},t.getFragmentKey=function(n){return n.type+"_"+n.level+"_"+n.urlId+"_"+n.sn},t.getPartialFragment=function(n){var t,r,i=this,u=null,f=0;return Object.keys(this.fragments).forEach(function(e){e=i.fragments[e];i.isPartial(e)&&(t=e.body.startPTS-i.bufferPadding,r=e.body.endPTS+i.bufferPadding,t<=n&&n<=r&&(t=Math.min(n-t,r-n),f<=t&&(u=e.body,f=t)))}),u},t.getState=function(n){var n=this.getFragmentKey(n),n=this.fragments[n],t=yt;return void 0!==n?n.buffered?!0===this.isPartial(n)?ri:or:er:t},t.isPartial=function(n){return!0===n.buffered&&(void 0!==n.range.video&&!0===n.range.video.partial||void 0!==n.range.audio&&!0===n.range.audio.partial)},t.isTimeBuffered=function(n,t,i){for(var u,f,r=0;r<i.length;r++){if(u=i.start(r)-this.bufferPadding,f=i.end(r)+this.bufferPadding,u<=n&&t<=f)return!0;if(t<=u)return!1}return!1},t.onFragLoaded=function(n){n=n.frag;Object(e.isFiniteNumber)(n.sn)&&!n.bitrateTest&&(this.fragments[this.getFragmentKey(n)]={body:n,range:Object.create(null),buffered:!1})},t.onBufferAppended=function(n){var t=this;this.timeRanges=n.timeRanges;Object.keys(this.timeRanges).forEach(function(n){var i=t.timeRanges[n];t.detectEvictedFragments(n,i)})},t.onFragBuffered=function(n){this.detectPartialFragments(n.frag)},t.hasFragment=function(n){return n=this.getFragmentKey(n),void 0!==this.fragments[n]},t.removeFragment=function(n){n=this.getFragmentKey(n);delete this.fragments[n]},t.removeAllFragments=function(){this.fragments=Object.create(null)},r}(h),pt={search:function(n,t){for(var u,e,f,i=0,r=n.length-1;i<=r;)if(f=t(e=n[u=(i+r)/2|0]),0<f)i=1+u;else{if(!(f<0))return e;r=u-1}return null}},a=function(){function n(){}return n.isBuffered=function(n,t){try{if(n)for(var r=n.buffered,i=0;i<r.length;i++)if(t>=r.start(i)&&t<=r.end(i))return!0}catch(n){}return!1},n.bufferInfo=function(n,t,i){try{if(n){for(var u=n.buffered,f=[],r=0;r<u.length;r++)f.push({start:u.start(r),end:u.end(r)});return this.bufferedInfo(f,t,i)}}catch(n){}return{len:0,start:t,end:t,nextStart:void 0}},n.bufferedInfo=function(n,t,i){var r,u,s,e,f,h;if(n.sort(function(n,t){var i=n.start-t.start;return i||t.end-n.end}),r=[],i)for(u=0;u<n.length;u++)e=r.length,e?(s=r[e-1].end,n[u].start-s<i?n[u].end>s&&(r[e-1].end=n[u].end):r.push(n[u])):r.push(n[u]);else r=n;for(var c,l=0,a=t,v=t,o=0;o<r.length;o++)if(f=r[o].start,h=r[o].end,f<=t+i&&t<h)a=f,l=(v=h)-t;else if(t+i<f){c=f;break}return{len:l,start:a,end:v,nextStart:c}},n}(),v=i("./node_modules/eventemitter3/index.js"),re=i("./node_modules/webworkify-webpack/index.js"),sr=i("./src/demux/demuxer-inline.js");var ot=i("./src/utils/get-self-scope.js"),hr=function(n){function r(){return n.apply(this,arguments)||this}var t,i;return i=n,(t=r).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,r.prototype.trigger=function(n){for(var i=arguments.length,r=new Array(1<i?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];this.emit.apply(this,[n,n].concat(r))},r}(v.EventEmitter),cr=Object(ot.getSelfScope)(),fi=ui()||{isTypeSupported:function(){return!1}},ei=function(){function t(n,t){function e(t,i){(i=i||{}).frag=l.frag;i.id=l.id;n.trigger(t,i)}var o,l=this,i=(this.hls=n,this.id=t,this.observer=new hr),s=n.config,h=(i.on(u.default.FRAG_DECRYPTED,e),i.on(u.default.FRAG_PARSING_INIT_SEGMENT,e),i.on(u.default.FRAG_PARSING_DATA,e),i.on(u.default.FRAG_PARSED,e),i.on(u.default.ERROR,e),i.on(u.default.FRAG_PARSING_METADATA,e),i.on(u.default.FRAG_PARSING_USERDATA,e),i.on(u.default.INIT_PTS_FOUND,e),{mp4:fi.isTypeSupported("video/mp4"),mpeg:fi.isTypeSupported("audio/mpeg"),mp3:fi.isTypeSupported('audio/mp4; codecs="mp3"')}),c=navigator.vendor;if(s.enableWorker&&"undefined"!=typeof Worker){r.logger.log("demuxing in webworker");try{o=this.w=re("./src/demux/demuxer-worker.js");this.onwmsg=this.onWorkerMessage.bind(this);o.addEventListener("message",this.onwmsg);o.onerror=function(t){n.trigger(u.default.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",err:{message:t.message+" ("+t.filename+":"+t.lineno+")"}})};o.postMessage({cmd:"init",typeSupported:h,vendor:c,id:t,config:JSON.stringify(s)})}catch(t){r.logger.warn("Error in worker:",t);r.logger.error("Error while initializing DemuxerWorker, fallback on DemuxerInline");o&&cr.URL.revokeObjectURL(o.objectURL);this.demuxer=new sr.default(i,h,s,c);this.w=void 0}}else this.demuxer=new sr.default(i,h,s,c)}var n=t.prototype;return n.destroy=function(){var n=this.w,n=(n?(n.removeEventListener("message",this.onwmsg),n.terminate(),this.w=null):(n=this.demuxer)&&(n.destroy(),this.demuxer=null),this.observer);n&&(n.removeAllListeners(),this.observer=null)},n.push=function(n,t,i,u,f,o,s,h){var v=this.w,y=Object(e.isFiniteNumber)(f.startPTS)?f.startPTS:f.start,p=f.decryptdata,c=this.frag,a=!(c&&f.cc===c.cc),l=!(c&&f.level===c.level),c=c&&f.sn===c.sn+1,c=!l&&c;a&&r.logger.log(this.id+":discontinuity detected");l&&r.logger.log(this.id+":switch detected");this.frag=f;v?v.postMessage({cmd:"demux",data:n,decryptdata:p,initSegment:t,audioCodec:i,videoCodec:u,timeOffset:y,discontinuity:a,trackSwitch:l,contiguous:c,duration:o,accurateTimeOffset:s,defaultInitPTS:h},n instanceof ArrayBuffer?[n]:[]):(f=this.demuxer)&&f.push(n,p,t,i,u,y,a,l,c,o,s,h)},n.onWorkerMessage=function(n){var t=n.data,i=this.hls;switch(t.event){case"init":cr.URL.revokeObjectURL(this.w.objectURL);break;case u.default.FRAG_PARSING_DATA:t.data.data1=new Uint8Array(t.data1);t.data2&&(t.data.data2=new Uint8Array(t.data2));default:t.data=t.data||{};t.data.frag=this.frag;t.data.id=this.id;i.trigger(t.event,t.data)}},t}();si={toString:function(n){for(var i="",r=n.length,t=0;t<r;t++)i+="["+n.start(t).toFixed(3)+","+n.end(t).toFixed(3)+"]";return i}};nu=function(){function t(n,t,i,r){this.config=n;this.media=t;this.fragmentTracker=i;this.hls=r;this.nudgeRetry=0;this.stallReported=!1;this.stalled=null;this.moved=!1;this.seeking=!1}var n=t.prototype;return n.poll=function(n){var s=this.config,u=this.media,f=this.stalled,e=u.currentTime,o=u.seeking,t=this.seeking&&!o,i=!this.seeking&&o;if(this.seeking=o,e!==n)return this.moved=!0,void(null!==f&&(this.stallReported&&(n=self.performance.now()-f,r.logger.warn("playback not stuck anymore @"+e+", after "+Math.round(n)+"ms"),this.stallReported=!1),this.stalled=null,this.nudgeRetry=0));if(((i||t)&&(this.stalled=null),!u.paused&&!u.ended&&0!==u.playbackRate&&u.buffered.length)&&(n=a.bufferInfo(u,e,0),i=0<n.len,t=n.nextStart||0,i||t)){if(o){if(2<n.len||!t||2<t-e)return;this.moved=!1}if(!this.moved&&this.stalled&&(i=Math.max(t,n.start||0)-e,0<i&&i<=2))return void this._trySkipBufferHole(null);t=self.performance.now();null!==f?(i=t-f,!o&&250<=i&&this._reportStall(n.len),f=a.bufferInfo(u,e,s.maxBufferHole),this._tryFixBufferStall(f,i)):this.stalled=t}},n._tryFixBufferStall=function(n,t){var u=this.config,i=this.fragmentTracker,f=this.media.currentTime,i=i.getPartialFragment(f);i&&this._trySkipBufferHole(i)||n.len>u.maxBufferHole&&t>1e3*u.highBufferWatchdogPeriod&&(r.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},n._reportStall=function(n){var t=this.hls,i=this.media;this.stallReported||(this.stallReported=!0,r.logger.warn("Playback stalling at @"+i.currentTime+" due to low buffer"),t.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:n}))},n._trySkipBufferHole=function(n){for(var t,h=this.config,c=this.hls,i=this.media,e=i.currentTime,s=0,o=0;o<i.buffered.length;o++){if(t=i.buffered.start(o),e+h.maxBufferHole>=s&&e<t)return t=Math.max(t+.05,i.currentTime+.1),r.logger.warn("skipping hole, adjusting currentTime from "+e+" to "+t),this.moved=!0,this.stalled=null,i.currentTime=t,n&&c.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+e+" to "+t,frag:n}),t;s=i.buffered.end(o)}return 0},n._tryNudgeBuffer=function(){var t=this.config,e=this.hls,o=this.media,i=o.currentTime,n=(this.nudgeRetry||0)+1;(this.nudgeRetry=n)<t.nudgeMaxRetry?(n=i+n*t.nudgeOffset,r.logger.warn("Nudging 'currentTime' from "+i+" to "+n),o.currentTime=n,e.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})):(r.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+t.nudgeMaxRetry+" nudges"),e.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0}))},t}();v=function(n){function r(t){for(var r=arguments.length,u=new Array(1<r?r-1:0),i=1;i<r;i++)u[i-1]=arguments[i];return(t=n.call.apply(n,[this,t].concat(u))||this)._boundTick=void 0,t._tickTimer=null,t._tickInterval=null,t._tickCallCount=0,t._boundTick=t.tick.bind(function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(t)),t}var i,t;return i=n,(t=r).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=r.prototype,t.onHandlerDestroying=function(){this.clearNextTick();this.clearInterval()},t.hasInterval=function(){return!!this._tickInterval},t.hasNextTick=function(){return!!this._tickTimer},t.setInterval=function(n){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,n),!0)},t.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),!(this._tickInterval=null))},t.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),!(this._tickTimer=null))},t.tick=function(){this._tickCallCount++;1===this._tickCallCount&&(this.doTick(),1<this._tickCallCount&&(this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)),this._tickCallCount=0)},t.doTick=function(){},r}(h);var k="STOPPED",tu="STARTING",s="IDLE",iu="PAUSED",rt="KEY_LOADING",d="FRAG_LOADING",wt="FRAG_LOADING_WAITING_RETRY",bt="WAITING_TRACK",y="PARSING",p="PARSED",st="BUFFER_FLUSHING",hi="ENDED",g="ERROR",ci="WAITING_INIT_PTS",kt="WAITING_LEVEL",ot=function(n){function u(){return n.apply(this,arguments)||this}var i,t;return i=n,(t=u).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=u.prototype,t.doTick=function(){},t.startLoad=function(){},t.stopLoad=function(){var n=this.fragCurrent;n&&(n.loader&&n.loader.abort(),this.fragmentTracker.removeFragment(n));this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);this.fragCurrent=null;this.fragPrevious=null;this.clearInterval();this.clearNextTick();this.state=k},t._streamEnded=function(n,t){var i=this.fragCurrent,r=this.fragmentTracker;return!(t.live||!i||i.backtracked||i.sn!==t.endSN||n.nextStart)&&((t=r.getState(i))===ri||t===or)},t.onMediaSeeking=function(){var n,o,i=this.config,u=this.media,f=this.mediaBuffer,h=this.state,t=u?u.currentTime:null,f=a.bufferInfo(f||u,t,this.config.maxBufferHole);Object(e.isFiniteNumber)(t)&&r.logger.log("media seeking to "+t.toFixed(3));h===d?(n=this.fragCurrent,0===f.len&&n&&(i=i.maxFragLookUpTolerance,o=n.start-i,i=n.start+n.duration+i,t<o||i<t?(n.loader&&(r.logger.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),n.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.state=s):r.logger.log("seeking outside of buffer but within currently loaded fragment range"))):h===hi&&(0===f.len&&(this.fragPrevious=null,this.fragCurrent=null),this.state=s);u&&(this.lastCurrentTime=t);this.loadedmetadata||(this.nextLoadPosition=this.startPosition=t);this.tick()},t.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},t.onHandlerDestroying=function(){this.stopLoad();n.prototype.onHandlerDestroying.call(this)},t.onHandlerDestroyed=function(){this.state=k;this.fragmentTracker=null},t.computeLivePosition=function(n,t){var i=void 0!==this.config.liveSyncDuration?this.config.liveSyncDuration:this.config.liveSyncDurationCount*t.targetduration;return n+Math.max(0,t.totalduration-i)},u}(v);uu=function(n){function o(t,i){var r=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.LEVEL_LOADED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_LOAD_EMERGENCY_ABORTED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_SWITCHED,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED)||this;return r.fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=k,r.stallReported=!1,r.gapController=null,r.altAudio=!1,r}i=n;(t=o).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,h,t=o.prototype;return t.startLoad=function(n){var t,i,u;this.levels?(t=this.lastCurrentTime,i=this.hls,this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,this.startFragRequested||(-1===(u=i.startLevel)&&(this.bitrateTest=!(u=0)),this.level=i.nextLoadLevel=u,this.loadedmetadata=!1),0<t&&-1===n&&(r.logger.log("override startPosition with lastCurrentTime @"+t.toFixed(3)),n=t),this.state=s,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()):(this.forceStartLoad=!0,this.state=k)},t.stopLoad=function(){this.forceStartLoad=!1;n.prototype.stopLoad.call(this)},t.doTick=function(){var n,t;switch(this.state){case st:this.fragLoadError=0;break;case s:this._doTickIdle();break;case kt:n=this.levels[this.level];n&&n.details&&(this.state=s);break;case wt:n=window.performance.now();t=this.retryDate;(!t||t<=n||this.media&&this.media.seeking)&&(r.logger.log("mediaController: retryDate reached, switch back to IDLE state"),this.state=s)}this._checkBuffer();this._checkFragmentChanged()},t._doTickIdle=function(){var f=this.hls,n=f.config,i=this.media;if(void 0!==this.levelLastLoaded&&(i||!this.startFragRequested&&n.startFragPrefetch)){var s=this.loadedmetadata?i.currentTime:this.nextLoadPosition,e=f.nextLoadLevel,o=this.levels[e];if(o){var t=o.bitrate,t=t?Math.max(8*n.maxBufferSize/t,n.maxBufferLength):n.maxBufferLength,i=(t=Math.min(t,n.maxMaxBufferLength),a.bufferInfo(this.mediaBuffer||i,s,n.maxBufferHole)),n=i.len;if(!(t<=n)){if(r.logger.trace("buffer length of "+n.toFixed(3)+" is below max of "+t.toFixed(3)+". checking for more payload ..."),this.level=f.nextLoadLevel=e,n=o.details,n&&(!n.live||this.levelLastLoaded===e))return this._streamEnded(i,n)?(t={},this.altAudio&&(t.type="video"),this.hls.trigger(u.default.BUFFER_EOS,t),void(this.state=hi)):void this._fetchPayloadOrEos(s,i,n);this.state=kt}}}},t._fetchPayloadOrEos=function(n,t,i){var h=this.fragPrevious,c=this.level,f=i.fragments,e=f.length,s;if(0!==e){var u,o=f[0].start,l=f[e-1].start+f[e-1].duration,t=t.end;if(i.initSegment&&!i.initSegment.data)u=i.initSegment;else if(i.live){if(s=this.config.initialLiveManifestSize,e<s)return void r.logger.warn("Can not start playback of a level, reason: not enough fragments "+e+" < "+s);if(null===(u=this._ensureFragmentAtLivePoint(i,t,o,l,h,f,e)))return}else t<o&&(u=f[0]);(u=u||this._findFragment(o,h,e,f,t,l,i))&&(u.encrypted?(r.logger.log("Loading key for "+u.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+c),this._loadKey(u)):(r.logger.log("Loading "+u.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+c+", currentTime:"+n.toFixed(3)+",bufferEnd:"+t.toFixed(3)),this._loadFragment(u)))}},t._ensureFragmentAtLivePoint=function(n,t,i,u,f,e,o){var h,l=this.hls.config,c=this.media,s=void 0!==l.liveMaxLatencyDuration?l.liveMaxLatencyDuration:l.liveMaxLatencyDurationCount*n.targetduration;return t<Math.max(i-l.maxFragLookUpTolerance,u-s)&&(t=s=this.liveSyncPosition=this.computeLivePosition(i,n),c&&!c.paused&&c.readyState&&c.duration>s&&s>c.currentTime&&(r.logger.log("buffer end: "+t.toFixed(3)+" is located too far from the end of live sliding playlist, reset currentTime to : "+s.toFixed(3)),c.currentTime=s),this.nextLoadPosition=s),n.PTSKnown&&u<t&&c&&c.readyState?null:(this.startFragRequested&&!n.PTSKnown&&(f&&(n.hasProgramDateTime?(r.logger.log("live playlist, switching playlist, load frag with same PDT: "+f.programDateTime),h=kr(e,f.endProgramDateTime,l.maxFragLookUpTolerance)):((i=f.sn+1)>=n.startSN&&i<=n.endSN&&(s=e[i-n.startSN],f.cc===s.cc&&r.logger.log("live playlist, switching playlist, load frag with next SN: "+(h=s).sn)),h||(h=pt.search(e,function(n){return f.cc-n.cc}))&&r.logger.log("live playlist, switching playlist, load frag with same CC: "+h.sn))),h||(h=e[Math.min(o-1,Math.round(o/2))],r.logger.log("live playlist, switching playlist, unknown, load middle frag : "+h.sn))),h)},t._findFragment=function(n,t,i,u,f,e,o){var s,h=this.hls.config;return(f=f<e?dr(t,u,f,f>e-h.maxFragLookUpTolerance?0:h.maxFragLookUpTolerance):u[i-1])&&(e=f.sn-o.startSN,i=t&&f.level===t.level,s=u[e-1],u=u[1+e],t&&f.sn===t.sn&&(i&&!f.backtracked?f.sn<o.endSN?(i=t.deltaPTS)&&i>h.maxBufferHole&&t.dropped&&e?(f=s,r.logger.warn("Previous fragment was dropped with large PTS gap between audio and video. Maybe fragment is not starting with a keyframe? Loading previous one to try to overcome this")):r.logger.log("Re-loading fragment with SN: "+(f=u).sn):f=null:f.backtracked&&(u&&u.backtracked?(r.logger.warn("Already backtracked from fragment "+u.sn+", will not backtrack to fragment "+f.sn+". Loading fragment "+u.sn),f=u):(r.logger.warn("Loaded fragment with dropped frames, backtracking 1 segment to find a keyframe"),f.dropped=0,s?(f=s).backtracked=!0:e&&(f=null))))),f},t._loadKey=function(n){this.state=rt;this.hls.trigger(u.default.KEY_LOADING,{frag:n})},t._loadFragment=function(n){var t=this.fragmentTracker.getState(n);"initSegment"!==(this.fragCurrent=n).sn&&(this.startFragRequested=!0);Object(e.isFiniteNumber)(n.sn)&&!n.bitrateTest&&(this.nextLoadPosition=n.start+n.duration);n.backtracked||t===yt||t===ri?(n.autoLevel=this.hls.autoLevelEnabled,n.bitrateTest=this.bitrateTest,this.hls.trigger(u.default.FRAG_LOADING,{frag:n}),this.demuxer||(this.demuxer=new ei(this.hls,"main")),this.state=d):t===er&&this._reduceMaxBufferLength(n.duration)&&this.fragmentTracker.removeFragment(n)},t.getBufferedFrag=function(n){return this.fragmentTracker.getBufferedFrag(n,it.MAIN)},t.followingBufferedFrag=function(n){return n?this.getBufferedFrag(n.endPTS+.5):null},t._checkFragmentChanged=function(){var i,t,n=this.media;n&&n.readyState&&!1===n.seeking&&((t=n.currentTime)>this.lastCurrentTime&&(this.lastCurrentTime=t),a.isBuffered(n,t)?i=this.getBufferedFrag(t):a.isBuffered(n,t+.1)&&(i=this.getBufferedFrag(t+.1)),!i||(n=i)!==this.fragPlaying&&(this.hls.trigger(u.default.FRAG_CHANGED,{frag:n}),t=n.level,this.fragPlaying&&this.fragPlaying.level===t||this.hls.trigger(u.default.LEVEL_SWITCHED,{level:t}),this.fragPlaying=n))},t.immediateLevelSwitch=function(){r.logger.log("immediateLevelSwitch");this.immediateSwitch||(this.immediateSwitch=!0,(n=this.media)?(t=n.paused,n.pause()):t=!0,this.previouslyPaused=t);var t,n=this.fragCurrent;n&&n.loader&&n.loader.abort();this.fragCurrent=null;this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},t.immediateLevelSwitchEnd=function(){var n=this.media;n&&n.buffered.length&&(this.immediateSwitch=!1,a.isBuffered(n,n.currentTime)&&(n.currentTime-=.0001),this.previouslyPaused||n.play())},t.nextLevelSwitch=function(){var i,n,t=this.media;t&&t.readyState&&((n=this.getBufferedFrag(t.currentTime))&&1<n.startPTS&&this.flushMainBuffer(0,n.startPTS-1),n=t.paused?0:(n=this.hls.nextLoadLevel,n=this.levels[n],(i=this.fragLastKbps)&&this.fragCurrent?this.fragCurrent.duration*n.bitrate/(1e3*i)+1:0),(i=(i=this.getBufferedFrag(t.currentTime+n))&&this.followingBufferedFrag(i))&&((t=this.fragCurrent)&&t.loader&&t.loader.abort(),this.fragCurrent=null,this.flushMainBuffer(i.maxStartPTS,Number.POSITIVE_INFINITY)))},t.flushMainBuffer=function(n,t){this.state=st;n={startOffset:n,endOffset:t};this.altAudio&&(n.type="video");this.hls.trigger(u.default.BUFFER_FLUSHING,n)},t.onMediaAttached=function(n){var n=this.media=this.mediaBuffer=n.media,t=(this.onvseeking=this.onMediaSeeking.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),this.onvended=this.onMediaEnded.bind(this),n.addEventListener("seeking",this.onvseeking),n.addEventListener("seeked",this.onvseeked),n.addEventListener("ended",this.onvended),this.config);this.levels&&t.autoStartLoad&&this.hls.startLoad(t.startPosition);this.gapController=new nu(t,n,this.fragmentTracker,this.hls)},t.onMediaDetaching=function(){var n=this.media,t=(n&&n.ended&&(r.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),this.levels);t&&t.forEach(function(n){n.details&&n.details.fragments.forEach(function(n){n.backtracked=void 0})});n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("seeked",this.onvseeked),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.fragmentTracker.removeAllFragments();this.media=this.mediaBuffer=null;this.loadedmetadata=!1;this.stopLoad()},t.onMediaSeeked=function(){var n=this.media,n=n?n.currentTime:void 0;Object(e.isFiniteNumber)(n)&&r.logger.log("media seeked to "+n.toFixed(3));this.tick()},t.onManifestLoading=function(){r.logger.log("trigger BUFFER_RESET");this.hls.trigger(u.default.BUFFER_RESET);this.fragmentTracker.removeAllFragments();this.stalled=!1;this.startPosition=this.lastCurrentTime=0},t.onManifestParsed=function(n){var t,i=!1,u=!1,n=(n.levels.forEach(function(n){(t=n.audioCodec)&&(-1!==t.indexOf("mp4a.40.2")&&(i=!0),-1!==t.indexOf("mp4a.40.5")&&(u=!0))}),this.audioCodecSwitch=i&&u,this.audioCodecSwitch&&r.logger.log("both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.altAudio=n.altAudio,this.levels=n.levels,this.startFragRequested=!1,this.config);(n.autoStartLoad||this.forceStartLoad)&&this.hls.startLoad(n.startPosition)},t.onLevelLoaded=function(n){var i,t=n.details,n=n.level,o=this.levels[this.levelLastLoaded],h=this.levels[n],c=t.totalduration,f=0;r.logger.log("level "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+c);t.live?(i=h.details)&&0<t.fragments.length?(vr(i,t),f=t.fragments[0].start,this.liveSyncPosition=this.computeLivePosition(f,i),t.PTSKnown&&Object(e.isFiniteNumber)(f)?r.logger.log("live playlist sliding:"+f.toFixed(3)):(r.logger.log("live playlist - outdated PTS, unknown sliding"),br(this.fragPrevious,o,t))):(r.logger.log("live playlist - first load, unknown sliding"),t.PTSKnown=!1,br(this.fragPrevious,o,t)):t.PTSKnown=!1;h.details=t;this.levelLastLoaded=n;this.hls.trigger(u.default.LEVEL_UPDATED,{details:t,level:n});!1===this.startFragRequested&&(-1!==this.startPosition&&-1!==this.lastCurrentTime||(i=t.startTimeOffset,Object(e.isFiniteNumber)(i)?(i<0&&(r.logger.log("negative start time offset "+i+", count from end of last fragment"),i=f+c+i),r.logger.log("start time offset found in playlist, adjust startPosition to "+i),this.startPosition=i):t.live?(this.startPosition=this.computeLivePosition(f,t),r.logger.log("configure startPosition to "+this.startPosition)):this.startPosition=0,this.lastCurrentTime=this.startPosition),this.nextLoadPosition=this.startPosition);this.state===kt&&(this.state=s);this.tick()},t.onKeyLoaded=function(){this.state===rt&&(this.state=s,this.tick())},t.onFragLoaded=function(n){var i,f,t=this.fragCurrent,o=this.hls,h=this.levels,c=this.media,e=n.frag;this.state===d&&t&&"main"===e.type&&e.level===t.level&&e.sn===t.sn&&(f=n.stats,i=(h=h[t.level]).details,this.bitrateTest=!1,this.stats=f,r.logger.log("Loaded "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level),e.bitrateTest&&o.nextLoadLevel?(this.state=s,this.startFragRequested=!1,f.tparsed=f.tbuffered=window.performance.now(),o.trigger(u.default.FRAG_BUFFERED,{stats:f,frag:t,id:"main"}),this.tick()):"initSegment"===e.sn?(this.state=s,f.tparsed=f.tbuffered=window.performance.now(),i.initSegment.data=n.payload,o.trigger(u.default.FRAG_BUFFERED,{stats:f,frag:t,id:"main"}),this.tick()):(r.logger.log("Parsing "+t.sn+" of ["+i.startSN+" ,"+i.endSN+"],level "+t.level+", cc "+t.cc),this.state=y,this.pendingBuffering=!0,this.appended=!1,e.bitrateTest&&(e.bitrateTest=!1,this.fragmentTracker.onFragLoaded({frag:e})),o=!(c&&c.seeking)&&(i.PTSKnown||!i.live),f=i.initSegment?i.initSegment.data:[],e=this._getAudioCodec(h),(this.demuxer=this.demuxer||new ei(this.hls,"main")).push(n.payload,f,e,h.videoCodec,t,i.totalduration,o)));this.fragLoadError=0},t.onFragParsingInitSegment=function(n){var e=this.fragCurrent,i=n.frag,o,t,f,s;if(e&&"main"===n.id&&i.sn===e.sn&&i.level===e.level&&this.state===y){f=n.tracks;for(o in f.audio&&this.altAudio&&delete f.audio,(t=f.audio)&&(i=this.levels[this.level].audioCodec,e=navigator.userAgent.toLowerCase(),i&&this.audioCodecSwap&&(r.logger.log("swapping playlist audio codec"),i=-1!==i.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5"),this.audioCodecSwitch&&1!==t.metadata.channelCount&&-1===e.indexOf("firefox")&&(i="mp4a.40.5"),-1!==e.indexOf("android")&&"audio/mpeg"!==t.container&&r.logger.log("Android: force audio codec to "+(i="mp4a.40.2")),t.levelCodec=i,t.id=n.id),(t=f.video)&&(t.levelCodec=this.levels[this.level].videoCodec,t.id=n.id),this.hls.trigger(u.default.BUFFER_CODECS,f),f)t=f[o],r.logger.log("main track:"+o+",container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),s=t.initSegment,s&&(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,{type:o,data:s,parent:"main",content:"initSegment"}));this.tick()}},t.onFragParsingData=function(n){var o=this,i=this.fragCurrent,f=n.frag,t,h;if(i&&"main"===n.id&&f.sn===i.sn&&f.level===i.level&&("audio"!==n.type||!this.altAudio)&&this.state===y){if(f=this.levels[this.level],t=i,Object(e.isFiniteNumber)(n.endPTS)||(n.endPTS=n.startPTS+i.duration,n.endDTS=n.startDTS+i.duration),!0===n.hasAudio&&t.addElementaryStream(b.AUDIO),!0===n.hasVideo&&t.addElementaryStream(b.VIDEO),r.logger.log("Parsed "+n.type+",PTS:["+n.startPTS.toFixed(3)+","+n.endPTS.toFixed(3)+"],DTS:["+n.startDTS.toFixed(3)+"/"+n.endDTS.toFixed(3)+"],nb:"+n.nb+",dropped:"+(n.dropped||0)),"video"===n.type)if(t.dropped=n.dropped,t.dropped)if(t.backtracked)r.logger.warn("Already backtracked on this fragment, appending with the gap",t.sn);else{if(i=f.details,!i||t.sn!==i.startSN)return r.logger.warn("missing video frame(s), backtracking fragment",t.sn),this.fragmentTracker.removeFragment(t),t.backtracked=!0,this.nextLoadPosition=n.startPTS,this.state=s,this.fragPrevious=t,void this.tick();r.logger.warn("missing video frame(s) on first frag, appending with gap",t.sn)}else t.backtracked=!1;i=oi(f.details,t,n.startPTS,n.endPTS,n.startDTS,n.endDTS);h=this.hls;h.trigger(u.default.LEVEL_PTS_UPDATED,{details:f.details,level:this.level,drift:i,type:n.type,start:n.startPTS,end:n.endPTS});[n.data1,n.data2].forEach(function(t){t&&t.length&&o.state===y&&(o.appended=!0,o.pendingBuffering=!0,h.trigger(u.default.BUFFER_APPENDING,{type:n.type,data:t,parent:"main",content:"data"}))});this.tick()}},t.onFragParsed=function(n){var t=this.fragCurrent,i=n.frag;t&&"main"===n.id&&i.sn===t.sn&&i.level===t.level&&this.state===y&&(this.stats.tparsed=window.performance.now(),this.state=p,this._checkAppendedParsed())},t.onAudioTrackSwitching=function(n){var t=!!n.url,n=n.id;t||(this.mediaBuffer!==this.media&&(r.logger.log("switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media,(t=this.fragCurrent).loader&&(r.logger.log("switching to main audio track, cancel main fragment load"),t.loader.abort()),this.fragCurrent=null,this.fragPrevious=null,this.demuxer&&(this.demuxer.destroy(),this.demuxer=null),this.state=s),(t=this.hls).trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),t.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:n}),this.altAudio=!1)},t.onAudioTrackSwitched=function(n){var t,n=n.id,n=!!this.hls.audioTracks[n].url;n&&(t=this.videoBuffer)&&this.mediaBuffer!==t&&(r.logger.log("switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=t);this.altAudio=n;this.tick()},t.onBufferCreated=function(n){var i,e,t,u=n.tracks,o=!1,f;for(t in u)f=u[t],"main"===f.id?(i=f,"video"===(e=t)&&(this.videoBuffer=u[t].buffer)):o=!0;o&&i?(r.logger.log("alternate track found, use "+e+".buffered to schedule main fragment loading"),this.mediaBuffer=i.buffer):this.mediaBuffer=this.media},t.onBufferAppended=function(n){var t;"main"===n.parent&&((t=this.state)!==y&&t!==p||(this.pendingBuffering=0<n.pending,this._checkAppendedParsed()))},t._checkAppendedParsed=function(){var t,n;this.state!==p||this.appended&&this.pendingBuffering||((t=this.fragCurrent)&&(n=this.mediaBuffer||this.media,r.logger.log("main buffered : "+si.toString(n.buffered)),this.fragPrevious=t,(n=this.stats).tbuffered=window.performance.now(),this.fragLastKbps=Math.round(8*n.total/(n.tbuffered-n.tfirst)),this.hls.trigger(u.default.FRAG_BUFFERED,{stats:n,frag:t,id:"main"}),this.state=s),this.tick())},t.onError=function(n){var i=n.frag||this.fragCurrent,t,u;if(!i||"main"===i.type){u=!!this.media&&a.isBuffered(this.media,this.media.currentTime)&&a.isBuffered(this.media,this.media.currentTime+.5);switch(n.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:n.fatal||(this.fragLoadError+1<=this.config.fragLoadingMaxRetry?(t=Math.min(Math.pow(2,this.fragLoadError)*this.config.fragLoadingRetryDelay,this.config.fragLoadingMaxRetryTimeout),r.logger.warn("mediaController: frag loading failed, retry in "+t+" ms"),this.retryDate=window.performance.now()+t,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.fragLoadError++,this.state=wt):(r.logger.error("mediaController: "+n.details+" reaches max retry, redispatch as fatal ..."),n.fatal=!0,this.state=g));break;case f.ErrorDetails.LEVEL_LOAD_ERROR:case f.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==g&&(n.fatal?(this.state=g,r.logger.warn("streamController: "+n.details+",switch to "+this.state+" state ...")):n.levelRetry||this.state!==kt||(this.state=s));break;case f.ErrorDetails.BUFFER_FULL_ERROR:"main"!==n.parent||this.state!==y&&this.state!==p||(u?(this._reduceMaxBufferLength(this.config.maxBufferLength),this.state=s):(r.logger.warn("buffer full error also media.currentTime is not buffered, flush everything"),this.fragCurrent=null,this.flushMainBuffer(0,Number.POSITIVE_INFINITY)))}}},t._reduceMaxBufferLength=function(n){var t=this.config;return t.maxMaxBufferLength>=n&&(t.maxMaxBufferLength/=2,r.logger.warn("main:reduce max buffer length to "+t.maxMaxBufferLength+"s"),!0)},t._checkBuffer=function(){var n=this.media;n&&0!==n.readyState&&(n=(this.mediaBuffer||n).buffered,!this.loadedmetadata&&n.length?(this.loadedmetadata=!0,this._seekToStartPos()):this.immediateSwitch?this.immediateLevelSwitchEnd():this.gapController.poll(this.lastCurrentTime,n))},t.onFragLoadEmergencyAborted=function(){this.state=s;this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);this.tick()},t.onBufferFlushed=function(){var n=this.mediaBuffer||this.media;n&&this.fragmentTracker.detectEvictedFragments(b.VIDEO,n.buffered);this.state=s;this.fragPrevious=null},t.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},t._seekToStartPos=function(){var t=this.media,i=t.currentTime,n=t.seeking?i:this.startPosition;i!==n&&0<=n&&(r.logger.log("target start position not buffered, seek to buffered.start(0) "+n+" from current time "+i+" "),t.currentTime=n)},t._getAudioCodec=function(n){return n=this.config.defaultAudioCodec||n.audioCodec,this.audioCodecSwap&&(r.logger.log("swapping playlist audio codec"),n=n&&(-1!==n.indexOf("mp4a.40.5")?"mp4a.40.2":"mp4a.40.5")),n},i=o,(t=[{key:"state",set:function(n){var t;this.state!==n&&(t=this.state,this._state=n,r.logger.log("main stream-controller: "+t+"->"+n),this.hls.trigger(u.default.STREAM_STATE_TRANSITION,{previousState:t,nextState:n}))},get:function(){return this._state}},{key:"currentLevel",get:function(){var n=this.media;return n&&(n=this.getBufferedFrag(n.currentTime),n)?n.level:-1}},{key:"nextBufferedFrag",get:function(){var n=this.media;return n?this.followingBufferedFrag(this.getBufferedFrag(n.currentTime)):null}},{key:"nextLevel",get:function(){var n=this.nextBufferedFrag;return n?n.level:-1}},{key:"liveSyncPosition",get:function(){return this._liveSyncPosition},set:function(n){this._liveSyncPosition=n}}])&&ru(i.prototype,t),h&&ru(i,h),o}(ot);window.performance;ou=function(n){function e(t){return t=n.call(this,t,u.default.MANIFEST_LOADED,u.default.LEVEL_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.FRAG_LOADED,u.default.ERROR)||this,t.canload=!1,t.currentLevelIndex=null,t.manualLevelIndex=-1,t.timer=null,eu=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),t}i=n;(t=e).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,o,t=e.prototype;return t.onHandlerDestroying=function(){this.clearTimer();this.manualLevelIndex=-1},t.clearTimer=function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)},t.startLoad=function(){var n=this._levels;this.canload=!0;this.levelRetryCount=0;n&&n.forEach(function(n){n.loadError=0;var t=n.details;t&&t.live&&(n.details=void 0)});null!==this.timer&&this.loadLevel()},t.stopLoad=function(){this.canload=!1},t.onManifestLoaded=function(n){var h,t=[],c=[],l={},o=null,s=!1,i=!1,e;if(n.levels.forEach(function(n){var r=n.attrs;n.loadError=0;n.fragmentError=!1;s=s||!!n.videoCodec;i=i||!!n.audioCodec;eu&&n.audioCodec&&-1!==n.audioCodec.indexOf("mp4a.40.34")&&(n.audioCodec=void 0);(o=l[n.bitrate])?o.url.push(n.url):(n.url=[n.url],n.urlId=0,l[n.bitrate]=n,t.push(n));r&&(r.AUDIO&&(i=!0,lr(o||n,"audio",r.AUDIO)),r.SUBTITLES&&lr(o||n,"text",r.SUBTITLES))}),t=(t=s&&i?t.filter(function(n){return!!n.videoCodec}):t).filter(function(n){var t=n.audioCodec,n=n.videoCodec;return(!t||ii(t,"audio"))&&(!n||ii(n,"video"))}),n.audioTracks&&(c=n.audioTracks.filter(function(n){return!n.audioCodec||ii(n.audioCodec,"audio")})).forEach(function(n,t){n.id=t}),0<t.length){for(h=t[0].bitrate,t.sort(function(n,t){return n.bitrate-t.bitrate}),this._levels=t,e=0;e<t.length;e++)if(t[e].bitrate===h){this._firstLevel=e;r.logger.log("manifest loaded,"+t.length+" level(s) found, first bitrate:"+h);break}this.hls.trigger(u.default.MANIFEST_PARSED,{levels:t,audioTracks:c,firstLevel:this._firstLevel,stats:n.stats,audio:i,video:s,altAudio:c.some(function(n){return!!n.url})})}else this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:this.hls.url,reason:"no level with compatible codecs found in manifest"})},t.setLevelInternal=function(n){var i,t=this._levels,e=this.hls;0<=n&&n<t.length?(this.clearTimer(),this.currentLevelIndex!==n&&(r.logger.log("switching to level "+n),(i=t[this.currentLevelIndex=n]).level=n,e.trigger(u.default.LEVEL_SWITCHING,i)),(t=(i=t[n]).details)&&!t.live||(t=i.urlId,e.trigger(u.default.LEVEL_LOADING,{url:i.url[t],level:n,id:t}))):e.trigger(u.default.ERROR,{type:f.ErrorTypes.OTHER_ERROR,details:f.ErrorDetails.LEVEL_SWITCH_ERROR,level:n,fatal:!1,reason:"invalid level idx"})},t.onError=function(n){if(n.fatal)n.type===f.ErrorTypes.NETWORK_ERROR&&this.clearTimer();else{var t,i=!1,r=!1;switch(n.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:t=n.frag.level;r=!0;break;case f.ErrorDetails.LEVEL_LOAD_ERROR:case f.ErrorDetails.LEVEL_LOAD_TIMEOUT:t=n.context.level;i=!0;break;case f.ErrorDetails.REMUX_ALLOC_ERROR:t=n.level;i=!0}void 0!==t&&this.recoverLevel(n,t,i,r)}},t.recoverLevel=function(n,t,i,u){var s=this,f=this.hls.config,o=n.details,e=this._levels[t];if(e.loadError++,e.fragmentError=u,i){if(!(this.levelRetryCount+1<=f.levelLoadingMaxRetry))return r.logger.error("level controller, cannot recover from "+o+" error"),this.currentLevelIndex=null,this.clearTimer(),void(n.fatal=!0);f=Math.min(Math.pow(2,this.levelRetryCount)*f.levelLoadingRetryDelay,f.levelLoadingMaxRetryTimeout);this.timer=setTimeout(function(){return s.loadLevel()},f);n.levelRetry=!0;this.levelRetryCount++;r.logger.warn("level controller, "+o+", retry in "+f+" ms, current retry count is "+this.levelRetryCount)}(i||u)&&(1<(n=e.url.length)&&e.loadError<n?(e.urlId=(e.urlId+1)%n,e.details=void 0,r.logger.warn("level controller, "+o+" for level "+t+": switching to redundant URL-id "+e.urlId)):-1===this.manualLevelIndex?(f=0===t?this._levels.length-1:t-1,r.logger.warn("level controller, "+o+": switch to "+f),this.hls.nextAutoLevel=this.currentLevelIndex=f):u&&(r.logger.warn("level controller, "+o+": reload a fragment"),this.currentLevelIndex=null))},t.onFragLoaded=function(n){var n=n.frag;void 0===n||"main"!==n.type||void 0!==(n=this._levels[n.level])&&(n.fragmentError=!1,n.loadError=0,this.levelRetryCount=0)},t.onLevelLoaded=function(n){var u=this,t=n.level,i=n.details;t===this.currentLevelIndex&&((t=this._levels[t]).fragmentError||(t.loadError=0,this.levelRetryCount=0),i.live?(t=pr(t.details,i,n.stats.trequest),r.logger.log("live playlist, reload in "+Math.round(t)+" ms"),this.timer=setTimeout(function(){return u.loadLevel()},t)):this.clearTimer())},t.onAudioTrackSwitched=function(n){var u=this.hls.audioTracks[n.id].groupId,t=this.hls.levels[this.currentLevelIndex],r,i;if(t&&t.audioGroupIds){for(r=-1,i=0;i<t.audioGroupIds.length;i++)if(t.audioGroupIds[i]===u){r=i;break}r!==t.urlId&&(t.urlId=r,this.startLoad())}},t.loadLevel=function(){var i,t,n;r.logger.debug("call to loadLevel");null!==this.currentLevelIndex&&this.canload&&"object"==typeof(n=this._levels[this.currentLevelIndex])&&0<n.url.length&&(i=this.currentLevelIndex,t=n.urlId,n=n.url[t],r.logger.log("Attempt loading level index "+i+" with URL-id "+t),this.hls.trigger(u.default.LEVEL_LOADING,{url:n,level:i,id:t}))},i=e,(t=[{key:"levels",get:function(){return this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(n){var t=this._levels;t&&(n=Math.min(n,t.length-1),this.currentLevelIndex===n&&t[n].details||this.setLevelInternal(n))}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(n){this.manualLevelIndex=n;void 0===this._startLevel&&(this._startLevel=n);-1!==n&&(this.level=n)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(n){this._firstLevel=n}},{key:"startLevel",get:function(){var n;return void 0===this._startLevel?void 0!==(n=this.hls.config.startLevel)?n:this._firstLevel:this._startLevel},set:function(n){this._startLevel=n}},{key:"nextLoadLevel",get:function(){return-1!==this.manualLevelIndex?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(n){this.level=n;-1===this.manualLevelIndex&&(this.hls.nextAutoLevel=n)}}])&&fu(i.prototype,t),o&&fu(i,o),e}(h);dt=i("./src/demux/id3.js");var fe=function(n){function f(t){return t=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_METADATA,u.default.LIVE_BACK_BUFFER_REACHED)||this,t.id3Track=void 0,t.media=void 0,t}var i,t;return i=n,(t=f).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=f.prototype,t.destroy=function(){h.prototype.destroy.call(this)},t.onMediaAttached=function(n){this.media=n.media;this.media},t.onMediaDetaching=function(){ht(this.id3Track);this.id3Track=void 0;this.media=void 0},t.getID3Track=function(n){for(var t,i=0;i<n.length;i++)if(t=n[i],"metadata"===t.kind&&"id3"===t.label)return su(t,this.media),t;return this.media.addTextTrack("metadata","id3")},t.onFragParsingMetadata=function(n){for(var e,f,i,o,h,s,c=n.frag,u=n.samples,l=(this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden"),window.WebKitDataCue||window.VTTCue||window.TextTrackCue),t=0;t<u.length;t++)if(e=dt.default.getID3Frames(u[t].data),e)for(f=u[t].pts,i=t<u.length-1?u[t+1].pts:c.endPTS,f===i?i+=.0001:i<f&&(r.logger.warn("detected an id3 sample with endTime < startTime, adjusting endTime to (startTime + 0.25)"),i=f+.25),o=0;o<e.length;o++)s=e[o],dt.default.isTimeStampFrame(s)||((h=new l(f,i,"")).value=s,this.id3Track.addCue(h))},t.onLiveBackBufferReached=function(n){var n=n.bufferEnd,t=this.id3Track,i;if(t&&t.cues&&t.cues.length&&(i=function(n,t){var i,r,u;if(t<n[0].endTime)return n[0];if(t>n[n.length-1].endTime)return n[n.length-1];for(i=0,r=n.length-1;i<=r;)if(u=Math.floor((r+i)/2),t<n[u].endTime)r=u-1;else{if(!(t>n[u].endTime))return n[u];i=u+1}return n[i].endTime-t<t-n[r].endTime?n[i]:n[r]}(t.cues,n),i))for(;t.cues[0]!==i;)t.removeCue(t.cues[0])},f}(h),hu=function(){function t(n){this.alpha_=void 0;this.estimate_=void 0;this.totalWeight_=void 0;this.alpha_=n?Math.exp(Math.log(.5)/n):0;this.estimate_=0;this.totalWeight_=0}var n=t.prototype;return n.sample=function(n,t){var i=Math.pow(this.alpha_,n);this.estimate_=t*(1-i)+i*this.estimate_;this.totalWeight_+=n},n.getTotalWeight=function(){return this.totalWeight_},n.getEstimate=function(){var n;return this.alpha_?(n=1-Math.pow(this.alpha_,this.totalWeight_),this.estimate_/n):this.estimate_},t}(),ee=function(){function t(n,t,i,r){this.hls=void 0;this.defaultEstimate_=void 0;this.minWeight_=void 0;this.minDelayMs_=void 0;this.slow_=void 0;this.fast_=void 0;this.hls=n;this.defaultEstimate_=r;this.minWeight_=.001;this.minDelayMs_=50;this.slow_=new hu(t);this.fast_=new hu(i)}var n=t.prototype;return n.sample=function(n,t){n=(n=Math.max(n,this.minDelayMs_))/1e3;t=8*t/n;this.fast_.sample(n,t);this.slow_.sample(n,t)},n.canEstimate=function(){var n=this.fast_;return n&&n.getTotalWeight()>=this.minWeight_},n.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},n.destroy=function(){},t}();var oe=window.performance,se=function(n){function o(t){var i=n.call(this,t,u.default.FRAG_LOADING,u.default.FRAG_LOADED,u.default.FRAG_BUFFERED,u.default.ERROR)||this;return i.lastLoadedFragLevel=0,i._nextAutoLevel=-1,i.hls=t,i.timer=null,i._bwEstimator=null,i.onCheck=i._abandonRulesCheck.bind(function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(i)),i}i=n;(t=o).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,s,t=o.prototype;return t.destroy=function(){this.clearTimer();h.prototype.destroy.call(this)},t.onFragLoading=function(n){var i,t,r,n=n.frag;"main"===n.type&&(this.timer||(this.fragCurrent=n,this.timer=setInterval(this.onCheck,100)),this._bwEstimator||(t=(i=this.hls).config,n=n.level,n=i.levels[n].details.live?(r=t.abrEwmaFastLive,t.abrEwmaSlowLive):(r=t.abrEwmaFastVoD,t.abrEwmaSlowVoD),this._bwEstimator=new ee(i,n,r,t.abrEwmaDefaultEstimate)))},t._abandonRulesCheck=function(){var o=this.hls,e=o.media,n=this.fragCurrent,s,y,t,c,l,i,b;if(n){if(s=n.loader,y=o.minAutoLevel,!s||s.stats&&s.stats.aborted)return r.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),void(this._nextAutoLevel=-1);if(t=s.stats,e&&t&&(!e.paused&&0!==e.playbackRate||!e.readyState)&&n.autoLevel&&n.level&&(c=oe.now()-t.trequest,l=Math.abs(e.playbackRate),c>500*n.duration/l)){var h=o.levels,p=Math.max(1,t.bw?t.bw/8:1e3*t.loaded/c),f=h[n.level],f=f.realBitrate?Math.max(f.realBitrate,f.bitrate):f.bitrate,f=t.total||Math.max(t.loaded,Math.round(n.duration*f/8)),w=e.currentTime,f=(f-t.loaded)/p,v=(a.bufferInfo(e,w,o.config.maxBufferHole).end-w)/l;if(v<2*n.duration/l&&v<f){for(i=n.level-1;y<i;i--)if(b=h[i].realBitrate?Math.max(h[i].realBitrate,h[i].bitrate):h[i].bitrate,n.duration*b/(6.4*p)<v)break;void 0<f&&(r.logger.warn("loading too slow, abort fragment loading and switch to level "+i+":fragLoadedDelay["+i+"]<fragLoadedDelay["+(n.level-1)+"];bufferStarvationDelay:"+(void 0).toFixed(1)+"<"+f.toFixed(1)+":"+v.toFixed(1)),o.nextLoadLevel=i,this._bwEstimator.sample(c,t.loaded),s.abort(),this.clearTimer(),o.trigger(u.default.FRAG_LOAD_EMERGENCY_ABORTED,{frag:n,stats:t}))}}}},t.onFragLoaded=function(n){var i,r,t=n.frag;"main"===t.type&&Object(e.isFiniteNumber)(t.sn)&&(this.clearTimer(),this.lastLoadedFragLevel=t.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate&&(i=((t=this.hls.levels[t.level]).loaded?t.loaded.bytes:0)+n.stats.loaded,r=(t.loaded?t.loaded.duration:0)+n.frag.duration,t.loaded={bytes:i,duration:r},t.realBitrate=Math.round(8*i/r)),n.frag.bitrateTest&&((t=n.stats).tparsed=t.tbuffered=t.tload,this.onFragBuffered(n)))},t.onFragBuffered=function(n){var i,t=n.stats,n=n.frag;!0===t.aborted||"main"!==n.type||!Object(e.isFiniteNumber)(n.sn)||n.bitrateTest&&t.tload!==t.tbuffered||(i=t.tparsed-t.trequest,r.logger.log("latency/loading/parsing/append/kbps:"+Math.round(t.tfirst-t.trequest)+"/"+Math.round(t.tload-t.tfirst)+"/"+Math.round(t.tparsed-t.tload)+"/"+Math.round(t.tbuffered-t.tparsed)+"/"+Math.round(8*t.loaded/(t.tbuffered-t.trequest))),this._bwEstimator.sample(i,t.loaded),t.bwEstimate=this._bwEstimator.getEstimate(),this.bitrateTestDelay=n.bitrateTest?i/1e3:0)},t.onError=function(n){switch(n.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer()}},t.clearTimer=function(){clearInterval(this.timer);this.timer=null},t._findBestLevel=function(n,t,i,u,f,e,o,s,h){for(var l,c=f;u<=c;c--)if(l=h[c],l){var l=l.details,p=l?l.totalduration/l.fragments.length:t,l=!!l&&l.live,a=void 0,a=c<=n?o*i:s*i,v=h[c].realBitrate?Math.max(h[c].realBitrate,h[c].bitrate):h[c].bitrate,y=v*p/a;if(r.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+c+"/"+Math.round(a)+"/"+v+"/"+p+"/"+e+"/"+y),v<a&&(!y||l&&!this.bitrateTestDelay||y<e))return c}return-1},i=o,(t=[{key:"nextAutoLevel",get:function(){var t=this._nextAutoLevel,n=this._bwEstimator;return(-1===t||n&&n.canEstimate())?(n=this._nextABRAutoLevel,-1!==t?Math.min(t,n):n):t},set:function(n){this._nextAutoLevel=n}},{key:"_nextABRAutoLevel",get:function(){var e,o,s,n=this.hls,h=n.maxAutoLevel,c=n.levels,t=n.config,l=n.minAutoLevel,n=n.media,v=this.lastLoadedFragLevel,i=this.fragCurrent?this.fragCurrent.duration:0,u=n?n.currentTime:0,f=n&&0!==n.playbackRate?Math.abs(n.playbackRate):1,y=this._bwEstimator?this._bwEstimator.getEstimate():t.abrEwmaDefaultEstimate,n=(a.bufferInfo(n,u,t.maxBufferHole).end-u)/f,u=this._findBestLevel(v,i,y,l,h,n,t.abrBandWidthFactor,t.abrBandWidthUpFactor,c);return 0<=u?u:(r.logger.trace("rebuffering expected to happen, lets try to find a quality level minimizing the rebuffering"),f=i?Math.min(i,t.maxStarvationDelay):t.maxStarvationDelay,e=t.abrBandWidthFactor,o=t.abrBandWidthUpFactor,0!=n||(s=this.bitrateTestDelay)&&(f=(i?Math.min(i,t.maxLoadingDelay):t.maxLoadingDelay)-s,r.logger.trace("bitrate test took "+Math.round(1e3*s)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*f)+" ms"),e=o=1),u=this._findBestLevel(v,i,y,l,h,n+f,e,o,c),Math.max(u,0))}}])&&cu(i.prototype,t),s&&cu(i,s),o}(h),lu=ui(),he=function(n){function o(t){var i=n.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_RESET,u.default.BUFFER_APPENDING,u.default.BUFFER_CODECS,u.default.BUFFER_EOS,u.default.BUFFER_FLUSHING,u.default.LEVEL_PTS_UPDATED,u.default.LEVEL_UPDATED)||this;return i._msDuration=null,i._levelDuration=null,i._levelTargetDuration=10,i._live=null,i._objectUrl=null,i._needsFlush=!1,i._needsEos=!1,i.config=void 0,i.audioTimestampOffset=void 0,i.bufferCodecEventsExpected=0,i._bufferCodecEventsTotal=0,i.media=null,i.mediaSource=null,i.segments=[],i.parent=void 0,i.appending=!1,i.appended=0,i.appendError=0,i.flushBufferCounter=0,i.tracks={},i.pendingTracks={},i.sourceBuffer={},i.flushRange=[],i._onMediaSourceOpen=function(){r.logger.log("media source opened");i.hls.trigger(u.default.MEDIA_ATTACHED,{media:i.media});var n=i.mediaSource;n&&n.removeEventListener("sourceopen",i._onMediaSourceOpen);i.checkPendingTracks()},i._onMediaSourceClose=function(){r.logger.log("media source closed")},i._onMediaSourceEnded=function(){r.logger.log("media source ended")},i._onSBUpdateEnd=function(){var f;i.audioTimestampOffset&&i.sourceBuffer.audio&&(n=i.sourceBuffer.audio,r.logger.warn("change mpeg audio timestamp offset from "+n.timestampOffset+" to "+i.audioTimestampOffset),n.timestampOffset=i.audioTimestampOffset,delete i.audioTimestampOffset);i._needsFlush&&i.doFlush();i._needsEos&&i.checkEos();i.appending=!1;var t,e=i.parent,n=i.segments.reduce(function(n,t){return t.parent===e?n+1:n},0),o={},s=i.sourceBuffer;for(t in s){if(f=s[t],!f)throw Error("handling source buffer update end error: source buffer for "+t+" uninitilized and unable to update buffered TimeRanges.");o[t]=f.buffered}i.hls.trigger(u.default.BUFFER_APPENDED,{parent:e,pending:n,timeRanges:o});i._needsFlush||i.doAppending();i.updateMediaElementDuration();0===n&&i.flushLiveBackBuffer()},i._onSBUpdateError=function(n){r.logger.error("sourceBuffer error:",n);i.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1})},i.config=t.config,i}var i,t;return i=n,(t=o).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=o.prototype,t.destroy=function(){h.prototype.destroy.call(this)},t.onLevelPtsUpdated=function(n){var t=n.type,i=this.tracks.audio;if("audio"===t&&i&&"audio/mpeg"===i.container){if(t=this.sourceBuffer.audio,!t)throw Error("Level PTS Updated and source buffer for audio uninitalized");if(.1<Math.abs(t.timestampOffset-n.start)){i=t.updating;try{t.abort()}catch(n){r.logger.warn("can not abort audio buffer: "+n)}i?this.audioTimestampOffset=n.start:(r.logger.warn("change mpeg audio timestamp offset from "+t.timestampOffset+" to "+n.start),t.timestampOffset=n.start)}}},t.onManifestParsed=function(n){this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=n.altAudio?2:1;r.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},t.onMediaAttaching=function(n){var t,n=this.media=n.media;n&&lu&&((t=this.mediaSource=new lu).addEventListener("sourceopen",this._onMediaSourceOpen),t.addEventListener("sourceended",this._onMediaSourceEnded),t.addEventListener("sourceclose",this._onMediaSourceClose),n.src=window.URL.createObjectURL(t),this._objectUrl=n.src)},t.onMediaDetaching=function(){r.logger.log("media source detaching");var n=this.mediaSource;if(n){if("open"===n.readyState)try{n.endOfStream()}catch(n){r.logger.warn("onMediaDetaching:"+n.message+" while calling endOfStream")}n.removeEventListener("sourceopen",this._onMediaSourceOpen);n.removeEventListener("sourceended",this._onMediaSourceEnded);n.removeEventListener("sourceclose",this._onMediaSourceClose);this.media&&(this._objectUrl&&window.URL.revokeObjectURL(this._objectUrl),this.media.src===this._objectUrl?(this.media.removeAttribute("src"),this.media.load()):r.logger.warn("media.src was changed by a third party - skip cleanup"));this.mediaSource=null;this.media=null;this._objectUrl=null;this.bufferCodecEventsExpected=this._bufferCodecEventsTotal;this.pendingTracks={};this.tracks={};this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0}this.hls.trigger(u.default.MEDIA_DETACHED)},t.checkPendingTracks=function(){var i=this.bufferCodecEventsExpected,n=this.pendingTracks,t=Object.keys(n).length;(t&&!i||2===t)&&(this.createSourceBuffers(n),this.pendingTracks={},this.doAppending())},t.onBufferReset=function(){var t,i=this.sourceBuffer,n;for(t in i){n=i[t];try{n&&(this.mediaSource&&this.mediaSource.removeSourceBuffer(n),n.removeEventListener("updateend",this._onSBUpdateEnd),n.removeEventListener("error",this._onSBUpdateError))}catch(t){}}this.sourceBuffer={};this.flushRange=[];this.segments=[];this.appended=0},t.onBufferCodecs=function(n){var t=this;Object.keys(this.sourceBuffer).length||(Object.keys(n).forEach(function(i){t.pendingTracks[i]=n[i]}),this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&"open"===this.mediaSource.readyState&&this.checkPendingTracks())},t.createSourceBuffers=function(n){var i,h=this.sourceBuffer,c=this.mediaSource,t,s,e,o;if(!c)throw Error("createSourceBuffers called when mediaSource was null");for(i in n)if(!h[i]){if(t=n[i],!t)throw Error("source buffer exists for track "+i+", however track does not");s=t.levelCodec||t.codec;e=t.container+";codecs="+s;r.logger.log("creating sourceBuffer("+e+")");try{o=h[i]=c.addSourceBuffer(e);o.addEventListener("updateend",this._onSBUpdateEnd);o.addEventListener("error",this._onSBUpdateError);this.tracks[i]={buffer:o,codec:s,id:t.id,container:t.container,levelCodec:t.levelCodec}}catch(n){r.logger.error("error while trying to add sourceBuffer:"+n.message);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,err:n,mimeType:e})}}this.hls.trigger(u.default.BUFFER_CREATED,{tracks:this.tracks})},t.onBufferAppending=function(n){this._needsFlush||(this.segments?this.segments.push(n):this.segments=[n],this.doAppending())},t.onBufferEos=function(n){var t,i;for(t in this.sourceBuffer)n.type&&n.type!==t||(i=this.sourceBuffer[t])&&!i.ended&&(i.ended=!0,r.logger.log(t+" sourceBuffer now EOS"));this.checkEos()},t.checkEos=function(){var i=this.sourceBuffer,t=this.mediaSource,n;if(t&&"open"===t.readyState){for(n in i)if(n=i[n],n){if(!n.ended)return;if(n.updating)return void(this._needsEos=!0)}r.logger.log("all media data are available, signal endOfStream() to MediaSource and stop loading fragment");try{t.endOfStream()}catch(i){r.logger.warn("exception while calling mediaSource.endOfStream()")}this._needsEos=!1}else this._needsEos=!1},t.onBufferFlushing=function(n){n.type?this.flushRange.push({start:n.startOffset,end:n.endOffset,type:n.type}):(this.flushRange.push({start:n.startOffset,end:n.endOffset,type:"video"}),this.flushRange.push({start:n.startOffset,end:n.endOffset,type:"audio"}));this.flushBufferCounter=0;this.doFlush()},t.flushLiveBackBuffer=function(){var n,h,e,t;if(this._live&&(n=this.config.liveBackBufferLength,isFinite(n)&&!(n<0)))if(this.media)for(var c=this.media.currentTime,o=this.sourceBuffer,s=Object.keys(o),i=c-Math.max(n,this._levelTargetDuration),f=s.length-1;0<=f;f--)e=s[f],t=o[e],t&&0<(h=t.buffered).length&&i>h.start(0)&&this.removeBufferRange(e,t,0,i)&&this.hls.trigger(u.default.LIVE_BACK_BUFFER_REACHED,{bufferEnd:i});else r.logger.error("flushLiveBackBuffer called without attaching media")},t.onLevelUpdated=function(n){n=n.details;0<n.fragments.length&&(this._levelDuration=n.totalduration+n.fragments[0].start,this._levelTargetDuration=n.averagetargetduration||n.targetduration||10,this._live=n.live,this.updateMediaElementDuration())},t.updateMediaElementDuration=function(){var t,i=this.config,n;if(null!==this._levelDuration&&this.media&&this.mediaSource&&this.sourceBuffer&&0!==this.media.readyState&&"open"===this.mediaSource.readyState){for(n in this.sourceBuffer)if(n=this.sourceBuffer[n],n&&!0===n.updating)return;t=this.media.duration;null===this._msDuration&&(this._msDuration=this.mediaSource.duration);!0===this._live&&!0===i.liveDurationInfinity?(r.logger.log("Media Source duration is set to Infinity"),this._msDuration=this.mediaSource.duration=1/0):(this._levelDuration>this._msDuration&&this._levelDuration>t||!Object(e.isFiniteNumber)(t))&&(r.logger.log("Updating Media Source duration to "+this._levelDuration.toFixed(3)),this._msDuration=this.mediaSource.duration=this._levelDuration)}},t.doFlush=function(){for(var n,t,i,e,f;this.flushRange.length;){if(n=this.flushRange[0],!this.flushBuffer(n.start,n.end,n.type))return void(this._needsFlush=!0);this.flushRange.shift();this.flushBufferCounter=0}if(0===this.flushRange.length){this._needsFlush=!1;t=0;i=this.sourceBuffer;try{for(e in i)f=i[e],f&&(t+=f.buffered.length)}catch(n){r.logger.error("error while accessing sourceBuffer.buffered")}this.appended=t;this.hls.trigger(u.default.BUFFER_FLUSHED)}},t.doAppending=function(){var o=this.config,s=this.hls,e=this.segments,t=this.sourceBuffer,n,i;if(Object.keys(t).length){if(!this.media||this.media.error)return this.segments=[],void r.logger.error("trying to append although a media error occured, flush segment and abort");if(!this.appending&&(n=e.shift(),n))try{if(i=t[n.type],!i)return void this._onSBUpdateEnd();if(i.updating)return void e.unshift(n);i.ended=!1;this.parent=n.parent;i.appendBuffer(n.data);this.appendError=0;this.appended++;this.appending=!0}catch(i){r.logger.error("error while trying to append buffer:"+i.message);e.unshift(n);t={type:f.ErrorTypes.MEDIA_ERROR,parent:n.parent,details:"",fatal:!1};22===i.code?(this.segments=[],t.details=f.ErrorDetails.BUFFER_FULL_ERROR):(this.appendError++,t.details=f.ErrorDetails.BUFFER_APPEND_ERROR,this.appendError>o.appendErrorMaxRetry&&(r.logger.log("fail "+o.appendErrorMaxRetry+" times to append segment in sourceBuffer"),this.segments=[],t.fatal=!0));s.trigger(u.default.ERROR,t)}}},t.flushBuffer=function(n,t,i){var f=this.sourceBuffer,u;if(!Object.keys(f).length)return!0;if(u="null",this.media&&(u=this.media.currentTime.toFixed(3)),r.logger.log("flushBuffer,pos/start/end: "+u+"/"+n+"/"+t),this.flushBufferCounter>=this.appended)return r.logger.warn("abort flushing too many retries"),!0;if(u=f[i],u){if(u.ended=!1,u.updating)return r.logger.warn("cannot flush, sb updating in progress"),!1;if(this.removeBufferRange(i,u,n,t))return this.flushBufferCounter++,!1}return r.logger.log("buffer flushed"),!0},t.removeBufferRange=function(n,t,i,u){var f;try{for(f=0;f<t.buffered.length;f++){var e,c=t.buffered.start(f),o=t.buffered.end(f),s=Math.max(c,i),h=Math.min(o,u);if(.5<Math.min(h,o)-s)return e="null",this.media&&(e=this.media.currentTime.toString()),r.logger.log("sb remove "+n+" ["+s+","+h+"], of ["+c+","+o+"], pos:"+e),t.remove(s,h),!0}}catch(n){r.logger.warn("removeBufferRange failed",n)}return!1},o}(h);var ce=function(n){function i(t){return t=n.call(this,t,u.default.FPS_DROP_LEVEL_CAPPING,u.default.MEDIA_ATTACHING,u.default.MANIFEST_PARSED,u.default.BUFFER_CODECS,u.default.MEDIA_DETACHING)||this,t.autoLevelCapping=Number.POSITIVE_INFINITY,t.firstLevel=null,t.levels=[],t.media=null,t.restrictedLevels=[],t.timer=null,t}r=n;(t=i).prototype=Object.create(r.prototype);(t.prototype.constructor=t).__proto__=r;var r,f,t=i.prototype;return t.destroy=function(){this.hls.config.capLevelToPlayerSize&&(this.media=null,this.stopCapping())},t.onFpsDropLevelCapping=function(n){i.isLevelAllowed(n.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(n.droppedLevel)},t.onMediaAttaching=function(n){this.media=n.media instanceof window.HTMLVideoElement?n.media:null},t.onManifestParsed=function(n){var t=this.hls;this.restrictedLevels=[];this.levels=n.levels;this.firstLevel=n.firstLevel;t.config.capLevelToPlayerSize&&n.video&&this.startCapping()},t.onBufferCodecs=function(n){this.hls.config.capLevelToPlayerSize&&n.video&&this.startCapping()},t.onLevelsUpdated=function(n){this.levels=n.levels},t.onMediaDetaching=function(){this.stopCapping()},t.detectPlayerSize=function(){var t,n;this.media&&(t=this.levels?this.levels.length:0)&&((n=this.hls).autoLevelCapping=this.getMaxLevel(t-1),n.autoLevelCapping>this.autoLevelCapping&&n.streamController.nextLevelSwitch(),this.autoLevelCapping=n.autoLevelCapping)},t.getMaxLevel=function(n){var r=this,t;return this.levels?(t=this.levels.filter(function(t,u){return i.isLevelAllowed(u,r.restrictedLevels)&&u<=n}),i.getMaxLevelByMediaSize(t,this.mediaWidth,this.mediaHeight)):-1},t.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),clearInterval(this.timer),this.timer=setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},t.stopCapping=function(){this.restrictedLevels=[];this.firstLevel=null;this.autoLevelCapping=Number.POSITIVE_INFINITY;this.timer&&(this.timer=clearInterval(this.timer),this.timer=null)},i.isLevelAllowed=function(n,t){return-1===(t=void 0===t?[]:t).indexOf(n)},i.getMaxLevelByMediaSize=function(n,t,i){var f,e,u,r;if(!n||!n.length)return-1;for(e=n.length-1,u=0;u<n.length;u+=1)if(r=n[u],(r.width>=t||r.height>=i)&&(r=r,!(f=n[u+1])||r.width!==f.width||r.height!==f.height)){e=u;break}return e},r=i,t=[{key:"contentScaleFactor",get:function(){var n=1;try{n=window.devicePixelRatio}catch(n){}return n}}],(f=[{key:"mediaWidth",get:function(){var t,n=this.media;return n&&(t=n.width||n.clientWidth||n.offsetWidth,t*=i.contentScaleFactor),t}},{key:"mediaHeight",get:function(){var t,n=this.media;return n&&(t=n.height||n.clientHeight||n.offsetHeight,t*=i.contentScaleFactor),t}}])&&au(r.prototype,f),t&&au(r,t),i}(h),le=window.performance,ae=function(n){function f(t){return n.call(this,t,u.default.MEDIA_ATTACHING)||this}var i,t;return i=n,(t=f).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=f.prototype,t.destroy=function(){this.timer&&clearInterval(this.timer);this.isVideoPlaybackQualityAvailable=!1},t.onMediaAttaching=function(n){var t=this.hls.config;t.capLevelOnFPSDrop&&("function"==typeof(this.video=n.media instanceof window.HTMLVideoElement?n.media:null).getVideoPlaybackQuality&&(this.isVideoPlaybackQualityAvailable=!0),clearInterval(this.timer),this.timer=setInterval(this.checkFPSInterval.bind(this),t.fpsDroppedMonitoringPeriod))},t.checkFPS=function(n,t,i){var o,s,e,f,h=le.now();t&&(this.lastTime&&(f=h-this.lastTime,o=i-this.lastDroppedFrames,s=t-this.lastDecodedFrames,f=1e3*o/f,(e=this.hls).trigger(u.default.FPS_DROP,{currentDropped:o,currentDecoded:s,totalDroppedFrames:i}),0<f&&o>e.config.fpsDroppedMonitoringThreshold*s&&(f=e.currentLevel,r.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+f),0<f&&(-1===e.autoLevelCapping||e.autoLevelCapping>=f)&&(e.trigger(u.default.FPS_DROP_LEVEL_CAPPING,{level:f-=1,droppedLevel:e.currentLevel}),e.autoLevelCapping=f,e.streamController.nextLevelSwitch()))),this.lastTime=h,this.lastDroppedFrames=i,this.lastDecodedFrames=t)},t.checkFPSInterval=function(){var t,n=this.video;n&&(this.isVideoPlaybackQualityAvailable?(t=n.getVideoPlaybackQuality(),this.checkFPS(n,t.totalVideoFrames,t.droppedVideoFrames)):this.checkFPS(n,n.webkitDecodedFrameCount,n.webkitDroppedFrameCount))},f}(h),li=window,ai=li.performance,ve=li.XMLHttpRequest,li=function(){function t(n){n&&n.xhrSetup&&(this.xhrSetup=n.xhrSetup)}var n=t.prototype;return n.destroy=function(){this.abort();this.loader=null},n.abort=function(){var n=this.loader;n&&4!==n.readyState&&(this.stats.aborted=!0,n.abort());window.clearTimeout(this.requestTimeout);this.requestTimeout=null;window.clearTimeout(this.retryTimeout);this.retryTimeout=null},n.load=function(n,t,i){this.context=n;this.config=t;this.callbacks=i;this.stats={trequest:ai.now(),retry:0};this.retryDelay=t.retryDelay;this.loadInternal()},n.loadInternal=function(){var t=this.context,n=this.loader=new ve,i=this.stats,i=(i.tfirst=0,i.loaded=0,this.xhrSetup);try{if(i)try{i(n,t.url)}catch(r){n.open("GET",t.url,!0);i(n,t.url)}n.readyState||n.open("GET",t.url,!0)}catch(r){return void this.callbacks.onError({code:n.status,text:r.message},t,n)}t.rangeEnd&&n.setRequestHeader("Range","bytes="+t.rangeStart+"-"+(t.rangeEnd-1));n.onreadystatechange=this.readystatechange.bind(this);n.onprogress=this.loadprogress.bind(this);n.responseType=t.responseType;this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),this.config.timeout);n.send()},n.readystatechange=function(n){var e,f,n=n.currentTarget,i=n.readyState,t=this.stats,u=this.context,o=this.config;t.aborted||2<=i&&(window.clearTimeout(this.requestTimeout),0===t.tfirst&&(t.tfirst=Math.max(ai.now(),t.trequest)),4===i?200<=(i=n.status)&&i<300?(t.tload=Math.max(t.tfirst,ai.now()),f="arraybuffer"===u.responseType?(e=n.response).byteLength:(e=n.responseText).length,t.loaded=t.total=f,f={url:n.responseURL,data:e},this.callbacks.onSuccess(f,t,u,n)):t.retry>=o.maxRetry||400<=i&&i<499?(r.logger.error(i+" while loading "+u.url),this.callbacks.onError({code:i,text:n.statusText},u,n)):(r.logger.warn(i+" while loading "+u.url+", retrying in "+this.retryDelay+"..."),this.destroy(),this.retryTimeout=window.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,o.maxRetryDelay),t.retry++):this.requestTimeout=window.setTimeout(this.loadtimeout.bind(this),o.timeout))},n.loadtimeout=function(){r.logger.warn("timeout while loading "+this.context.url);this.callbacks.onTimeout(this.stats,this.context,null)},n.loadprogress=function(n){var i=n.currentTarget,t=this.stats,n=(t.loaded=n.loaded,n.lengthComputable&&(t.total=n.total),this.callbacks.onProgress);n&&n(t,this.context,null,i)},t}();v=function(n){function e(t){return t=n.call(this,t,u.default.MANIFEST_LOADING,u.default.MANIFEST_PARSED,u.default.AUDIO_TRACK_LOADED,u.default.AUDIO_TRACK_SWITCHED,u.default.LEVEL_LOADED,u.default.ERROR)||this,t._trackId=-1,t._selectDefaultTrack=!0,t.tracks=[],t.trackIdBlacklist=Object.create(null),t.audioGroupId=null,t}i=n;(t=e).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,o,t=e.prototype;return t.onManifestLoading=function(){this.tracks=[];this._trackId=-1;this._selectDefaultTrack=!0},t.onManifestParsed=function(n){n=this.tracks=n.audioTracks||[];this.hls.trigger(u.default.AUDIO_TRACKS_UPDATED,{audioTracks:n});this._selectAudioGroup(this.hls.nextLoadLevel)},t.onAudioTrackLoaded=function(n){var t;n.id>=this.tracks.length?r.logger.warn("Invalid audio track id:",n.id):(r.logger.log("audioTrack "+n.id+" loaded"),this.tracks[n.id].details=n.details,n.details.live&&!this.hasInterval()&&(t=1e3*n.details.targetduration,this.setInterval(t)),!n.details.live&&this.hasInterval()&&this.clearInterval())},t.onAudioTrackSwitched=function(n){n=this.tracks[n.id].groupId;n&&this.audioGroupId!==n&&(this.audioGroupId=n)},t.onLevelLoaded=function(n){this._selectAudioGroup(n.level)},t.onError=function(n){n.type===f.ErrorTypes.NETWORK_ERROR&&(n.fatal&&this.clearInterval(),n.details===f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR&&(r.logger.warn("Network failure on audio-track id:",n.context.id),this._handleLoadError()))},t._setAudioTrack=function(n){var t,i,f;this._trackId===n&&this.tracks[this._trackId].details?r.logger.debug("Same id as current audio-track passed, and track details available -> no-op"):n<0||n>=this.tracks.length?r.logger.warn("Invalid id passed to audio-track controller"):(t=this.tracks[n],r.logger.log("Now switching to audio-track index "+n),this.clearInterval(),this._trackId=n,n=t.url,i=t.type,f=t.id,this.hls.trigger(u.default.AUDIO_TRACK_SWITCHING,{id:f,type:i,url:n}),this._loadTrackDetailsIfNeeded(t))},t.doTick=function(){this._updateTrack(this._trackId)},t._selectAudioGroup=function(n){var n=this.hls.levels[n];n&&n.audioGroupIds&&(n=n.audioGroupIds[n.urlId],this.audioGroupId!==n&&(this.audioGroupId=n,this._selectInitialAudioTrack()))},t._selectInitialAudioTrack=function(){var t,i,n,o=this,e=this.tracks;e.length&&(n=this.tracks[this._trackId],t=null,n&&(t=n.name),this._selectDefaultTrack&&((n=e.filter(function(n){return n.default})).length?e=n:r.logger.warn("No default audio tracks defined")),i=!1,(n=function(){e.forEach(function(n){i||o.audioGroupId&&n.groupId!==o.audioGroupId||t&&t!==n.name||(o._setAudioTrack(n.id),i=!0)})})(),i||(t=null,n()),i||(r.logger.error("No track found for running audio group-ID: "+this.audioGroupId),this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0})))},t._needsTrackLoading=function(n){var t=n.details,n=n.url;return!(t&&!t.live)&&!!n},t._loadTrackDetailsIfNeeded=function(n){var t;this._needsTrackLoading(n)&&(t=n.url,n=n.id,r.logger.log("loading audio-track playlist for id: "+n),this.hls.trigger(u.default.AUDIO_TRACK_LOADING,{url:t,id:n}))},t._updateTrack=function(n){n<0||n>=this.tracks.length||(this.clearInterval(),this._trackId=n,r.logger.log("trying to update audio-track "+n),n=this.tracks[n],this._loadTrackDetailsIfNeeded(n))},t._handleLoadError=function(){this.trackIdBlacklist[this._trackId]=!0;for(var i=this._trackId,u=this.tracks[i],f=u.name,e=u.language,u=u.groupId,n=(r.logger.warn("Loading failed on audio track id: "+i+", group-id: "+u+', name/language: "'+f+'" / "'+e+'"'),i),t=0;t<this.tracks.length;t++)if(!this.trackIdBlacklist[t]&&this.tracks[t].name===f){n=t;break}n!==i?(r.logger.log("Attempting audio-track fallback id:",n,"group-id:",this.tracks[n].groupId),this._setAudioTrack(n)):r.logger.warn('No fallback audio-track found for name/language: "'+f+'" / "'+e+'"')},i=e,(t=[{key:"audioTracks",get:function(){return this.tracks}},{key:"audioTrack",get:function(){return this._trackId},set:function(n){this._setAudioTrack(n);this._selectDefaultTrack=!1}}])&&vu(i.prototype,t),o&&vu(i,o),e}(v);var ct=window.performance,pe=function(n){function o(t,i){var r=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.AUDIO_TRACKS_UPDATED,u.default.AUDIO_TRACK_SWITCHING,u.default.AUDIO_TRACK_LOADED,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.FRAG_PARSING_INIT_SEGMENT,u.default.FRAG_PARSING_DATA,u.default.FRAG_PARSED,u.default.ERROR,u.default.BUFFER_RESET,u.default.BUFFER_CREATED,u.default.BUFFER_APPENDED,u.default.BUFFER_FLUSHED,u.default.INIT_PTS_FOUND)||this;return r.fragmentTracker=i,r.config=t.config,r.audioCodecSwap=!1,r._state=k,r.initPTS=[],r.waitingFragment=null,r.videoTrackCC=null,r}i=n;(t=o).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,h,t=o.prototype;return t.onInitPtsFound=function(n){var i=n.id,t=n.frag.cc,n=n.initPTS;"main"===i&&(this.initPTS[t]=n,this.videoTrackCC=t,r.logger.log("InitPTS for cc: "+t+" found from video track: "+n),this.state===ci&&this.tick())},t.startLoad=function(n){var t;this.tracks?(t=this.lastCurrentTime,this.stopLoad(),this.setInterval(100),(this.fragLoadError=0)<t&&-1===n?(r.logger.log("audio:override startPosition with lastCurrentTime @"+t.toFixed(3)),this.state=s):(this.lastCurrentTime=this.startPosition||n,this.state=tu),this.nextLoadPosition=this.startPosition=this.lastCurrentTime,this.tick()):(this.startPosition=n,this.state=k)},t.doTick=function(){var l,k,t,tt,it=this.hls,p=it.config,f,n;switch(this.state){case tu:this.state=bt;this.loadedmetadata=!1;break;case s:if(f=this.tracks,!f)break;if(!this.media&&(this.startFragRequested||!p.startFragPrefetch))break;if(this.loadedmetadata)l=this.media.currentTime;else if(void 0===(l=this.nextLoadPosition))break;var ut=this.mediaBuffer||this.media,w=this.videoBuffer||this.media,i=a.bufferInfo(ut,l,p.maxBufferHole),w=a.bufferInfo(w,l,p.maxBufferHole),o=i.len,h=i.end,v=this.fragPrevious,y=Math.min(p.maxBufferLength,p.maxMaxBufferLength),y=Math.max(y,w.len),w=this.audioSwitch,nt=this.trackId;if((o<y||w)&&nt<f.length){if(void 0===(t=f[nt].details)){this.state=bt;break}if(!w&&this._streamEnded(i,t))return this.hls.trigger(u.default.BUFFER_EOS,{type:"audio"}),void(this.state=hi);var o=t.fragments,y=o.length,f=o[0].start,c=o[y-1].start+o[y-1].duration;if(w)if(t.live&&!t.PTSKnown)r.logger.log("switching audiotrack, live stream, unknown PTS,load first fragment"),h=0;else if(h=l,t.PTSKnown&&l<f){if(!(i.end>f||i.nextStart))return;r.logger.log("alt audio track ahead of main track, seek to start of alt audio track");this.media.currentTime=f+.05}if(t.initSegment&&!t.initSegment.data)n=t.initSegment;else if(h<=f){if(n=o[0],null!==this.videoTrackCC&&n.cc!==this.videoTrackCC&&(tt=this.videoTrackCC,n=pt.search(o,function(n){return n.cc<tt?1:n.cc>tt?-1:0})),t.live&&n.loadIdx&&n.loadIdx===this.fragLoadIdx)return i=i.nextStart||f,r.logger.log("no alt audio available @currentTime:"+this.media.currentTime+", seeking @"+(i+.05)),void(this.media.currentTime=i+.05)}else{var ft=p.maxFragLookUpTolerance,i=v?o[v.sn-o[0].sn+1]:void 0,b=function(n){var t=Math.min(ft,n.duration);return n.start+n.duration-t<=h?1:n.start-t>h&&n.start?-1:0},c=h<c?(c-ft<h&&(ft=0),i&&!b(i)?i:pt.search(o,b)):o[y-1];c&&(f=(n=c).start,v&&n.level===v.level&&n.sn===v.sn&&(n.sn<t.endSN?(n=o[n.sn+1-t.startSN],r.logger.log("SN just loaded, load next one: "+n.sn)):n=null))}n&&(n.encrypted?(r.logger.log("Loading key for "+n.sn+" of ["+t.startSN+" ,"+t.endSN+"],track "+nt),this.state=rt,it.trigger(u.default.KEY_LOADING,{frag:n})):(r.logger.log("Loading "+n.sn+", cc: "+n.cc+" of ["+t.startSN+" ,"+t.endSN+"],track "+nt+", currentTime:"+l+",bufferEnd:"+h.toFixed(3)),this.fragCurrent=n,!w&&this.fragmentTracker.getState(n)!==yt||("initSegment"!==n.sn&&(this.startFragRequested=!0),Object(e.isFiniteNumber)(n.sn)&&(this.nextLoadPosition=n.start+n.duration),it.trigger(u.default.FRAG_LOADING,{frag:n}),this.state=d)))}break;case bt:(k=this.tracks[this.trackId])&&k.details&&(this.state=s);break;case wt:i=ct.now();b=this.retryDate;y=(ut=this.media)&&ut.seeking;(!b||b<=i||y)&&(r.logger.log("audioStreamController: retryDate reached, switch back to IDLE state"),this.state=s);break;case ci:if(c=this.videoTrackCC,void 0===this.initPTS[c])break;f=this.waitingFragment;f?c!==(v=f.frag.cc)?(k=this.tracks[this.trackId]).details&&k.details.live&&(r.logger.warn("Waiting fragment CC ("+v+") does not match video track CC ("+c+")"),this.waitingFragment=null,this.state=s):(this.state=d,this.onFragLoaded(this.waitingFragment),this.waitingFragment=null):this.state=s}},t.onMediaAttached=function(n){n=this.media=this.mediaBuffer=n.media;this.onvseeking=this.onMediaSeeking.bind(this);this.onvended=this.onMediaEnded.bind(this);n.addEventListener("seeking",this.onvseeking);n.addEventListener("ended",this.onvended);n=this.config;this.tracks&&n.autoStartLoad&&this.startLoad(n.startPosition)},t.onMediaDetaching=function(){var n=this.media;n&&n.ended&&(r.logger.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0);n&&(n.removeEventListener("seeking",this.onvseeking),n.removeEventListener("ended",this.onvended),this.onvseeking=this.onvseeked=this.onvended=null);this.media=this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1;this.fragmentTracker.removeAllFragments();this.stopLoad()},t.onAudioTracksUpdated=function(n){r.logger.log("audio tracks updated");this.tracks=n.audioTracks},t.onAudioTrackSwitching=function(n){var t=!!n.url;this.trackId=n.id;this.fragCurrent=null;this.state=iu;this.waitingFragment=null;t?this.setInterval(100):this.demuxer&&(this.demuxer.destroy(),this.demuxer=null);t&&(this.audioSwitch=!0,this.state=s);this.tick()},t.onAudioTrackLoaded=function(n){var t=n.details,n=n.id,f=this.tracks[n],i=t.totalduration,u=0;r.logger.log("track "+n+" loaded ["+t.startSN+","+t.endSN+"],duration:"+i);t.live?(n=f.details)&&0<t.fragments.length?(vr(n,t),u=t.fragments[0].start,t.PTSKnown?r.logger.log("live audio playlist sliding:"+u.toFixed(3)):r.logger.log("live audio playlist - outdated PTS, unknown sliding")):(t.PTSKnown=!1,r.logger.log("live audio playlist - first load, unknown sliding")):t.PTSKnown=!1;f.details=t;this.startFragRequested||(-1===this.startPosition&&(i=t.startTimeOffset,Object(e.isFiniteNumber)(i)?(r.logger.log("start time offset found in playlist, adjust startPosition to "+i),this.startPosition=i):t.live?(this.startPosition=this.computeLivePosition(u,t),r.logger.log("compute startPosition for audio-track to "+this.startPosition)):this.startPosition=0),this.nextLoadPosition=this.startPosition);this.state===bt&&(this.state=s);this.tick()},t.onKeyLoaded=function(){this.state===rt&&(this.state=s,this.tick())},t.onFragLoaded=function(n){var t,l,h,o,c,f,a,i=this.fragCurrent,e=n.frag;this.state===d&&i&&"audio"===e.type&&e.level===i.level&&e.sn===i.sn&&(l=(t=(e=this.tracks[this.trackId]).details).totalduration,h=i.level,o=i.sn,c=i.cc,e=this.config.defaultAudioCodec||e.audioCodec||"mp4a.40.2",f=this.stats=n.stats,"initSegment"===o?(this.state=s,f.tparsed=f.tbuffered=ct.now(),t.initSegment.data=n.payload,this.hls.trigger(u.default.FRAG_BUFFERED,{stats:f,frag:i,id:"audio"}),this.tick()):(this.state=y,this.appended=!1,this.demuxer||(this.demuxer=new ei(this.hls,"audio")),f=this.initPTS[c],a=t.initSegment?t.initSegment.data:[],t.initSegment||void 0!==f?(this.pendingBuffering=!0,r.logger.log("Demuxing "+o+" of ["+t.startSN+" ,"+t.endSN+"],track "+h),this.demuxer.push(n.payload,a,e,null,i,l,!1,f)):(r.logger.log("unknown video PTS for continuity counter "+c+", waiting for video PTS before demuxing audio frag "+o+" of ["+t.startSN+" ,"+t.endSN+"],track "+h),this.waitingFragment=n,this.state=ci)));this.fragLoadError=0},t.onFragParsingInitSegment=function(n){var t=this.fragCurrent,i=n.frag;t&&"audio"===n.id&&i.sn===t.sn&&i.level===t.level&&this.state===y&&((i=n.tracks).video&&delete i.video,(t=i.audio)&&(t.levelCodec=t.codec,t.id=n.id,this.hls.trigger(u.default.BUFFER_CODECS,i),r.logger.log("audio track:audio,container:"+t.container+",codecs[level/parsed]=["+t.levelCodec+"/"+t.codec+"]"),(n=t.initSegment)&&(i={type:"audio",data:n,parent:"audio",content:"initSegment"},this.audioSwitch?this.pendingData=[i]:(this.appended=!0,this.pendingBuffering=!0,this.hls.trigger(u.default.BUFFER_APPENDING,i))),this.tick()))},t.onFragParsingData=function(n){var c=this,t=this.fragCurrent,i=n.frag;if(t&&"audio"===n.id&&"audio"===n.type&&i.sn===t.sn&&i.level===t.level&&this.state===y){var i=this.trackId,o=this.tracks[i],s=this.hls,o=(Object(e.isFiniteNumber)(n.endPTS)||(n.endPTS=n.startPTS+t.duration,n.endDTS=n.startDTS+t.duration),t.addElementaryStream(b.AUDIO),r.logger.log("parsed "+n.type+",PTS:["+n.startPTS.toFixed(3)+","+n.endPTS.toFixed(3)+"],DTS:["+n.startDTS.toFixed(3)+"/"+n.endDTS.toFixed(3)+"],nb:"+n.nb),oi(o.details,t,n.startPTS,n.endPTS),this.audioSwitch),t=this.media,l=!1,h=(o&&(t&&t.readyState?(o=t.currentTime,r.logger.log("switching audio track : currentTime:"+o),o>=n.startPTS&&(r.logger.log("switching audio track : flushing all audio"),this.state=st,s.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),this.audioSwitch=!(l=!0),s.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:i}))):(this.audioSwitch=!1,s.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:i}))),this.pendingData);if(!h)return r.logger.warn("Apparently attempt to enqueue media payload without codec initialization data upfront"),void s.trigger(u.default.ERROR,{type:f.ErrorTypes.MEDIA_ERROR,details:null,fatal:!0});this.audioSwitch||([n.data1,n.data2].forEach(function(t){t&&t.length&&h.push({type:n.type,data:t,parent:"audio",content:"data"})}),!l&&h.length&&(h.forEach(function(n){c.state===y&&(c.pendingBuffering=!0,c.hls.trigger(u.default.BUFFER_APPENDING,n))}),this.pendingData=[],this.appended=!0));this.tick()}},t.onFragParsed=function(n){var t=this.fragCurrent,i=n.frag;t&&"audio"===n.id&&i.sn===t.sn&&i.level===t.level&&this.state===y&&(this.stats.tparsed=ct.now(),this.state=p,this._checkAppendedParsed())},t.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null;this.loadedmetadata=!1},t.onBufferCreated=function(n){var t=n.tracks.audio;t&&(this.mediaBuffer=t.buffer,this.loadedmetadata=!0);n.tracks.video&&(this.videoBuffer=n.tracks.video.buffer)},t.onBufferAppended=function(n){var t;"audio"===n.parent&&((t=this.state)!==y&&t!==p||(this.pendingBuffering=0<n.pending,this._checkAppendedParsed()))},t._checkAppendedParsed=function(){var t,i,n;this.state!==p||this.appended&&this.pendingBuffering||(t=this.fragCurrent,n=this.stats,i=this.hls,t&&(this.fragPrevious=t,n.tbuffered=ct.now(),i.trigger(u.default.FRAG_BUFFERED,{stats:n,frag:t,id:"audio"}),(n=this.mediaBuffer||this.media)&&r.logger.log("audio buffered : "+si.toString(n.buffered)),this.audioSwitch&&this.appended&&(this.audioSwitch=!1,i.trigger(u.default.AUDIO_TRACK_SWITCHED,{id:this.trackId})),this.state=s),this.tick())},t.onError=function(n){var e=n.frag,i,t;if(!e||"audio"===e.type)switch(n.details){case f.ErrorDetails.FRAG_LOAD_ERROR:case f.ErrorDetails.FRAG_LOAD_TIMEOUT:if(t=n.frag,t&&"audio"!==t.type)break;n.fatal||((t=this.fragLoadError)?t++:t=1,t<=(i=this.config).fragLoadingMaxRetry?(this.fragLoadError=t,t=Math.min(Math.pow(2,t-1)*i.fragLoadingRetryDelay,i.fragLoadingMaxRetryTimeout),r.logger.warn("AudioStreamController: frag loading failed, retry in "+t+" ms"),this.retryDate=ct.now()+t,this.state=wt):(r.logger.error("AudioStreamController: "+n.details+" reaches max retry, redispatch as fatal ..."),n.fatal=!0,this.state=g));break;case f.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case f.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:case f.ErrorDetails.KEY_LOAD_ERROR:case f.ErrorDetails.KEY_LOAD_TIMEOUT:this.state!==g&&(this.state=n.fatal?g:s,r.logger.warn("AudioStreamController: "+n.details+" while loading frag, now switching to "+this.state+" state ..."));break;case f.ErrorDetails.BUFFER_FULL_ERROR:"audio"!==n.parent||this.state!==y&&this.state!==p||(i=this.mediaBuffer,t=this.media.currentTime,i&&a.isBuffered(i,t)&&a.isBuffered(i,t+.5)?((i=this.config).maxMaxBufferLength>=i.maxBufferLength&&(i.maxMaxBufferLength/=2,r.logger.warn("AudioStreamController: reduce max buffer length to "+i.maxMaxBufferLength+"s")),this.state=s):(r.logger.warn("AudioStreamController: buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,this.state=st,this.hls.trigger(u.default.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"})))}},t.onBufferFlushed=function(){var t=this,n=this.pendingData;n&&n.length?(r.logger.log("AudioStreamController: appending pending audio data after buffer flushed"),n.forEach(function(n){t.hls.trigger(u.default.BUFFER_APPENDING,n)}),this.appended=!0,this.pendingData=[],this.state=p):(this.state=s,this.fragPrevious=null,this.tick())},i=o,(t=[{key:"state",set:function(n){var t;this.state!==n&&(t=this.state,this._state=n,r.logger.log("audio stream:"+t+"->"+n))},get:function(){return this._state}}])&&yu(i.prototype,t),h&&yu(i,h),o}(ot),pu=function(){function t(n){return"string"==typeof n&&!!u[n.toLowerCase()]&&n.toLowerCase()}function n(n){for(var i,r,t=1;t<arguments.length;t++){r=arguments[t];for(i in r)n[i]=r[i]}return n}function i(i,u,f){var e=this,o={enumerable:!0},s=(e.hasBeenReset=!1,""),h=!1,c=i,l=u,a=f,v=null,y="",p=!0,w="auto",b="start",k=50,d="middle",g=50,nt="middle";Object.defineProperty(e,"id",n({},o,{get:function(){return s},set:function(n){s=""+n}}));Object.defineProperty(e,"pauseOnExit",n({},o,{get:function(){return h},set:function(n){h=!!n}}));Object.defineProperty(e,"startTime",n({},o,{get:function(){return c},set:function(n){if("number"!=typeof n)throw new TypeError("Start time must be set to a number.");c=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"endTime",n({},o,{get:function(){return l},set:function(n){if("number"!=typeof n)throw new TypeError("End time must be set to a number.");l=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"text",n({},o,{get:function(){return a},set:function(n){a=""+n;this.hasBeenReset=!0}}));Object.defineProperty(e,"region",n({},o,{get:function(){return v},set:function(n){v=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"vertical",n({},o,{get:function(){return y},set:function(n){if(n="string"==typeof(n=n)&&!!r[n.toLowerCase()]&&n.toLowerCase(),!1===n)throw new SyntaxError("An invalid or illegal string was specified.");y=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"snapToLines",n({},o,{get:function(){return p},set:function(n){p=!!n;this.hasBeenReset=!0}}));Object.defineProperty(e,"line",n({},o,{get:function(){return w},set:function(n){if("number"!=typeof n&&"auto"!==n)throw new SyntaxError("An invalid number or illegal string was specified.");w=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"lineAlign",n({},o,{get:function(){return b},set:function(n){if(n=t(n),!n)throw new SyntaxError("An invalid or illegal string was specified.");b=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"position",n({},o,{get:function(){return k},set:function(n){if(n<0||100<n)throw new Error("Position must be between 0 and 100.");k=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"positionAlign",n({},o,{get:function(){return d},set:function(n){if(n=t(n),!n)throw new SyntaxError("An invalid or illegal string was specified.");d=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"size",n({},o,{get:function(){return g},set:function(n){if(n<0||100<n)throw new Error("Size must be between 0 and 100.");g=n;this.hasBeenReset=!0}}));Object.defineProperty(e,"align",n({},o,{get:function(){return nt},set:function(n){if(n=t(n),!n)throw new SyntaxError("An invalid or illegal string was specified.");nt=n;this.hasBeenReset=!0}}));e.displayState=void 0}if("undefined"!=typeof window&&window.VTTCue)return window.VTTCue;var r={"":!0,lr:!0,rl:!0},u={start:!0,middle:!0,end:!0,left:!0,right:!0};return i.prototype.getCueAsHTML=function(){return window.WebVTT.convertCueToDOMTree(window,this.text)},i}();bu.prototype={set:function(n,t){this.get(n)||""===t||(this.values[n]=t)},get:function(n,t,i){return i?this.has(n)?this.values[n]:t[i]:this.has(n)?this.values[n]:t},has:function(n){return n in this.values},alt:function(n,t,i){for(var r=0;r<i.length;++r)if(t===i[r]){this.set(n,t);break}},integer:function(n,t){/^-?\d+$/.test(t)&&this.set(n,parseInt(t,10))},percent:function(n,t){return!!(t.match(/^([\d]{1,3})(\.[\d]*)?%$/)&&0<=(t=parseFloat(t))&&t<=100)&&(this.set(n,t),!0)}};gt=new pu(0,0,0);lt="middle"===gt.align?"middle":"center";wu.prototype={parse:function(n){function f(){for(var r,n=0,i=du(i=t.buffer);n<i.length&&"\r"!==i[n]&&"\n"!==i[n];)++n;return r=i.substr(0,n),"\r"===i[n]&&++n,"\n"===i[n]&&++n,t.buffer=i.substr(n),r}var t=this,i,u,r,e;n&&(t.buffer+=t.decoder.decode(n,{stream:!0}));try{if("INITIAL"===t.state){if(!/\r\n|\n/.test(t.buffer))return this;if(u=(i=f()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/),!u||!u[0])throw new Error("Malformed WebVTT signature.");t.state="HEADER"}for(r=!1;t.buffer;){if(!/\r\n|\n/.test(t.buffer))return this;switch(r?r=!1:i=f(),t.state){case"HEADER":/:/.test(i)?ku(i,function(n){n},/:/):i||(t.state="ID");continue;case"NOTE":i||(t.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(i)){t.state="NOTE";break}if(!i)continue;if(t.cue=new pu(0,0,""),t.state="CUE",-1===i.indexOf("-->")){t.cue.id=i;continue}case"CUE":try{we(i,t.cue,t.regionList)}catch(n){t.cue=null;t.state="BADCUE";continue}t.state="CUETEXT";continue;case"CUETEXT":if(e=-1!==i.indexOf("-->"),!i||e&&(r=!0)){t.oncue&&t.oncue(t.cue);t.cue=null;t.state="ID";continue}t.cue.text&&(t.cue.text+="\n");t.cue.text+=i;continue;case"BADCUE":i||(t.state="ID");continue}}}catch(n){"CUETEXT"===t.state&&t.cue&&t.oncue&&t.oncue(t.cue);t.cue=null;t.state="INITIAL"===t.state?"BADWEBVTT":"BADCUE"}return this},flush:function(){try{if(this.buffer+=this.decoder.decode(),!this.cue&&"HEADER"!==this.state||(this.buffer+="\n\n",this.parse()),"INITIAL"===this.state)throw new Error("Malformed WebVTT signature.");}catch(n){throw n;}return this.onflush&&this.onflush(),this}};gu=wu;var tf={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},w=100,ke={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},de={17:2,18:4,21:6,22:8,23:10,19:13,20:15},ge={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},no={25:2,26:4,29:6,30:8,31:10,27:13,28:15},to=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],o=((tt={ERROR:0,0:"ERROR",TEXT:1,1:"TEXT",WARNING:2,2:"WARNING",INFO:2})[2]="INFO",tt[tt.DEBUG=3]="DEBUG",tt[tt.DATA=3]="DATA",{verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(n){this.time=n},log:function(n){this.verboseFilter[n];this.verboseLevel}}),rf=function(){function t(n,t,i,r,u){this.foreground=void 0;this.underline=void 0;this.italics=void 0;this.background=void 0;this.flash=void 0;this.foreground=n||"white";this.underline=t||!1;this.italics=i||!1;this.background=r||"black";this.flash=u||!1}var n=t.prototype;return n.reset=function(){this.foreground="white";this.underline=!1;this.italics=!1;this.background="black";this.flash=!1},n.setStyles=function(n){for(var i,r=["foreground","underline","italics","background","flash"],t=0;t<r.length;t++)i=r[t],n.hasOwnProperty(i)&&(this[i]=n[i])},n.isDefault=function(){return"white"===this.foreground&&!this.underline&&!this.italics&&"black"===this.background&&!this.flash},n.equals=function(n){return this.foreground===n.foreground&&this.underline===n.underline&&this.italics===n.italics&&this.background===n.background&&this.flash===n.flash},n.copy=function(n){this.foreground=n.foreground;this.underline=n.underline;this.italics=n.italics;this.background=n.background;this.flash=n.flash},n.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},t}(),io=function(){function t(n,t,i,r,u,f){this.uchar=void 0;this.penState=void 0;this.uchar=n||" ";this.penState=new rf(t,i,r,u,f)}var n=t.prototype;return n.reset=function(){this.uchar=" ";this.penState.reset()},n.setChar=function(n,t){this.uchar=n;this.penState.copy(t)},n.setPenState=function(n){this.penState.copy(n)},n.equals=function(n){return this.uchar===n.uchar&&this.penState.equals(n.penState)},n.copy=function(n){this.uchar=n.uchar;this.penState.copy(n.penState)},n.isEmpty=function(){return" "===this.uchar&&this.penState.isDefault()},t}(),ro=function(){function t(){this.chars=void 0;this.pos=void 0;this.currPenState=void 0;this.cueStartTime=void 0;this.chars=[];for(var n=0;n<w;n++)this.chars.push(new io);this.pos=0;this.currPenState=new rf}var n=t.prototype;return n.equals=function(n){for(var i=!0,t=0;t<w;t++)if(!this.chars[t].equals(n.chars[t])){i=!1;break}return i},n.copy=function(n){for(var t=0;t<w;t++)this.chars[t].copy(n.chars[t])},n.isEmpty=function(){for(var t=!0,n=0;n<w;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},n.setCursor=function(n){this.pos!==n&&(this.pos=n);this.pos<0?(o.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>w&&(o.log("ERROR","Too large cursor position "+this.pos),this.pos=w)},n.moveCursor=function(n){var i=this.pos+n,t;if(1<n)for(t=this.pos+1;t<i+1;t++)this.chars[t].setPenState(this.currPenState);this.setCursor(i)},n.backSpace=function(){this.moveCursor(-1);this.chars[this.pos].setChar(" ",this.currPenState)},n.insertChar=function(n){144<=n&&this.backSpace();var t=nf(n);this.pos>=w?o.log("ERROR","Cannot insert "+n.toString(16)+" ("+t+") at position "+this.pos+". Skipping it!"):(this.chars[this.pos].setChar(t,this.currPenState),this.moveCursor(1))},n.clearFromPos=function(n){for(var t=n;t<w;t++)this.chars[t].reset()},n.clear=function(){this.clearFromPos(0);this.pos=0;this.currPenState.reset()},n.clearToEndOfRow=function(){this.clearFromPos(this.pos)},n.getTextString=function(){for(var t,i=[],r=!0,n=0;n<w;n++)t=this.chars[n].uchar," "!==t&&(r=!1),i.push(t);return r?"":i.join("")},n.setPenStyles=function(n){this.currPenState.setStyles(n);this.chars[this.pos].setPenState(this.currPenState)},t}(),pi=function(){function t(){this.rows=void 0;this.currRow=void 0;this.nrRollUpRows=void 0;this.lastOutputScreen=void 0;this.rows=[];for(var n=0;n<15;n++)this.rows.push(new ro);this.currRow=14;this.nrRollUpRows=null;this.reset()}var n=t.prototype;return n.reset=function(){for(var n=0;n<15;n++)this.rows[n].clear();this.currRow=14},n.equals=function(n){for(var i=!0,t=0;t<15;t++)if(!this.rows[t].equals(n.rows[t])){i=!1;break}return i},n.copy=function(n){for(var t=0;t<15;t++)this.rows[t].copy(n.rows[t])},n.isEmpty=function(){for(var t=!0,n=0;n<15;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t},n.backSpace=function(){this.rows[this.currRow].backSpace()},n.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},n.insertChar=function(n){this.rows[this.currRow].insertChar(n)},n.setPen=function(n){this.rows[this.currRow].setPenStyles(n)},n.moveCursor=function(n){this.rows[this.currRow].moveCursor(n)},n.setCursor=function(n){o.log("INFO","setCursor: "+n);this.rows[this.currRow].setCursor(n)},n.setPAC=function(n){var i,u,s,f,r,e,t;if(o.log("INFO","pacData = "+JSON.stringify(n)),i=n.row-1,this.nrRollUpRows&&i<this.nrRollUpRows-1&&(i=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==i){for(u=0;u<15;u++)this.rows[u].clear();if(s=this.currRow+1-this.nrRollUpRows,f=this.lastOutputScreen,f&&(t=f.rows[s].cueStartTime,t&&o.time&&t<o.time))for(r=0;r<this.nrRollUpRows;r++)this.rows[i-this.nrRollUpRows+r+1].copy(f.rows[s+r])}this.currRow=i;t=this.rows[this.currRow];t=(null!==n.indent&&(e=n.indent,e=Math.max(e-1,0),t.setCursor(n.indent),n.color=t.chars[e].penState.foreground),{foreground:n.color,underline:n.underline,italics:n.italics,background:"black",flash:!1});this.setPen(t)},n.setBkgData=function(n){o.log("INFO","bkgData = "+JSON.stringify(n));this.backSpace();this.setPen(n);this.insertChar(32)},n.setRollUpRows=function(n){this.nrRollUpRows=n},n.rollUp=function(){var n;null!==this.nrRollUpRows?(o.log("TEXT",this.getDisplayText()),n=this.currRow+1-this.nrRollUpRows,(n=this.rows.splice(n,1)[0]).clear(),this.rows.splice(this.currRow,0,n),o.log("INFO","Rolling up")):o.log("DEBUG","roll_up but nrRollUpRows not set yet")},n.getDisplayText=function(n){var r;n=n||!1;for(var t=[],i=0;i<15;i++)r=this.rows[i].getTextString(),r&&(n?t.push("Row "+(i+1)+": '"+r+"'"):t.push(r.trim()));return 0<t.length?n?"["+t.join(" | ")+"]":t.join("\n"):""},n.getTextAndFormat=function(){return this.rows},t}(),uf=function(){function t(n,t){this.chNr=void 0;this.outputFilter=void 0;this.mode=void 0;this.verbose=void 0;this.displayedMemory=void 0;this.nonDisplayedMemory=void 0;this.lastOutputScreen=void 0;this.currRollUpRow=void 0;this.writeScreen=void 0;this.cueStartTime=void 0;this.lastCueEndTime=void 0;this.chNr=n;this.outputFilter=t;this.mode=null;this.verbose=0;this.displayedMemory=new pi;this.nonDisplayedMemory=new pi;this.lastOutputScreen=new pi;this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null}var n=t.prototype;return n.reset=function(){this.mode=null;this.displayedMemory.reset();this.nonDisplayedMemory.reset();this.lastOutputScreen.reset();this.currRollUpRow=this.displayedMemory.rows[14];this.writeScreen=this.displayedMemory;this.mode=null;this.cueStartTime=null},n.getHandler=function(){return this.outputFilter},n.setHandler=function(n){this.outputFilter=n},n.setPAC=function(n){this.writeScreen.setPAC(n)},n.setBkgData=function(n){this.writeScreen.setBkgData(n)},n.setMode=function(n){n!==this.mode&&(this.mode=n,o.log("INFO","MODE="+n),"MODE_POP-ON"===this.mode?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),"MODE_ROLL-UP"!==this.mode&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=n)},n.insertChars=function(n){for(var i,t=0;t<n.length;t++)this.writeScreen.insertChar(n[t]);i=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";o.log("INFO",i+": "+this.writeScreen.getDisplayText(!0));"MODE_PAINT-ON"!==this.mode&&"MODE_ROLL-UP"!==this.mode||(o.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},n.ccRCL=function(){o.log("INFO","RCL - Resume Caption Loading");this.setMode("MODE_POP-ON")},n.ccBS=function(){o.log("INFO","BS - BackSpace");"MODE_TEXT"!==this.mode&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},n.ccAOF=function(){},n.ccAON=function(){},n.ccDER=function(){o.log("INFO","DER- Delete to End of Row");this.writeScreen.clearToEndOfRow();this.outputDataUpdate()},n.ccRU=function(n){o.log("INFO","RU("+n+") - Roll Up");this.writeScreen=this.displayedMemory;this.setMode("MODE_ROLL-UP");this.writeScreen.setRollUpRows(n)},n.ccFON=function(){o.log("INFO","FON - Flash On");this.writeScreen.setPen({flash:!0})},n.ccRDC=function(){o.log("INFO","RDC - Resume Direct Captioning");this.setMode("MODE_PAINT-ON")},n.ccTR=function(){o.log("INFO","TR");this.setMode("MODE_TEXT")},n.ccRTD=function(){o.log("INFO","RTD");this.setMode("MODE_TEXT")},n.ccEDM=function(){o.log("INFO","EDM - Erase Displayed Memory");this.displayedMemory.reset();this.outputDataUpdate(!0)},n.ccCR=function(){o.log("INFO","CR - Carriage Return");this.writeScreen.rollUp();this.outputDataUpdate(!0)},n.ccENM=function(){o.log("INFO","ENM - Erase Non-displayed Memory");this.nonDisplayedMemory.reset()},n.ccEOC=function(){var n;o.log("INFO","EOC - End Of Caption");"MODE_POP-ON"===this.mode&&(n=this.displayedMemory,this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=n,this.writeScreen=this.nonDisplayedMemory,o.log("TEXT","DISP: "+this.displayedMemory.getDisplayText()));this.outputDataUpdate(!0)},n.ccTO=function(n){o.log("INFO","TO("+n+") - Tab Offset");this.writeScreen.moveCursor(n)},n.ccMIDROW=function(n){var t={flash:!1};t.underline=n%2==1;t.italics=46<=n;t.italics?t.foreground="white":(n=Math.floor(n/2)-16,t.foreground=["white","green","blue","cyan","red","yellow","magenta"][n]);o.log("INFO","MIDROW: "+JSON.stringify(t));this.writeScreen.setPen(t)},n.outputDataUpdate=function(n){void 0===n&&(n=!1);var t=o.time;null!==t&&this.outputFilter&&(null!==this.cueStartTime||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,t,this.lastOutputScreen),n&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:t):this.cueStartTime=t,this.lastOutputScreen.copy(this.displayedMemory))},n.cueSplitAtTime=function(n){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,n,this.displayedMemory),this.cueStartTime=n))},t}(),uo=function(){function t(n,t,i){this.field=void 0;this.outputs=void 0;this.channels=void 0;this.currChNr=void 0;this.lastCmdA=void 0;this.lastCmdB=void 0;this.lastTime=void 0;this.dataCounters=void 0;this.field=n||1;this.outputs=[t,i];this.channels=[new uf(1,t),new uf(2,i)];this.currChNr=-1;this.lastCmdA=null;this.lastCmdB=null;this.lastTime=null;this.dataCounters={padding:0,char:0,cmd:0,other:0}}var n=t.prototype;return n.getHandler=function(n){return this.channels[n].getHandler()},n.setHandler=function(n,t){this.channels[n].setHandler(t)},n.addData=function(n,t){var f,e=!1,i,r,u;for(this.lastTime=n,o.setTime(n),i=0;i<t.length;i+=2)r=127&t[i],u=127&t[i+1],0!=r||0!=u?(o.log("DATA","["+nt([t[i],t[i+1]])+"] -> ("+nt([r,u])+")"),(f=(f=(f=(f=this.parseCmd(r,u))||this.parseMidrow(r,u))||this.parsePAC(r,u))||this.parseBackgroundAttributes(r,u))||(e=this.parseChars(r,u))&&(this.currChNr&&0<=this.currChNr?this.channels[this.currChNr-1].insertChars(e):o.log("WARNING","No channel found yet. TEXT-MODE?")),f?this.dataCounters.cmd+=2:e?this.dataCounters.char+=2:(this.dataCounters.other+=2,o.log("WARNING","Couldn't parse cleaned data "+nt([r,u])+" orig: "+nt([t[i],t[i+1]])))):this.dataCounters.padding+=2},n.parseCmd=function(n,t){var r=null,i;return!((20===n||28===n)&&32<=t&&t<=47)&&!((23===n||31===n)&&33<=t&&t<=35)?!1:n===this.lastCmdA&&t===this.lastCmdB?(this.lastCmdA=null,this.lastCmdB=null,o.log("DEBUG","Repeated command ("+nt([n,t])+") is dropped"),!0):(r=20===n||23===n?1:2,i=this.channels[r-1],20===n||28===n?32===t?i.ccRCL():33===t?i.ccBS():34===t?i.ccAOF():35===t?i.ccAON():36===t?i.ccDER():37===t?i.ccRU(2):38===t?i.ccRU(3):39===t?i.ccRU(4):40===t?i.ccFON():41===t?i.ccRDC():42===t?i.ccTR():43===t?i.ccRTD():44===t?i.ccEDM():45===t?i.ccCR():46===t?i.ccENM():47===t&&i.ccEOC():i.ccTO(t-32),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=r,!0)},n.parseMidrow=function(n,t){var i=null;return(17===n||25===n)&&32<=t&&t<=47&&((i=17===n?1:2)!==this.currChNr?(o.log("ERROR","Mismatch channel in midrow parsing"),!1):(this.channels[i-1].ccMIDROW(t),o.log("DEBUG","MIDROW ("+nt([n,t])+")"),!0))},n.parsePAC=function(n,t){var r=null;if(!((17<=n&&n<=23||25<=n&&n<=31)&&64<=t&&t<=127)&&!((16===n||24===n)&&64<=t&&t<=95))return!1;if(n===this.lastCmdA&&t===this.lastCmdB)return this.lastCmdA=null,!(this.lastCmdB=null);var i=n<=23?1:2,r=(64<=t&&t<=95?1==i?ke:ge:1==i?de:no)[n],r=this.interpretPAC(r,t);return this.channels[i-1].setPAC(r),this.lastCmdA=n,this.lastCmdB=t,this.currChNr=i,!0},n.interpretPAC=function(n,t){var i=t,n={color:null,italics:!1,indent:null,underline:!1,row:n},i=95<t?t-96:t-64;return n.underline=1==(1&i),i<=13?n.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(i/2)]:i<=15?(n.italics=!0,n.color="white"):n.indent=4*Math.floor((i-16)/2),n},n.parseChars=function(n,t){var u,f=null,r=null,i=null;return 17<=(i=25<=n?(f=2,n-8):(f=1,n))&&i<=19?(u=t,o.log("INFO","Special char '"+nf(u=17===i?t+80:18===i?t+112:t+144)+"' in channel "+f),r=[u]):32<=n&&n<=127&&(r=0===t?[n]:[n,t]),r&&(i=nt(r),o.log("DEBUG","Char codes =  "+i.join(",")),this.lastCmdA=null,this.lastCmdB=null),r},n.parseBackgroundAttributes=function(n,t){var i,r;return((16===n||24===n)&&32<=t&&t<=47||(23===n||31===n)&&45<=t&&t<=47)&&(i={},16===n||24===n?(r=Math.floor((t-32)/2),i.background=to[r],t%2==1&&(i.background=i.background+"_semi")):45===t?i.background="transparent":(i.foreground="black",47===t&&(i.underline=!0)),this.channels[(n<24?1:2)-1].setBkgData(i),this.lastCmdA=null,!(this.lastCmdB=null))},n.reset=function(){for(var n=0;n<this.channels.length;n++)this.channels[n]&&this.channels[n].reset();this.lastCmdA=null;this.lastCmdB=null},n.cueSplitAtTime=function(n){for(var t=0;t<this.channels.length;t++)this.channels[t]&&this.channels[t].cueSplitAtTime(n)},t}(),ff=function(){function n(n,t){this.timelineController=void 0;this.trackName=void 0;this.startTime=void 0;this.endTime=void 0;this.screen=void 0;this.timelineController=n;this.trackName=t;this.startTime=null;this.endTime=null;this.screen=null}var t=n.prototype;return t.dispatchCue=function(){null!==this.startTime&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen),this.startTime=null)},t.newCue=function(n,t,i){(null===this.startTime||this.startTime>n)&&(this.startTime=n);this.endTime=t;this.screen=i;this.timelineController.createCaptionsTrack(this.trackName)},n}(),fo={parse:function(n,t,i,r,u,f){var s,n=Object(dt.utf8ArrayToStr)(new Uint8Array(n)).trim().replace(/\r\n|\n\r|\n|\r/g,"\n").split("\n"),y="00:00.000",l=0,h=0,c=0,p=[],a=!0,v=!1,o=new gu;o.oncue=function(n){var u=i[r],t=i.ccOffset;u&&u.new&&(void 0!==h?t=i.ccOffset=u.start:function(n,t,i){var r=n[t],u=n[r.prevCC];if(!u||!u.new&&r.new)return n.ccOffset=n.presentationOffset=r.start,r.new=!1;for(;u&&u.new;)n.ccOffset+=r.start-u.start,r.new=!1,u=n[(r=u).prevCC];n.presentationOffset=i}(i,r,c));c&&(t=c-i.presentationOffset);v&&(n.startTime+=t-h,n.endTime+=t-h);n.id=yi(n.startTime.toString())+yi(n.endTime.toString())+yi(n.text);n.text=decodeURIComponent(encodeURIComponent(n.text));0<n.endTime&&p.push(n)};o.onparsingerror=function(n){s=n};o.onflush=function(){s&&f?f(s):u(p)};n.forEach(function(n){if(a){if(vi(n,"X-TIMESTAMP-MAP=")){v=!(a=!1);n.substr(16).split(",").forEach(function(n){vi(n,"LOCAL:")?y=n.substr(6):vi(n,"MPEGTS:")&&(l=parseInt(n.substr(7)))});try{t+(9e4*i[r].start||0)<0&&(t+=8589934592);l-=t;h=function(n){var t=parseInt(n.substr(-3)),i=parseInt(n.substr(-6,2)),r=parseInt(n.substr(-9,2)),u=9<n.length?parseInt(n.substr(0,n.indexOf(":"))):0;if(!(Object(e.isFiniteNumber)(t)&&Object(e.isFiniteNumber)(i)&&Object(e.isFiniteNumber)(r)&&Object(e.isFiniteNumber)(u)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+n);return(t+=1e3*i)+6e4*r+36e5*u}(y)/1e3;c=l/9e4}catch(n){v=!1;s=n}return}""===n&&(a=!1)}o.parse(n+"\n")});o.flush()}};tt=function(n){function f(t){var r,i=n.call(this,t,u.default.MEDIA_ATTACHING,u.default.MEDIA_DETACHING,u.default.FRAG_PARSING_USERDATA,u.default.FRAG_DECRYPTED,u.default.MANIFEST_LOADING,u.default.MANIFEST_LOADED,u.default.FRAG_LOADED,u.default.INIT_PTS_FOUND)||this;return i.media=null,i.config=void 0,i.enabled=!0,i.Cues=void 0,i.textTracks=[],i.tracks=[],i.initPTS=[],i.unparsedVttFrags=[],i.cueRanges=[],i.captionsTracks={},i.captionsProperties=void 0,i.cea608Parser=void 0,i.lastSn=-1,i.prevCC=-1,i.vttCCs=null,i.hls=t,i.config=t.config,i.Cues=t.config.cueHandler,i.captionsProperties={textTrack1:{label:i.config.captionsTextTrack1Label,languageCode:i.config.captionsTextTrack1LanguageCode},textTrack2:{label:i.config.captionsTextTrack2Label,languageCode:i.config.captionsTextTrack2LanguageCode}},i.config.enableCEA708Captions&&(t=new ff(ef(i),"textTrack1"),r=new ff(ef(i),"textTrack2"),i.cea608Parser=new uo(0,t,r)),i}var i,t;return i=n,(t=f).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=f.prototype,t.addCues=function(n,t,i,r){for(var u,f,o,s,e=this.cueRanges,h=!1,c=e.length;c--;)if(u=e[c],f=(o=u[0],f=u[1],s=t,Math.min(f,i)-Math.max(o,s)),0<=f&&(u[0]=Math.min(u[0],t),u[1]=Math.max(u[1],i),h=!0,.5<f/(i-t)))return;h||e.push([t,i]);this.Cues.newCue(this.captionsTracks[n],t,i,r)},t.onInitPtsFound=function(n){var i=this,r=n.frag,u=n.id,n=n.initPTS,t=this.unparsedVttFrags;"main"===u&&(this.initPTS[r.cc]=n);t.length&&(this.unparsedVttFrags=[],t.forEach(function(n){i.onFragLoaded(n)}))},t.getExistingTrack=function(n){var i=this.media,t,r;if(i)for(t=0;t<i.textTracks.length;t++)if(r=i.textTracks[t],r[n])return r;return null},t.createCaptionsTrack=function(n){var t,r=this.captionsProperties,i=this.captionsTracks,u=this.media,r=r[n],f=r.label,r=r.languageCode;i[n]||((t=this.getExistingTrack(n))?(i[n]=t,ht(i[n]),su(i[n],u)):(t=this.createTextTrack("captions",f,r))&&(t[n]=!0,i[n]=t))},t.createTextTrack=function(n,t,i){var r=this.media;if(r)return r.addTextTrack(n,t,i)},t.destroy=function(){n.prototype.destroy.call(this)},t.onMediaAttaching=function(n){this.media=n.media;this._cleanTracks()},t.onMediaDetaching=function(){var n=this.captionsTracks;Object.keys(n).forEach(function(t){ht(n[t]);delete n[t]})},t.onManifestLoading=function(){this.lastSn=-1;this.prevCC=-1;this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,"new":!1}};this._cleanTracks()},t._cleanTracks=function(){var i=this.media,n,t;if(i&&(n=i.textTracks,n))for(t=0;t<n.length;t++)ht(n[t])},t.onManifestLoaded=function(n){var t,i=this;this.textTracks=[];this.unparsedVttFrags=this.unparsedVttFrags||[];this.initPTS=[];this.cueRanges=[];this.config.enableWebVTT&&(this.tracks=n.subtitles||[],t=this.media?this.media.textTracks:[],this.tracks.forEach(function(n,r){var u,f,s,o,e;if(r<t.length){for(o=null,e=0;e<t.length;e++)if(f=t[e],s=n,f&&f.label===s.name&&!(f.textTrack1||f.textTrack2)){o=t[e];break}o&&(u=o)}u=u||i.createTextTrack("subtitles",n.name,n.lang);u.mode=n.default?i.hls.subtitleDisplay?"showing":"hidden":"disabled";i.textTracks.push(u)}))},t.onFragLoaded=function(n){var t=n.frag,r=n.payload,f=this.cea608Parser,o=this.initPTS,i=this.lastSn,h=this.unparsedVttFrags,s;if("main"===t.type)s=t.sn,t.sn!==i+1&&f&&f.reset(),this.lastSn=s;else if("subtitle"===t.type)if(r.byteLength){if(!Object(e.isFiniteNumber)(o[t.cc]))return h.push(n),void(o.length&&this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t}));i=t.decryptdata;null!=i&&null!=i.key&&"AES-128"===i.method||this._parseVTTs(t,r)}else this.hls.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t})},t._parseVTTs=function(n,t){var i=this.hls,e=this.prevCC,o=this.textTracks,f=this.vttCCs;f[n.cc]||(f[n.cc]={start:n.start,prevCC:e,"new":!0},this.prevCC=n.cc);fo.parse(t,this.initPTS[n.cc],f,n.cc,function(t){var f=o[n.level];"disabled"!==f.mode?(t.forEach(function(n){if(!f.cues.getCueById(n.id))try{if(f.addCue(n),!f.cues.getCueById(n.id))throw new Error("addCue is failed for: "+n);}catch(i){r.logger.debug("Failed occurred on adding cues: "+i);var t=new window.TextTrackCue(n.startTime,n.endTime,n.text);t.id=n.id;f.addCue(t)}}),i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:n})):i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})},function(t){r.logger.log("Failed to parse VTT cue: "+t);i.trigger(u.default.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:n})})},t.onFragDecrypted=function(n){var t=n.frag,i=n.payload;"subtitle"===t.type&&(Object(e.isFiniteNumber)(this.initPTS[t.cc])?this._parseVTTs(t,i):this.unparsedVttFrags.push(n))},t.onFragParsingUserdata=function(n){var t,i;if(this.enabled&&this.cea608Parser)for(t=0;t<n.samples.length;t++)i=n.samples[t].bytes,i&&(i=this.extractCea608Data(i),this.cea608Parser.addData(n.samples[t].pts,i))},t.extractCea608Data=function(n){for(var t,i,r,o=31&n[0],u=2,f=[],e=0;e<o;e++)t=n[u++],i=127&n[u++],r=127&n[u++],0==i&&0==r||0!=(4&t)&&0==(3&t)&&(f.push(i),f.push(r));return f},f}(h);var eo=function(n){function f(t){return t=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.MANIFEST_LOADED,u.default.SUBTITLE_TRACK_LOADED)||this,t.tracks=[],t.trackId=-1,t.media=null,t.stopped=!0,t.subtitleDisplay=!0,t.queuedDefaultTrack=null,t}i=n;(t=f).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,o,t=f.prototype;return t.destroy=function(){h.prototype.destroy.call(this)},t.onMediaAttached=function(n){var t=this;this.media=n.media;this.media&&(Object(e.isFiniteNumber)(this.queuedDefaultTrack)&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=null),this.trackChangeListener=this._onTextTracksChanged.bind(this),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.subtitlePollingInterval=setInterval(function(){t.trackChangeListener()},500):this.media.textTracks.addEventListener("change",this.trackChangeListener))},t.onMediaDetaching=function(){this.media&&(this.useTextTrackPolling?clearInterval(this.subtitlePollingInterval):this.media.textTracks.removeEventListener("change",this.trackChangeListener),Object(e.isFiniteNumber)(this.subtitleTrack)&&(this.queuedDefaultTrack=this.subtitleTrack),wi(this.media.textTracks).forEach(function(n){ht(n)}),this.subtitleTrack=-1,this.media=null)},t.onManifestLoaded=function(n){var t=this,n=n.subtitles||[];this.tracks=n;this.hls.trigger(u.default.SUBTITLE_TRACKS_UPDATED,{subtitleTracks:n});n.forEach(function(n){n.default&&(t.media?t.subtitleTrack=n.id:t.queuedDefaultTrack=n.id)})},t.onSubtitleTrackLoaded=function(n){var o=this,i=n.id,u=n.details,f=this.trackId,t=this.tracks,e=t[f];i>=t.length||i!==f||!e||this.stopped?this._clearReloadTimer():(r.logger.log("subtitle track "+i+" loaded"),u.live?(t=pr(e.details,u,n.stats.trequest),r.logger.log("Reloading live subtitle playlist in "+t+"ms"),this.timer=setTimeout(function(){o._loadCurrentTrack()},t)):this._clearReloadTimer())},t.startLoad=function(){this.stopped=!1;this._loadCurrentTrack()},t.stopLoad=function(){this.stopped=!0;this._clearReloadTimer()},t._clearReloadTimer=function(){this.timer&&(clearTimeout(this.timer),this.timer=null)},t._loadCurrentTrack=function(){var t=this.trackId,n=this.tracks,i=this.hls,n=n[t];t<0||!n||n.details&&!n.details.live||(r.logger.log("Loading subtitle track "+t),i.trigger(u.default.SUBTITLE_TRACK_LOADING,{url:n.url,id:t}))},t._toggleTrackModes=function(n){var t=this.media,r=this.subtitleDisplay,i=this.trackId;t&&(t=wi(t.textTracks),-1===n?[].slice.call(t).forEach(function(n){n.mode="disabled"}):(i=t[i])&&(i.mode="disabled"),(i=t[n])&&(i.mode=r?"showing":"hidden"))},t._setSubtitleTrackInternal=function(n){var t=this.hls,i=this.tracks;!Object(e.isFiniteNumber)(n)||n<-1||n>=i.length||(this.trackId=n,r.logger.log("Switching to subtitle track "+n),t.trigger(u.default.SUBTITLE_TRACK_SWITCH,{id:n}),this._loadCurrentTrack())},t._onTextTracksChanged=function(){if(this.media){for(var t=-1,i=wi(this.media.textTracks),n=0;n<i.length;n++)if("hidden"===i[n].mode)t=n;else if("showing"===i[n].mode){t=n;break}this.subtitleTrack=t}},i=f,(t=[{key:"subtitleTracks",get:function(){return this.tracks}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(n){this.trackId!==n&&(this._toggleTrackModes(n),this._setSubtitleTrackInternal(n))}}])&&of(i.prototype,t),o&&of(i,o),f}(h),oo=i("./src/crypt/decrypter.js"),ut,sf=window.performance,ot=function(n){function f(t,i){var r=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHING,u.default.ERROR,u.default.KEY_LOADED,u.default.FRAG_LOADED,u.default.SUBTITLE_TRACKS_UPDATED,u.default.SUBTITLE_TRACK_SWITCH,u.default.SUBTITLE_TRACK_LOADED,u.default.SUBTITLE_FRAG_PROCESSED,u.default.LEVEL_UPDATED)||this;return r.fragmentTracker=i,r.config=t.config,r.state=k,r.tracks=[],r.tracksBuffered=[],r.currentTrackId=-1,r.decrypter=new oo.default(t,t.config),r.lastAVStart=0,r._onMediaSeeking=r.onMediaSeeking.bind(function(n){if(void 0===n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}(r)),r}var i,t;return i=n,(t=f).prototype=Object.create(i.prototype),(t.prototype.constructor=t).__proto__=i,t=f.prototype,t.onSubtitleFragProcessed=function(n){var r=n.frag,n=n.success,t,u,f,i;if((this.fragPrevious=r,this.state=s,n)&&(t=this.tracksBuffered[this.currentTrackId],t)){for(f=r.start,i=0;i<t.length;i++)if(f>=t[i].start&&f<=t[i].end){u=t[i];break}n=r.start+r.duration;u?u.end=n:t.push(u={start:f,end:n})}},t.onMediaAttached=function(n){n=n.media;(this.media=n).addEventListener("seeking",this._onMediaSeeking);this.state=s},t.onMediaDetaching=function(){var n=this;this.media&&(this.media.removeEventListener("seeking",this._onMediaSeeking),this.fragmentTracker.removeAllFragments(),this.currentTrackId=-1,this.tracks.forEach(function(t){n.tracksBuffered[t.id]=[]}),this.media=null,this.state=k)},t.onError=function(n){n=n.frag;n&&"subtitle"===n.type&&(this.state=s)},t.onSubtitleTracksUpdated=function(n){var t=this;r.logger.log("subtitle tracks updated");this.tracksBuffered=[];this.tracks=n.subtitleTracks;this.tracks.forEach(function(n){t.tracksBuffered[n.id]=[]})},t.onSubtitleTrackSwitch=function(n){this.currentTrackId=n.id;this.tracks&&this.tracks.length&&-1!==this.currentTrackId?(n=this.tracks[this.currentTrackId])&&n.details&&this.setInterval(500):this.clearInterval()},t.onSubtitleTrackLoaded=function(n){var r=n.id,n=n.details,s=this.currentTrackId,u=this.tracks,f=u[s],t;if(!(r>=u.length||r!==s)&&f){if(n.live){var u=f.details,r=n,e=this.lastAVStart,o=(void 0===e&&(e=0),-1),i=(yr(u,r,function(n,t,i){t.start=n.start;o=i}),r.fragments);if(o<0)i.forEach(function(n){n.start+=e});else for(t=o+1;t<i.length;t++)i[t].start=i[t-1].start+i[t-1].duration}f.details=n;this.setInterval(500)}},t.onKeyLoaded=function(){this.state===rt&&(this.state=s)},t.onFragLoaded=function(n){var i,r=this.fragCurrent,t=n.frag.decryptdata,f=n.frag,e=this.hls;this.state===d&&r&&"subtitle"===n.frag.type&&r.sn===n.frag.sn&&0<n.payload.byteLength&&t&&t.key&&"AES-128"===t.method&&(i=sf.now(),this.decrypter.decrypt(n.payload,t.key.buffer,t.iv.buffer,function(n){var t=sf.now();e.trigger(u.default.FRAG_DECRYPTED,{frag:f,payload:n,stats:{tstart:i,tdecrypt:t}})}))},t.onLevelUpdated=function(n){n=n.details.fragments;this.lastAVStart=n.length?n[0].start:0},t.doTick=function(){var n,t;if(this.media)switch(this.state){case s:var t=this.config,i=this.currentTrackId,l=this.fragmentTracker,e=this.media,f=this.tracks;if(!f||!f[i]||!f[i].details)break;var o=t.maxBufferHole,c=t.maxFragLookUpTolerance,t=Math.min(t.maxBufferLength,t.maxMaxBufferLength),e=a.bufferedInfo(this._getBuffered(),e.currentTime,o),o=e.end,e=e.len,f=f[i].details,i=f.fragments,h=i.length,v=i[h-1].start+i[h-1].duration;if(t<e)return;t=this.fragPrevious;(n=o<v?(n=t&&f.hasProgramDateTime?kr(i,t.endProgramDateTime,c):n)||dr(t,i,o,c):i[h-1])&&n.encrypted?(r.logger.log("Loading key for "+n.sn),this.state=rt,this.hls.trigger(u.default.KEY_LOADING,{frag:n})):n&&l.getState(n)===yt&&(this.fragCurrent=n,this.state=d,this.hls.trigger(u.default.FRAG_LOADING,{frag:n}))}else this.state=s},t.stopLoad=function(){this.lastAVStart=0;n.prototype.stopLoad.call(this)},t._getBuffered=function(){return this.tracksBuffered[this.currentTrackId]||[]},t.onMediaSeeking=function(){this.fragPrevious=null},f}(ot),bi=((bi=ut=ut||{}).WIDEVINE="com.widevine.alpha",bi.PLAYREADY="com.microsoft.playready","undefined"!=typeof window&&window.navigator&&window.navigator.requestMediaKeySystemAccess?window.navigator.requestMediaKeySystemAccess.bind(window.navigator):null);cf=function(n){for(var i,r,t=1;t<arguments.length;t++)i=null!=arguments[t]?arguments[t]:{},r=Object.keys(i),(r="function"==typeof Object.getOwnPropertySymbols?r.concat(Object.getOwnPropertySymbols(i).filter(function(n){return Object.getOwnPropertyDescriptor(i,n).enumerable})):r).forEach(function(t){var r,u;r=n;u=i[t=t];t in r?Object.defineProperty(r,t,{value:u,enumerable:!0,configurable:!0,writable:!0}):r[t]=u});return n}({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,maxBufferSize:6e7,maxBufferHole:.5,lowBufferWatchdogPeriod:.5,highBufferWatchdogPeriod:3,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,liveDurationInfinity:!1,liveBackBufferLength:1/0,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:li,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,abrController:se,bufferController:he,capLevelController:ce,fpsController:ae,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,requestMediaKeySystemAccessFunc:bi},function(){return{cueHandler:ni,enableCEA708Captions:!0,enableWebVTT:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es"}}(),{subtitleStreamController:ot,subtitleTrackController:eo,timelineController:tt,audioStreamController:pe,audioTrackController:v,emeController:function(n){function e(t){var i=n.call(this,t,u.default.MEDIA_ATTACHED,u.default.MEDIA_DETACHED,u.default.MANIFEST_PARSED)||this;return i._widevineLicenseUrl=void 0,i._licenseXhrSetup=void 0,i._emeEnabled=void 0,i._requestMediaKeySystemAccess=void 0,i._config=void 0,i._mediaKeysList=[],i._media=null,i._hasSetMediaKeys=!1,i._requestLicenseFailureCount=0,i._onMediaEncrypted=function(n){r.logger.log('Media is encrypted using "'+n.initDataType+'" init data type');i._attemptSetMediaKeys();i._generateRequestWithPreferredKeySession(n.initDataType,n.initData)},i._config=t.config,i._widevineLicenseUrl=i._config.widevineLicenseUrl,i._licenseXhrSetup=i._config.licenseXhrSetup,i._emeEnabled=i._config.emeEnabled,i._requestMediaKeySystemAccess=i._config.requestMediaKeySystemAccessFunc,i}i=n;(t=e).prototype=Object.create(i.prototype);(t.prototype.constructor=t).__proto__=i;var i,o,t=e.prototype;return t.getLicenseServerUrl=function(n){switch(n){case ut.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+n+'"');},t._attemptKeySystemAccess=function(n,t,i){var u=this,i=function(n,t){if(n!==ut.WIDEVINE)throw new Error("Unknown key-system: "+n);return i={videoCapabilities:[]},t.forEach(function(n){i.videoCapabilities.push({contentType:'video/mp4; codecs="'+n+'"'})}),[i];var i}(n,i);r.logger.log("Requesting encrypted media key-system access");this.requestMediaKeySystemAccess(n,i).then(function(t){u._onMediaKeySystemAccessObtained(n,t)}).catch(function(t){r.logger.error('Failed to obtain key-system "'+n+'" access:',t)})},t._onMediaKeySystemAccessObtained=function(n,t){var u=this,i=(r.logger.log('Access for key-system "'+n+'" obtained'),{mediaKeysSessionInitialized:!1,mediaKeySystemAccess:t,mediaKeySystemDomain:n});this._mediaKeysList.push(i);t.createMediaKeys().then(function(t){i.mediaKeys=t;r.logger.log('Media-keys created for key-system "'+n+'"');u._onMediaKeysCreated()}).catch(function(n){r.logger.error("Failed to create media-keys:",n)})},t._onMediaKeysCreated=function(){var n=this;this._mediaKeysList.forEach(function(t){t.mediaKeysSession||(t.mediaKeysSession=t.mediaKeys.createSession(),n._onNewMediaKeySession(t.mediaKeysSession))})},t._onNewMediaKeySession=function(n){var t=this;r.logger.log("New key-system session "+n.sessionId);n.addEventListener("message",function(i){t._onKeySessionMessage(n,i.message)},!1)},t._onKeySessionMessage=function(n,t){r.logger.log("Got EME message event, creating license request");this._requestLicense(t,function(t){r.logger.log("Received license data (length: "+(t&&t.byteLength)+"), updating key-session");n.update(t)})},t._attemptSetMediaKeys=function(){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var n=this._mediaKeysList[0];if(!n||!n.mediaKeys)return r.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});r.logger.log("Setting keys for encrypted media");this._media.setMediaKeys(n.mediaKeys);this._hasSetMediaKeys=!0}},t._generateRequestWithPreferredKeySession=function(n,t){var e,o=this,i=this._mediaKeysList[0];if(!i)return r.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});if(!i.mediaKeysSessionInitialized)return(e=i.mediaKeysSession)?t?(r.logger.log('Generating key-session request for "'+n+'" init data type'),i.mediaKeysSessionInitialized=!0,void e.generateRequest(n,t).then(function(){r.logger.debug("Key-session generation succeeded")}).catch(function(n){r.logger.error("Error generating key-session request:",n);o.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})):(r.logger.warn("Fatal: initData required for generating a key session is null"),void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0})):(r.logger.error("Fatal: Media is encrypted but no key-session existing"),void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0}));r.logger.warn("Key-Session already initialized but requested again")},t._createLicenseXhr=function(n,t,i){var r=new XMLHttpRequest,u=this._licenseXhrSetup;try{if(u)try{u(r,n)}catch(t){r.open("POST",n,!0);u(r,n)}r.readyState||r.open("POST",n,!0)}catch(t){throw new Error("issue setting up KeySystem license XHR "+t);}return r.responseType="arraybuffer",r.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,r,n,t,i),r},t._onLicenseRequestReadyStageChange=function(n,t,i,e){if(4===n.readyState)if(200===n.status)this._requestLicenseFailureCount=0,r.logger.log("License request succeeded"),"arraybuffer"!==n.responseType&&r.logger.warn("xhr response type was not set to the expected arraybuffer for license request"),e(n.response);else{if(r.logger.error("License Request XHR failed ("+t+"). Status: "+n.status+" ("+n.statusText+")"),this._requestLicenseFailureCount++,3<this._requestLicenseFailureCount)return void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});t=4-this._requestLicenseFailureCount;r.logger.warn("Retrying license request, "+t+" attempts left");this._requestLicense(i,e)}},t._generateLicenseRequestChallenge=function(n,t){if(n.mediaKeySystemDomain===ut.WIDEVINE)return t;throw new Error("unsupported key-system: "+n.mediaKeySystemDomain);},t._requestLicense=function(n,t){var i;if(r.logger.log("Requesting content license for key-system"),i=this._mediaKeysList[0],!i)return r.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),void this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});try{var e=this.getLicenseServerUrl(i.mediaKeySystemDomain),o=this._createLicenseXhr(e,n,t),s=(r.logger.log("Sending license request to URL: "+e),this._generateLicenseRequestChallenge(i,n));o.send(s)}catch(n){r.logger.error("Failure requesting DRM license: "+n);this.hls.trigger(u.default.ERROR,{type:f.ErrorTypes.KEY_SYSTEM_ERROR,details:f.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},t.onMediaAttached=function(n){this._emeEnabled&&(n=n.media,(this._media=n).addEventListener("encrypted",this._onMediaEncrypted))},t.onMediaDetached=function(){this._media&&(this._media.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null)},t.onManifestParsed=function(n){var t;this._emeEnabled&&(t=n.levels.map(function(n){return n.audioCodec}),n=n.levels.map(function(n){return n.videoCodec}),this._attemptKeySystemAccess(ut.WIDEVINE,t,n))},i=e,(t=[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}])&&hf(i.prototype,t),o&&hf(i,o),e}(h)});i.d(t,"default",function(){return ki});ki=function(n){function i(t){var u,f;if(void 0===t&&(t={}),(u=n.call(this)||this).config=void 0,u._autoLevelCapping=void 0,u.abrController=void 0,u.capLevelController=void 0,u.levelController=void 0,u.streamController=void 0,u.networkControllers=void 0,u.audioTrackController=void 0,u.subtitleTrackController=void 0,u.emeController=void 0,u.coreComponents=void 0,u.media=null,u.url=null,f=i.DefaultConfig,(t.liveSyncDurationCount||t.liveMaxLatencyDurationCount)&&(t.liveSyncDuration||t.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(u.config=so({},f,t),f=l(u).config,void 0!==f.liveMaxLatencyDurationCount&&f.liveMaxLatencyDurationCount<=f.liveSyncDurationCount)throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be gt "liveSyncDurationCount"');if(void 0!==f.liveMaxLatencyDuration&&(void 0===f.liveSyncDuration||f.liveMaxLatencyDuration<=f.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be gt "liveSyncDuration"');Object(r.enableLogs)(f.debug);u._autoLevelCapping=-1;var t=u.abrController=new f.abrController(l(u)),v=new f.bufferController(l(u)),y=u.capLevelController=new f.capLevelController(l(u)),p=new f.fpsController(l(u)),o=new gf(l(u)),h=new ne(l(u)),c=new te(l(u)),w=new fe(l(u)),s=u.levelController=new ou(l(u)),a=new ie(l(u)),s=[s,u.streamController=new uu(l(u),a)],e=f.audioStreamController,o=(e&&s.push(new e(l(u),a)),u.networkControllers=s,[o,h,c,t,v,y,p,w,a]);return(e=f.audioTrackController)&&(h=new e(l(u)),u.audioTrackController=h,o.push(h)),(e=f.subtitleTrackController)&&(c=new e(l(u)),u.subtitleTrackController=c,s.push(c)),(e=f.emeController)&&(t=new e(l(u)),u.emeController=t,o.push(t)),(e=f.subtitleStreamController)&&s.push(new e(l(u),a)),(e=f.timelineController)&&o.push(new e(l(u))),u.coreComponents=o,u}var e,t;return e=n,(t=i).prototype=Object.create(e.prototype),(t.prototype.constructor=t).__proto__=e,i.isSupported=function(){if(!(t=ui()))return!1;var n=self.SourceBuffer||self.WebKitSourceBuffer,t=t&&"function"==typeof t.isTypeSupported&&t.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),n=!n||n.prototype&&"function"==typeof n.prototype.appendBuffer&&"function"==typeof n.prototype.remove;return!!t&&!!n},af(i,null,[{key:"version",get:function(){return"0.13.2"}},{key:"Events",get:function(){return u.default}},{key:"ErrorTypes",get:function(){return f.ErrorTypes}},{key:"ErrorDetails",get:function(){return f.ErrorDetails}},{key:"DefaultConfig",get:function(){return i.defaultConfig||cf},set:function(n){i.defaultConfig=n}}]),t=i.prototype,t.destroy=function(){r.logger.log("destroy");this.trigger(u.default.DESTROYING);this.detachMedia();this.coreComponents.concat(this.networkControllers).forEach(function(n){n.destroy()});this.url=null;this.removeAllListeners();this._autoLevelCapping=-1},t.attachMedia=function(n){r.logger.log("attachMedia");this.media=n;this.trigger(u.default.MEDIA_ATTACHING,{media:n})},t.detachMedia=function(){r.logger.log("detachMedia");this.trigger(u.default.MEDIA_DETACHING);this.media=null},t.loadSource=function(n){n=at.buildAbsoluteURL(window.location.href,n,{alwaysNormalize:!0});r.logger.log("loadSource:"+n);this.url=n;this.trigger(u.default.MANIFEST_LOADING,{url:n})},t.startLoad=function(n){void 0===n&&(n=-1);r.logger.log("startLoad("+n+")");this.networkControllers.forEach(function(t){t.startLoad(n)})},t.stopLoad=function(){r.logger.log("stopLoad");this.networkControllers.forEach(function(n){n.stopLoad()})},t.swapAudioCodec=function(){r.logger.log("swapAudioCodec");this.streamController.swapAudioCodec()},t.recoverMediaError=function(){r.logger.log("recoverMediaError");var n=this.media;this.detachMedia();n&&this.attachMedia(n)},af(i,[{key:"levels",get:function(){return this.levelController.levels}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(n){r.logger.log("set currentLevel:"+n);this.loadLevel=n;this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(n){r.logger.log("set nextLevel:"+n);this.levelController.manualLevel=n;this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(n){r.logger.log("set loadLevel:"+n);this.levelController.manualLevel=n}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(n){this.levelController.nextLoadLevel=n}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(n){r.logger.log("set firstLevel:"+n);this.levelController.firstLevel=n}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(n){r.logger.log("set startLevel:"+n);-1!==n&&(n=Math.max(n,this.minAutoLevel));this.levelController.startLevel=n}},{key:"capLevelToPlayerSize",set:function(n){n=!!n;n!==this.config.capLevelToPlayerSize&&(n?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=n)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(n){r.logger.log("set autoLevelCapping:"+n);this._autoLevelCapping=n}},{key:"bandwidthEstimate",get:function(){var n=this.abrController._bwEstimator;return n?n.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return-1===this.levelController.manualLevel}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){for(var t=this.levels,i=this.config.minAutoBitrate,r=t?t.length:0,n=0;n<r;n++)if(i<(t[n].realBitrate?Math.max(t[n].realBitrate,t[n].bitrate):t[n].bitrate))return n;return 0}},{key:"maxAutoLevel",get:function(){var n=this.levels,t=this.autoLevelCapping,n=-1===t&&n&&n.length?n.length-1:t;return n}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(n){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,n)}},{key:"audioTracks",get:function(){var n=this.audioTrackController;return n?n.audioTracks:[]}},{key:"audioTrack",get:function(){var n=this.audioTrackController;return n?n.audioTrack:-1},set:function(n){var t=this.audioTrackController;t&&(t.audioTrack=n)}},{key:"liveSyncPosition",get:function(){return this.streamController.liveSyncPosition}},{key:"subtitleTracks",get:function(){var n=this.subtitleTrackController;return n?n.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var n=this.subtitleTrackController;return n?n.subtitleTrack:-1},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleTrack=n)}},{key:"subtitleDisplay",get:function(){var n=this.subtitleTrackController;return!!n&&n.subtitleDisplay},set:function(n){var t=this.subtitleTrackController;t&&(t.subtitleDisplay=n)}}]),i}(hr);ki.defaultConfig=void 0},"./src/polyfills/number-isFinite.js":function(n,t,i){"use strict";i.r(t);i.d(t,"isFiniteNumber",function(){return r});var r=Number.isFinite||function(n){return"number"==typeof n&&isFinite(n)}},"./src/utils/get-self-scope.js":function(n,t,i){"use strict";function r(){return"undefined"==typeof window?self:window}i.r(t);i.d(t,"getSelfScope",function(){return r})},"./src/utils/logger.js":function(n,t,i){"use strict";function r(){}function h(n){var t=e.console[n];return t?function(){for(var f,u,o=arguments.length,i=new Array(o),r=0;r<o;r++)i[r]=arguments[r];i[0]&&(i[0]=(f=n,u=i[0],u="["+f+"] > "+u));t.apply(e.console,i)}:r}var o,s;i.r(t);i.d(t,"enableLogs",function(){return o});i.d(t,"logger",function(){return s});t=i("./src/utils/get-self-scope.js");var f={trace:r,debug:r,log:r,warn:r,info:r,error:r},u=f,e=Object(t.getSelfScope)();o=function(n){if(e.console&&!0===n||"object"==typeof n){!function(n){for(var i=arguments.length,r=new Array(1<i?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];r.forEach(function(t){u[t]=n[t]?n[t].bind(n):h(t)})}(n,"debug","log","info","warn","error");try{u.log()}catch(n){u=f}}else u=f};s=u}},n.c=t,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},n.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},n.t=function(t,i){var r,u;if((1&i&&(t=n(t)),8&i)||4&i&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(u in t)n.d(r,u,function(n){return t[n]}.bind(null,u));return r},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},n.p="/dist/",n(n.s="./src/hls.ts").default;var i,t},n.exports=t())}]);typeof module=="object"&&module.exports&&(module.exports=window.hlsSourceHandler),function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("video.js"),require("global/document")):typeof define=="function"&&define.amd?define(["video.js","global/document"],t):n.videojsContribQualityLevels=t(n.videojs,n.document)}(this,function(n,t){"use strict";function s(n,t){n.prototype=Object.create(t.prototype);n.prototype.constructor=n;n.__proto__=t}function u(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}var r,i,e;n=n&&n.hasOwnProperty("default")?n["default"]:n;t=t&&t.hasOwnProperty("default")?t["default"]:t;r=function r(i){var u=this,f;if(n.browser.IS_IE8){u=t.createElement("custom");for(f in r.prototype)f!=="constructor"&&(u[f]=r.prototype[f])}return u.id=i.id,u.label=u.id,u.width=i.width,u.height=i.height,u.bitrate=i.bandwidth,u.enabled_=i.enabled,Object.defineProperty(u,"enabled",{get:function(){return u.enabled_()},set:function(n){u.enabled_(n)}}),u};i=function(i){function f(){var o,r,e;if(o=i.call(this)||this,r=u(u(o)),n.browser.IS_IE8){r=t.createElement("custom");for(e in f.prototype)e!=="constructor"&&(r[e]=f.prototype[e])}return r.levels_=[],r.selectedIndex_=-1,Object.defineProperty(r,"selectedIndex",{get:function(){return r.selectedIndex_}}),Object.defineProperty(r,"length",{get:function(){return r.levels_.length}}),r||u(o)}s(f,i);var e=f.prototype;return e.addQualityLevel=function(n){var t=this.getQualityLevelById(n.id),i;return t?t:(i=this.levels_.length,t=new r(n),""+i in this||Object.defineProperty(this,i,{get:function(){return this.levels_[i]}}),this.levels_.push(t),this.trigger({qualityLevel:t,type:"addqualitylevel"}),t)},e.removeQualityLevel=function(n){for(var i=null,t=0,r=this.length;t<r;t++)if(this[t]===n){i=this.levels_.splice(t,1)[0];this.selectedIndex_===t?this.selectedIndex_=-1:this.selectedIndex_>t&&this.selectedIndex_--;break}return i&&this.trigger({qualityLevel:n,type:"removequalitylevel"}),i},e.getQualityLevelById=function(n){for(var i,t=0,r=this.length;t<r;t++)if(i=this[t],i.id===n)return i;return null},e.dispose=function(){this.selectedIndex_=-1;this.levels_.length=0},f}(n.EventTarget);i.prototype.allowedEvents_={change:"change",addqualitylevel:"addqualitylevel",removequalitylevel:"removequalitylevel"};for(e in i.prototype.allowedEvents_)i.prototype["on"+e]=null;var o="2.0.9",h=n.registerPlugin||n.plugin,c=function(n){var u=n.qualityLevels,t=new i,r=function r(){t.dispose();n.qualityLevels=u;n.off("dispose",r)};n.on("dispose",r);return n.qualityLevels=function(){return t},n.qualityLevels.VERSION=o,t},f=function(t){return c(this,n.mergeOptions({},t))};return h("qualityLevels",f),f.VERSION=o,f}),function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t(require("video.js")):typeof define=="function"&&define.amd?define(["video.js"],t):n.videojsHlsQualitySelector=t(n.videojs)}(this,function(n){"use strict";function c(n){return typeof n!="string"?n:n.charAt(0).toUpperCase()+n.slice(1)}n=n&&n.hasOwnProperty("default")?n["default"]:n;var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},k=function(){function t(n){this.value=n}function n(n){function e(n,t){return new Promise(function(f,e){var o={key:n,arg:t,resolve:f,reject:e,next:null};r?r=r.next=o:(i=r=o,u(n,t))})}function u(i,r){try{var e=n[i](r),o=e.value;o instanceof t?Promise.resolve(o.value).then(function(n){u("next",n)},function(n){u("throw",n)}):f(e.done?"return":"normal",e.value)}catch(s){f("throw",s)}}function f(n,t){switch(n){case"return":i.resolve({value:t,done:!0});break;case"throw":i.reject(t);break;default:i.resolve({value:t,done:!1})}i=i.next;i?u(i.key,i.arg):r=null}var i,r;this._invoke=e;typeof n.return!="function"&&(this.return=undefined)}return typeof Symbol=="function"&&Symbol.asyncIterator&&(n.prototype[Symbol.asyncIterator]=function(){return this}),n.prototype.next=function(n){return this._invoke("next",n)},n.prototype.throw=function(n){return this._invoke("throw",n)},n.prototype.return=function(n){return this._invoke("return",n)},{wrap:function(t){return function(){return new n(t.apply(this,arguments))}},await:function(n){return new t(n)}}}(),t=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");},u=function(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof t);n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}});t&&(Object.setPrototypeOf?Object.setPrototypeOf(n,t):n.__proto__=t)},f=function(n,t){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t&&(typeof t=="object"||typeof t=="function")?t:n},e=n.getComponent("MenuButton"),o=n.getComponent("Menu"),s=n.getComponent("Component"),h=n.dom;var l=function(n){function i(r){return t(this,i),f(this,n.call(this,r,{title:r.localize("Quality"),name:"QualityButton"}))}return u(i,n),i.prototype.createItems=function(){return[]},i.prototype.createMenu=function(){var t=new o(this.player_,{menuButton:this}),i,r,n;if(this.hideThreshold_=0,this.options_.title&&(i=h.createEl("li",{className:"vjs-menu-title",innerHTML:c(this.options_.title),tabIndex:-1}),r=new s(this.player_,{el:i}),this.hideThreshold_+=1,t.addItem(r)),this.items=this.createItems(),this.items)for(n=0;n<this.items.length;n++)t.addItem(this.items[n]);return t},i}(e),a=n.getComponent("MenuItem"),v=function(n){function i(r,u,e,o){t(this,i);var s=f(this,n.call(this,r,{label:u.label,selectable:!0,selected:u.selected||!1}));return s.item=u,s.qualityButton=e,s.plugin=o,s}return u(i,n),i.prototype.handleClick=function(){for(var n=0;n<this.qualityButton.items.length;++n)this.qualityButton.items[n].selected(!1);this.plugin.setQuality(this.item.value);this.selected(!0)},i}(a),y={},p=n.registerPlugin||n.plugin,w=function(){function n(i,r){t(this,n);this.player=i;this.config=r;this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}return n.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls},n.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))},n.prototype.createQualityButton=function(){var t=this.player,i,n,r;this._qualityButton=new l(t);i=t.controlBar.children().length-2;n=t.controlBar.addChild(this._qualityButton,{componentClass:"qualitySelector"},this.config.placementIndex||i);n.addClass("vjs-quality-selector");this.config.displayCurrentQuality?this.setButtonInnerText("auto"):(r=" "+(this.config.vjsIconClass||"vjs-icon-hd"),n.menuButton_.$(".vjs-icon-placeholder").className+=r);n.removeClass("vjs-hidden")},n.prototype.setButtonInnerText=function(n){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=n},n.prototype.getQualityMenuItem=function(n){var t=this.player;return new v(t,n,this._qualityButton,this)},n.prototype.onAddQualityLevel=function(){for(var u=this,f=this.player,e=f.qualityLevels(),t=e.levels_||[],n=[],o=function(i){if(!n.filter(function(n){return n.item&&n.item.value===t[i].height}).length){var r=u.getQualityMenuItem.call(u,{label:t[i].height+"p",value:t[i].height});n.push(r)}},i=0;i<t.length;++i)o(i);n.sort(function(n,t){return(typeof n=="undefined"?"undefined":r(n))!=="object"||(typeof t=="undefined"?"undefined":r(t))!=="object"?-1:n.item.value<t.item.value?-1:n.item.value>t.item.value?1:0});n.push(this.getQualityMenuItem.call(this,{label:f.localize("Auto"),value:"auto",selected:!0}));this._qualityButton&&(this._qualityButton.createItems=function(){return n},this._qualityButton.update())},n.prototype.setQuality=function(n){var r=this.player.qualityLevels(),t,i;for(this._currentQuality=n,this.config.displayCurrentQuality&&this.setButtonInnerText(n==="auto"?n:n+"p"),t=0;t<r.length;++t)i=r[t],i.enabled=i.height===n||n==="auto";this._qualityButton.unpressButton()},n.prototype.getCurrentQuality=function(){return this._currentQuality||"auto"},n}(),b=function(n,t){n.addClass("vjs-hls-quality-selector");n.hlsQualitySelector=new w(n,t)},i=function(t){var i=this;this.ready(function(){b(i,n.mergeOptions(y,t))})};return p("hlsQualitySelector",i),i.VERSION="1.1.4",i});var App=App||{};App.VideoJsPlayerInitializer=function(){function f(f,h,c,l=true){if(c?(c.userActions={hotkeys:function(t){t.which===37&&(t.preventDefault(),i(n));t.which===39&&(t.preventDefault(),r(n));t.which===38&&(t.preventDefault(),o(n));t.which===40&&(t.preventDefault(),e(n));t.which===32&&(t.preventDefault(),u(n))}},n=videojs(f,c)):n=videojs(f),l){var a=window.localStorage.getItem(h);n.currentTime(a===null?0:a)}n.hlsQualitySelector({displayCurrentQuality:!0});n.on("ended",function(){t=!0});n.qualityLevels().addEventListener("addqualitylevel",function(){setTimeout(function(){n.hlsQualitySelector._qualityButton&&n.hlsQualitySelector._qualityButton.children().forEach(n=>{n.children().forEach(n=>n.off("keydown"))})},1)});n.ready(function(){n.hlsQualitySelector._qualityButton&&n.hlsQualitySelector._qualityButton.off("keydown");$(".vjs-control").on("keydown",function(t){t.which==32&&(t.stopImmediatePropagation(),t.preventDefault(),t.stopPropagation(),u(n))});this.el_.querySelector(".vjs-text-track-display").style.pointerEvents="auto";this.el_.querySelector(".vjs-text-track-display").addEventListener("click",function(){n.el_.classList.contains("vjs-touch-enabled")||(n.paused()?n.play():n.pause())});document.querySelector(".vjs-text-track-display").addEventListener("dblclick",function(t){if(n.el_.classList.contains("vjs-touch-enabled")){const u=document.querySelector("#"+f).getBoundingClientRect().width;.66*u<t.offsetX?r(n):t.offsetX<.33*u&&i(n)}else n.isFullscreen()?n.exitFullscreen():n.requestFullscreen()});var e=n.options().playbackRates,t=e.indexOf(n.playbackRate());$("<span class='vjs-playback-rate-minus fa fa-minus'><\/span>").prependTo(".vjs-playback-rate.vjs-control").click(function(){t-1>=0&&t-1<e.length&&(n.playbackRate(e[t-1]),t--)});$("<span class='vjs-playback-rate-plus fa fa-plus'><\/span>").appendTo(".vjs-playback-rate.vjs-control").click(function(){t+1>=0&&t+1<e.length&&(n.playbackRate(e[t+1]),t++)})});l&&setInterval(s,5e3,n,h)}function i(n){n.currentTime(n.currentTime()-5<0?0:n.currentTime()-5)}function r(n){n.currentTime(n.currentTime()+5>n.duration()?n.duration()-1:n.currentTime()+5)}function e(n){n.volume(n.volume()===0?0:n.volume()-.1)}function o(n){n.volume(n.volume===1?1:n.volume()+.1)}function u(n){n.paused()?n.play():n.pause()}function s(n,i){window.localStorage.setItem(i,t?0:n.currentTime())}var n,t=!1;return{init:f}}()